<html><head><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"><title>WinDriver&#8482; PCI&#65279;/&#65279;ISA User's Manual</title><link rel="stylesheet" type="text/css" href="html_theme.css"><meta name="generator" content="DocBook XSL Stylesheets V1.78.1"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div style="margin-top: 1.25em; margin-bottom: 2.5em;"><div xmlns:fo="http://www.w3.org/1999/XSL/Format" id="j_vendor_logos"><img src="images/logo_jungo_site.png" alt="Jungo Connectivity Ltd."></div></div><div class="book"><div class="titlepage"><div><div><h1 class="title"><a name="idp46253651601232"></a>WinDriver&#8482; PCI&#65279;/&#65279;ISA User's Manual</h1></div><div><div class="author"><h3 class="author"><span class="firstname">Jungo Connectivity Ltd.</span></h3></div></div><div><p class="releaseinfo"><span class="book_releaseinfo">
    Version 12.8.1
  </span></p></div><div><p class="copyright">Copyright ©  2018 Jungo Connectivity Ltd. All Rights Reserved
    </p></div><div><div class="legalnotice"><a name="idp46253631010240"></a><p>
    Information in this document is subject to change without notice. The
    software described in this document is furnished under a license agreement.
    The software may be used, copied or distributed only in accordance with
    that agreement. No part of this publication may be reproduced, stored in a
    retrieval system, or transmitted in any form or any means, electronically
    or mechanically, including photocopying and recording for any purpose
    without the written permission of Jungo Connectivity Ltd.
    </p><p>
    Brand and product names mentioned in this document are trademarks of their
    respective owners and are used here only for identification purposes.
    </p></div></div></div><hr></div><div class="toc"><p><b>Table of Contents</b></p><dl class="toc"><dt><span class="chapter"><a href="#WD_Overview">1. WinDriver Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_intro">1.1. Introduction to WinDriver</a></span></dt><dt><span class="section"><a href="#WD_overview_background">1.2. Background</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_overview_the_challenge">1.2.1. The Challenge</a></span></dt><dt><span class="section"><a href="#WD_overview_the_WD_solution">1.2.2. The WinDriver Solution</a></span></dt></dl></dd><dt><span class="section"><a href="#WD_overview_how_fast">1.3. How Fast Can WinDriver Go?</a></span></dt><dt><span class="section"><a href="#WD_overview_conclusion">1.4. Conclusion</a></span></dt><dt><span class="section"><a href="#WD_benefits">1.5. WinDriver Benefits</a></span></dt><dt><span class="section"><a href="#WD_arch">1.6. WinDriver Architecture</a></span></dt><dt><span class="section"><a href="#WD_sup_platforms">1.7. What Platforms Does WinDriver Support?</a></span></dt><dt><span class="section"><a href="#WD_eval_limits">1.8. Limitations of the Different Evaluation Versions</a></span></dt><dt><span class="section"><a href="#WD_dev_overview">1.9. How Do I Develop My Driver with WinDriver?</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_dev_winnoce_mac_unix">1.9.1. On Windows and Linux</a></span></dt></dl></dd><dt><span class="section"><a href="#WD_toolkit_include">1.10. What Does the WinDriver Toolkit Include?</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_modules">1.10.1. WinDriver Modules</a></span></dt><dt><span class="section"><a href="#WD_utilities">1.10.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Utilities</span></a></span></dt><dt><span class="section"><a href="#WD_samples">1.10.3. Samples<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> and Enhanced-Support Chipset APIs</span></a></span></dt><dd><dl><dt><span class="section"><a href="#spec_chipset_sup">1.10.3.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Enhanced Chipset Support</span></a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#wd_can_distrib">1.11. Can I Distribute the Driver Created with WinDriver?</a></span></dt></dl></dd><dt><span class="chapter"><a href="#understanding_device_drivers">2. Understanding Device Drivers</a></span></dt><dd><dl><dt><span class="section"><a href="#device_driver_overview">2.1. Device Driver Overview</a></span></dt><dt><span class="section"><a href="#drivers_func_classification">2.2. Classification of Drivers According to Functionality</a></span></dt><dd><dl><dt><span class="section"><a href="#mono_drivers">2.2.1. Monolithic Drivers</a></span></dt><dt><span class="section"><a href="#layered_drivers">2.2.2. Layered Drivers</a></span></dt><dt><span class="section"><a href="#miniport_drivers">2.2.3. Miniport Drivers</a></span></dt></dl></dd><dt><span class="section"><a href="#os_classification">2.3. Classification of Drivers According to Operating Systems</a></span></dt><dd><dl><dt><span class="section"><a href="#wdm_drivers_overview">2.3.1. WDM Drivers</a></span></dt><dt><span class="section"><a href="#unix_drivers_overview">2.3.2. Unix Device Drivers</a></span></dt><dt><span class="section"><a href="#linux_drivers_overview">2.3.3. Linux Device Drivers</a></span></dt></dl></dd><dt><span class="section"><a href="#driver_entry_point">2.4. The Entry Point of the Driver</a></span></dt><dt><span class="section"><a href="#hw_driver_assoc">2.5. Associating the Hardware with the Driver</a></span></dt><dt><span class="section"><a href="#communicating_with_drivers">2.6. Communicating with Drivers</a></span></dt></dl></dd><dt><span class="chapter"><a href="#wd_install">3. Installing WinDriver</a></span></dt><dd><dl><dt><span class="section"><a href="#sys_req">3.1. System Requirements</a></span></dt><dd><dl><dt><span class="section"><a href="#sys_req_windows">3.1.1. Windows System Requirements</a></span></dt><dt><span class="section"><a href="#sys_req_windows_10iotcore">3.1.2. Windows 10 IoT Core System Requirements</a></span></dt><dt><span class="section"><a href="#sys_req_linux">3.1.3. Linux System Requirements</a></span></dt></dl></dd><dt><span class="section"><a href="#wd_install_process">3.2. WinDriver Installation Process</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_install_windows">3.2.1. Windows WinDriver Installation Instructions</a></span></dt><dt><span class="section"><a href="#wd_install_linux">3.2.2. Linux WinDriver Installation Instructions</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_install_linux_prepare">3.2.2.1. Preparing the System for Installation</a></span></dt><dt><span class="section"><a href="#wd_linux_installation">3.2.2.2. Installation</a></span></dt><dt><span class="section"><a href="#linux_hw_access_restrict">3.2.2.3. Restricting Hardware Access on Linux</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#wd_install_upgrade">3.3. Upgrading Your Installation</a></span></dt><dt><span class="section"><a href="#wd_install_check">3.4. Checking Your Installation</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_install_check_windows_mac_unix">3.4.1. Windows and Linux Installation Check</a></span></dt></dl></dd><dt><span class="section"><a href="#wd_uninstall">3.5. Uninstalling WinDriver</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_uninstall_windows">3.5.1. Windows WinDriver Uninstall Instructions</a></span></dt><dt><span class="section"><a href="#wd_uninstall_linux">3.5.2. Linux WinDriver Uninstall Instructions</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#driverwizard">4. Using DriverWizard</a></span></dt><dd><dl><dt><span class="section"><a href="#wiz_overview">4.1. An Overview</a></span></dt><dt><span class="section"><a href="#DriverWizard_Walkthrough">4.2. DriverWizard Walkthrough</a></span></dt><dd><dl><dt><span class="section"><a href="#wiz_auto_code_gen">4.2.1. Automatic Code Generation</a></span></dt><dd><dl><dt><span class="section"><a href="#wiz_code_gen">4.2.1.1. Generating the Code</a></span></dt><dt><span class="section"><a href="#wiz_gen_C_code_pci">4.2.1.2. The Generated PCI/ISA C Code</a></span></dt><dt><span class="section"><a href="#wiz_gen_py_code_pci">4.2.1.3. The Generated PCI/ISA Python Code</a></span></dt><dt><span class="section"><a href="#wiz_gen_cs_code_pci">4.2.1.4. The Generated PCI/ISA C#.NET Code</a></span></dt></dl></dd><dt><span class="section"><a href="#wiz_gen_code_compile">4.2.2. Compiling the Generated Code</a></span></dt><dd><dl><dt><span class="section"><a href="#wiz_win_gen_code_compile">4.2.2.1. Windows Compilation</a></span></dt><dd><dl><dt><span class="section"><a href="#wiz_running_compiled_win10iot">4.2.2.1.1. Running compiled code under Windows 10 IoT Core</a></span></dt></dl></dd><dt><span class="section"><a href="#wiz_unix_gen_code_compile">4.2.2.2. Linux Compilation</a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="chapter"><a href="#driver_develop">5. Developing a Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#dev_driver_use_wiz">5.1. Using DriverWizard to Build a Device Driver</a></span></dt><dt><span class="section"><a href="#driver_dev_no_wizard">5.2. Writing the Device Driver Without DriverWizard</a></span></dt><dd><dl><dt><span class="section"><a href="#no_wiz_include_req_wd_files">5.2.1. Include the Required WinDriver Files</a></span></dt><dt><span class="section"><a href="#no_wiz_write_your_code">5.2.2. Write Your Code</a></span></dt><dt><span class="section"><a href="#no_wiz_cfg_n_build_code">5.2.3. Configure and Build Your Code</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#debugging_drivers">6. Debugging Drivers</a></span></dt><dd><dl><dt><span class="section"><a href="#dbg_user">6.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">User-Mode Debugging</span></a></span></dt><dt><span class="section"><a href="#Debug_Monitor">6.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Debug Monitor</span></a></span></dt><dd><dl><dt><span class="section"><a href="#wddebug_gui">6.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">The wddebug_gui Utility</span></a></span></dt><dd><dl><dt><span class="section"><a href="#search%20in%20wddebug_gui">6.2.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Search in wddebug_gui</span></a></span></dt><dt><span class="section"><a href="#wddebug_gui_kernel_dump">6.2.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Opening Windows kernel crash dump with wddebug_gui</span></a></span></dt><dt><span class="section"><a href="#wddebug_gui_renamed_driver">6.2.1.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Running wddebug_gui for a Renamed Driver</span></a></span></dt></dl></dd><dt><span class="section"><a href="#wddebug">6.2.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">The wddebug Utility</span></a></span></dt><dd><dl><dt><span class="section"><a href="#wddebug_console">6.2.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Console-Mode wddebug Execution</span></a></span></dt><dt><span class="section"><a href="#wddebug_win10iot">6.2.2.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Debugging in Windows 10 IoT Core</span></a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="chapter"><a href="#enhanced_support">7. Enhanced Support for Specific Chipsets</a></span></dt><dd><dl><dt><span class="section"><a href="#Enhanced_Support_Overview">7.1. Overview</a></span></dt><dt><span class="section"><a href="#dev_drv_enhanced_sup">7.2. Developing a Driver Using the Enhanced Chipset Support</a></span></dt></dl></dd><dt><span class="chapter"><a href="#PCI_Express">8. PCI Express</a></span></dt><dd><dl><dt><span class="section"><a href="#PCI_Express_Overview">8.1. PCI Express Overview</a></span></dt><dt><span class="section"><a href="#WD_PCI_Express">8.2. WinDriver for PCI Express</a></span></dt></dl></dd><dt><span class="chapter"><a href="#Advanced_Issues">9. Advanced Issues</a></span></dt><dd><dl><dt><span class="section"><a href="#advanced_issues_dma">9.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Performing Direct Memory Access (DMA)</span></a></span></dt><dd><dl><dt><span class="section"><a href="#sg_dma_impl">9.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Implementing Scatter/&#65279;Gather DMA</span></a></span></dt><dt><span class="section"><a href="#ctg_dma_impl">9.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""> Implementing Contiguous-Buffer DMA</span></a></span></dt><dd><dl><dt><span class="section"><a href="#ctg_dma_prealloc_win">9.1.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Preallocating Contiguous DMA Buffers on Windows</span></a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#Handling_Interrupts">9.2. Handling Interrupts</a></span></dt><dd><dl><dt><span class="section"><a href="#int_handling_overview">9.2.1. Interrupt Handling &#8212; Overview</a></span></dt><dt><span class="section"><a href="#wd_int_seq">9.2.2. WinDriver Interrupt Handling Sequence</a></span></dt><dt><span class="section"><a href="#wd_win_isa_irq_reg">9.2.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Registering IRQs for Non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play Hardware on Windows 7 and Higher</span></a></span></dt><dt><span class="section"><a href="#wd_get_sup_int_types">9.2.4. Determining the Interrupt Types Supported by the Hardware</a></span></dt><dt><span class="section"><a href="#wd_get_enabled_int_type">9.2.5. Determining the Interrupt Type Enabled for a PCI Card</a></span></dt><dt><span class="section"><a href="#wd_int_trans_cmd">9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands</a></span></dt><dd><dl><dt><span class="section"><a href="#int_mask_cmd">9.2.6.1. Interrupt Mask Commands</a></span></dt><dt><span class="section"><a href="#wd_trans_cmds_sample">9.2.6.2. Sample WinDriver Transfer Commands Code</a></span></dt></dl></dd><dt><span class="section"><a href="#wd_msi_handling">9.2.7. WinDriver MSI/MSI-&#65279;X Interrupt Handling</a></span></dt><dd><dl><dt><span class="section"><a href="#win_msi_inf_files">9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files</a></span></dt></dl></dd><dt><span class="section"><a href="#wd_int_samp_user_code">9.2.8. Sample User-Mode WinDriver Interrupt Handling Code</a></span></dt></dl></dd><dt><span class="section"><a href="#sharing_buffer">9.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Buffer sharing between multiple processes</span></a></span></dt></dl></dd><dt><span class="chapter"><a href="#performance_improve">10. Improving Performance</a></span></dt><dd><dl><dt><span class="section"><a href="#wdpci_perf_imprv_overview">10.1. Overview</a></span></dt><dd><dl><dt><span class="section"><a href="#pci_wd_perf_checklist">10.1.1. Performance Improvement Checklist</a></span></dt></dl></dd><dt><span class="section"><a href="#perf_user_impr">10.2. Improving the Performance of a User&#65279;-&#65279;Mode Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#mem_direct_access">10.2.1. Using Direct Access to Memory-Mapped Regions</a></span></dt><dt><span class="section"><a href="#perf_block_multi_trans">10.2.2. Block Transfers and Grouping Multiple Transfers</a></span></dt><dt><span class="section"><a href="#64_bit_data_transfers">10.2.3. Performing 64-&#65279;Bit Data Transfers</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#WinDriver_Kernel_PlugIn">11. Understanding the Kernel PlugIn</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_background">11.1. Background</a></span></dt><dt><span class="section"><a href="#kp_when_needed">11.2. Do I Need to Write a Kernel PlugIn Driver?</a></span></dt><dt><span class="section"><a href="#kp_perf">11.3. What Kind of Performance Can I Expect?</a></span></dt><dt><span class="section"><a href="#kp_dev_process">11.4. Overview of the Development Process</a></span></dt><dt><span class="section"><a href="#kp_arch">11.5. The Kernel PlugIn Architecture</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_arch_overview">11.5.1. Architecture Overview</a></span></dt><dt><span class="section"><a href="#wd_kp_inter">11.5.2. WinDriver's Kernel and Kernel PlugIn Interaction</a></span></dt><dt><span class="section"><a href="#kp_comp">11.5.3. Kernel PlugIn Components</a></span></dt><dt><span class="section"><a href="#KP_Event_Sequence">11.5.4. Kernel PlugIn Event Sequence</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_open_handle_from_user">11.5.4.1. Opening a Handle from the User Mode to a Kernel PlugIn Driver</a></span></dt><dt><span class="section"><a href="#kp_handle_user_requests">11.5.4.2. Handling User-Mode Requests from the Kernel PlugIn</a></span></dt><dt><span class="section"><a href="#kp_ints_enable_disable_highirql">11.5.4.3. Interrupt Handling &#8212; Enable&#65279;/&#65279;Disable and
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">High Interrupt Request Level Processing</span></a></span></dt><dt><span class="section"><a href="#kp_int_dpc">11.5.4.4. Interrupt Handling &#8212; Deferred Procedure Calls</a></span></dt><dt><span class="section"><a href="#kp_pnp">11.5.4.5. Plug&#65279;-&#65279;and&#65279;-&#65279;Play and Power Management Events</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#kp_how_does_it_work">11.6. How Does Kernel PlugIn Work?</a></span></dt><dd><dl><dt><span class="section"><a href="#KP_min_requirements">11.6.1. Minimal Requirements for Creating a Kernel PlugIn Driver</a></span></dt><dt><span class="section"><a href="#kp_implementation">11.6.2. Kernel PlugIn Implementation</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_before_you_begin">11.6.2.1. Before You Begin</a></span></dt><dt><span class="section"><a href="#KP_Init_write">11.6.2.2. Write Your KP_Init Function</a></span></dt><dt><span class="section"><a href="#KP_Open_write">11.6.2.3. Write Your KP_Open Function(s)</a></span></dt><dt><span class="section"><a href="#kp_cbs_write">11.6.2.4. Write the Remaining PlugIn Callbacks</a></span></dt></dl></dd><dt><span class="section"><a href="#samp_gen_KP_code">11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview</a></span></dt><dt><span class="section"><a href="#KP_dir_structure">11.6.4. Kernel PlugIn Sample/Generated Code Directory Structure</a></span></dt><dd><dl><dt><span class="section"><a href="#pci_diag_kp_pci_dir">11.6.4.1. pci_diag and kp_pci Sample Directories</a></span></dt><dt><span class="section"><a href="#kp_gen_dir">11.6.4.2. The Generated DriverWizard Kernel PlugIn Directory</a></span></dt></dl></dd><dt><span class="section"><a href="#KP_int_handling">11.6.5. Handling Interrupts in the Kernel PlugIn</a></span></dt><dd><dl><dt><span class="section"><a href="#user_mode_int_handling">11.6.5.1. Interrupt Handling in the User Mode
  (Without the Kernel PlugIn)</a></span></dt><dt><span class="section"><a href="#kernel_int_handling_w_kp">11.6.5.2. Interrupt Handling in the Kernel (Using the Kernel PlugIn)</a></span></dt></dl></dd><dt><span class="section"><a href="#kp_message_passing">11.6.6. Message Passing</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#kp_create">12. Creating a Kernel PlugIn Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_decide_if_needed">12.1. Determine Whether a Kernel PlugIn is Needed</a></span></dt><dt><span class="section"><a href="#kp_languages">12.2. What programming languages can be used with a Kernel PlugIn?</a></span></dt><dt><span class="section"><a href="#kp_prepare_user_code">12.3. Prepare the User-Mode Source Code</a></span></dt><dt><span class="section"><a href="#kp_create_kp_proj">12.4. Create a New Kernel PlugIn Project</a></span></dt><dt><span class="section"><a href="#kp_handle_open">12.5. Open a Handle to the Kernel PlugIn</a></span></dt><dt><span class="section"><a href="#KP_int_handling_set">12.6. Set Interrupt Handling in the Kernel PlugIn</a></span></dt><dt><span class="section"><a href="#KP_io_handling_set">12.7. Set I/&#65279;O Handling in the Kernel PlugIn</a></span></dt><dt><span class="section"><a href="#KP_compile">12.8. Compile Your Kernel PlugIn Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_compilation_windows">12.8.1. Windows Kernel PlugIn Driver Compilation</a></span></dt><dt><span class="section"><a href="#kp_compilation_linux">12.8.2. Linux Kernel PlugIn Driver Compilation</a></span></dt></dl></dd><dt><span class="section"><a href="#KP_install">12.9. Install Your Kernel PlugIn Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#KP_install_win32">12.9.1. Windows Kernel PlugIn Driver Installation</a></span></dt><dt><span class="section"><a href="#KP_install_linux">12.9.2. Linux Kernel PlugIn Driver Installation</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#Dynamic_Driver_Load">13. Dynamically Loading Your Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#dyn_load_why">13.1. Why Do You Need a Dynamically Loadable Driver?</a></span></dt><dt><span class="section"><a href="#dyn_windows">13.2. Windows Dynamic Driver Loading</a></span></dt><dd><dl><dt><span class="section"><a href="#dyn_windows_wdreg">13.2.1. The wdreg Utility</a></span></dt><dd><dl><dt><span class="section"><a href="#wdreg_WDM">13.2.1.1. WDM Drivers</a></span></dt><dt><span class="section"><a href="#wdreg_non_WDM">13.2.1.2. Non-WDM Drivers</a></span></dt></dl></dd><dt><span class="section"><a href="#dyn_windrvr_inf_load">13.2.2. Dynamically Loading/Unloading windrvr1281.sys INF
  Files</a></span></dt><dt><span class="section"><a href="#dyn_kp_load_windows">13.2.3. Dynamically Loading/Unloading Your Kernel PlugIn Driver</a></span></dt></dl></dd><dt><span class="section"><a href="#wdreg_frontend">13.3. The wdreg_frontend utility</a></span></dt><dt><span class="section"><a href="#dyn_win10iot">13.4. Windows 10 IoT Core Dynamic Driver Loading</a></span></dt><dt><span class="section"><a href="#dyn_linux">13.5. Linux Dynamic Driver Loading</a></span></dt><dd><dl><dt><span class="section"><a href="#dyn_kp_load_linux">13.5.1. Dynamically Loading/Unloading Your Kernel PlugIn Driver</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#driver_distribution">14. Distributing Your Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#distr_get_valid_lic">14.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Getting a Valid WinDriver License</span></a></span></dt><dt><span class="section"><a href="#dist_winpnp">14.2. Windows Driver Distribution</a></span></dt><dd><dl><dt><span class="section"><a href="#dist_winpnp_pkg_prepare">14.2.1. Preparing the Distribution Package</a></span></dt><dt><span class="section"><a href="#dist_winpnp_install_on_target">14.2.2. Installing Your Driver on the Target Computer</a></span></dt><dt><span class="section"><a href="#dist_winpnp_kp_install_on_target">14.2.3. Installing Your Kernel PlugIn on the Target Computer</a></span></dt></dl></dd><dt><span class="section"><a href="#dist_linux">14.3. Linux Driver Distribution</a></span></dt><dd><dl><dt><span class="section"><a href="#dist_linux_pkg_prepare">14.3.1. Preparing the Distribution Package</a></span></dt><dd><dl><dt><span class="section"><a href="#dist_linux_pkg_prepare_kernel_modules">14.3.1.1. Kernel Module Components</a></span></dt><dt><span class="section"><a href="#dist_linux_pkg_prepare_user_hw_ctrl_app_so">14.3.1.2. User-Mode Hardware-Control Application or Shared Object</a></span></dt></dl></dd><dt><span class="section"><a href="#dist_linux_build_install_wd_modules">14.3.2. Building and Installing the WinDriver Driver Module on the Target</a></span></dt><dt><span class="section"><a href="#dist_linux_build_install_kp_module">14.3.3. Building and Installing Your Kernel PlugIn Driver on the Target</a></span></dt><dt><span class="section"><a href="#dist_linux_install_user_hw_ctrl_app_so">14.3.4. Installing the User-Mode Hardware-Control Application or
  Shared Object</a></span></dt></dl></dd></dl></dd><dt><span class="chapter"><a href="#driver_install_advanced">15. Driver Installation &#8212; Advanced Issues</a></span></dt><dd><dl><dt><span class="section"><a href="#winpnp_inf">15.1. Windows INF Files</a></span></dt><dd><dl><dt><span class="section"><a href="#Why_Create_INF">15.1.1. Why Should I Create an INF File?</a></span></dt><dt><span class="section"><a href="#INF_install_no_driver">15.1.2. How Do I Install an INF File When No Driver Exists?</a></span></dt><dt><span class="section"><a href="#INF_replace_driver">15.1.3. How Do I Replace an Existing Driver Using the INF File?</a></span></dt></dl></dd><dt><span class="section"><a href="#wd_rename_driver">15.2. Renaming the WinDriver Kernel Driver</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_rename_driver_windows">15.2.1. Windows Driver Renaming</a></span></dt><dt><span class="section"><a href="#wd_rename_driver_linux">15.2.2. Linux Driver Renaming</a></span></dt></dl></dd><dt><span class="section"><a href="#driver_sign">15.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Windows Digital Driver Signing and Certification</span></a></span></dt><dd><dl><dt><span class="section"><a href="#driver_sign_n_cert_overview">15.3.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Overview</span></a></span></dt><dd><dl><dt><span class="section"><a href="#authenticode_overview">15.3.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Authenticode Driver Signature</span></a></span></dt><dt><span class="section"><a href="#whql_overview">15.3.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Windows Certification Program</span></a></span></dt></dl></dd><dt><span class="section"><a href="#driver_sign_wd_drivers">15.3.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Driver Signing and Certification of WinDriver-Based Drivers</span></a></span></dt><dd><dl><dt><span class="section"><a href="#hck_test_notes">15.3.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">HCK Test Notes</span></a></span></dt></dl></dd></dl></dd></dl></dd><dt><span class="appendix"><a href="#64bit_os_sup">A. 64-&#65279;Bit Operating Systems Support</a></span></dt><dd><dl><dt><span class="section"><a href="#64bit_arch_sup">A.1. Supported 64-&#65279;Bit Architectures</a></span></dt><dt><span class="section"><a href="#32bit_app_on_64bit_arch_win_unix">A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux
  Platforms</a></span></dt><dt><span class="section"><a href="#64bit_bit_data_types">A.3. 64-&#65279;Bit and 32-&#65279;Bit Data Types</a></span></dt></dl></dd><dt><span class="appendix"><a href="#API_REF">B. API Reference</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_DriverName">B.1. WD_DriverName</a></span></dt><dt><span class="section"><a href="#WDC_OVERVIEW">B.2. WDC Library Overview</a></span></dt><dt><span class="section"><a href="#WDC_LIB_API">B.3. WDC High&#65279;-&#65279;Level API</a></span></dt><dd><dl><dt><span class="section"><a href="#WDC_LIB_TYPES">B.3.1. Structures, Types and General Definitions</a></span></dt><dd><dl><dt><span class="section"><a href="#WDC_DEVICE_HANDLE">B.3.1.1. WDC_DEVICE_HANDLE</a></span></dt><dt><span class="section"><a href="#WDC_DRV_OPEN_OPTIONS">B.3.1.2. WDC_DRV_OPEN_OPTIONS Definitions</a></span></dt><dt><span class="section"><a href="#WDC_DIRECTION">B.3.1.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_DIRECTION Enumeration</span></a></span></dt><dt><span class="section"><a href="#WDC_ADDR_MODE">B.3.1.4. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_MODE Enumeration</span></a></span></dt><dt><span class="section"><a href="#WDC_ADDR_RW_OPTIONS">B.3.1.5. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_RW_OPTIONS Enumeration</span></a></span></dt><dt><span class="section"><a href="#WDC_ADDR_SIZE_">B.3.1.6. WDC_ADDR_SIZE Definitions</a></span></dt><dt><span class="section"><a href="#WDC_SLEEP_OPTIONS">B.3.1.7. WDC_SLEEP_OPTIONS Definitions</a></span></dt><dt><span class="section"><a href="#WDC_DBG_OPTIONS">B.3.1.8. WDC_DBG_OPTIONS Definitions</a></span></dt><dt><span class="section"><a href="#WDC_PCI_SCAN_RESULT">B.3.1.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PCI_SCAN_RESULT Structure</span></a></span></dt><dt><span class="section"><a href="#WDC_PCI_SCAN_CAPS_RESULT">B.3.1.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PCI_SCAN_CAPS_RESULT Structure</span></a></span></dt></dl></dd><dt><span class="section"><a href="#WDC_DriverOpen">B.3.2. WDC_DriverOpen()</a></span></dt><dt><span class="section"><a href="#WDC_DriverClose">B.3.3. WDC_DriverClose()</a></span></dt><dt><span class="section"><a href="#WDC_PciScanDevices">B.3.4. WDC_PciScanDevices()</a></span></dt><dt><span class="section"><a href="#WDC_PciScanDevicesByTopology">B.3.5. WDC_PciScanDevicesByTopology()</a></span></dt><dt><span class="section"><a href="#WDC_PciScanRegisteredDevices">B.3.6. WDC_PciScanRegisteredDevices()</a></span></dt><dt><span class="section"><a href="#WDC_PciScanCaps">B.3.7. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanCaps()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciScanCapsBySlot">B.3.8. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanCapsBySlot()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciScanExtCaps">B.3.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanExtCaps()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciGetExpressGen">B.3.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressGen()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciGetExpressGenBySlot">B.3.11. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressGenBySlot()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciGetExpressOffset">B.3.12. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressOffset()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciGetHeaderType">B.3.13. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetHeaderType()</span></a></span></dt><dt><span class="section"><a href="#PciConfRegData2Str">B.3.14. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">PciConfRegData2Str()</span></a></span></dt><dt><span class="section"><a href="#PciExpressConfRegData2Str">B.3.15. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">PciExpressConfRegData2Str()</span></a></span></dt><dt><span class="section"><a href="#WDC_PciGetDeviceInfo">B.3.16. WDC_PciGetDeviceInfo()</a></span></dt><dt><span class="section"><a href="#WDC_PciDeviceOpen">B.3.17. WDC_PciDeviceOpen()</a></span></dt><dt><span class="section"><a href="#WDC_IsaDeviceOpen">B.3.18. WDC_IsaDeviceOpen()</a></span></dt><dt><span class="section"><a href="#WDC_PciDeviceClose">B.3.19. WDC_PciDeviceClose()</a></span></dt><dt><span class="section"><a href="#WDC_IsaDeviceClose">B.3.20. WDC_IsaDeviceClose()</a></span></dt><dt><span class="section"><a href="#WDC_CardCleanupSetup">B.3.21. WDC_CardCleanupSetup()</a></span></dt><dt><span class="section"><a href="#WDC_KernelPlugInOpen">B.3.22. WDC_KernelPlugInOpen()</a></span></dt><dt><span class="section"><a href="#WDC_CallKerPlug">B.3.23. WDC_CallKerPlug()</a></span></dt><dt><span class="section"><a href="#WDC_ReadMemXXX">B.3.24. WDC_ReadMemXXX()</a></span></dt><dt><span class="section"><a href="#WDC_WriteMemXXX">B.3.25. WDC_WriteMemXXX()</a></span></dt><dt><span class="section"><a href="#WDC_ReadAddrXXX">B.3.26. WDC_ReadAddrXXX()</a></span></dt><dt><span class="section"><a href="#WDC_WriteAddrXXX">B.3.27. WDC_WriteAddrXXX()</a></span></dt><dt><span class="section"><a href="#WDC_ReadAddrBlock">B.3.28. WDC_ReadAddrBlock()</a></span></dt><dt><span class="section"><a href="#WDC_WriteAddrBlock">B.3.29. WDC_WriteAddrBlock()</a></span></dt><dt><span class="section"><a href="#WDC_MultiTransfer">B.3.30. WDC_MultiTransfer()</a></span></dt><dt><span class="section"><a href="#WDC_AddrSpaceIsActive">B.3.31. WDC_AddrSpaceIsActive()</a></span></dt><dt><span class="section"><a href="#WDC_PciReadCfgBySlot">B.3.32. WDC_PciReadCfgBySlot()</a></span></dt><dt><span class="section"><a href="#WDC_PciWriteCfgBySlot">B.3.33. WDC_PciWriteCfgBySlot()</a></span></dt><dt><span class="section"><a href="#WDC_PciReadCfg">B.3.34. WDC_PciReadCfg()</a></span></dt><dt><span class="section"><a href="#WDC_PciWriteCfg">B.3.35. WDC_PciWriteCfg()</a></span></dt><dt><span class="section"><a href="#WDC_PciReadCfgBySlotXXX">B.3.36. WDC_PciReadCfgBySlotXXX()</a></span></dt><dt><span class="section"><a href="#WDC_PciWriteCfgBySlotXXX">B.3.37. WDC_PciWriteCfgBySlotXXX()</a></span></dt><dt><span class="section"><a href="#WDC_PciReadCfgXXX">B.3.38. WDC_PciReadCfgXXX()</a></span></dt><dt><span class="section"><a href="#WDC_PciWriteCfgXXX">B.3.39. WDC_PciWriteCfgXXX()</a></span></dt><dt><span class="section"><a href="#WDC_DMAContigBufLock">B.3.40. WDC_DMAContigBufLock()</a></span></dt><dt><span class="section"><a href="#WDC_DMASGBufLock">B.3.41. WDC_DMASGBufLock()</a></span></dt><dt><span class="section"><a href="#WDC_DMAReservedBufLock">B.3.42. WDC_DMAReservedBufLock()</a></span></dt><dt><span class="section"><a href="#WDC_DMABufUnlock">B.3.43. WDC_DMABufUnlock()</a></span></dt><dt><span class="section"><a href="#WDC_DMABufGet">B.3.44. WDC_DMABufGet()</a></span></dt><dt><span class="section"><a href="#WDC_DMAGetGlobalHandle">B.3.45. WDC_DMAGetGlobalHandle Macro</a></span></dt><dt><span class="section"><a href="#WDC_DMASyncCpu">B.3.46. WDC_DMASyncCpu()</a></span></dt><dt><span class="section"><a href="#WDC_DMASyncIo">B.3.47. WDC_DMASyncIo()</a></span></dt><dt><span class="section"><a href="#WDC_IntEnable">B.3.48. WDC_IntEnable()</a></span></dt><dt><span class="section"><a href="#WDC_IntDisable">B.3.49. WDC_IntDisable()</a></span></dt><dt><span class="section"><a href="#WDC_IntIsEnabled">B.3.50. WDC_IntIsEnabled()</a></span></dt><dt><span class="section"><a href="#WDC_IntType2Str">B.3.51. WDC_IntType2Str()</a></span></dt><dt><span class="section"><a href="#WDC_EventRegister">B.3.52. WDC_EventRegister()</a></span></dt><dt><span class="section"><a href="#WDC_EventUnregister">B.3.53. WDC_EventUnregister()</a></span></dt><dt><span class="section"><a href="#WDC_EventIsRegistered">B.3.54. WDC_EventIsRegistered()</a></span></dt><dt><span class="section"><a href="#WDC_SetDebugOptions">B.3.55. WDC_SetDebugOptions()</a></span></dt><dt><span class="section"><a href="#WDC_Err">B.3.56. WDC_Err()</a></span></dt><dt><span class="section"><a href="#WDC_Trace">B.3.57. WDC_Trace()</a></span></dt><dt><span class="section"><a href="#WDC_GetWDHandle">B.3.58. WDC_GetWDHandle()</a></span></dt><dt><span class="section"><a href="#WDC_GetDevContext">B.3.59. WDC_GetDevContext()</a></span></dt><dt><span class="section"><a href="#WDC_GetBusType">B.3.60. WDC_GetBusType()</a></span></dt><dt><span class="section"><a href="#WDC_Sleep">B.3.61. WDC_Sleep()</a></span></dt><dt><span class="section"><a href="#WDC_Version">B.3.62. WDC_Version()</a></span></dt></dl></dd><dt><span class="section"><a href="#WDC_DEFS_API">B.4. WDC Low&#65279;-&#65279;Level API</a></span></dt><dd><dl><dt><span class="section"><a href="#WDC_ADDR_DESC">B.4.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_DESC Structure</span></a></span></dt><dt><span class="section"><a href="#WDC_DEVICE">B.4.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_DEVICE Structure</span></a></span></dt><dt><span class="section"><a href="#PWDC_DEVICE">B.4.3. PWDC_DEVICE</a></span></dt><dt><span class="section"><a href="#WDC_MEM_DIRECT_ADDR">B.4.4. WDC_MEM_DIRECT_ADDR Macro</a></span></dt><dt><span class="section"><a href="#WDC_ADDR_IS_MEM">B.4.5. WDC_ADDR_IS_MEM Macro</a></span></dt><dt><span class="section"><a href="#WDC_GET_ADDR_DESC">B.4.6. WDC_GET_ADDR_DESC Macro</a></span></dt><dt><span class="section"><a href="#WDC_GET_ADDR_SPACE_SIZE">B.4.7. WDC_GET_ADDR_SPACE_SIZE Macro</a></span></dt><dt><span class="section"><a href="#WDC_GET_ENABLED_INT_TYPE">B.4.8. WDC_GET_ENABLED_INT_TYPE Macro</a></span></dt><dt><span class="section"><a href="#WDC_GET_INT_OPTIONS">B.4.9. WDC_GET_INT_OPTIONS Macro</a></span></dt><dt><span class="section"><a href="#WDC_INT_IS_MSI">B.4.10. WDC_INT_IS_MSI Macro</a></span></dt><dt><span class="section"><a href="#WDC_GET_ENABLED_INT_LAST_MSG">B.4.11. WDC_GET_ENABLED_INT_LAST_MSG Macro</a></span></dt><dt><span class="section"><a href="#WDC_IS_KP">B.4.12. WDC_IS_KP Macro</a></span></dt></dl></dd><dt><span class="section"><a href="#WDS_OVERVIEW">B.5. WDS Library Overview</a></span></dt><dt><span class="section"><a href="#WDS_LIB_API">B.6. WDS High&#65279;-&#65279;Level API</a></span></dt><dd><dl><dt><span class="section"><a href="#WDS_SharedBufferAlloc">B.6.1. WDS_SharedBufferAlloc()</a></span></dt><dt><span class="section"><a href="#WDS_SharedBufferFree">B.6.2. WDS_SharedBufferFree()</a></span></dt><dt><span class="section"><a href="#WDS_SharedBufferGet">B.6.3. WDS_SharedBufferGet()</a></span></dt><dt><span class="section"><a href="#WDS_SharedBufferGetGlobalHandle">B.6.4. WDS_SharedBufferGetGlobalHandle Macro</a></span></dt></dl></dd><dt><span class="section"><a href="#WDC_WD_TYPES">B.7. WD_xxx Structures, Types and General Definitions</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_BUS_TYPE">B.7.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_BUS_TYPE Enumeration</span></a></span></dt><dt><span class="section"><a href="#ITEM_TYPE">B.7.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">ITEM_TYPE Enumeration</span></a></span></dt><dt><span class="section"><a href="#WD_PCI_ID">B.7.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_ID Structure</span></a></span></dt><dt><span class="section"><a href="#WD_PCI_SLOT">B.7.4. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_SLOT Structure</span></a></span></dt><dt><span class="section"><a href="#WD_PCI_CAP">B.7.5. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_CAP Structure</span></a></span></dt><dt><span class="section"><a href="#WD_ITEMS">B.7.6. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_ITEMS Structure</span></a></span></dt><dt><span class="section"><a href="#WD_CARD">B.7.7. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_CARD Structure</span></a></span></dt><dt><span class="section"><a href="#WD_PCI_CARD_INFO">B.7.8. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_CARD_INFO Structure</span></a></span></dt><dt><span class="section"><a href="#WD_DMA">B.7.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_DMA Structure</span></a></span></dt><dt><span class="section"><a href="#WD_TRANSFER">B.7.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_TRANSFER Structure</span></a></span></dt><dt><span class="section"><a href="#WD_KERNEL_BUFFER">B.7.11. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_KERNEL_BUFFER Structure</span></a></span></dt></dl></dd><dt><span class="section"><a href="#KPKERNELFUNC">B.8. Kernel PlugIn Kernel-Mode Functions</a></span></dt><dd><dl><dt><span class="section"><a href="#KP_Init">B.8.1. KP_Init</a></span></dt><dt><span class="section"><a href="#KP_Open">B.8.2. KP_Open</a></span></dt><dt><span class="section"><a href="#KP_Close">B.8.3. KP_Close</a></span></dt><dt><span class="section"><a href="#KP_Call">B.8.4. KP_Call</a></span></dt><dt><span class="section"><a href="#KP_Event">B.8.5. KP_Event</a></span></dt><dt><span class="section"><a href="#KP_IntEnable">B.8.6. KP_IntEnable</a></span></dt><dt><span class="section"><a href="#KP_IntDisable">B.8.7. KP_IntDisable</a></span></dt><dt><span class="section"><a href="#KP_IntAtIrql">B.8.8. KP_IntAtIrql</a></span></dt><dt><span class="section"><a href="#KP_IntAtDpc">B.8.9. KP_IntAtDpc</a></span></dt><dt><span class="section"><a href="#KP_IntAtIrqlMSI">B.8.10. KP_IntAtIrqlMSI</a></span></dt><dt><span class="section"><a href="#KP_IntAtDpcMSI">B.8.11. KP_IntAtDpcMSI</a></span></dt><dt><span class="section"><a href="#COPY_TO_USER_OR_KERNEL">B.8.12. COPY_TO_USER_OR_KERNEL, COPY_FROM_USER_OR_KERNEL</a></span></dt><dt><span class="section"><a href="#kp_sync_apis">B.8.13. Kernel PlugIn Synchronization APIs</a></span></dt><dd><dl><dt><span class="section"><a href="#kp_sync_types">B.8.13.1. Kernel PlugIn Synchronization Types</a></span></dt><dt><span class="section"><a href="#kp_spinlock_init">B.8.13.2. kp_spinlock_init()</a></span></dt><dt><span class="section"><a href="#kp_spinlock_wait">B.8.13.3. kp_spinlock_wait()</a></span></dt><dt><span class="section"><a href="#kp_spinlock_release">B.8.13.4. kp_spinlock_release()</a></span></dt><dt><span class="section"><a href="#kp_spinlock_uninit">B.8.13.5. kp_spinlock_uninit()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_init">B.8.13.6. kp_interlocked_init()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_uninit">B.8.13.7. kp_interlocked_uninit()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_increment">B.8.13.8. kp_interlocked_increment()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_decrement">B.8.13.9. kp_interlocked_decrement()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_add">B.8.13.10. kp_interlocked_add()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_read">B.8.13.11. kp_interlocked_read()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_set">B.8.13.12. kp_interlocked_set()</a></span></dt><dt><span class="section"><a href="#kp_interlocked_exchange">B.8.13.13. kp_interlocked_exchange()</a></span></dt></dl></dd></dl></dd><dt><span class="section"><a href="#KPSTRUCT">B.9. Kernel PlugIn Structure Reference</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_KERNEL_PLUGIN">B.9.1. WD_KERNEL_PLUGIN</a></span></dt><dt><span class="section"><a href="#WD_INTERRUPT">B.9.2. WD_INTERRUPT</a></span></dt><dt><span class="section"><a href="#WD_KERNEL_PLUGIN_CALL">B.9.3. WD_KERNEL_PLUGIN_CALL</a></span></dt><dt><span class="section"><a href="#KP_INIT">B.9.4. KP_INIT</a></span></dt><dt><span class="section"><a href="#KP_OPEN_CALL">B.9.5. KP_OPEN_CALL</a></span></dt></dl></dd><dt><span class="section"><a href="#Function_Reference_Utils">B.10. User-Mode Utility Functions</a></span></dt><dd><dl><dt><span class="section"><a href="#Stat2Str">B.10.1. Stat2Str</a></span></dt><dt><span class="section"><a href="#get_os_type">B.10.2. get_os_type</a></span></dt><dt><span class="section"><a href="#check_secureBoot_enabled">B.10.3. check_secureBoot_enabled</a></span></dt><dt><span class="section"><a href="#ThreadStart">B.10.4. ThreadStart</a></span></dt><dt><span class="section"><a href="#ThreadWait">B.10.5. ThreadWait</a></span></dt><dt><span class="section"><a href="#OsEventCreate">B.10.6. OsEventCreate</a></span></dt><dt><span class="section"><a href="#OsEventClose">B.10.7. OsEventClose</a></span></dt><dt><span class="section"><a href="#OsEventWait">B.10.8. OsEventWait</a></span></dt><dt><span class="section"><a href="#OsEventSignal">B.10.9. OsEventSignal</a></span></dt><dt><span class="section"><a href="#OsEventReset">B.10.10. OsEventReset</a></span></dt><dt><span class="section"><a href="#OsMutexCreate">B.10.11. OsMutexCreate</a></span></dt><dt><span class="section"><a href="#OsMutexClose">B.10.12. OsMutexClose</a></span></dt><dt><span class="section"><a href="#OsMutexLock">B.10.13. OsMutexLock</a></span></dt><dt><span class="section"><a href="#OsMutexUnlock">B.10.14. OsMutexUnlock</a></span></dt><dt><span class="section"><a href="#PrintDbgMessage">B.10.15. PrintDbgMessage</a></span></dt><dt><span class="section"><a href="#WD_LogStart">B.10.16. WD_LogStart</a></span></dt><dt><span class="section"><a href="#WD_LogStop">B.10.17. WD_LogStop</a></span></dt><dt><span class="section"><a href="#WD_LogAdd">B.10.18. WD_LogAdd</a></span></dt></dl></dd><dt><span class="section"><a href="#Status_Strings">B.11. WinDriver Status Codes</a></span></dt><dd><dl><dt><span class="section"><a href="#wd_status_codes_intro">B.11.1. Introduction</a></span></dt><dt><span class="section"><a href="#wd_status_codes">B.11.2. Status Codes Returned by WinDriver</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="#windriver_ipc">C. WinDriver IPC</a></span></dt><dd><dl><dt><span class="section"><a href="#WD_IPC_overview">C.1. WinDriver IPC Overview</a></span></dt><dt><span class="section"><a href="#WDS_IPC_API_reference">C.2. WinDriver IPC API Reference</a></span></dt><dd><dl><dt><span class="section"><a href="#IPC_MSG_RX_HANDLER">C.2.1. IPC_MSG_RX_HANDLER()</a></span></dt><dt><span class="section"><a href="#WDS_IpcRegister">C.2.2. WDS_IpcRegister()</a></span></dt><dt><span class="section"><a href="#WDS_IpcUnRegister">C.2.3. WDS_IpcUnRegister()</a></span></dt><dt><span class="section"><a href="#WDS_IsIpcRegistered">C.2.4. WDS_IsIpcRegistered()</a></span></dt><dt><span class="section"><a href="#WDS_IpcScanProcs">C.2.5. WDS_IpcScanProcs()</a></span></dt><dt><span class="section"><a href="#WDS_IpcMulticast">C.2.6. WDS_IpcMulticast()</a></span></dt><dt><span class="section"><a href="#WDS_IpcSubGroupMulticast">C.2.7. WDS_IpcSubGroupMulticast()</a></span></dt><dt><span class="section"><a href="#WDS_IpcUidUnicast">C.2.8. WDS_IpcUidUnicast()</a></span></dt></dl></dd></dl></dd><dt><span class="appendix"><a href="#troubleshooting_n_support">D. Troubleshooting and Support</a></span></dt><dt><span class="appendix"><a href="#Appendix_Limitations">E. Evaluation Version Limitations</a></span></dt><dd><dl><dt><span class="section"><a href="#winpnp_eval_limits">E.1. Windows WinDriver Evaluation Limitations</a></span></dt><dt><span class="section"><a href="#linux_eval_limits">E.2. Linux WinDriver Evaluation Limitations</a></span></dt></dl></dd><dt><span class="appendix"><a href="#purchasing_wd">F. Purchasing WinDriver</a></span></dt><dt><span class="appendix"><a href="#Distrib_Legal">G. Distributing Your Driver &#8212; Legal Issues</a></span></dt><dt><span class="appendix"><a href="#additional_doc">H. Additional Documentation</a></span></dt></dl></div><div class="list-of-figures"><p><b>List of Figures</b></p><dl><dt>1.1. <a href="#wdpci_arch">WinDriver Architecture</a></dt><dt>2.1. <a href="#Monolithic">Monolithic Drivers</a></dt><dt>2.2. <a href="#Layered">Layered Drivers</a></dt><dt>2.3. <a href="#Miniport">Miniport Drivers</a></dt><dt>4.1. <a href="#wiz_start">Create or Open a Driver Project</a></dt><dt>4.2. <a href="#figure_wiz_select_device">Select Your Plug&#65279;-&#65279;and&#65279;-&#65279;Play Device</a></dt><dt>4.3. <a href="#wiz_pci_inf_info">DriverWizard INF File Information</a></dt><dt>4.4. <a href="#wiz_pci_define_n_test_res">PCI Resources</a></dt><dt>4.5. <a href="#wiz_pci_register_info">Define Registers</a></dt><dt>4.6. <a href="#wiz_pci_rw_mem_io">Read/Write Memory and I/&#65279;O</a></dt><dt>4.7. <a href="#wiz_pci_listen_to_int">Listen to Interrupts</a></dt><dt>4.8. <a href="#wiz_pci_int_ack_prepare">Define Transfer Commands for Level-Sensitive Interrupts</a></dt><dt>4.9. <a href="#wiz_pci_gen_code">Code Generation Options</a></dt><dt>4.10. <a href="#wiz_pci_driver_options">Additional Driver Options</a></dt><dt>6.1. <a href="#dbgm_log">Start Debug Monitor</a></dt><dt>6.2. <a href="#dbgm_dbg_opts">Debug Options</a></dt><dt>6.3. <a href="#dbgm_find">Search in wddebug_gui</a></dt><dt>9.1. <a href="#wiz_pci_inf_info_2">DriverWizard INF File Information</a></dt><dt>11.1. <a href="#KPArch">Kernel PlugIn Architecture</a></dt><dt>11.2. <a href="#int_handling_no_kp">Interrupt Handling Without Kernel PlugIn</a></dt><dt>11.3. <a href="#int_handling_with_kp">Interrupt Handling With the Kernel PlugIn</a></dt><dt>13.1. <a href="#frontend_icon">The wdreg_frontend icon</a></dt><dt>13.2. <a href="#copy_driver_file">The dialog box wdreg_frontend will open if driver file is not located in the         Windows system directory</a></dt><dt>13.3. <a href="#load_driver">wdreg_frontend after successfully loading a sys file</a></dt><dt>13.4. <a href="#digital_sign_fail">Error message given by Windows when trying to install an unsigned driver</a></dt><dt>13.5. <a href="#driver_install_success">wdreg_frontend upon successfully installing a sys driver</a></dt></dl></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="WD_Overview"></a>Chapter 1. WinDriver Overview</h1></div></div></div><p>
In this chapter you will explore the uses of WinDriver, and learn the basic steps
of creating your driver.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This manual outlines WinDriver's support for <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI/ISA/EISA/CompactPCI/PCI Express</span> devices.<br><span xmlns:fo="http://www.w3.org/1999/XSL/Format">
  WinDriver also supports the Universal Serial Bus (<span class="b"><strong>USB</strong></span>). For detailed information
  regarding WinDriver USB, please refer to the WinDriver product page on our web
  site (<span style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/products/windriver/" target="_top">https://www.jungo.com/st/products/windriver/</a></span>) and to the <span class="jprintfilename"><strong>WinDriver USB Manual</strong></span></span>,
which is available online at <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/windriver/" target="_top">https://www.jungo.com/st/support/windriver/</a></span>.
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_intro"></a>1.1. Introduction to WinDriver</h2></div></div></div><p>
WinDriver is a development toolkit that dramatically simplifies the difficult task
of creating device drivers and hardware-access applications. WinDriver includes a
wizard and code generation features that automatically detect your hardware and
generate the driver to access it from your application. The driver and
application you develop using WinDriver are source code compatible across all
supported operating systems<a class="xref" href="#WD_sup_platforms" title="1.7. What Platforms Does WinDriver Support?"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [1.7]</fo:inline></a>. The driver is binary
compatible across Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008.
</p><p>
Bus architecture support includes PCI&#65279;/&#65279;/&#65279;ISA&#65279;/&#65279;EISA&#65279;/&#65279;CompactPCI&#65279;/&#65279;PCI Express.<br>
ISA, and EISA are supported on Windows, and Linux.
</p><p>
WinDriver provides a complete solution for creating high-performance drivers.
</p><p>
Don't let the size of this manual fool you. WinDriver makes developing device
drivers an easy task that takes hours instead of months. Most of this manual
deals with the features that WinDriver offers to the advanced user. However,
most developers will find that reading this chapter and glancing
through the DriverWizard and function-reference chapters is all they need to
successfully write their driver.
</p><p>
WinDriver supports development for all <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI/ISA/EISA/CompactPCI/PCI Express</span> chipsets<span xmlns:fo="http://www.w3.org/1999/XSL/Format">,
  and offers enhanced support for specific chipsets, as outlined in
  <a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline>Chapter 7</fo:inline></a></span>.
  
</p><p>
<a class="xref" href="#performance_improve" title="Chapter 10. Improving Performance"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 10</fo:inline></a> explains how to tune your driver code
to achieve optimal performance, with special emphasis on WinDriver's Kernel PlugIn
feature. This feature allows the developer to write and debug the entire device
driver in the user mode, and later drop performance critical portions of the
code into kernel mode. In this way the driver achieves optimal kernel-mode
performance, while the developer need not sacrifice the ease of user-mode
development. For a detailed overview of the Kernel PlugIn, refer to
<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapters 11&#8211;</fo:inline></a><a class="xref" href="#kp_create" title="Chapter 12. Creating a Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">12</fo:inline></a>.
</p><p>
Visit Jungo's web site at <a class="ulink" href="https://www.jungo.com" target="_top">https://www.jungo.com</a> for the latest news about WinDriver and
other driver development tools that Jungo offers.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_overview_background"></a>1.2. Background</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_overview_the_challenge"></a>1.2.1. The Challenge</h3></div></div></div><p>
In protected operating systems such as Windows and Linux, a programmer
cannot access hardware directly from the application level (user mode), where
development work is usually done. Hardware can only be accessed from within the
operating system itself (kernel mode or Ring-0), utilizing software modules
called device drivers. In order to access a custom hardware device from the
application level, a programmer must do the following:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Learn the internals of the operating system he is working on.
  </li><li class="listitem" style="list-style-type: disc">
    Learn how to write a device driver.
  </li><li class="listitem" style="list-style-type: disc">
    Learn new tools for developing/debugging in kernel mode (WDK, ETK,
    DDI/DKI).
  </li><li class="listitem" style="list-style-type: disc">
    Write the kernel-mode device driver that does the basic hardware
    input/output.
  </li><li class="listitem" style="list-style-type: disc">
    Write the application in user mode that accesses the hardware
    through the device driver written in kernel mode.
  </li><li class="listitem" style="list-style-type: disc">
    Repeat the first four steps for each new operating system on which
    the code should run.
  </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_overview_the_WD_solution"></a>1.2.2. The WinDriver Solution</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Easy Development</strong></span> &#8212; WinDriver enables <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows, and Linux</span> programmers to
    create <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI/ISA/EISA/CompactPCI/PCI Express</span> based device drivers in an extremely short time. WinDriver
    allows you to create your driver in the familiar user-mode environment,
    using MS Visual Studio, C&#65279;+&#65279;+, GCC, Windows GCC, or any other appropriate compiler or development
    environment. You do not need to have any device-driver knowledge, nor do
    you have to be familiar with operating system internals, kernel
    programming, the WDK, ETK or DDI/DKI.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Cross Platform</strong></span> &#8212; The driver created with WinDriver will run on
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008, Windows 10 IoT/Embedded Windows 8.1/8/7, and Linux</span>. In other words &#8212; write it once, run it on many
    platforms.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Friendly Wizards</strong></span> &#8212; DriverWizard (included) is a graphical
    diagnostics tool that lets you view <span xmlns:fo="http://www.w3.org/1999/XSL/Format">/define</span>
    the device's resources and test the communication with the hardware with
    just a few mouse clicks, before writing a single line of code. Once the
    device is operating to your satisfaction, DriverWizard creates the skeletal
    driver source code, giving access-functions to all the resources on the
    hardware.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Kernel-Mode Performance</strong></span> &#8212; WinDriver's API is optimized for
    performance.
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format"><br>
     For drivers that need kernel-mode performance, WinDriver offers the
     Kernel PlugIn. This powerful feature enables you to create and debug
     your code in user mode and run the performance-critical parts of your
     code (such as the interrupt handling or access to I/&#65279;O mapped memory
     ranges) in kernel mode, thereby achieving kernel-mode performance (zero
     performance degradation). This unique feature allows the developer to
     run user-mode code in the OS kernel without having to learn how the
     kernel works. For a detailed overview of this feature, see
     <a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline>Chapter 11</fo:inline></a>.
   </span>
    </li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_overview_how_fast"></a>1.3. How Fast Can WinDriver Go?</h2></div></div></div><p>
You can expect the same throughput using the WinDriver Kernel PlugIn as
when using a custom kernel driver. Throughput is constrained only by the
limitations of your operating system and hardware. A rough estimate of the
throughput you can obtain using the Kernel PlugIn is approximately 100,000
interrupts per second.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_overview_conclusion"></a>1.4. Conclusion</h2></div></div></div><p>
Using WinDriver, a developer need only do the following to create an
application that accesses the custom hardware:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Start DriverWizard and detect the hardware and its resources.
  </li><li class="listitem" style="list-style-type: disc">
    Automatically generate the device-driver code from within DriverWizard, or
    use one of the WinDriver samples as the basis for the application<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      (see <a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline>Chapter 7</fo:inline></a> for an overview of WinDriver's
      enhanced support for specific chipsets)</span>.
      </li><li class="listitem" style="list-style-type: disc">
    Modify the user-mode application, as needed, using the generated/sample
    functions, to implement the desired functionality for your application.
  </li></ul></div><p>
</p><p>
Your hardware-access application will run on all the supported platforms<a class="xref" href="#WD_sup_platforms" title="1.7. What Platforms Does WinDriver Support?"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [1.7]</fo:inline></a> &#8212; just recompile the code for the target
platform. The code is binary-compatible across Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008 platforms;
there is no need to rebuild the code when porting it across binary-compatible
platforms.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_benefits"></a>1.5. WinDriver Benefits</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Easy user-mode driver development.
  </li><li class="listitem" style="list-style-type: disc">
    Kernel PlugIn for high-performance drivers.
  </li><li class="listitem" style="list-style-type: disc">
    Friendly DriverWizard allows hardware diagnostics without writing a single
    line of code.
  </li><li class="listitem" style="list-style-type: disc">
    Automatically generates the driver code for the project in
    C or C&#65279;#.
    </li><li class="listitem" style="list-style-type: disc">
    Supports any <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI/ISA/EISA/CompactPCI/PCI Express</span> device, regardless of manufacturer.
  </li><li class="listitem" style="list-style-type: disc">
    Enhanced support for specific chipsets<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a> frees
    the developer of the need to study the hardware's specification.
    </li><li class="listitem" style="list-style-type: disc">
    Applications are binary compatible across Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008.
    </li><li class="listitem" style="list-style-type: disc">
    Applications are source code compatible across all supported operating
    systems &#8212; <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008, Windows 10 IoT/Embedded Windows 8.1/8/7, and Linux</span>.
    </li><li class="listitem" style="list-style-type: disc">
    Can be used with common development environments, including MS Visual Studio, C&#65279;+&#65279;+, GCC, Windows GCC,
    or any other appropriate compiler/environment.
    
    </li><li class="listitem" style="list-style-type: disc">
    No WDK, ETK, DDI or any system-level programming knowledge required.
  </li><li class="listitem" style="list-style-type: disc">
    Supports I/&#65279;O, DMA, interrupt handling and access to memory-mapped cards.
  </li><li class="listitem" style="list-style-type: disc">
    Supports multiple CPUs<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      and multiple PCI bus platforms (PCI/ISA/EISA/CompactPCI/PCI Express)</span>.
    </li><li class="listitem" style="list-style-type: disc">
    Supports 64-&#65279;bit PCI data transfers.
  </li><li class="listitem" style="list-style-type: disc">
    Includes dynamic driver loader.
  </li><li class="listitem" style="list-style-type: disc">
    Comprehensive documentation and help files.
  </li><li class="listitem" style="list-style-type: disc">
    Detailed examples in C or C&#65279;#.
  </li><li class="listitem" style="list-style-type: disc">
    WinDriver Windows drivers are compliant with Microsoft's Windows Certification Program
    </li><li class="listitem" style="list-style-type: disc">
    Two months of free technical support.
  </li><li class="listitem" style="list-style-type: disc">
    No run-time fees or royalties.
  </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_arch"></a>1.6. WinDriver Architecture</h2></div></div></div><p>
</p><div class="figure"><a name="wdpci_arch"></a><p class="title"><b>Figure 1.1. WinDriver Architecture</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wdpci_arch.png" alt="WinDriver Architecture"></div></div></div><p><br class="figure-break">
</p><p>
For hardware access, your application calls one of the WinDriver user-mode
functions. The user-mode function calls the WinDriver kernel, which accesses
the hardware for you through the native calls of the operating system.
</p><p>
WinDriver's design minimizes performance hits on your code, even though it is
running in user mode. However, some hardware drivers have high performance
requirements that cannot be achieved in user mode. This is where WinDriver's
edge sharpens. After easily creating and debugging your code in user mode, you
may drop the performance-critical modules of your code (such as a hardware
interrupt handler) into the WinDriver Kernel PlugIn without changing them at
all. Now, the WinDriver kernel calls this module from kernel mode, thereby
achieving maximal performance. This allows you to program and debug in user
mode, and still achieve kernel performance where needed. For a detailed
overview of the Kernel PlugIn feature, see
<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 11</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_sup_platforms"></a>1.7. What Platforms Does WinDriver Support?</h2></div></div></div><p>
WinDriver supports the following operating systems:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008 and Windows 10 IoT/Embedded Windows 8.1/8/7 &#8212; henceforth collectively:
    <span class="b"><strong>Windows</strong></span></li><li class="listitem" style="list-style-type: disc">
    Linux
  </li></ul></div><p>
</p><p>
The same source code will run on all supported platforms &#8212; simply
recompile it for the target platform. The source code is binary compatible
across Windows 10/Server 2016/8.1/Server 2012 R2/8/Server 2012/7/Server 2008 R2/Server 2008;
WinDriver executables can be ported among the binary-compatible platforms without
recompilation.
</p><p>
Even if your code is meant only for one of the supported operating systems,
using WinDriver will give you the flexibility to move your driver to another
operating system in the future without needing to change your code.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  OS-specific support is provided only for operating systems with official
  vendor support.
  </td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_eval_limits"></a>1.8. Limitations of the Different Evaluation Versions</h2></div></div></div><p>
All the evaluation versions of

<span xmlns:fo="http://www.w3.org/1999/XSL/Format">WinDriver</span>
are full featured. No functions are limited or crippled in any way. The
evaluation version of WinDriver varies from the registered version in the
following ways:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Each time WinDriver is activated, an <em class="guilabel">Unregistered</em>
    message appears.
  </li><li class="listitem" style="list-style-type: disc">
    When using DriverWizard, a dialogue box with a message stating that an
    evaluation version is being run appears on every interaction with the
    hardware.
  </li><li class="listitem" style="list-style-type: disc">
    In the Linux the driver will remain operational for 60 minutes, after
    which time it must be restarted.
  </li><li class="listitem" style="list-style-type: disc">
    The Windows evaluation version expires 30 days from the date of
    installation.
  </li></ul></div><p>
</p><p>
For more details please refer to <a class="xref" href="#Appendix_Limitations" title="Appendix E. Evaluation Version Limitations"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Appendix E</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_dev_overview"></a>1.9. How Do I Develop My Driver with WinDriver?</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_dev_winnoce_mac_unix"></a>1.9.1. On Windows and Linux</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Start DriverWizard and use it to diagnose your hardware &#8212; see details
    in <a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 4</fo:inline></a>.
  </li><li class="listitem">
    Let DriverWizard generate skeletal code for your driver, or use one of the
    WinDriver samples as the basis for your driver application<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      (see <a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline>Chapter 7</fo:inline></a> for details regarding
      WinDriver's enhanced support for specific chipsets)</span>.
      </li><li class="listitem">
    Modify the generated/sample code to suit your application's needs.
  </li><li class="listitem">
    Run and debug your driver in the user mode.
  </li><li class="listitem">
    If your code contains performance-critical sections, refer to
    <a class="xref" href="#performance_improve" title="Chapter 10. Improving Performance"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 10</fo:inline></a> for suggestions on how to improve
    your driver's performance.
  </li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The code generated by DriverWizard is a diagnostics program that contains
functions that read and write to any resource detected or defined (including
custom-defined registers), enables your card's interrupts, listens to them,
and more.
</td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_toolkit_include"></a>1.10. What Does the WinDriver Toolkit Include?</h2></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Two months of basic technical support (via support center)
  </li><li class="listitem" style="list-style-type: disc">
    WinDriver modules
  </li><li class="listitem" style="list-style-type: disc">
     Utilities
  </li><li class="listitem" style="list-style-type: disc">
    Samples<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> 
      and wrapper APIs for enhanced-support chipsets</span></li></ul></div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_modules"></a>1.10.1. WinDriver Modules</h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    WinDriver (<span class="jdirectory"><strong>WinDriver/include</strong></span>) &#8212; the general
    purpose hardware access toolkit. The main files here are

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        <span class="jprintfilename"><strong>windrvr.h</strong></span>: Declarations and
        definitions of WinDriver's basic API.
        </li><li class="listitem">
        <span class="jprintfilename"><strong>wdc_lib.h</strong></span> and
        <span class="jprintfilename"><strong>wdc_defs.h</strong></span>: Declarations and
        definitions of the WinDriver Card (WDC) library, which provides convenient
        wrapper APIs for accessing PCI/ISA/EISA/CompactPCI/PCI Express devices (see
        <a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section B.2</fo:inline></a>).
        </li><li class="listitem">
        <span class="jprintfilename"><strong>windrvr_int_thread.h</strong></span>: Declarations of
        convenient wrapper functions to simplify interrupt handling.
        
        </li><li class="listitem">
        <span class="jprintfilename"><strong>windrvr_events.h</strong></span>: Declarations of APIs
        for handling Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management events.
        </li><li class="listitem">
        <span class="jprintfilename"><strong>utils.h</strong></span>: Declarations of general
        utility functions.
        </li><li class="listitem">
        <span class="jprintfilename"><strong>status_strings.h</strong></span>: Declarations of API
        for converting WinDriver status codes to descriptive error strings.
        </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    DriverWizard (<span class="jprintfilename"><strong>WinDriver/wizard/wdwizard</strong></span>) &#8212; a graphical
    application that diagnoses your hardware and enables you to easily generate
    code for your driver (refer to <a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 4</fo:inline></a> for
    details).
    </li><li class="listitem" style="list-style-type: disc">
    Debug Monitor &#8212; a debugging tool that collects information about your
    driver as it runs. This tool is available both as a fully graphical
    application &#8212; <span class="jprintfilename"><strong>WinDriver/util/wddebug_gui</strong></span>
    &#8212; and as a console-mode application &#8212;
    <span class="jprintfilename"><strong>WinDriver/util/wddebug</strong></span>.<br>
    For details regarding the Debug Monitor, refer to
    <a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 6.2</fo:inline></a>.
    </li><li class="listitem" style="list-style-type: disc">
    WinDriver distribution package (<span class="jdirectory"><strong>WinDriver&#65279;/&#65279;redist</strong></span>) &#8212; the files you
    include in the driver distribution to customers.
    </li><li class="listitem" style="list-style-type: disc">
    WinDriver Kernel PlugIn &#8212; the files and samples needed to create a
    kernel-mode Kernel PlugIn driver (refer to
    <a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 11</fo:inline></a> for details.)
    </li><li class="listitem" style="list-style-type: disc">
    This manual &#8212; the full WinDriver manual (this document), in different
    formats, can be found under the <span class="jdirectory"><strong>WinDriver/docs</strong></span>
    directory.
    </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_utilities"></a>1.10.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Utilities</span></h3></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>pci_dump.exe</strong></span>
    (<span class="jdirectory"><strong>WinDriver/util/pci_dump.exe</strong></span>) &#8212; used to obtain
    a dump of the PCI configuration registers of the installed PCI cards.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>pci_diag.exe</strong></span>
    (<span class="jdirectory"><strong>WinDriver/util/pci_diag.exe</strong></span>) &#8212; used for
    reading/writing PCI configuration registers, accessing PCI I/&#65279;O and
    memory ranges and handling PCI interrupts.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>pci_scan.exe</strong></span>
    (<span class="jdirectory"><strong>WinDriver/util/pci_scan.exe</strong></span>) &#8212; used to obtain
    a list of the PCI cards installed and the resources allocated for each
    card.
    </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_samples"></a>1.10.3. Samples<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> and Enhanced-Support Chipset APIs</span></h3></div></div></div>
<p>
WinDriver includes a variety of samples that demonstrate how to use WinDriver's API
to communicate with your device and perform various driver tasks.

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    C samples: found under the <span class="jdirectory"><strong>WinDriver/samples</strong></span>
    directory.<br>
    These samples also include the source code for the utilities listed
    above<a class="xref" href="#WD_utilities" title="1.10.2. Utilities"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [1.10.2]</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    Python samples: found under the
    <span class="jdirectory"><strong>WinDriver/samples/python</strong></span> directory.<br>
    These samples also include the source code for the utilities listed
    above<a class="xref" href="#WD_utilities" title="1.10.2. Utilities"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [1.10.2]</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    .NET C&#65279;#
    
    samples (Windows): found under the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver\csharp.net</strong></span></span><span xmlns:fo="http://www.w3.org/1999/XSL/Format">
    directory.
   </span></li></ul></div><p>
</p>
<div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="spec_chipset_sup"></a>1.10.3.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Enhanced Chipset Support</span></h4></div></div></div>

<p>
In addition to the generic samples described above, WinDriver provides custom
wrapper APIs and sample code for major PCI chipsets, as outlined in
<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 7</fo:inline></a>. The relevant files are provided in the
following WinDriver installation directories:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    PLX 6466, 9030, 9050, 9052, 9054, 9056, 9080 and 9656 &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/plx</strong></span></span></li><li class="listitem" style="list-style-type: disc">
    Altera Qsys design &#8212; <span class="jdirectory"><strong>WinDriver/&#65279;altera/&#65279;qsys_design</strong></span></li><li class="listitem" style="list-style-type: disc">
    Xilinx Bus Master DMA (BMD) design &#8212; <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span></li><li class="listitem" style="list-style-type: disc">
    Xilinx XDMA design &#8212; <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;XDMA_design</strong></span></li></ul></div><p>

For the Xilinx BMD, Xilinx XDMA and Altera Qsys designs there is also an
option to
generate customized driver code that utilizes the related enhanced-support
APIs.
</p>
</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_can_distrib"></a>1.11. Can I Distribute the Driver Created with WinDriver?</h2></div></div></div><p>
Yes. WinDriver is purchased as a development toolkit, and any device driver
created using WinDriver may be distributed, royalties free, in as many
copies as you wish. See the license agreement at
(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/docs/</strong></span><span class="jprintfilename"><strong>wd_license.pdf</strong></span></span>) for more details.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="understanding_device_drivers"></a>Chapter 2. Understanding Device Drivers</h1></div></div></div><p>
This chapter provides you with a general introduction to device drivers and
takes you through the structural elements of a device driver.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Using WinDriver, you do not need to familiarize yourself with the internal
workings of driver development. As explained in
<a class="xref" href="#WD_Overview" title="Chapter 1. WinDriver Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 1</fo:inline></a> of the manual, WinDriver enables you to
communicate with your hardware and develop a driver for your device from the
user mode, using only WinDriver's simple APIs, without any need for driver or
kernel development knowledge.
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="device_driver_overview"></a>2.1. Device Driver Overview</h2></div></div></div><p>
Device drivers are the software segments that provides an interface between
the operating system and the specific hardware devices &#8212; such as
terminals, disks, tape drives, video cards, and network media. The device
driver brings the device into and out of service, sets hardware parameters in
the device, transmits data from the kernel to the device, receives data from
the device and passes it back to the kernel, and handles device errors.
</p><p>
A driver acts like a translator between the device and programs that use the
device. Each device has its own set of specialized commands that only its
driver knows. In contrast, most programs access devices by using generic
commands. The driver, therefore, accepts generic commands from a program and
then translates them into specialized commands for the device.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="drivers_func_classification"></a>2.2. Classification of Drivers According to Functionality</h2></div></div></div><p>
There are numerous driver types, differing in their functionality. This
subsection briefly describes three of the most common driver types.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mono_drivers"></a>2.2.1. Monolithic Drivers</h3></div></div></div><p>
Monolithic drivers are device drivers that embody all the functionality needed
to support a hardware device. A monolithic driver is accessed by one or more
user applications, and directly drives a hardware device. The driver
communicates with the application through I/&#65279;O control commands (IOCTLs) and
drives the hardware using calls to the different WDK, ETK, DDI/DKI functions.
</p><div class="figure"><a name="Monolithic"></a><p class="title"><b>Figure 2.1. Monolithic Drivers</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/Monolithic.png" height="" alt="Monolithic Drivers"></div></div></div><p><br class="figure-break">
</p><p>
Monolithic drivers are supported in all operating systems including all
Windows platforms and all Unix platforms.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="layered_drivers"></a>2.2.2. Layered Drivers</h3></div></div></div><p>
Layered drivers are device drivers that are part of a stack of device drivers
that together process an I/&#65279;O request. An example of a layered driver is a
driver that intercepts calls to the disk and encrypts/decrypts all data being
transferred to/from the disk. In this example, a driver would be hooked on to
the top of the existing driver and would only do the encryption/decryption.
</p><p>
Layered drivers are sometimes also known as filter drivers, and are supported
in all operating systems including all Windows platforms and all Unix
platforms.

</p><div class="figure"><a name="Layered"></a><p class="title"><b>Figure 2.2. Layered Drivers</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/Layered.png" height="" alt="Layered Drivers"></div></div></div><p><br class="figure-break">
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="miniport_drivers"></a>2.2.3. Miniport Drivers</h3></div></div></div><p>
A Miniport driver is an add-on to a class driver that supports miniport
drivers. It is used so the miniport driver does not have to implement all of
the functions required of a driver for that class. The class driver provides
the basic class functionality for the miniport driver. <br>
A class driver is a driver that supports a group of devices of common
functionality, such as all HID devices or all network devices.
</p><p>
Miniport drivers are also called miniclass drivers or minidrivers, and are
supported in the Windows 7 and higher operating systems.

</p><div class="figure"><a name="Miniport"></a><p class="title"><b>Figure 2.3. Miniport Drivers</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/Miniport.png" height="" alt="Miniport Drivers"></div></div></div><p><br class="figure-break">
</p><p>
The Windows 7 and higher operating systems provide several driver classes (called
ports) that handle the common functionality of their class. It is then up to
the user to add only the functionality that has to do with the inner workings
of the specific hardware.  The NDIS miniport driver is one example of such a
driver. The NDIS miniport framework is used to create network drivers that hook up to Windows's communication stacks, and are therefore accessible to common communication calls used by applications. The Windows kernel provides drivers for the various communication stacks and other code that is common to communication cards. Due to the NDIS framework, the network card developer does not have to write all of this code, only the code that is specific to the network card he is developing.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="os_classification"></a>2.3. Classification of Drivers According to Operating Systems</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wdm_drivers_overview"></a>2.3.1. WDM Drivers</h3></div></div></div><p>
Windows Driver Model (WDM) drivers are kernel-mode drivers within the Windows operating
systems. WDM works by channeling some of the work of the device driver into
portions of the code that are integrated into the operating system. These
portions of code handle all of the low&#65279;-&#65279;level buffer management, including
DMA and Plug&#65279;-&#65279;and&#65279;-&#65279;Play (Pnp) device enumeration.<br>
WDM drivers are PnP drivers that support power management protocols, and
include monolithic drivers, layered drivers and miniport drivers.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="unix_drivers_overview"></a>2.3.2. Unix Device Drivers</h3></div></div></div><p>
In the classic Unix driver model, devices belong to one of three categories:
character (char) devices, block devices and network devices. Drivers that
implement these devices are correspondingly known as char drivers, block
drivers or network drivers. Under Unix, drivers are code units linked into the
kernel that run in privileged kernel mode. Generally, driver code runs on
behalf of a user-mode application. Access to Unix drivers from user-mode
applications is provided via the file system. In other words, devices appear
to the applications as special device files that can be opened.
</p><p>
Unix device drivers are either layered or monolithic drivers. A monolithic
driver can be perceived as a one-layer layered driver.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="linux_drivers_overview"></a>2.3.3. Linux Device Drivers</h3></div></div></div><p>
Linux device drivers are based on the classic Unix device driver model<a class="xref" href="#unix_drivers_overview" title="2.3.2. Unix Device Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [2.3.2]</fo:inline></a>. In addition, Linux introduces some new
characteristics.
</p><p>
Under Linux, a block device can be accessed like a character device, as in
Unix, but also has a block-oriented interface that is invisible to the user or
application.
</p><p>
Traditionally, under Unix, device drivers are linked with the kernel, and the
system is brought down and restarted after installing a new driver. Linux
introduces the concept of a dynamically loadable driver called a module. Linux
modules can be loaded or removed dynamically without requiring the system to
be shut down. A Linux driver can be written so that it is statically linked or
written in a modular form that allows it to be dynamically loaded. This makes
Linux memory usage very efficient because modules can be written to probe for
their own hardware and unload themselves if they cannot find the hardware they
are looking for.
</p><p>
Like Unix device drivers, Linux device drivers are either layered or
monolithic drivers.
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="driver_entry_point"></a>2.4. The Entry Point of the Driver</h2></div></div></div><p>
Every device driver must have one main entry point, like the
<code class="jfunc">main</code><span class="jfunc">()</span> function in a C console application. This entry point is
called <code class="jfunc">DriverEntry</code><span class="jfunc">()</span> in Windows and <code class="jfunc">init_module</code><span class="jfunc">()</span> in
Linux. When the operating system loads the device driver, this driver entry
procedure is called.
</p><p>
There is some global initialization that every driver needs to perform only
once when it is loaded for the first time. This global initialization is the
responsibility of the
<code class="jfunc">DriverEntry</code><span class="jfunc">()</span>/<code class="jfunc">init_module</code><span class="jfunc">()</span> routine. The entry
function also registers which driver callbacks will be called by the operating
system. These driver callbacks are operating system requests for services from
the driver. In Windows, these callbacks are called <em class="it">dispatch routines</em>,
and in Linux they are called <em class="it">file operations</em>. Each registered callback
is called by the operating system as a result of some criteria, such as
disconnection of hardware, for example.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="hw_driver_assoc"></a>2.5. Associating the Hardware with the Driver</h2></div></div></div><p>
Operating systems differ in the ways they associate a device with a specific
driver.
</p><p>
In Windows, the hardware-driver association is performed via an INF file,
which registers the device to work with the driver. This association is
performed before the <code class="jfunc">DriverEntry</code><span class="jfunc">()</span> routine is called. The
operating system recognizes the device, checks its database to identify which
INF file is associated with the device, and according to the INF file, calls
the driver's entry point.
</p><p>
In Linux, the hardware-driver association is defined in the driver's
<code class="jfunc">init_module</code><span class="jfunc">()</span> routine. This routine includes a callback that
indicates which hardware the driver is designated to handle. The operating
system calls the driver's entry point, based on the definition in the code.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="communicating_with_drivers"></a>2.6. Communicating with Drivers</h2></div></div></div><p>
Communication between a user-mode application and the driver that drives the
hardware, is implemented differently for each operating system, using the
custom OS Application Programming Interfaces (APIs).
</p><p>
On Windows, and Linux, the application can use the OS
file-access API to open a handle to the driver (e.g., using the Windows
<code class="jfunc">CreateFile</code><span class="jfunc">()</span> function or using the Linux <code class="jfunc">open</code><span class="jfunc">()</span>
function), and then read and write from/to the device by passing the handle to
the relevant OS file-access functions (e.g., the Windows
<code class="jfunc">ReadFile</code><span class="jfunc">()</span> and <code class="jfunc">WriteFile</code><span class="jfunc">()</span> functions, or the Linux
<code class="jfunc">read</code><span class="jfunc">()</span> and <code class="jfunc">write</code><span class="jfunc">()</span> functions).
</p><p>
The application sends requests to the driver via I/&#65279;O control (IOCTL) calls,
using the custom OS APIs provided for this purpose (e.g., the Windows
<code class="jfunc">DeviceIoControl</code><span class="jfunc">()</span> function, or the Linux <code class="jfunc">ioctl</code><span class="jfunc">()</span> 
function).
<br>
The data passed between the driver and the application via the IOCTL calls is
encapsulated using custom OS mechanisms. For example, on Windows the data is
passed via an I/&#65279;O Request Packet (IRP) structure, and is encapsulated by the
I/&#65279;O Manager.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="wd_install"></a>Chapter 3. Installing WinDriver</h1></div></div></div><p>
This chapter takes you through the process of installing WinDriver on your
development platform, and shows you how to verify that your WinDriver is properly
installed. The last section discusses the uninstall procedure. To find out how
to install the driver you create on target platforms, refer to
<a class="xref" href="#driver_distribution" title="Chapter 14. Distributing Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 14</fo:inline></a>.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sys_req"></a>3.1. System Requirements</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sys_req_windows"></a>3.1.1. Windows System Requirements</h3></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Any x86 32-&#65279;bit or 64-&#65279;bit (x64: AMD64 or Intel EM64T) processor
  </li><li class="listitem" style="list-style-type: disc">
    Any compiler or development environment supporting C or .NET
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sys_req_windows_10iotcore"></a>3.1.2. Windows 10 IoT Core System Requirements</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
WinDriver supports driver development for the Windows 10 IoT Core operating
system.
Please note that Windows 10 IoT Enterprise is a full version of Windows 10, so
the regular WinDriver for Windows desktop / server can be used for those OSes.
</td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
WinDriver must be installed on a development computer running a desktop version
of Windows, in order to use DriverWizard.
</li><li class="listitem" style="list-style-type: disc">
A network connection allowing an SSH session with the target computer.
</li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sys_req_linux"></a>3.1.3. Linux System Requirements</h3></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Any of the following processor architectures, with a 2.6.x or higher
    Linux kernel:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        32-&#65279;bit x86
      </li><li class="listitem">
        64-&#65279;bit x86 AMD64 or Intel EM64T (<span class="b"><strong>x86_64</strong></span>)
      </li></ul></div>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    Jungo strives to support new Linux kernel versions as close as
    possible to their release.<br>
    To find out the latest supported kernel version, refer to the WinDriver
    release notes (found online at <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/windriver/wdver/" target="_top">https://www.jungo.com/st/support/windriver/wdver/</a></span>).
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    A GCC compiler
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The version of the GCC compiler should match the compiler version used for
    building the running Linux kernel.
    </td></tr></table></div>
    </li><li class="listitem" style="list-style-type: disc">
    Any 32-&#65279;bit or 64-&#65279;bit development environment (depending on your target
    configuration) supporting C for user mode
  </li><li class="listitem" style="list-style-type: disc">
    On your development PC: <span class="jprintfilename"><strong>glibc2.14.x (or newer)
        </strong></span></li><li class="listitem" style="list-style-type: disc">
    The following libraries are required for running GUI WinDriver application
    (e.g., DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a>; Debug Monitor 
    <a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2]</fo:inline></a>):<br>
    - <span class="jprintfilename"><strong>libstdc++.so.6</strong></span><br>
    - <span class="jprintfilename"><strong>libpng12.so.0</strong></span><br>
    - <span class="jprintfilename"><strong>libQtGui.so.4</strong></span><br>
    - <span class="jprintfilename"><strong>libQtCore.so.4</strong></span><br>
    - <span class="jprintfilename"><strong>libQtNetwork.so.4</strong></span>
    </li></ul></div>
</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_install_process"></a>3.2. WinDriver Installation Process</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_install_windows"></a>3.2.1. Windows WinDriver Installation Instructions</h3></div></div></div>

  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Driver installation on Windows requires administrator privileges.
  </td></tr></table></div>


<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Run the WinDriver installation &#8212;
    <span class="jprintfilename"><strong>WD1281.EXE</strong></span> &#8212; and follow
    the installation instructions.
  </li><li class="listitem">
    At the end of the installation, you may be prompted to reboot your
    computer.
  </li></ol></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><a name="wd_install_windows_notes_wd_basedir_note"></a>
    The WinDriver installation defines a <strong class="japib"><code>WD_BASEDIR</code></strong> environment
    variable, which is set to point to the location of your WinDriver directory,
    as selected during the installation. This variable is used during the
    DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a> code generation &#8212; it determines
    the default directory for saving your generated code and is used in the
    include paths of the generated project/make files.
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      This variable is also used in the sample Kernel PlugIn projects and
      makefiles.
    </span></li><li class="listitem" style="list-style-type: disc">
    If the installation fails with an
  <strong class="japib"><code>ERROR_FILE_NOT_FOUND</code></strong> error, inspect the Windows registry to
  see if the <strong class="japib"><code>RunOnce</code></strong> key exists in
  <strong class="japib"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code></strong>.
  This registry key is required by Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play in order to properly install
  drivers using INF files. If the <strong class="japib"><code>RunOnce</code></strong> key is missing, create
  it; then try installing the INF file again.
  </li></ul></div></td></tr></table></div><p>

  </p><p>
  <span class="b"><strong>The following steps are for registered users only:</strong></span>
  </p><p>
  </p><p>
  To register your copy of WinDriver with the license you received from
  Jungo, follow these steps:
  </p><p>

</p><div class="orderedlist"><ol class="orderedlist" start="3" type="1"><li class="listitem">
    Start DriverWizard: <span class="jmenupath"><strong>Start | Programs | WinDriver |
  DriverWizard</strong></span>.
  </li><li class="listitem">
    Select the <span class="jmenuitem"><strong>Register WinDriver</strong></span> option from the
    <span class="jmenuitem"><strong>File</strong></span> menu, and insert the license string you
    received from Jungo.
    </li><li class="listitem">
    Click the <span class="jmenuitem"><strong>Activate License</strong></span> button.
  </li><li class="listitem">
    To register source code that you developed during the evaluation period,
    refer to the documentation of<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>.
      When using the low&#65279;-&#65279;level <code class="japi">WD_xxx</code> API instead of the
      <code class="japi">WDC_xxx</code> API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a> (which is
      used by default), refer to the documentation of
      <code class="jfunc">WD_License</code><span class="jfunc">()</span> in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
   </span>
    </li></ol></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_install_linux"></a>3.2.2. Linux WinDriver Installation Instructions</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wd_install_linux_prepare"></a>3.2.2.1. Preparing the System for Installation</h4></div></div></div><p>
In Linux, kernel modules must be compiled with the same header files that the
kernel itself was compiled with. Since WinDriver installs kernel modules, it
must compile with the header files of the Linux kernel during the installation
process.
</p><p>
Therefore, before you install WinDriver for Linux, verify that the Linux
source code and the file <span class="jprintfilename"><strong>version.h</strong></span> are
installed on your machine:
</p><p>
<span class="b"><strong>Install the Linux kernel source code:</strong></span>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    If you have yet to install Linux, install it, including the kernel source
    code, by following the instructions for your Linux distribution.
    </li><li class="listitem" style="list-style-type: disc">
    If Linux is already installed on your machine, check whether the Linux
    source code was installed. You can do this by looking for 'linux' in the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src</strong></span></span> directory. If the
    source code is not installed, either install it, or reinstall Linux with
    the source code, by following the instructions for your Linux distribution.
    </li></ul></div><p>
</p><p>
<span class="b"><strong>Install version.h</strong></span>:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The file <span class="jprintfilename"><strong>version.h</strong></span> is created when you
    first compile the Linux kernel source code. Some distributions provide a
    compiled kernel without the file
    <span class="jprintfilename"><strong>version.h</strong></span>. Look under
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src/linux/include/linux</strong></span></span>
    to see whether you have this file. If you do not, follow these steps:
    <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
        Become super user:<br>
        <strong class="jcmd"><code>$ su</code></strong>
          
        </li><li class="listitem">
        Change directory to the Linux source directory:<br>
        <strong class="jcmd"><code># cd /usr/src/linux</code></strong>
        </li><li class="listitem">
        Type:<br>
        <strong class="jcmd"><code># make xconfig</code></strong>
        </li><li class="listitem">
        Save the configuration by choosing
        <span class="jmenuitem"><strong>Save and Exit</strong></span>.
        </li><li class="listitem">
        Type:<br>
        <strong class="jcmd"><code># make dep</code></strong>
        </li><li class="listitem">
    Exit super user mode:<br>
    <strong class="jcmd"><code># exit</code></strong>
    </li></ol></div></li></ul></div><p>
</p><p>
To run GUI WinDriver applications (e.g., DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a>;
Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2]</fo:inline></a>) you must also have version
6.0 of the <span class="jprintfilename"><strong>libstdc++</strong></span> library &#8212;
<span class="jprintfilename"><strong>libstdc++.so.6</strong></span> &#8212; and version 12.0 of
the <span class="jprintfilename"><strong>libpng</strong></span> library &#8212; <span class="jprintfilename"><strong>libpng12.so.0</strong></span>. If you do
not have these files, install the relevant packages for your Linux distribution
(e.g.,
<span class="jprintfilename"><strong>libstdc++6</strong></span>
and
<span class="jprintfilename"><strong>libpng12-0</strong></span>).
Also required is the <span class="b"><strong>libqtgui4</strong></span> package.
</p><p>
Before proceeding with the installation, you must also make sure that you have
a <em class="it">linux</em> symbolic link. If you do not, create one by typing<br>
<strong class="jcmd"><code>/usr/src$ ln -s &lt;target kernel&gt; linux</code></strong><br>

For example, for the Linux 3.0 kernel type<br>
<strong class="jcmd"><code>/usr/src$ ln -s linux-3.0/ linux</code></strong>

</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wd_linux_installation"></a>3.2.2.2. Installation</h4></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    On your development Linux machine, change directory to your preferred
    installation directory, for example to your home directory:<br>
    <strong class="jcmd"><code>$ cd ~</code></strong>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The path to the installation directory must not contain any spaces.
    </td></tr></table></div>
    </li><li class="listitem"><p>
    Extract the WinDriver distribution file &#8212; <span class="jprintfilename"><strong>WD1281LN.tgz</strong></span> or <span class="jprintfilename"><strong>WD1281LNx86_64.tgz</strong></span>
    &#8212;<br>
    <strong class="jcmd"><code>$
      tar xvzf &lt;file location&gt;/WD1281LN[x86_64].tgz</code></strong>
    </p><p>
    For example, to extract <span class="jprintfilename"><strong>WD1281LN.tgz</strong></span> run this command:
    <br>
      <strong class="jcmd"><code>$ tar xvzf ~/WD1281LN.tgz</code></strong>
    </p></li><li class="listitem">
    Change directory to your WinDriver <span class="jdirectory"><strong>redist</strong></span> directory (the tar
    automatically creates a <span class="jdirectory"><strong>WinDriver</strong></span> directory):<br>
    <strong class="jcmd"><code>$ cd &lt;WinDriver directory path&gt;/redist</code></strong>
    </li><li class="listitem">
    Install WinDriver:

    <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        <strong class="jcmd"><code>&lt;WinDriver directory&gt;/redist</code></strong><strong class="jcmd"><code>$ </code></strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="jcmd"><code>./configure --disable-usb-support</code></strong></span>
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      The configuration script creates a makefile based on the running kernel.
      You may select to use another installed kernel source, by executing the
      script with the
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="japib"><code>--with-kernel-source=&lt;path&gt;</code></strong></span>
      option, where <strong class="japib"><code>&lt;path&gt;</code></strong> is the full path to the kernel
      source directory &#8212; e.g.,
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src/linux</strong></span></span>.<br></li><li class="listitem" style="list-style-type: disc">
      If the Linux kernel version is 2.6.26 or
  higher, the configuration script generates makefiles that use
  <span class="jprintfilename"><strong>kbuild</strong></span> to compile the kernel modules. You
  can force the use of <span class="jprintfilename"><strong>kbuild</strong></span> on earlier
  versions of Linux, by executing the configuration script with the
  <strong class="japib"><code>--enable-kbuild</code></strong> flag.
    </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  For a full list of the configuration script options, use the
  <strong class="jcmd"><code>--help</code></strong> option:<br><strong class="jcmd"><code>./configure --help</code></strong></td></tr></table></div></li><li class="listitem">
        <strong class="jcmd"><code>&lt;WinDriver directory&gt;/redist$ make</code></strong>
        </li><li class="listitem">
        Become super user:<br>
        <strong class="jcmd"><code>&lt;WinDriver directory&gt;/redist$ su</code></strong>
        
        </li><li class="listitem">
        Install the driver: <br>
        <strong class="jcmd"><code>&lt;WinDriver directory&gt;/redist# make install</code></strong>
        </li></ol></div></li><li class="listitem">
    Create a symbolic link so that you can easily launch the DriverWizard
    GUI:<br>
    <strong class="jcmd"><code>$ ln -s <span class="jprintfilename"><strong>&lt;path to WinDriver&gt;/wizard/wdwizard</strong></span> /usr/bin/wdwizard</code></strong>
    </li><li class="listitem">
    Change the read and execute permissions on the file <span class="jprintfilename"><strong>wdwizard</strong></span> so that
    ordinary users can access this program.
    </li><li class="listitem">
    Change the user and group IDs and give read/write permissions to the device
    file
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/dev/windrvr1281</strong></span></span>,
    depending on how you wish to allow users to access hardware through the
    device. Due to security reasons, by default the device file is created with
    permissions only for the root user. Change the permissions by modifying
    your <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/udev/permissions.d/50-udev.permissions</strong></span></span>
    file. For example, add the following line to provide read and write
    permissions:<br>
    <code class="code">windrvr1281:root:root:0666</code><br>
    </li><li class="listitem"><a name="wd_linux_installation_step_wd_basedir"></a>
    Define a new <strong class="japib"><code>WD_BASEDIR</code></strong> environment variable and set it to
    point to the location of your WinDriver directory, as selected during the
    installation. This variable is used in the make and source files of the
    WinDriver samples and generated DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a> code, and
    is also used to determine the default directory for saving your generated
    DriverWizard projects. If you do not define this variable you will be
    instructed to do so when attempting to build the sample/generated code
    using the WinDriver makefiles.
    </li><li class="listitem">
    Exit super user mode:<br>
    <strong class="jcmd"><code># exit</code></strong>
    </li><li class="listitem">
    You can now start using WinDriver to access your hardware and generate your
    driver code!
    </li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">

  Use the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/util/wdreg</strong></span></span> script to load the
  WinDriver kernel module<a class="xref" href="#dyn_linux" title="13.5. Linux Dynamic Driver Loading"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.5]</fo:inline></a>.<br></td></tr></table></div><p>

  </p><p>
  <span class="b"><strong>The following steps are for registered users only:</strong></span>
  </p><p>
  </p><p>
  To register your copy of WinDriver with the license you received from
  Jungo, follow these steps:
  </p><p>

</p><div class="orderedlist"><ol class="orderedlist" start="11" type="1"><li class="listitem" value="12">
    Start DriverWizard:<br>
    <strong class="jcmd"><code>$ <span class="jprintfilename"><strong>&lt;path to WinDriver&gt;/wizard/wdwizard</strong></span></code></strong>
    </li><li class="listitem">
    Select the <span class="jmenuitem"><strong>Register WinDriver</strong></span> option from the
    <span class="jmenuitem"><strong>File</strong></span> menu, and insert the license string you
    received from Jungo.
    </li><li class="listitem">
    Click the <span class="jmenuitem"><strong>Activate License</strong></span> button.
  </li><li class="listitem">
    To register source code that you developed during the evaluation period,
    refer to the documentation of<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>.
      When using the low&#65279;-&#65279;level <code class="japi">WD_xxx</code> API instead of the
      <code class="japi">WDC_xxx</code> API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a> (which is
      used by default), refer to the documentation of
      <code class="jfunc">WD_License</code><span class="jfunc">()</span> in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
   </span>
    </li></ol></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="linux_hw_access_restrict"></a>3.2.2.3. Restricting Hardware Access on Linux</h4></div></div></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="scripts/images/caution.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
Since <span class="jdirectory"><strong>/dev/windrvr1281</strong></span> gives direct
hardware access to user programs, it may compromise kernel stability on
multi-user Linux systems. Please restrict access to DriverWizard and the device
file <span class="jdirectory"><strong>/dev/windrvr1281</strong></span> to trusted
users.
</p><p>
For security reasons the WinDriver installation script does not automatically
perform the steps of changing the permissions on
<span class="jdirectory"><strong>/dev/windrvr1281</strong></span> and the DriverWizard
application (<span class="jprintfilename"><strong>wdwizard</strong></span>).
</p></td></tr></table></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_install_upgrade"></a>3.3. Upgrading Your Installation</h2></div></div></div><p>
To upgrade to a new version of WinDriver, follow the installation steps for your
target operating system, as outlined in the previous section<a class="xref" href="#wd_install_process" title="3.2. WinDriver Installation Process"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [3.2]</fo:inline></a>. You can either choose to overwrite the existing
installation or install to a separate directory.
</p><p>
After the installation, start DriverWizard and enter the new license string, if
you have received one. This completes the minimal upgrade steps.
</p><p>
To upgrade your source code &#8212;
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Pass the new license string as a parameter to<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span> (or to <code class="jfunc">WD_License</code><span class="jfunc">()</span> &#8212; see
      the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> &#8212; when using the low&#65279;-&#65279;level
      <code class="japi">WD_xxx</code> API instead of the <code class="japi">WDC_xxx</code> API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a>.
    </span>
    </li><li class="listitem" style="list-style-type: disc">
    Verify that the call to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_DriverName</code><span class="japi">()</span></span><a class="xref" href="#WD_DriverName" title="B.1. WD_DriverName"><fo:inline> [B.1]</fo:inline></a></span> in your driver code (if
    exists) uses the name of the new driver module &#8212;
    <span class="jprintfilename"><strong>windrvr1281</strong></span> or your renamed version of this driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>.<br>
    If you use the generated DriverWizard code or one of the samples from the
    new WinDriver version, the code will already use the default driver name from
    the new version. Also, if your code is based on generated/sample code from
    an earlier version of WinDriver, rebuilding the code with
    <span class="jprintfilename"><strong>windrvr.h</strong></span> from the new version is
    sufficient to update the code to use the new default driver-module name
    (due to the use of the <code class="japi">WD_DEFAULT_DRIVER_NAME_BASE</code> definition).
    <br>
    If you elect to rename the WinDriver driver module<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>,
    ensure that your code calls <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_DriverName</code><span class="japi">()</span></span><a class="xref" href="#WD_DriverName" title="B.1. WD_DriverName"><fo:inline> [B.1]</fo:inline></a></span> with your custom
    driver name. If you rename the driver from the new version to a name
    already used in your old project, you do not need to modify your code.
  </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_install_check"></a>3.4. Checking Your Installation</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_install_check_windows_mac_unix"></a>3.4.1. Windows and Linux Installation Check</h3></div></div></div>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    
  Start DriverWizard &#8212; <span class="jprintfilename"><strong>&lt;path to WinDriver&gt;/wizard/wdwizard</strong></span>. On Windows you can also run DriverWizard from the
    <span class="jmenuitem"><strong>Start</strong></span> menu: <span class="jmenupath"><strong>Start | Programs | WinDriver |
  DriverWizard</strong></span>.
  </li><li class="listitem">
    If you are a registered user, make sure that your WinDriver license is
    registered (refer to <a class="xref" href="#wd_install_process" title="3.2. WinDriver Installation Process"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.2</fo:inline></a>, which
    explains how to install WinDriver and register your license).<br>
    If you are an evaluation version user, you do not need to register a
    license.
  </li><li class="listitem">
    For PCI cards &#8212; Insert your card into the PCI bus, and verify that
    DriverWizard detects it.
  </li><li class="listitem">
    For ISA cards (Windows and Linux) &#8212; Insert your card into
    the ISA bus, configure DriverWizard with your card's resources and try to
    read/write to the card using DriverWizard.
  </li></ol></div>
</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_uninstall"></a>3.5. Uninstalling WinDriver</h2></div></div></div><p>
This section will help you to uninstall either the evaluation or registered
version of WinDriver.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_uninstall_windows"></a>3.5.1. Windows WinDriver Uninstall Instructions</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    You can select to use the graphical
    <span class="jprintfilename"><strong>wdreg_gui.exe</strong></span> utility instead of
    <span class="jprintfilename"><strong>wdreg.exe</strong></span>.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>wdreg.exe</strong></span> and
    <span class="jprintfilename"><strong>wdreg_gui.exe</strong></span> are found in the
    <span class="jdirectory"><strong>WinDriver\util</strong></span> directory (see
    <a class="xref" href="#Dynamic_Driver_Load" title="Chapter 13. Dynamically Loading Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 13</fo:inline></a> for details regarding these
    utilities).
  </li></ul></div></td></tr></table></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Close any open WinDriver applications, including DriverWizard, the Debug
    Monitor, and user-specific applications.
  </li><li class="listitem">
    If you created a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>,
    uninstall and erase it:
    <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        If your Kernel PlugIn driver is currently installed, uninstall it using
        the <span class="jprintfilename"><strong>wdreg</strong></span> utility:<br><strong class="jcmd"><code>wdreg -name &lt;Kernel PlugIn name&gt; uninstall</code></strong><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        The Kernel PlugIn driver name should be specified without the *.sys
        extension.
        </td></tr></table></div></li><li class="listitem">
        Erase your Kernel PlugIn driver from the
        <span class="jdirectory"><strong>%windir%\&#65279;system32\&#65279;drivers</strong></span>
        directory.
      </li></ol></div>
    </li><li class="listitem">
    Uninstall all Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices (USB/PCI) that have been registered with 
    WinDriver via an INF file:<br>
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Uninstall the device using the <span class="jprintfilename"><strong>wdreg</strong></span>
        utility:<br><strong class="jcmd"><code>wdreg -inf &lt;path to the INF file&gt; uninstall</code></strong></li><li class="listitem" style="list-style-type: disc">
        Verify that no INF files that register your device(s) with WinDriver's
        kernel module (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>) are found in the
        <span class="jdirectory"><strong>%windir%\&#65279;inf</strong></span> directory.
      </li></ul></div>
    </li><li class="listitem">
    Uninstall WinDriver:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
        <span class="b"><strong>On the development PC</strong></span>, on which you installed the WinDriver
        toolkit:<br>
        Run <span class="jmenuitem"><strong>Start | WinDriver | Uninstall</strong></span> , <span class="b"><strong>OR</strong></span> run
        the <span class="jprintfilename"><strong>uninstall.exe</strong></span> utility from the
        <span class="jdirectory"><strong>WinDriver</strong></span> installation directory.
        </p><p>
        The uninstall will stop and unload the WinDriver kernel module
        (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>); delete the copy of the <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file
        from the <span class="jdirectory"><strong>%windir%\&#65279;inf</strong></span> directory; delete
        WinDriver from Windows' <span class="jmenuitem"><strong>Start</strong></span> menu; delete the
        <span class="jdirectory"><strong>WinDriver</strong></span> installation directory (except for
        files that you added to this directory); and delete the shortcut icons
        to the DriverWizard and Debug Monitor utilities from the Desktop.
        </p></li><li class="listitem" style="list-style-type: disc"><p>
        <span class="b"><strong>On a target PC</strong></span>, on which you installed the WinDriver kernel module
        (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>), but not the entire WinDriver toolkit:<br>
        Use the <span class="jprintfilename"><strong>wdreg</strong></span> utility to stop and
        unload the driver:<br>
        <strong class="jcmd"><code>wdreg -inf &lt;path to windrvr1281.inf&gt; uninstall</code></strong>
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        When running this command, <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> should reside in the
        same directory as <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>.
        </td></tr></table></div><p>
        (On the development PC, the relevant
        <span class="jprintfilename"><strong>wdreg</strong></span> uninstall command is executed
        for you by the uninstall utility).
        </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
          If you attempt to uninstall WinDriver while there are open handles to
          the WinDriver service (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span> or your renamed driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>, or there are connected and enabled Plug&#65279;-&#65279;and&#65279;-&#65279;Play
          devices that are registered to work with this service,
          <span class="jprintfilename"><strong>wdreg</strong></span> will fail to uninstall the
          driver. This ensures that you do not uninstall the driver while it is
          being used.
          </li><li class="listitem" style="list-style-type: disc">
          You can check if the WinDriver kernel module is loaded by running the
          Debug Monitor utility
          (<span class="jdirectory"><strong>WinDriver\util\wddebug_gui.exe</strong></span>)<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2]</fo:inline></a>. When the driver is loaded, the Debug Monitor
          log displays driver and OS information; otherwise, it displays a
          relevant error message. On the development PC, the uninstall command
          will delete the Debug Monitor executables; to use this utility after
          the uninstallation, create a copy of
          <span class="jprintfilename"><strong>wddebug_gui.exe</strong></span> before performing
          the uninstall procedure.
        </li></ul></div></td></tr></table></div></li><li class="listitem">
    If <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> was successfully unloaded, erase the following
    files (if they exist):<br>
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>%windir%\&#65279;system32\&#65279;drivers\</strong></span><span class="jprintfilename"><strong>windrvr1281.sys</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>%windir%&#65279;\inf\&#65279;</strong></span><span class="jprintfilename"><strong>windrvr1281.inf</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>%windir%\&#65279;system32\&#65279;wdapi1281.dll</strong></span></li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>%windir%\&#65279;sysWOW64\&#65279;wdapi1281.dll</strong></span>
        (Windows x64)<br></li></ul></div>
    </li><li class="listitem">
    Reboot the computer.
  </li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_uninstall_linux"></a>3.5.2. Linux WinDriver Uninstall Instructions</h3></div></div></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following commands must be executed with root privileges.
  </td></tr></table></div>


<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Verify that the WinDriver <span xmlns:fo="http://www.w3.org/1999/XSL/Format">driver module is</span> not being used by another program:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        View the list of modules and the programs using each of them:<br>
        <strong class="jcmd"><code># /sbin/lsmod</code></strong>
        </li><li class="listitem" style="list-style-type: disc">
        Identify any applications and modules that are using the WinDriver
        driver module. (By default, WinDriver module names begin with
        <span class="jprintfilename"><strong>windrvr1281</strong></span>).
        </li><li class="listitem" style="list-style-type: disc">
        Close any applications that are using the WinDriver driver module.
      </li><li class="listitem" style="list-style-type: disc">
        If you created a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>, unload the Kernel PlugIn driver
        module:<br>
        <strong class="jcmd"><code># /sbin/rmmod kp_xxx_module</code></strong>
        </li></ul></div></li><li class="listitem">
    Run the following command to unload the WinDriver driver module:<br>
    <strong class="jcmd"><code># /sbin/modprobe -r windrvr1281</code></strong>
    
    </li><li class="listitem">
    If you created a Kernel PlugIn driver, remove it as well.
    </li><li class="listitem">
    Remove the file <span class="jprintfilename"><strong>.windriver.rc</strong></span> from the
    <span class="jdirectory"><strong>/etc</strong></span> directory:<br>
    <strong class="jcmd"><code># rm -f /etc/.windriver.rc</code></strong>
    </li><li class="listitem">
    Remove the file <span class="jprintfilename"><strong>.windriver.rc</strong></span> from
    <span class="jdirectory"><strong>$HOME</strong></span>:<br>
    <strong class="jcmd"><code># rm -f $HOME/.windriver.rc</code></strong>
    </li><li class="listitem">
    If you created a symbolic link to DriverWizard, remove the link using the
    command<br>
    <strong class="jcmd"><code># rm -f /usr/bin/wdwizard</code></strong>
    </li><li class="listitem">
    Remove the WinDriver installation directory using the command<br>
    <strong class="jcmd"><code># rm -rf &lt;path to the WinDriver directory&gt;</code></strong><br>
    (for example: <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="jcmd"><code># rm -rf ~/WinDriver</code></strong></span>).
    </li><li class="listitem">
    Remove the WinDriver shared object file, if it exists:<br>
    <span class="jprintfilename"><strong>/usr/lib/libwdapi1281.so</strong></span>
    (32-&#65279;bit x86) /<br>
    <span class="jprintfilename"><strong>/usr/lib64/libwdapi1281.so</strong></span>
    (64-&#65279;bit x86).
    </li></ol></div>
</div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="driverwizard"></a>Chapter 4. Using DriverWizard</h1></div></div></div><p>
This chapter describes the WinDriver DriverWizard utility and its hardware
diagnostics and driver code generation capabilities.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wiz_overview"></a>4.1. An Overview</h2></div></div></div><p>

DriverWizard (included in the WinDriver toolkit) is a graphical user interface (GUI) tool that is
targeted at two major phases in the hardware and driver development:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Hardware diagnostics</strong></span> &#8212; DriverWizard enables you to write and
    read hardware resources before writing a single line of code. After the
    hardware has been built,<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      insert your device into the appropriate bus slot on your machine, view
      its resources &#8212; memory and I/&#65279;O ranges, PCI configuration
      registers, and interrupts &#8212; and verify the hardware's functionality
      by reading/writing memory and I/&#65279;O addresses, defining and accessing
      custom registers, and listening to interrupts.
     </span>
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Code generation</strong></span> &#8212; Once you have verified that the device is
    operating to your satisfaction, use DriverWizard generate skeletal driver
    source code with functions to view and access your hardware's resources.
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If you are developing a driver for a device that is based on an
    enhanced-support <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> chipset (PLX 6466, 9030, 9050, 9052, 9054, 9056, 9080 and
  9656; Altera Qsys design; Xilinx BMD design; Xilinx XDMA design), we recommend
    that you first read <a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 7: <i>Enhanced Support for Specific Chipsets</i></fo:inline></a> to understand
    your development options.
    </td></tr></table></div></li></ul></div><p>
</p><p>
On Windows, DriverWizard can also be used to generate an INF file<a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.1]</fo:inline></a> for your hardware.
</p><p>
The code generated by DriverWizard is composed of the following elements:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Library functions</strong></span> for accessing each element of your device's
    resources (memory ranges, I/&#65279;O ranges, registers and interrupts).
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>A 32-&#65279;bit diagnostics program</strong></span> in console mode with which you can
    diagnose your device. This application utilizes the special library
    functions described above. Use this diagnostics program as your skeletal
    device driver.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>A project solution</strong></span> that you can use to automatically load all of the
    project information and files into your development environment.<br>
    For Linux, DriverWizard generates the required makefile.
    </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="DriverWizard_Walkthrough"></a>4.2. DriverWizard Walkthrough</h2></div></div></div><p>
To use DriverWizard, follow these steps:






</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="b"><strong>Attach your hardware to the computer:</strong></span><br>
    Attach the card to the appropriate bus slot on your computer.<br><span class="b"><strong>Alternatively</strong></span>, you have the option to use DriverWizard to generate
    code for a virtual PCI device, without having the actual device installed,
    by selecting the <span class="jmenuitem"><strong>PCI Virtual Device</strong></span> DriverWizard
    option (see information in <a class="xref" href="#step_dw_wiz_run_n_dev_select"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>). When
    selecting this option, DriverWizard will generate code for your
    <em class="it">virtual PCI device</em>.
  </li><li class="listitem"><a name="step_dw_wiz_run_n_dev_select"></a><span class="b"><strong>Run DriverWizard and select your device:</strong></span><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        
  Start DriverWizard &#8212; <span class="jprintfilename"><strong>&lt;path to WinDriver&gt;/wizard/wdwizard</strong></span>. On Windows you can also run DriverWizard from the
    <span class="jmenuitem"><strong>Start</strong></span> menu: <span class="jmenupath"><strong>Start | Programs | WinDriver |
  DriverWizard</strong></span>.
        <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        On Windows 7 and higher you must run DriverWizard as administrator.
        </td></tr></table></div></li><li class="listitem">
        Click <span class="jmenuitem"><strong>New host driver project</strong></span> to start a new
        project<span xmlns:fo="http://www.w3.org/1999/XSL/Format">,
          or <span class="jmenuitem"><strong>Open an existing project</strong></span> to open a saved
          session</span>.
        <div class="figure"><a name="wiz_start"></a><p class="title"><b>Figure 4.1. Create or Open a Driver Project</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_start.png" height="" alt="Create or Open a Driver Project"></div></div></div><br class="figure-break"></li><li class="listitem"><p>
        Select your <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Plug&#65279;-&#65279;and&#65279;-&#65279;Play card</span>
        from the list of devices detected by DriverWizard.

        
        </p><div class="figure"><a name="figure_wiz_select_device"></a><p class="title"><b>Figure 4.2. Select Your Plug&#65279;-&#65279;and&#65279;-&#65279;Play Device</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_select_device.png" height="" alt="Select Your Plug&#65279;-&#65279;and&#65279;-&#65279;Play Device"></div></div></div><p><br class="figure-break">
        </p><p>
        For non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play cards, select <span class="jmenuitem"><strong>ISA</strong></span>.<br>
        To generate code for a PCI device that is not currently attached to the
        computer, select <span class="jmenuitem"><strong>PCI Virtual Device</strong></span>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        When selecting the <span class="jmenuitem"><strong>PCI Virtual Device</strong></span> option,
        DriverWizard allows you to define the device's resources. By specifying
        the I/&#65279;O and/or memory ranges, you may further define run-time
        registers (the offsets are relative to BARs). In addition, the IRQ must
        be specified if you want to generate code that acknowledges interrupts
        via run-time registers. Note, that the IRQ number and the size of the
        I/&#65279;O and memory ranges are irrelevant, since these will be
        automatically detected by DriverWizard when you install a physical
        device.
        </td></tr></table></div></li></ol></div></li><li class="listitem"><p><a name="step_dw_inf_gen_install"></a>
    
    <span class="b"><strong>Generate and install an INF file for your device [Windows]</strong></span>:<br>
    On the supported <span class="b"><strong>Windows</strong></span> operating systems, the driver for Plug&#65279;-&#65279;and&#65279;-&#65279;Play
    devices (such as <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span>) is installed by installing an INF file for
    the device. DriverWizard enables you to generate an INF file that registers
    your device to work with WinDriver (i.e., with the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>
    driver). The INF file generated by DriverWizard should later be distributed
    to your Windows customers, and installed on their PCs.
    
    <br>
    
    The INF file that you generate in this step is also designed to enable
    DriverWizard to diagnose <span xmlns:fo="http://www.w3.org/1999/XSL/Format">your device</span>
    on Windows<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> (for example, when no driver is installed for your
      PCI device)</span>.
    Additional information concerning the need for an INF file is provided in
    <a class="xref" href="#Why_Create_INF" title="15.1.1. Why Should I Create an INF File?"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.1.1</fo:inline></a>.
    
    </p><p>
    <span class="b"><strong>If you don't need to generate and install an INF file<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> (e.g., if you are using DriverWizard on Linux)</span>,
      skip this step.</strong></span>
    </p><p>
    To generate and install the INF file with DriverWizard, do the following:

    </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        In the <a class="link" href="#figure_wiz_select_device" title="Figure 4.2. Select Your Plug&#65279;-&#65279;and&#65279;-&#65279;Play Device"><span class="jmenuitem"><strong>Select
          Your Device</strong></span></a> screen
        (see <a class="xref" href="#step_dw_wiz_run_n_dev_select"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>), click the
        <span class="jmenuitem"><strong>Generate .INF file</strong></span> button or click
        <span class="jmenuitem"><strong>Next</strong></span>.
        </li><li class="listitem">
        DriverWizard will display information detected for your device &#8212;
        Vendor ID,
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Device</span>
        
        ID, Device Class, manufacturer name and device name &#8212; and allow
        you to modify this information<span xmlns:fo="http://www.w3.org/1999/XSL/Format">,
            as demonstrated in <a class="xref" href="#wiz_pci_inf_info" title="Figure 4.3. DriverWizard INF File Information"><fo:inline>Figure 4.3</fo:inline></a> below.
            </span>
        <div class="figure"><a name="wiz_pci_inf_info"></a><p class="title"><b>Figure 4.3. DriverWizard INF File Information</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_inf_info.png" alt="DriverWizard INF File Information"></div></div></div><br class="figure-break"></li><li class="listitem"><p>
        When you are done, click <span class="jmenuitem"><strong>Next</strong></span> and choose the
        directory in which you wish to store the generated INF file.
        DriverWizard will then automatically generate the INF file for you.
        </p><p>
        
        You can choose to automatically install the INF file by checking the
        <span class="jmenuitem"><strong>Automatically Install the INF file</strong></span> option in the
        DriverWizard's INF generation dialogue.<br>
        
        
        If the automatic INF file installation fails, DriverWizard will notify
        you and provide manual installation instructions (refer also the manual
        INF file installation instructions in <a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.1</fo:inline></a>).
        
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
            For further information on Preallocating DMA Buffers in Windows,
            please refer to
        <a class="xref" href="#ctg_dma_prealloc_win" title="9.1.2.1. Preallocating Contiguous DMA Buffers on Windows"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.1.2.1</fo:inline></a> of the manual.
        </td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        Handling of PCI Message-Signaled Interrupts (MSI) and Extended Message-Signaled Interrupts (MSI-&#65279;X) requires
        specific configuration in the device's INF file, as explained in
        <a class="xref" href="#win_msi_inf_files" title="9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.7.1</fo:inline></a> of the manual.<br>
        On Windows 7 and higher, if your hardware supports MSI or MSI-&#65279;X, the
        <span class="jmenuitem"><strong>Support Message Signaled Interrupts</strong></span> option in the DriverWizard's INF generation dialogue
        will be enabled and checked by default. When this option is checked,
        the generated DriverWizard INF file for your device will include
        support for MSI/MSI-&#65279;X handling. However, when this option is not
        checked, PCI interrupts will be handled using the legacy
        level-sensitive interrupts method, regardless of whether the hardware
        and OS support MSI/MSI-&#65279;X.
        </td></tr></table></div></li><li class="listitem">
        When the INF file installation completes, select and open your device
        from the list in the <span class="jmenuitem"><strong>Select Your Device</strong></span> screen.
        </li></ol></div><p>
    </p></li><li class="listitem"><p>
    <span class="b"><strong>Uninstall the INF file of your device [Windows]:</strong></span><br>
    On Windows, you can use DriverWizard to uninstall a previously installed
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Plug&#65279;-&#65279;and&#65279;-&#65279;Play PCI)</span> device INF
    file. This will unregister the device from its current driver and delete
    the copy of the INF file in the Windows INF directory.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    In order for WinDriver to correctly identify the resouces of a
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Plug&#65279;-&#65279;and&#65279;-&#65279;Play</span>
    device and communicate with it &#8212; including for the purpose of the
    DriverWizard device diagnostics outlined in the next step &#8212; the
    deivce must be registered to work with WinDriver via an INF file (see
    <a class="xref" href="#step_dw_inf_gen_install"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>).
    </td></tr></table></div><p>
    <span class="b"><strong>If you do not wish to uninstall an INF file, skip this step.</strong></span>
    </p><p>
    To uninstall the INF file, do the following:
    </p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        In the <a class="link" href="#figure_wiz_select_device" title="Figure 4.2. Select Your Plug&#65279;-&#65279;and&#65279;-&#65279;Play Device"><span class="jmenuitem"><strong>Select
          Your Device</strong></span></a> screen
        (see <a class="xref" href="#step_dw_wiz_run_n_dev_select"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>), click the
        <span class="jmenuitem"><strong>Uninstall .INF file</strong></span> button.
      </li><li class="listitem">
        Select the INF file to be removed.
      </li></ol></div><p>
    </p></li><li class="listitem"><a name="step_dw_dev_diagnose_pci"></a>
    <span class="b"><strong>Diagnose your device:</strong></span><br>
    Before writing your device driver, it is important to make sure your
    hardware is working as expected. Use DriverWizard to diagnose your
    hardware. All of your activity will be logged in the DriverWizard log so
    that you may later analyze your tests:
    <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
        Define and test your device's I/&#65279;O and memory ranges, registers
        and interrupts:

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
            DriverWizard will automatically detect your Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware
            resources: I/&#65279;O ranges, memory ranges, and interrupts.
            </p><div class="figure"><a name="wiz_pci_define_n_test_res"></a><p class="title"><b>Figure 4.4. PCI Resources</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_define_n_test_res.png" height="" alt="PCI Resources"></div></div></div><p><br class="figure-break">
            </p><p>
            For non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware, define your hardware's resources
            manually.

            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><span class="b"><strong>On Windows 7 and higher</strong></span>, you may need to register an IRQ
            with WinDriver before you can assign it to your non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play
            hardware<a class="xref" href="#wd_win_isa_irq_reg" title="9.2.3. Registering IRQs for Non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play Hardware on Windows 7 and Higher"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.3]</fo:inline></a>.
            </td></tr></table></div><p>
            </p><p>
            You can also manually define hardware registers, as
            demonstrated in <a class="xref" href="#wiz_pci_register_info" title="Figure 4.5. Define Registers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Figure 4.5</fo:inline></a> below.

            </p><div class="figure"><a name="wiz_pci_register_info"></a><p class="title"><b>Figure 4.5. Define Registers</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_register_info.png" height="" alt="Define Registers"></div></div></div><p><br class="figure-break">
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
            When defining registers, you may check the <span class="jmenuitem"><strong>Auto
            Read</strong></span> box in the <span class="jmenuitem"><strong>Register
            Information</strong></span> window. Registers marked as
            <span class="jmenuitem"><strong>Auto Read</strong></span> will automatically be read for
            any register read/write operation performed from DriverWizard.
            The read results will be displayed in the wizard's Log window.
            </td></tr></table></div></li><li class="listitem" style="list-style-type: disc"><p>
            Read and write to the I/&#65279;O ports, memory space and your defined
            registers, as demonstrated in <a class="xref" href="#wiz_pci_rw_mem_io" title="Figure 4.6. Read/Write Memory and I/&#65279;O"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Figure 4.6</fo:inline></a>.
            </p><div class="figure"><a name="wiz_pci_rw_mem_io"></a><p class="title"><b>Figure 4.6. Read/Write Memory and I/&#65279;O</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_rw_mem_io.png" alt="Read/Write Memory and I/&#65279;O"></div></div></div><br class="figure-break"></li><li class="listitem" style="list-style-type: disc"><p>
            'Listen' to your hardware's interrupts.

            </p><div class="figure"><a name="wiz_pci_listen_to_int"></a><p class="title"><b>Figure 4.7. Listen to Interrupts</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_listen_to_int.png" height="" alt="Listen to Interrupts"></div></div></div><p><br class="figure-break">
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
            For level-sensitive interrupts, such as legacy PCI interrupts, you
            must use DriverWizard to define the interrupt status register and
            assign the read/write command(s) for acknowledging (clearing) the
            interrupt, before attempting to listen to the interrupts with the
            wizard, otherwise the OS may hang!
            <a class="xref" href="#wiz_pci_int_ack_prepare" title="Figure 4.8. Define Transfer Commands for Level-Sensitive Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Figure 4.8</fo:inline></a> below demonstrates how to
            define an interrupt acknowledgment command for a defined
            <code class="japi">INTCSR</code> hardware register. Note, however, that
            interrupt acknowledgment information is hardware-specific.
            </td></tr></table></div><div class="figure"><a name="wiz_pci_int_ack_prepare"></a><p class="title"><b>Figure 4.8. Define Transfer Commands for Level-Sensitive Interrupts</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_int_ack_prepare.png" height="" alt="Define Transfer Commands for Level-Sensitive Interrupts"></div></div></div><br class="figure-break"></li></ul></div></li></ol></div></li><li class="listitem"><a name="step_dw_code_gen"></a><span class="b"><strong>Generate the skeletal driver code:</strong></span><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><a name="step_dw_code_gen_code"></a>
        Select to generate code either via the
        <span class="jmenuitem"><strong>Generate Code</strong></span> toolbar icon or from the
        <span class="jmenuitem"><strong>Project | Generate Code</strong></span> menu.
        </li><li class="listitem"><a name="step_dw_code_gen_select_code_gen_opt"></a>
        In the <span class="jmenuitem"><strong>Select Code Generation Options</strong></span> dialogue
        box that will appear, <span xmlns:fo="http://www.w3.org/1999/XSL/Format"> 
          you may optionally select to generate additional customized code for
          one of the supported devices<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline> [7]</fo:inline></a>; then
        </span>
        choose the code language and development environment(s) for the
        generated code and select <span class="jmenuitem"><strong>Next</strong></span> to generate the
        code.
        <div class="figure"><a name="wiz_pci_gen_code"></a><p class="title"><b>Figure 4.9. Code Generation Options</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_gen_code.png" alt="Code Generation Options"></div></div></div><br class="figure-break"></li><li class="listitem"><a name="step_dw_code_gen_add_drv_opt_pci"></a>
        Click <span class="jmenuitem"><strong>Next</strong></span> and select whether to handle
        handle Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management
  events from within your driver code, whether to generate Kernel PlugIn
  code<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a> (and what type of
  related application to create), and whether to build your project's library
  as a DLL (for MS Visual Studio Windows projects).
        <div class="figure"><a name="wiz_pci_driver_options"></a><p class="title"><b>Figure 4.10. Additional Driver Options</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_driver_options.png" alt="Additional Driver Options"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Kernel PlugIn Windows Project Notes"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left">Kernel PlugIn Windows Project Notes</th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
            To compile the generated Kernel PlugIn code, the Windows Driver Kit (WDK) must
            be installed.
          </li><li class="listitem" style="list-style-type: disc">
            
  To successfully build a Kernel PlugIn project using MS Visual Studio, the path to
  the project directory must not contain any spaces.
          </li></ul></div></td></tr></table></div></li><li class="listitem">
        Save your project (if required) and click <span class="jmenuitem"><strong>OK</strong></span> to
        open your development environment with the generated driver.
        </li><li class="listitem">
        Close DriverWizard to avoid device overlap errors.
      </li></ol></div></li><li class="listitem"><p><a name="step_dw_code_build"></a>
    <span class="b"><strong>Compile and run the generated code:</strong></span>

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Use this code as a starting point for your device driver. Modify
        where needed to perform your driver's specific functionality.
        </li><li class="listitem" style="list-style-type: disc">
        The source code DriverWizard creates can be compiled with any 32-&#65279;bit
        compiler, and will run on all supported platforms without
        modification.
        </li></ul></div><p>
    </p><p>
    For detailed compilation instructions, refer to
    <a class="xref" href="#wiz_gen_code_compile" title="4.2.2. Compiling the Generated Code"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2.2</fo:inline></a>.
    </p></li></ol></div><p>

</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wiz_auto_code_gen"></a>4.2.1. Automatic Code Generation</h3></div></div></div><p>
After you have finished diagnosing your device and have ensured that it runs
according to your specifications, you are ready to write your driver.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_code_gen"></a>4.2.1.1. Generating the Code</h4></div></div></div><p>
Generate code by selecting this option either via DriverWizard's
<span class="jmenuitem"><strong>Generate Code</strong></span> toolbar icon or from the wizard's
<span class="jmenuitem"><strong>Project | Generate Code </strong></span> menu (see
<a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>, <a class="xref" href="#step_dw_code_gen"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 6</fo:inline></a>). DriverWizard will generate the source
code for your driver<span xmlns:fo="http://www.w3.org/1999/XSL/Format">,
  and save it together with the wizard driver-project file
  (<span class="jprintfilename"><strong>xxx.wdp</strong></span>, where "xxx" is the project
  name)</span>.
  
The files are saved in a directory DriverWizard creates for every development
environment and operating system selected in the code generation dialogue.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_gen_C_code_pci"></a>4.2.1.2. The Generated PCI/ISA C Code</h4></div></div></div><p>
In the source code directory you now have a new
<span class="jprintfilename"><strong>xxx_lib.h</strong></span> file, which contains type
definitions and functions declarations for the API created for you by the
DriverWizard, and an <span class="jprintfilename"><strong>xxx_lib.c</strong></span> source file,
which contains the implementation of the generated device-specific API.<br>
In addition, you will find an <span class="jprintfilename"><strong>xxx_diag.c</strong></span>
source file, which includes a <code class="jfunc">main</code><span class="jfunc">()</span> function and implements a
sample diagnostics application that utilizes the generated DriverWizard API to
communicate with your device.
</p><p>
The code generated by DriverWizard is composed of the following elements and
files, where <span class="jprintfilename"><strong>xxx</strong></span> represents your DriverWizard
project name:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Library functions for accessing each element of your card's resources
    (memory ranges and I/&#65279;O, registers and interrupts):

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_lib.c</strong></span> &#8212; the implementation
        of the hardware-specific API (declared in
        <span class="jprintfilename"><strong>xxx_lib.h</strong></span>), using the WinDriver Card
        (WDC) API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>.
      </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_lib.h</strong></span> &#8212; a header file that
        contains type definitions and function declarations for the API
        implemented in the <span class="jprintfilename"><strong>xxx_lib.c</strong></span> source
        file.<br>
        You should include this file in your source code to use the API
        generated by DriverWizard for your device.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    A diagnostics program that utilizes the generated DriverWizard API
    (declared in <span class="jprintfilename"><strong>xxx_lib.h</strong></span>) to communicate
    with your device(s):<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_diag.c</strong></span> The source code of the
        generated diagnostics console application.<br>
        Use this diagnostics program as your skeletal device driver.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    A list of all files created can be found at
    <span class="jprintfilename"><strong>xxx_files.txt</strong></span>.
  </li></ul></div><p>
</p><p>
After creating your code, compile it with your favorite compiler, and see it
work!
</p><p>
Change the function <code class="jfunc">main</code><span class="jfunc">()</span> of the program so that the
functionality suits your needs.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_gen_py_code_pci"></a>4.2.1.3. The Generated PCI/ISA Python Code</h4></div></div></div>
In the source code directory you now have a new
<span class="jprintfilename"><strong>xxx_lib.py</strong></span> file, which contains type
definitions and function implementations for the API created for you by the
DriverWizard.
In addition, you will find an <span class="jprintfilename"><strong>xxx_diag.py</strong></span>
source file, which includes a <code class="jfunc">main</code><span class="jfunc">()</span> function and implements a
sample diagnostics application that utilizes the generated DriverWizard API to
communicate with your device.
The <span class="jdirectory"><strong>wdlib</strong></span> subdirectory
includes shared Python code files that implement the WinDriver API structs,
import the WinDriver user API DLL file, define variables, and implement user
I/O functions required for the user application to run.

The code generated by DriverWizard is composed of the following elements and
files, where <span class="jprintfilename"><strong>xxx</strong></span> represents your DriverWizard
project name:
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
Library functions for accessing each element of your card's resources (memory
    ranges and I/O, registers and interrupts):

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_lib.py</strong></span> &#8212; type definitions and the
        implementation of the hardware-specific API, using the WinDriver Card
        (WDC) API [B.2].
        </li></ul></div></li><li class="listitem" style="list-style-type: disc">
        A diagnostics program that utilizes the generated DriverWizard API
        (declared in <span class="jprintfilename"><strong>xxx_lib.py</strong></span>) to communicate
        with your device(s):
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_diag.py</strong></span> The source code of
                 the generated diagnostics console application.
                Use this diagnostics program as your skeletal device driver.
        </li></ul></div></li><li class="listitem" style="list-style-type: disc">
        A list of all files created can be found at
        <span class="jprintfilename"><strong>xxx_files.txt</strong></span>.
</li></ul></div><p>
After creating your code, run it with your favorite Python
interpreter and see it work!

</p><p>
Change the function <code class="jfunc">main</code><span class="jfunc">()</span> of the program so that
the functionality suits your needs.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_gen_cs_code_pci"></a>4.2.1.4. The Generated PCI/ISA C#.NET Code</h4></div></div></div>
In the source code directory you now have a new <span class="jdirectory"><strong>lib</strong></span>
subdirectory, which contains type definitions and function implementations for
the API created for you by the DriverWizard. This subdirectory outputs a DLL
file that is compiled by the <span class="jprintfilename"><strong>xxx_diag</strong></span> project.
In addition, you will find a <span class="jdirectory"><strong>diag</strong></span> subdirectory, a
sample diagnostics application that utilizes the generated DriverWizard API to
communicate with your device.
The <span class="jprintfilename"><strong>xxx_diag.cs</strong></span> file that
includes a <code class="jfunc">Main</code><span class="jfunc">()</span> function.
A list of all files created can be found at
<span class="jprintfilename"><strong>xxx_files.txt</strong></span>.
<p>
After creating your code, compile it with your favorite C# compiler and see it
work!

</p><p>
Change the function <code class="jfunc">Main</code><span class="jfunc">()</span> of the program so that the
functionality suits your needs.
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wiz_gen_code_compile"></a>4.2.2. Compiling the Generated Code</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_win_gen_code_compile"></a>4.2.2.1. Windows Compilation</h4></div></div></div><p>
As explained above, on Windows you can select to generate project, solution,
and make files for the supported compilers and development environments &#8212;
MS Visual Studio, Windows GCC (MinGW/Cygwin).<br>
For integrated development environments (IDEs), such as MS Visual Studio, you can also
select to automatically invoke your selected IDE from the wizard. You can then
proceed to immediately build and run the code from your selected IDE.
</p><p>
You can also build the generated code using any other compiler or development
environment that supports the selected code language and target OS. Simply
create a new project or make file for your selected compiler/environment,
include the generated source files, and run the code.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    For Windows, the generated compiler/environment files are located under an
    <span class="jdirectory"><strong>x86</strong></span> directory &#8212; for 32-&#65279;bit projects
    &#8212; or an <span class="jdirectory"><strong>amd64</strong></span> directory &#8212; for 64-&#65279;bit
    projects.
  </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To build a Kernel PlugIn project (on Windows), follow the instructions in
<a class="xref" href="#kp_compilation_windows" title="12.8.1. Windows Kernel PlugIn Driver Compilation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.8.1</fo:inline></a>.
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h5 class="title"><a name="wiz_running_compiled_win10iot"></a>4.2.2.1.1. Running compiled code under Windows 10 IoT Core</h5></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Since Windows 10 IoT Core currently does not support WinForms applications, the
DriverWizard generated code in C#/Visual Basic (which use these libraries) will
not run on this environment. However, you can import
<span class="jprintfilename"><strong>wdapi_dotnet1281.dll</strong></span> and use it in
a console mode C#/VB.Net Application you develop.
</td></tr></table></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Copy <span class="jprintfilename"><strong>wdapi1281.dll</strong></span> from
<span class="jprintfilename"><strong>WinDriver\redist</strong></span>. Make sure you are using the
suitable version for your platform (x86/x64/ARM).
</li><li class="listitem">
Compile your code on the development computer. Make sure you compile it to suit
your target platform.
</li><li class="listitem">
Copy your compiled binary to your Windows 10 IoT Core target computer and run
it using SSH.
</li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wiz_unix_gen_code_compile"></a>4.2.2.2. Linux Compilation</h4></div></div></div>
<p>
Use the makefile that was created for you by DriverWizard in order to build
the generated code using your favorite compiler, preferably GCC.
</p>

<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To build a Kernel PlugIn project, follow the instructions in
<a class="xref" href="#kp_compilation_linux" title="12.8.2. Linux Kernel PlugIn Driver Compilation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.8.2</fo:inline></a>.
</td></tr></table></div>
</div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="driver_develop"></a>Chapter 5. Developing a Driver</h1></div></div></div><p>
This chapter takes you through the WinDriver driver development cycle.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dev_driver_use_wiz"></a>5.1. Using DriverWizard to Build a Device Driver</h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Use DriverWizard to diagnose your device and verify that it operates as
    expected:<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      Read/write the I/&#65279;O and memory ranges, view the PCI configuration
      registers, define and access custom registers, and listen to interrupts.
    </span>
    </li><li class="listitem" style="list-style-type: disc">
    Use DriverWizard to generate skeletal code for your device in
    C or C&#65279;#. For more information about DriverWizard, refer to
    <a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 4</fo:inline></a>.
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If you are using an enhanced-support <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> device
    (PLX 6466, 9030, 9050, 9052, 9054, 9056, 9080 and
  9656; Altera Qsys design; Xilinx BMD design; Xilinx XDMA design), you may want to use the related WinDriver sample as the
    basis for your development instead of generating code with DriverWizard.
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Note that for devices based on the
      Altera Qsys design, Xilinx BMD design or Xilinx XDMA design, you can use DriverWizard to
      generate customized device-specific code, which utilizes the
      enhanced-support sample APIs.</span>
    For additional information, refer to <a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 7: <i>Enhanced Support for Specific Chipsets</i></fo:inline></a>.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Use any C or .NET compiler or development environment (depending on the
    code you created) to build the skeletal driver you need.<br>
    WinDriver provides specific support for the following environments and
    compilers: MS Visual Studio, C&#65279;+&#65279;+, GCC, Windows GCC
    </li></ul></div><p>
That is all you need to do in order to create your user-mode driver.<br>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
  If you discover that better performance is needed, refer to
  <a class="xref" href="#performance_improve" title="Chapter 10. Improving Performance"><fo:inline>Chapter 10</fo:inline></a>.<br>
 </span>
For a detailed description of WinDriver's <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI/ISA</span> API, refer to
<a class="xref" href="#API_REF" title="Appendix B. API Reference"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Appendix B</fo:inline></a>.<br>




<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
To learn how to perform operations that DriverWizard cannot automate, refer to
<a class="xref" href="#Advanced_Issues" title="Chapter 9. Advanced Issues"><fo:inline>Chapter 9</fo:inline></a>.
</span>

</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="driver_dev_no_wizard"></a>5.2. Writing the Device Driver Without DriverWizard</h2></div></div></div><p>
There may be times when you choose to write your driver directly, without
using DriverWizard. In such cases, either follow the steps outlined in this
section to create a new driver project, or select a WinDriver sample that most
closely resembles your target driver and modify it to suit your specific
requirements.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="no_wiz_include_req_wd_files"></a>5.2.1. Include the Required WinDriver Files</h3></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    Include the relevant WinDriver header files in your driver project.<br>
    All header files are found under the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/include</strong></span></span> directory.
    </p><p>
    All WinDriver projects require the <span class="jprintfilename"><strong>windrvr.h</strong></span>
    header file.<br>
   
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format">
    When using the <code class="japi">WDC_xxx</code> API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a>, include
    the <span class="jprintfilename"><strong>wdc_lib.h</strong></span> and
    <span class="jprintfilename"><strong>wdc_defs.</strong></span> header files (these files
    already include <span class="jprintfilename"><strong>windrvr.h</strong></span>).<br>
    </span>
    </p><p>
    Include any other header file that provides APIs that you wish to use from
    your code (e.g., files from the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/samples/shared</strong></span></span>
    directory, which provide convenient diagnostics functions.)
    </p></li><li class="listitem">
    Include the relevant header files from your source code:
   
   <span xmlns:fo="http://www.w3.org/1999/XSL/Format">
    For example, to use API from the
    <span class="jprintfilename"><strong>windrvr.h</strong></span> header file, add the following
    line to the code:
    <pre class="screen">#include "windrvr.h"</pre>
     </span></li><li class="listitem">
    Link your code with the WDAPI library (Windows) / shared object 
    (Linux):<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        For Windows:
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver\lib\&lt;CPU&gt;\wdapi1281.lib</strong></span></span>,
        where the <span class="jdirectory"><strong>&lt;CPU&gt;</strong></span> directory is either
        <span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit binaries for x86 platforms),
        <span class="jdirectory"><strong>amd64</strong></span> (64-&#65279;bit binaries for x64 platforms),
        or <span class="jdirectory"><strong>amd64\x86</strong></span> (32-&#65279;bit binaries for x64
        platforms<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a></li><li class="listitem" style="list-style-type: disc">
        For Linux: From the
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/lib</strong></span></span> directory
        &#8212; <span class="jprintfilename"><strong>libwdapi1281.so</strong></span> or
        <span class="jprintfilename"><strong>libwdapi1281_32.so</strong></span> (for
        32-&#65279;bit applications targeted at 64-&#65279;bit platforms)<br>
        Note: When using
        <span class="jprintfilename"><strong>libwdapi1281_32.so</strong></span>, first
        create a copy of this file in a different directory and rename it to
        <span class="jprintfilename"><strong>libwdapi1281.so</strong></span>, then link
        your code with the renamed file<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a>.
      </li></ul></div><p>
    You can also include the library's source files in your project instead of
    linking the project with the library. The C source files are located under
    the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/src/wdapi</strong></span></span>
    directory.
    
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    When linking your project with the WDAPI library<span xmlns:fo="http://www.w3.org/1999/XSL/Format">/framework</span>/shared object, you will need to
    distribute this binary with your driver.<br>
    For Windows, get <span class="jprintfilename"><strong>wdapi1281.dll</strong></span>
    / <span class="jprintfilename"><strong>wdapi1281_32.dll</strong></span> (for
    32-&#65279;bit applications targeted at 64-&#65279;bit platforms) from the
    <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory.<br>
    For Linux, get
    <span class="jprintfilename"><strong>libwdapi1281.so</strong></span> /
    <span class="jprintfilename"><strong>libwdapi1281_32.so</strong></span>
    (for 32-&#65279;bit applications targeted at 64-&#65279;bit platforms) from the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/lib</strong></span></span> directory.
    </td></tr></table></div><p>
    Note: On Windows and Linux, when using the DLL/shared object file
    for 32-&#65279;bit applications on 64-&#65279;bit platforms
    (<span class="jprintfilename"><strong>wdapi1281_32.dll</strong></span> /
    <span class="jprintfilename"><strong>libwdapi1281_32.so</strong></span>), rename
    the copy of the file in the distribution package, by removing the
    <span class="jprintfilename"><strong>_32</strong></span> portion<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a>.<br>
    For detailed distribution instructions, refer to
    <a class="xref" href="#driver_distribution" title="Chapter 14. Distributing Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 14</fo:inline></a>.
    </p></li><li class="listitem">
    Add any other WinDriver source files that implement API that you which to use
    in your code (e.g., files from the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/samples/shared</strong></span></span>
    directory.)
  </li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="no_wiz_write_your_code"></a>5.2.2. Write Your Code</h3></div></div></div><p>
This section outlines the calling sequence when using the <code class="japi">WDC_xxx</code>
API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>.

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span> to open a handle to WinDriver and the WDC
    library, compare the version of the loaded driver with that of your driver
    source files, and register your WinDriver license (for registered users).
  </li><li class="listitem">
    For PCI/PCI Express devices, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span> to scan 
    the PCI bus and locate your device.
  </li><li class="listitem">
    For PCI/PCI Express devices, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciGetDeviceInfo</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a></span> to
    retrieve the resources information for your selected device.<br>
    For ISA devices, define the resources yourself within a
    <code class="japi">WD_CARD</code> structure.
  </li><li class="listitem">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span> / <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IsaDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a></span>
    (depending on your device), and pass to the function the device's resources
    information. These functions return a handle to the device, which you can 
    later use to communicate with the device using the <code class="japi">WDC_xxx</code> API.
  </li><li class="listitem">
    Communicate with the device using the <code class="japi">WDC_xxx</code> API (see the
    description in <a class="xref" href="#API_REF" title="Appendix B. API Reference"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Appendix B</fo:inline></a>).<br>
    To enable interrupts, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span>.<br>
    To register to receive notifications for Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management
    events, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span>.
  </li><li class="listitem">
    When you are done, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> to disable interrupt
    handling (if previously enabled), call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span> to
    unregister Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management event handling (if previously
    registered), and then call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciDeviceClose</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline> [B.3.19]</fo:inline></a></span> / 
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IsaDeviceClose</code><span class="japi">()</span></span><a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline> [B.3.20]</fo:inline></a></span> (depending on your device) in order to
    close the handle to the device.
  </li><li class="listitem">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverClose</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverClose" title="B.3.3. WDC_DriverClose()"><fo:inline> [B.3.3]</fo:inline></a></span> to close the handles to WinDriver and the
    WDC library.
  </li></ol></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="no_wiz_cfg_n_build_code"></a>5.2.3. Configure and Build Your Code</h3></div></div></div><p>
After including the required files and writing your code, make sure that the
required build flags and environment variables are set, then build your code.
</p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
When developing a driver for a 64-&#65279;bit platform<a class="xref" href="#64bit_os_sup" title="Appendix A. 64-&#65279;Bit Operating Systems Support"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A]</fo:inline></a>, your
project or makefile must include the <strong class="japib"><code>KERNEL_64BIT</code></strong> preprocessor
definition. In the makefiles, the definition is
  added using the <code class="japi">-D</code> flag: <code class="japi">-&#65279;DKERNEL_64BIT</code>.
(The sample and
  wizard-generated Linux and Windows GCC makefiles and the Windows MS Visual Studio
  projects, in the 64-&#65279;bit WinDriver toolkit, already include this definition.)
</td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Before building your code, verify that the <code class="japi">WD_BASEDIR</code> environment
variable is set to the location of the of the WinDriver installation directory.
<br>
On Windows and Linux you can define the <code class="japi">WD_BASEDIR</code>
environment variable globally &#8212; as explained in
<a class="xref" href="#wd_install" title="Chapter 3. Installing WinDriver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 3</fo:inline></a>: For Windows &#8212; refer to the
<a class="xref" href="#wd_install_windows_notes_wd_basedir_note"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows WD_BASEDIR note</fo:inline></a> in
<a class="xref" href="#wd_install_windows" title="3.2.1. Windows WinDriver Installation Instructions"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.2.1</fo:inline></a>; for Linux: refer to
<a class="xref" href="#wd_linux_installation" title="3.2.2.2. Installation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.2.2.2</fo:inline></a>,
<a class="xref" href="#wd_linux_installation_step_wd_basedir"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 8</fo:inline></a>.
</td></tr></table></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="debugging_drivers"></a>Chapter 6. Debugging Drivers</h1></div></div></div><p>
The following sections describe how to debug your hardware-access application
code.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dbg_user"></a>6.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">User-Mode Debugging</span></h2></div></div></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Since WinDriver is accessed from the user mode, we recommend that you first
    debug your code using your standard debugging software.
  </li><li class="listitem" style="list-style-type: disc">
    The Debug Monitor utility<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2]</fo:inline></a> logs debug messages from
    WinDriver's kernel-mode and user-mode APIs. You can also use WinDriver APIs to
    send your own debug messages to the Debug Monitor log.
  </li><li class="listitem" style="list-style-type: disc">
    When using WinDriver's API (such as <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span> &#8212; see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), to read/write memory ranges on the card in the kernel,
    while the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2]</fo:inline></a> is activated, WinDriver's
    kernel module validates the memory ranges, i.e., it verifies that the
    reading/writing from/to the memory is in the range that is defined for the
    card.
    </li><li class="listitem" style="list-style-type: disc">
    Use DriverWizard to check values of memory and registers in the debugging
    process.
  </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Debug_Monitor"></a>6.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Debug Monitor</span></h2></div></div></div><p>
Debug Monitor is a powerful graphical- and console-mode tool for monitoring all
activities handled by the WinDriver kernel.<br>
You can use this tool to monitor how each command sent to the kernel is
executed.
</p><p>
In addition, WinDriver enables you to print your own debug messages to the
Debug Monitor, using the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_DebugAdd</code><span class="japi">()</span></span><span> function</span></span>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">(described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)</span>
or the high&#65279;-&#65279;level <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">PrintDbgMessage</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#PrintDbgMessage" title="B.10.15. PrintDbgMessage"><fo:inline> [B.10.15]</fo:inline></a></span>.
</p><p>
The Debug Monitor comes in two versions:<br>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>wddebug_gui</strong></span><a class="xref" href="#wddebug_gui" title="6.2.1. The wddebug_gui Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2.1]</fo:inline></a> &#8212;
    a GUI version for Windows and Linux.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>wddebug</strong></span><a class="xref" href="#wddebug" title="6.2.2. The wddebug Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [6.2.2]</fo:inline></a> &#8212; a
    console-mode version for <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows, and Linux</span>.
  </li></ul></div><p>
</p><p>
Both Debug Monitor versions are provided in the
<span class="jdirectory"><strong>WinDriver/util</strong></span> directory
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wddebug_gui"></a>6.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">The wddebug_gui Utility</span></h3></div></div></div><p>
<span class="jprintfilename"><strong>wddebug_gui</strong></span> is a fully graphical (GUI) version
of the Debug Monitor utility for Windows and Linux.

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Run the Debug Monitor using either of the following methods:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Run <span class="jprintfilename"><strong>WinDriver/util/wddebug_gui</strong></span></li><li class="listitem" style="list-style-type: disc">
        Run the Debug Monitor from DriverWizard's <span class="jmenuitem"><strong>Tools</strong></span>
        menu.
      </li><li class="listitem" style="list-style-type: disc">
        On Windows, run
        <span class="jmenupath"><strong>Start | Programs | WinDriver | Debug Monitor</strong></span>.
      </li></ul></div><div class="figure"><a name="dbgm_log"></a><p class="title"><b>Figure 6.1. Start Debug Monitor</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/dbgm_log.png" height="" alt="Start Debug Monitor"></div></div></div><br class="figure-break"></li><li class="listitem"><a name="step_wddebug_gui_opts"></a>
    Set the Debug Monitor's status, trace level and debug sections information
    from the <span class="jmenuitem"><strong>Debug Options</strong></span> dialogue, which is activated
    either from the Debug Monitor's <span class="jmenupath"><strong>View | Debug Options</strong></span>
    menu or the <span class="jmenuitem"><strong>Debug Options</strong></span> toolbar button.
    <div class="figure"><a name="dbgm_dbg_opts"></a><p class="title"><b>Figure 6.2. Debug Options</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/dbgm_dbg_opts.png" height="" alt="Debug Options"></div></div></div><br class="figure-break"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jmenuitem"><strong>Status</strong></span> &#8212; Set trace on or off.
      </li><li class="listitem" style="list-style-type: disc">
        <span class="jmenuitem"><strong>Section</strong></span> &#8212; Choose what part of the WinDriver
        API you would like to monitor.

        
        <p>For example, if you are experiencing problems
        with the interrupt handler on your PCI card, select the
        <span class="jmenuitem"><strong>PCI</strong></span> and <span class="jmenuitem"><strong>Interrupts</strong></span>
        sections.
        </p>
        <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        Choose carefully those sections that you would like to monitor.
        Checking more options than necessary could result in an overflow of
        information, making it harder for you to locate your problem.
        </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
        <span class="jmenuitem"><strong>Level</strong></span> &#8212; Choose the level of messages you
        want to see for the resources defined.
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
            <span class="b"><strong>Error</strong></span> is the lowest trace level, resulting in minimum output
            to the screen.
            </li><li class="listitem">
            <span class="b"><strong>Trace</strong></span> is the highest trace level, displaying every operation
            the WinDriver kernel performs.
            </li></ul></div></li><li class="listitem" style="list-style-type: disc">
        <span class="jmenuitem"><strong>Send debug messages to the operating system kernel
          debugger</strong></span> &#8212;
        <p>
        Select this option to send the debug messages received from the WinDriver
        kernel module to an external kernel debugger, in addition to the
        Debug Monitor.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><span class="b"><strong>On Windows 7 and higher</strong></span>, the first time that you enable this option you
 will need to restart the PC.
 </td></tr></table></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        A free Windows kernel debugger, WinDbg, is distributed with the
        Windows Driver Kit (WDK) and is part of the Debugging Tools for Windows package,
        distributed via the Microsoft web site.
        </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
        <span class="jmenuitem"><strong>Driver Name</strong></span> &#8212;
        <p>
        This field displays the name of the driver currently being debugged. Changing it
        allows you to debug a renamed WinDriver driver.
        </p></li></ul></div></li><li class="listitem">
    Once you have defined what you want to trace and on what level, click
    <span class="jmenuitem"><strong>OK</strong></span> to close the
    <span class="jmenuitem"><strong>Debug Options</strong></span> window.
    </li><li class="listitem">
    Optionally make additional configurations via the Debug Monitor menus and
    toolbar.
    <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    When debugging OS crashes or hangs, it's useful to auto-save the
    Debug Monitor log, via the <span class="jmenuitem"><strong>File &#8211;&gt;
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">Toggle Auto-Save</span></strong></span> menu option
    (available also via a toolbar icon), in addition to sending the debug
    messages to the OS kernel debugger
    (see <a class="xref" href="#step_wddebug_gui_opts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>).
    </td></tr></table></div></li><li class="listitem">
    Run your application (step-by-step or in one run).

    <div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    You can use the <span class="jmenuitem"><strong>Edit &#8211;&gt;
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">Add Custom Message...</span></strong></span> menu option
    (available also via a toolbar icon) to add custom messages to the log.
    This is especially useful for clearly marking different execution sections
    in the log.
    </td></tr></table></div></li><li class="listitem">
    Watch the Debug Monitor log (or the kernel debugger log, if enabled) for
    errors or any unexpected messages.
    </li></ol></div><p>
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="search%20in%20wddebug_gui"></a>6.2.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Search in wddebug_gui</span></h4></div></div></div><p>
    <span class="jprintfilename"><strong>wddebug_gui</strong></span> allows to find expressions in the Debug output in 4 ways:
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"> Starting to type an expression with the keyboard immediately searches for it in the Debug output.</li><li class="listitem"> Pressing <span class="jmenuitem"><strong>CTRL+F</strong></span> displays the Find field in the toolbar</li><li class="listitem"> Clicking the <span class="jmenuitem"><strong>Find</strong></span> icon in the toolbar. </li><li class="listitem"> Going to <span class="jmenuitem"><strong>Edit-&gt;Find...</strong></span></li></ol></div><p>

    If an expression is found it is marked.
    It is possible to browse between occurences of an expression using <span class="jmenuitem"><strong>Prev (F2)</strong></span> and <span class="jmenuitem"><strong>Next (F3)</strong></span>.
</p><div class="figure"><a name="dbgm_find"></a><p class="title"><b>Figure 6.3. Search in wddebug_gui</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/dbgm_find.png" height="" alt="Search in wddebug_gui"></div></div></div><br class="figure-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wddebug_gui_kernel_dump"></a>6.2.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Opening Windows kernel crash dump with wddebug_gui</span></h4></div></div></div><p>
      In driver development, it is not uncommon to experience kernel crashes that lead to the Blue Screen of Death (BSOD). In order to assist developers in debugging and solving these crashes, WinDriver allows saving its kernel debug messages in the memory dump that Windows automatically creates when the system crashes. These crash dumps can later be opened in <span class="jprintfilename"><strong>wddebug_gui</strong></span> after the system was restarted.
    </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
        Make sure <span class="b"><strong>Send debug messages to the operating system kernel debugger</strong></span> is checked in the <span class="b"><strong>Options</strong></span> window before reproducing the crash.
    </li><li class="listitem">
        Load up the WinDriver symbols by going to <span class="b"><strong>File-&gt;Symbol File Path...</strong></span> and loading your driver's symbols <span class="jprintfilename"><strong>MyDriver.pdb</strong></span>(the file name for the default driver is <span class="jprintfilename"><strong>lib/windrvr1281.pdb</strong></span>). Do not skip this step, otherwise the kernel dump might not be comprehensible.
    </li><li class="listitem">
        Load the kernel crash dump (.dmp) file by going to <span class="b"><strong>File-&gt;Process Kernel Dump...</strong></span>. <span class="jprintfilename"><strong>wddebug_gui</strong></span> will display the output from the crash dump.
    </li></ol></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wddebug_gui_renamed_driver"></a>6.2.1.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Running wddebug_gui for a Renamed Driver</span></h4></div></div></div><p>
By default, <span class="jprintfilename"><strong>wddebug_gui</strong></span> logs messages from the
default WinDriver kernel module &#8212; <span class="jprintfilename"><strong>windrvr1281.sys/.dll/.o/.ko</strong></span>. However, you can
also use <span class="jprintfilename"><strong>wddebug_gui</strong></span> to log debug messages
from a renamed version of this driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>, in two ways:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">From within <span class="jprintfilename"><strong>wddebug_gui</strong></span>, By going to <span class="jmenuitem"><strong>View-&gt;Debug Options</strong></span> and changing the value of the "Driver name" field to
        your own renamed driver's name.
    </li><li class="listitem">By running <span class="jprintfilename"><strong>wddebug_gui</strong></span> from the command line with the
<strong class="jcmd"><code>driver_name</code></strong> argument:
<strong class="jcmd"><code>wddebug_gui &lt;driver_name&gt;</code></strong>.
    </li></ol></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The driver name should be set to the name of the driver file without the file's
extension; e.g., <span class="jprintfilename"><strong>windrvr1281</strong></span>, not <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> (on Windows)
or <span class="jprintfilename"><strong>windrvr1281.o</strong></span> (on Linux).
</td></tr></table></div><p>
For example, if you have renamed the default <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver on
Windows to <span class="jprintfilename"><strong>my_driver.sys</strong></span>, you can log messages
from your driver by running the Debug Monitor using the following command:
<strong class="jcmd"><code>wddebug_gui my_driver</code></strong>
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wddebug"></a>6.2.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">The wddebug Utility</span></h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wddebug_console"></a>6.2.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Console-Mode wddebug Execution</span></h4></div></div></div><p>
The <span class="jprintfilename"><strong>wddebug</strong></span> version of the Debug Monitor
utility can be executed as a console-mode application on all supported
operating systems: <span xmlns:fo="http://www.w3.org/1999/XSL/Format">Windows, and Linux</span>. To use the console-mode Debug Monitor
version, run
<span class="jprintfilename"><strong>WinDriver/util/wddebug</strong></span> in the manner explained
below.
</p>
<h4><a name="idp46253653508304"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">wddebug console-mode usage</span></div>

<p>
</p><pre class="screen">wddebug [&lt;driver_name&gt;] [&lt;command&gt;] [&lt;level&gt;] [&lt;sections&gt;]</pre><p>
</p>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The <span class="jprintfilename"><strong>wddebug</strong></span> arguments must be provided in the
order in which they appear in the usage statement above.
</td></tr></table></div>
<p>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p><a name="wddebug_arg_driver_name"></a>
    <strong class="jcmd"><code>&lt;driver_name&gt;</code></strong> &#8212; The name of the driver to which to
    apply the command.
    </p><p>
    The driver name should be set to the name of the WinDriver kernel module
    &#8212; <span class="jprintfilename"><strong>windrvr1281</strong></span> (default), or a renamed version of this driver (refer
    to the explanation in <a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2</fo:inline></a>).
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The driver name should be set to the name of the driver file without the
    file's extension; e.g., <span class="jprintfilename"><strong>windrvr1281</strong></span>, <em class="it">not </em><span class="jprintfilename"><strong>windrvr1281.sys</strong></span> (on Windows) or
    <span class="jprintfilename"><strong>windrvr1281.o</strong></span> (on Linux).
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc"><strong class="jcmd"><code>&lt;command&gt;</code></strong> &#8212; The Debug Monitor command to execute:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        Activation commands:

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><a name="wddebug_cmd_on"></a><strong class="jcmd"><code>on</code></strong> &#8212; Turn the Debug Monitor on.
          </li><li class="listitem"><a name="wddebug_cmd_off"></a><strong class="jcmd"><code>off</code></strong> &#8212; Turn the Debug Monitor off.
          </li><li class="listitem"><a name="wddebug_cmd_dbg_on"></a><strong class="jcmd"><code>dbg_on</code></strong> &#8212; Redirect the debug messages from the
            Debug Monitor to a kernel debugger and turn the Debug Monitor on
            (if it was not already turned on).
            
 <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><span class="b"><strong>On Windows 7 and higher</strong></span>, the first time that you enable this option you
 will need to restart the PC.
 </td></tr></table></div></li><li class="listitem"><a name="wddebug_cmd_dbg_off"></a><strong class="jcmd"><code>dbg_off</code></strong>  &#8212; Stop redirecting debug messages from
            the Debug Monitor to a kernel debugger.
            </li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        The <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">on</fo:inline></a></code></strong> and
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> commands can be used
        together with the <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_level"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;level&gt;</fo:inline></a></code></strong> and
        <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_sections"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;sections&gt;</fo:inline></a></code></strong> arguments.
        </td></tr></table></div></li><li class="listitem"><a name="wddebug_cmd_dump"></a><strong class="jcmd"><code>dump</code></strong> &#8212; Continuously send ("dump") debug information
        to the command prompt, until the user selects to stop (by following the
        instructions displayed in the command prompt).
        </li><li class="listitem"><a name="wddebug_cmd_status"></a><strong class="jcmd"><code>status</code></strong> &#8212; Display information regarding the running
        driver (<strong class="jcmd"><code>&lt;driver_name&gt;</code></strong>), the current Debug Monitor
        status &#8212; including the active debug level and sections (when the
        Debug Monitor is on) &#8212; and the size of the debug-messages buffer.
      </li><li class="listitem"><a name="wddebug_cmd_clock_on"></a><strong class="jcmd"><code>clock_on</code></strong> &#8212; Add a timestamp to each debug message.
        The timestamps are relative to the driver-load time, or to the time of
        the last <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_clock_reset"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">clock_reset</fo:inline></a></code></strong> command.
      </li><li class="listitem"><a name="wddebug_cmd_clock_off"></a><strong class="jcmd"><code>clock_off</code></strong> &#8212; Do not add timestamps to the debug
        messages.
      </li><li class="listitem"><a name="wddebug_cmd_clock_reset"></a><strong class="jcmd"><code>clock_reset</code></strong> &#8212; Reset the debug-messages timestamps
        clock.
      </li><li class="listitem"><a name="wddebug_cmd_sect_info_on"></a><strong class="jcmd"><code>sect_info_on</code></strong> &#8212; Add section(s) information to each
        debug message.
      </li><li class="listitem"><a name="wddebug_cmd_sect_info_off"></a><strong class="jcmd"><code>sect_info_off</code></strong> &#8212; Do not add section(s) information to
        the debug messages.
      </li><li class="listitem"><a name="wddebug_cmd_help"></a><strong class="jcmd"><code>help</code></strong> &#8212; Display usage instructions.
      </li><li class="listitem">
        No arguments (including no commands) &#8212; This is equivalent to running
        '<strong class="jcmd"><code>wddebug <a class="xref" href="#wddebug_cmd_help"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">help</fo:inline></a></code></strong>'.
      </li></ul></div></li></ul></div><p>

</p><p>
The following arguments are applicable only with the
<strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">on</fo:inline></a></code></strong> or
<strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> commands:
</p><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><a name="wddebug_arg_level"></a><strong class="jcmd"><code>&lt;level&gt;</code></strong> &#8212; The debug trace level to set &#8212;
    one of the following flags: <strong class="japib"><code>ERROR</code></strong>, <strong class="japib"><code>WARN</code></strong>,
    <strong class="japib"><code>INFO</code></strong>, or <strong class="japib"><code>TRACE</code></strong> (default).<br><code class="japi">ERROR</code> is the lowest trace level and <code class="japi">TRACE</code> is the
    highest level (displays all messages).<br><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    When the <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_sections"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;sections&gt;</fo:inline></a></code></strong> argument is
    set, the <strong class="jcmd"><code>&lt;level&gt;</code></strong> argument must be set as well (no
    default).
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc"><p><a name="wddebug_arg_sections"></a>
    <strong class="jcmd"><code>&lt;sections&gt;</code></strong> &#8212; The debug sections &#8212; i.e., the
    WinDriver API sections &#8212; to monitor.<br>
    This argument can be set either to <strong class="jcmd"><code>ALL</code></strong> (default) &#8212; to
    monitor all the supported debug sections &#8212; or to a quoted string that
    contains a combination of any of the supported debug-section flags (run
    '<strong class="jcmd"><code>wddebug <a class="xref" href="#wddebug_cmd_help"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">help</fo:inline></a></code></strong>' to see the full list).
    </p></li></ul></div><p>
</p>
<h4><a name="idp46253653557392"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">Usage Sequence</span></div>

<p>
To log messages using <span class="jprintfilename"><strong>wddebug</strong></span>, use the
following sequence:
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
    Turn on the Debug Monitor by running
    <span class="jprintfilename"><strong>wddebug</strong></span> with either the
    <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">on</fo:inline></a></code></strong> or
    <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> command; the latter redirects
    the debug messages to the OS kernel debugger before turning on the
    Debug Monitor.
    </p><p>
    You can use the <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_level"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;level&gt;</fo:inline></a></code></strong> and
    <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_sections"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;sections&gt;</fo:inline></a></code></strong> arguments to set the debug
    level and sections for the log. If these arguments are not explicitly set,
    the default values will be used; (note that if you set the sections you
    must also set the level).
    </p><p>
    You can also log messages from a renamed WinDriver driver by preceding the
    command with the name of the driver (default: <span class="jprintfilename"><strong>windrvr1281</strong></span>) &#8212; see
    the <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_driver_name"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;driver_name&gt;</fo:inline></a></code></strong> argument.
    </p></li><li class="listitem" style="list-style-type: disc">
    If you did not select to redirect the debug messages to the OS kernel
    debugger (using the <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> command),
    run <span class="jprintfilename"><strong>wddebug</strong></span> with the
    <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dump"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dump</fo:inline></a></code></strong> command to begin dumping debug
    messages to the command prompt.<br>
    You can turn off the display of the debug messages, at any time, by
    following the instructions displayed in the command prompt.
  </li><li class="listitem" style="list-style-type: disc">
    Run applications that use the driver, and view the debug messages as they
    are being logged to the command prompt/the kernel debugger.
  </li><li class="listitem" style="list-style-type: disc">
    At any time while the Debug Monitor is running, you can run
    <span class="jprintfilename"><strong>wddebug</strong></span> with the following commands:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_status"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">status</fo:inline></a></code></strong>,
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_clock_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">clock_on</fo:inline></a></code></strong>,
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_clock_off"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">clock_off</fo:inline></a></code></strong>,
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_clock_reset"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">clock_reset</fo:inline></a></code></strong>,
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_sect_info_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">sect_info_on</fo:inline></a></code></strong>, or
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_sect_info_off"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">sect_info_off</fo:inline></a></code></strong>,
      </li><li class="listitem"><strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">on</fo:inline></a></code></strong> or
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> with different
        <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_level"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;level&gt;</fo:inline></a></code></strong> and/or
        <strong class="jcmd"><code><a class="xref" href="#wddebug_arg_sections"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;sections&gt;</fo:inline></a></code></strong> arguments
      </li><li class="listitem"><strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_on"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_on</fo:inline></a></code></strong> and
        <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dbg_off"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dbg_off</fo:inline></a></code></strong> &#8212; to toggle the
        redirection of debug messages to the OS kernel debugger
      </li><li class="listitem"><strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_dump"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dump</fo:inline></a></code></strong> &#8212; to start a new dump
        of the debug log to the command prompt; (the dump can be stopped at any
        time by following the instructions in the prompt)
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    When you are ready, turn off the Debug Monitor by running
    <span class="jprintfilename"><strong>wddebug</strong></span> with the
    <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_off"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">off</fo:inline></a></code></strong> command.

    <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The <strong class="jcmd"><code><a class="xref" href="#wddebug_cmd_status"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">status</fo:inline></a></code></strong> command can be used to view
    information regarding the running WinDriver driver even when the Debug Monitor
    is off.
    </td></tr></table></div>
    </li></ul></div>
<h5><a name="idp46253653583504"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>

<p>
The following is an example of a typical
<span class="jprintfilename"><strong>wddebug</strong></span> usage sequence. Since no
<strong class="jcmd"><code>&lt;driver_name&gt;</code></strong> is set, the commands are applied to the
default driver &#8212; <span class="jprintfilename"><strong>windrvr1281</strong></span>.

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
    Turn the Debug Monitor on with the highest trace level for all
    sections:<br>
    <strong class="jcmd"><code>wddebug on TRACE ALL</code></strong>
    </p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    This is the same as running '<strong class="jcmd"><code>wddebug on TRACE</code></strong>', because
    <strong class="jcmd"><code>ALL</code></strong> is the default <a class="xref" href="#wddebug_arg_sections"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">&lt;sections&gt;</fo:inline></a> value.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Dump the debug messages continuously to the command prompt or a file, until
    the user selects to stop:<br><strong class="jcmd"><code>wddebug dump</code></strong><br><strong class="jcmd"><code>wddebug dump &lt;filename&gt;</code></strong></li><li class="listitem" style="list-style-type: disc">
    Use the driver and view the debug messages in the command prompt.
  </li><li class="listitem" style="list-style-type: disc">
    Turn the Debug Monitor off:<br><strong class="jcmd"><code>wddebug off</code></strong></li></ul></div><p>
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wddebug_win10iot"></a>6.2.2.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Debugging in Windows 10 IoT Core</span></h4></div></div></div>
In order to debug your WinDriver application and driver under Windows 10 IoT
Core:

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Copy <span class="jprintfilename"><strong>WinDriver\samples\wddebug\wddebug.exe</strong></span> to
your Windows 10 IoT Core device.
  </li><li class="listitem">
Run <strong class="jcmd"><code>wddebug dump</code></strong> from your target device (Preferrably using your
SSH terminal).
  </li><li class="listitem">
 Run your application.
  </li><li class="listitem">
Stop <strong class="jcmd"><code>wddebug</code></strong> utility using <strong class="jcmd"><code>CTRL+C</code></strong>.
  </li></ol></div></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="enhanced_support"></a>Chapter 7. Enhanced Support for Specific Chipsets</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Enhanced_Support_Overview"></a>7.1. Overview</h2></div></div></div><p>
In addition to the standard WinDriver APIs and the DriverWizard code generation
capabilities described in this manual, which support development of drivers for
any <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI&#65279;/&#65279;ISA</span> device, WinDriver features enhanced support for specific
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> chipsets. This enhanced support includes custom APIs<span xmlns:fo="http://www.w3.org/1999/XSL/Format">,
 customized code generation (for some of the chipsets),</span>
and sample diagnostics code, which are all designed specifically for these
chipsets.
</p><p>
WinDriver's enhanced support is currently available for<span xmlns:fo="http://www.w3.org/1999/XSL/Format"> the following <span>PCI</span> chipsets:</span>
PLX 6466, 9030, 9050, 9052, 9054, 9056, 9080 and
  9656; Altera Qsys design; Xilinx BMD design; Xilinx XDMA design.
<span xmlns:fo="http://www.w3.org/1999/XSL/Format"><br>
  Customized code generation is available for the
  Altera Qsys design, Xilinx BMD design and Xilinx XDMA design chipsets.
</span>
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dev_drv_enhanced_sup"></a>7.2. Developing a Driver Using the Enhanced Chipset Support</h2></div></div></div><p>
When developing a driver for a device based on one of the enhanced-support
chipsets<a class="xref" href="#Enhanced_Support_Overview" title="7.1. Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7.1]</fo:inline></a>, you can use WinDriver's chipset-set
specific support in the following manner:
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
If your device is based on the Altera Qsys design, Xilinx BMD design or Xilinx XDMA design, you can
generate customized code for the device by selecting this option in the
DriverWizard code generation options dialogue (see
<a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline>Section 4.2</fo:inline></a>, <a class="xref" href="#step_dw_code_gen"><fo:inline>Step 6.</fo:inline></a><a class="xref" href="#step_dw_code_gen_select_code_gen_opt"><fo:inline>b</fo:inline></a>).
Alternatively, or if you are using another enhanced-support device, follow the
steps below to use one the enhanced-support WinDriver samples as the starting
point for your development:
</span>
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Locate the sample diagnostics program for your device under the
    <span class="jdirectory"><strong>WinDriver/chip_vendor/chip_name</strong></span> directory.
    <p>
    Most of the sample diagnostics programs are named
    <span class="jprintfilename"><strong>xxx_diag</strong></span> and their source code is normally
    found under an <span class="jdirectory"><strong>xxx_diag</strong></span> subdirectory. The
    program's executable is found under a subdirectory for your target
    operating system (e.g., <span class="jdirectory"><strong>WIN32</strong></span> for Windows.)
    </p></li><li class="listitem">
    Run the custom diagnostics program to diagnose your device and familiarize
    yourself with the options provided by the sample program.
    </li><li class="listitem">
    Use the source code of the diagnostics program as your skeletal device
    driver and modify the code, as needed, to suit your specific development
    needs. When modifying the code, you can utilize the custom WinDriver API for
    your specific chip. The custom API is typically found under the
    <span class="jdirectory"><strong>WinDriver/chip_vendor/lib</strong></span> directory.
    </li><li class="listitem">
    If the user-mode driver application that you created by following the steps
    above contains parts that require enhanced performance (e.g., an interrupt
    handler), you can move the relevant portions of your code to a Kernel
    PlugIn driver for optimal performance, as explained in
    <a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 11</fo:inline></a>.
    </li></ol></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="PCI_Express"></a>Chapter 8. PCI Express</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="PCI_Express_Overview"></a>8.1. PCI Express Overview</h2></div></div></div><p>
The PCI Express (<span class="b"><strong>PCIe</strong></span>) bus architecture (formerly 3GIO or 3rd
Generation I/&#65279;O) was introduced by Intel, in partnership with other leading
companies, including IBM, Dell, Compaq, HP and Microsoft, with the intention
that it will become the prevailing standard for PC I/&#65279;O in the years to come.
</p><p>
PCI Express allows for larger bandwidth and higher scalability than the
standard PCI 2.2 bus.
</p><p>
The standard PCI 2.2 bus is designed as a single parallel data bus through
which all data is routed at a set rate. The bus shares the bandwidth between
all connected devices, without the ability to prioritize between devices. The
maximum bandwidth for this bus is 132MB/&#65279;s, which has to be shared among
all connected devices.
</p><p>
PCI Express consists of serial, point-to-point wired, individually clocked
'lanes', each lane consisting of two pairs of data lines that can carry data
upstream and downstream simultaneously (full-duplex). The bus slots are
connected to a switch that controls the data flow on the bus. A connection
between a PCI Express device and a PCI Express switch is called a 'link'. Each
link is composed of one or more lanes. A link composed of a single lane is
called an x1 link; a link composed of two lanes is called an x2 link; etc.
PCI Express supports x1, x2, x4, x8, x12, x16, and x32 link widths (lanes).
The PCI Express architecture allows for a maximum bandwidth of approximately
500MB/&#65279;s per lane. Therefore, the maximum potential bandwidth of this bus
is 500MB/&#65279;s for x1, 1,000MB/&#65279;s for x2, 2,000MB/&#65279;s for x4,
4,000MB/&#65279;s for x8, 6,000MB/&#65279;s for x12, and 8,000MB/&#65279;s for x16.
These values provide a significant improvement over the maximum 132MB/&#65279;s
bandwidth of the standard 32-&#65279;bit PCI bus. The increased bandwidth support
makes PCI Express ideal for the growing number of devices that require high
bandwidth, such as hard drive controllers, video streaming devices and
networking cards.
</p><p>
The usage of a switch to control the data flow in the PCI Express bus, as
explained above, provides an improvement over a shared PCI bus, because each
device essentially has direct access to the bus, instead of multiple
components having to share the bus. This allows each device to use its full
bandwidth capabilities without having to compete for the maximum bandwidth
offered by a single shared bus. Adding to this the lanes of traffic that each
device has access to in the PCI Express bus, PCI Express truly allows for
control of much more bandwidth than previous PCI technologies. In addition,
this architecture enables devices to communicate with each other directly
(peer-to-peer communication).
</p><p>
In addition, the PCI Express bus topology allows for centralized
traffic-routing and resource-management, as opposed to the shared bus
topology. This enables PCI Express to support quality of service (QoS): The
PCI Express switch can prioritize packets, so that real-time streaming packets
(i.e., a video stream or an audio stream) can take priority over packets that
are not as time critical.
</p><p>
Another main advantage of the PCI Express is that it is cost-efficient to
manufacture when compared to PCI and AGP slots or other new I/&#65279;O bus
solutions such as PCI-X.
</p><p>
PCI Express was designed to maintain complete hardware and software
compatibility with the existing PCI bus and PCI devices, despite the different
architecture of these two buses.
</p><p>
As part of the backward compatibility with the PCI 2.2 bus, legacy PCI 2.2
devices can be plugged into a PCI Express system via a PCI Express-to-PCI
bridge, which translates PCI Express packets back into standard PCI 2.2 bus
signals. This bridging can occur either on the motherboard or on an external
card.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_PCI_Express"></a>8.2. WinDriver for PCI Express</h2></div></div></div><p>
WinDriver fully supports backward compatibility with the standard PCI features
on PCI Express boards. The wide support provided by WinDriver for the
standard PCI bus &#8212; including a rich set of APIs, code samples and the
graphical DriverWizard for hardware debugging and driver code generation
&#8212; is also applicable to PCI Express devices, which by design are backward
compatible with the legacy PCI bus.
</p><p>
You can also use WinDriver's PCI API to easily communicate with PCI devices
connected to the PC via PCI Express-to-PCI bridges and switches (e.g., the PLX
8111/8114 bridges or the PLX 8532 switch, respectively).
</p><p>
In addition, WinDriver provides you with a set of APIs for easy access to the
PCI Express extended configuration space on target platforms that support such access (e.g., Windows and Linux) &#8212; see
the description of the <code class="jfunc">WDC_PciReadCfgXXX</code><span class="jfunc">()</span> and
<code class="jfunc">WDC_PciWriteCfgXXX</code><span class="jfunc">()</span> functions in
<a class="xref" href="#WDC_PciReadCfgBySlot" title="B.3.32. WDC_PciReadCfgBySlot()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections B.3.32&#8211;</fo:inline></a><a class="xref" href="#WDC_PciWriteCfgXXX" title="B.3.39. WDC_PciWriteCfgXXX()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.3.39</fo:inline></a> of the present manual, or the description of the
lower-level <code class="jfunc">WD_PciConfigDump</code><span class="jfunc">()</span> function in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p><p>
On Linux and Windows 7 and higher, the WinDriver interrupt handling APIs also support Message-Signaled Interrupts (MSI)
and Extended Message-Signaled Interrupts (MSI-&#65279;X), as detailed in
<a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a>
of the manual.
</p><p>
WinDriver also features enhanced support for PCI Express cards that are based on
the Xilinx Bus Master DMA (BMD) design or the Altera Qsys design. The WinDriver
<span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span> and <span class="jdirectory"><strong>WinDriver/&#65279;altera/&#65279;qsys_design</strong></span> directories each contain
library APIs and a sample user-mode diagnostic applications for communicating
with the respective device type, including DMA and MSI handling code. The
Xilinx BMD directory also contains sample Kernel PlugIn driver code<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>. In addition, the DriverWizard can be used to
generate customized code for such cards<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a>.
</p></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="Advanced_Issues"></a>Chapter 9. Advanced Issues</h1></div></div></div><p>
This chapter covers advanced driver development issues and contains guidelines
for using WinDriver to perform tasks that cannot be fully automated by the
DriverWizard.
</p><p>
Note that WinDriver's enhanced support for specific chipsets<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a> includes custom APIs for performing hardware-specific
tasks like DMA and interrupt handling, thus freeing developers of drivers for
these chipsets from the need to implement the code for performing these tasks
themselves.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="advanced_issues_dma"></a>9.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Performing Direct Memory Access (DMA)</span></h2></div></div></div><p>
This section describes how to use WinDriver to implement bus-master Direct Memory Access
(<span class="b"><strong>DMA</strong></span>) for devices capable of acting as bus masters. Such devices have a
DMA controller, which the driver should program directly.
</p><p>
DMA is a capability provided by some computer bus architectures &#8212;
including PCI and PCIe &#8212; which allows data to be sent directly
from an attached device to the memory on the host, freeing the CPU from
involvement with the data transfer and thus improving the host's performance.
</p><p>
A DMA buffer can be allocated in two ways:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Contiguous buffer</strong></span> &#8212; A contiguous block of memory is allocated.
  </li><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Scatter/&#65279;Gather</strong></span> &#8212; The allocated buffer can be fragmented in the
    physical memory and does not need to be allocated contiguously. The
    allocated physical memory blocks are mapped to a contiguous buffer in the
    calling process's virtual address space, thus enabling easy access to the
    allocated physical memory blocks.
  </li></ul></div><p>
</p><p>
The programming of a device's DMA controller is hardware specific. Normally,
you need to program your device with the <em class="it">local address</em> (on your
device), the <em class="it">host address</em> (the physical memory address on your PC) and
the <em class="it">transfer count</em> (the size of the memory block to transfer), and
then set the register that initiates the transfer.
</p><p>
WinDriver provides you with API for implementing both contiguous-buffer DMA and
Scatter/&#65279;Gather DMA (if supported by the hardware) &#8212; see the description of
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span>, and
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span>. (The lower-level <code class="japi">WD_DMAxxx</code> API is
described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>, but we recommend using the convenient
wrapper <code class="japi">WDC_xxx</code> API instead.)
</p><p>
The following sections include code samples that demonstrate how to use WinDriver
to implement Scatter/&#65279;Gather DMA<a class="xref" href="#sg_dma_impl" title="9.1.1. Implementing Scatter/&#65279;Gather DMA"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.1.1]</fo:inline></a> and contiguous-buffer DMA<a class="xref" href="#ctg_dma_impl" title="9.1.2.  Implementing Contiguous-Buffer DMA"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.1.2]</fo:inline></a>, and an explanation on how to preallocate contiguous DMA
buffers on Windows<a class="xref" href="#ctg_dma_prealloc_win" title="9.1.2.1. Preallocating Contiguous DMA Buffers on Windows"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.1.2.1]</fo:inline></a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The sample routines demonstrate using either an interrupt mechanism or a
    polling mechanism to determine DMA completion.
  </li><li class="listitem" style="list-style-type: disc">
    The sample routines allocate a DMA buffer and enable DMA interrupts (if
    polling is not used) and then free the buffer and disable the interrupts
    (if enabled) for each DMA transfer. However, when you implement your actual
    DMA code, you can allocate DMA buffer(s) once, at the beginning of your
    application, enable the DMA interrupts (if polling is not used), then
    perform DMA transfers repeatedly, using the same buffer(s), and disable the
    interrupts (if enabled) and free the buffer(s) only when your application
    no longer needs to perform DMA.
  </li></ul></div></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="sg_dma_impl"></a>9.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Implementing Scatter/&#65279;Gather DMA</span></h3></div></div></div><p>
Following is a sample routine that uses WinDriver's WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>
to allocate a Scatter/&#65279;Gather DMA buffer and perform bus-master DMA transfers.<br><br>
</p><h4><a name="idp46253653678992"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">C Example:</span></div><p>
A more detailed example, which is specific to the enhanced support for PLX
chipsets<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a> can be found in the
<span class="jdirectory"><strong>WinDriver/plx/lib/plx_lib.c</strong></span> library file and
<span class="jdirectory"><strong>WinDriver/plx/diag_lib/plx_diag_lib.c</strong></span> diagnostics library
file (which utilizes the <span class="jprintfilename"><strong>plx_lib.c</strong></span> DMA API).
</p><pre class="screen">BOOL DMARoutine(WDC_DEVICE_HANDLE hDev, DWORD dwDMABufSize,
    UINT32 u32LocalAddr, BOOL fPolling, BOOL fToDev)
{
    PVOID pBuf;
    WD_DMA *pDma = NULL;
    BOOL fRet = FALSE;

    /* Allocate a user-mode buffer for Scatter/Gather DMA */
    pBuf = malloc(dwDMABufSize);
    if (!pBuf)
        return FALSE;

    /* Lock the DMA buffer and program the DMA controller */
    if (!DMAOpen(hDev, pBuf, u32LocalAddr, dwDMABufSize, fToDev, &amp;pDma))
        goto Exit;

    /* Enable DMA interrupts (if not polling) */
    if (!fPolling)
    {
        if (!MyDMAInterruptEnable(hDev, MyDmaIntHandler, pDma))
            goto Exit; /* Failed enabling DMA interrupts */
    }

    /* Flush the CPU caches (see documentation of WDC_DMASyncCpu()) */
    WDC_DMASyncCpu(pDma);
	

    /* Start DMA - write to the device to initiate the DMA transfer */
    MyDMAStart(hDev, pDma);

    /* Wait for the DMA transfer to complete */
    MyDMAWaitForCompletion(hDev, pDma, fPolling);
    /* Flush the I/O caches (see documentation of WDC_DMASyncIo()) */
    WDC_DMASyncIo(pDma);

    fRet = TRUE;
Exit:
    DMAClose(hDev, pDma, fPolling);
    free(pBuf);
    return fRet;
}

/* DMAOpen: Locks a Scatter/&#65279;Gather DMA buffer */
BOOL DMAOpen(WDC_DEVICE_HANDLE hDev, PVOID pBuf, UINT32 u32LocalAddr,
    DWORD dwDMABufSize, BOOL fToDev, WD_DMA **ppDma)
{
    DWORD dwStatus, i;
    DWORD dwOptions = fToDev ? DMA_TO_DEVICE : DMA_FROM_DEVICE;

    /* Lock a Scatter/&#65279;Gather DMA buffer */
    dwStatus = WDC_DMASGBufLock(hDev, pBuf, dwOptions, dwDMABufSize, ppDma);
    if (WD_STATUS_SUCCESS != dwStatus)
    {
        printf("Failed locking a Scatter/&#65279;Gather DMA buffer. Error 0x%lx - %s\n",
            dwStatus, Stat2Str(dwStatus));
        return FALSE;
    }

    /* Program the device's DMA registers for each physical page */
    MyDMAProgram((*ppDma)-&gt;Page, (*ppDma)-&gt;dwPages, fToDev, u32LocalAddr);

    return TRUE;
}

/* DMAClose: Unlocks a previously locked Scatter/&#65279;Gather DMA buffer */
void DMAClose(WDC_DEVICE_HANDLE hDev, WD_DMA *pDma, BOOL fPolling)
{
    /* Disable DMA interrupts (if not polling) */
    if (!fPolling)
        MyDMAInterruptDisable(hDev);

    /* Unlock and free the DMA buffer */
    WDC_DMABufUnlock(pDma);
}</pre><p>
</p><h4><a name="idp46253653689264"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">C# Example:</span></div><p>
A more detailed example, which is specific to the enhanced support for PLX
chipsets<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a> can be found in the
<span class="jdirectory"><strong>WinDriver/plx/dotnet/lib/</strong></span> library and
<span class="jdirectory"><strong>WinDriver/plx/dotnet/diag/</strong></span> diagnostics library.
</p><pre class="screen">bool DMARoutine(PCI_Device dev, DWORD dwDMABufSize, UINT32 u32LocalAddr,
    bool fPolling, bool fToDev, IntHandler MyDmaIntHandler)
{
    bool fRet = false;
    IntPtr pBuf = IntPtr.Zero;
    Log log = new Log(new Log.TRACE_LOG(TraceLog),
        new Log.ERR_LOG(ErrLog));
    WD_DMA wdDma = new WD_DMA();
    DmaBuffer dmaBuf = new DmaBufferSG(dev, log);

    /* Allocate user mode buffer for Scatter/Gather DMA */
    pBuf = Marshal.AllocHGlobal((int)dwDMABufSize);
    if (pBuf == IntPtr.Zero)
    {
        fRet = false;
        goto Exit;
    }
            
    /* Lock the DMA buffer and program the DMA controller */
    if (!DMAOpen(ref dmaBuf, pBuf, u32LocalAddr, dwDMABufSize,
        fToDev, ref wdDma))
    {
        fRet = false;
        goto Exit;
    }

    /* Enable DMA interrupts (if not polling) */
    if (!fPolling)
    {
        if (!MyDMAInterruptEnable(dev, MyDmaIntHandler, ref wdDma))
        {
            fRet = false;
            goto Exit;  /* Failed enabling DMA interrupts */
        }
    }

    /* Flush the CPU caches (see documentation of WDC_DMASyncCpu()) */
    wdc_lib_decl.WDC_DMASyncCpu(dmaBuf.pWdDma);

    /* Start DMA - write to the device to initiate the DMA transfer */
    MyDmaStart(dev, ref wdDma);

    /* Wait for the DMA transfer to complete */
    MyDMAWaitForCompletion(dev, ref wdDma, fPolling);

    /* Flush the I/O caches (see documentation of WDC_DMASyncIo()) */
    wdc_lib_decl.WDC_DMASyncIo(dmaBuf.pWdDma);

    fRet = true;

Exit:
    DMAClose(dev, dmaBuf, fPolling);
    if (pBuf != IntPtr.Zero)
        Marshal.FreeHGlobal(pBuf);
    return fRet;
}

/* OpenDMA: Locks a Scatter/Gather DMA buffer */
public bool DMAOpen(ref DmaBuffer dmaBuf, IntPtr pBuf, UINT32 u32LocalAddr,
    DWORD bufSize, bool fToDev, ref WD_DMA wdDma)
{
    IntPtr pDma = dmaBuf.pWdDma;
    WDC_DEVICE_HANDLE hDev = dmaBuf.DeviceHandle;
    DWORD dwOptions = fToDev ? (DWORD)WD_DMA_OPTIONS.DMA_TO_DEVICE : 
        (DWORD)WD_DMA_OPTIONS.DMA_FROM_DEVICE;

    wdDma = MarshalDMA(pDma);

    /* Lock a Scatter/Gather DMA buffer */
    if (wdc_lib_decl.WDC_DMASGBufLock(hDev, pBuf, dwOptions,
        bufSize, ref pDma) != (DWORD)wdc_err.WD_STATUS_SUCCESS)
        return false;

    /* Program the device's DMA registers for each physical page */
    MyDMAProgram(fToDev, wdDma.Page[0], wdDma.dwPages, u32LocalAddr);
    return true;
}

/* DMAClose: Unlocks a previously locked Scatter/Gather DMA buffer */
public void DMAClose(PCI_Device dev, DmaBuffer dmaBuf, bool fPolling)
{
    /* Disable DMA interrupts (if not polling) */
    if (!fPolling)
        MyDMAInterruptDisable(dev);

    /* Unlock and free the DMA buffer */
    wdc_lib_decl.WDC_DMABufUnlock(dmaBuf.pWdDma);
}
</pre><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    Notice the difference between <code class="japi">ref WD_DMA wdDma</code> and <code class="japi">IntPtr pWdDma</code>.
    The former is used by C# user functions, while the latter is used by WDC API C functions, that
    can only take a pointer, not a reference.
</td></tr></table></div><h4><a name="idp46253653698736"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">What Should You Implement?</span></div><p>
In the code sample above, it is up to you to implement the following
<code class="jfunc">MyDMAxxx</code><span class="jfunc">()</span> routines, according to your device's specification:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <code class="jfunc">MyDMAProgram</code><span class="jfunc">()</span>: Program the device's DMA registers.<br>
      Refer the device's data sheet for the details.
    </li><li class="listitem" style="list-style-type: disc">
    <code class="jfunc">MyDMAStart</code><span class="jfunc">()</span>: Write to the device to initiate DMA transfers.
    </li><li class="listitem" style="list-style-type: disc">
    <code class="jfunc">MyDMAInterruptEnable</code><span class="jfunc">()</span> and
    <code class="jfunc">MyDMAInterruptDisable</code><span class="jfunc">()</span>: Use <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> and
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> (respectively) to enable&#65279;/&#65279;disable the
    software interrupts and write/read the relevant register(s) on the device
    in order to physically enable&#65279;/&#65279;disable the hardware DMA interrupts (see
    <a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a> for details regarding interrupt
    handling with WinDriver.)
    </li><li class="listitem" style="list-style-type: disc">
    <code class="jfunc">MyDMAWaitForCompletion</code><span class="jfunc">()</span>: Poll the device for completion or
    wait for "DMA DONE" interrupt.
    </li><li class="listitem" style="list-style-type: disc">
    <code class="japi">MyDmaIntHandler</code>: The device's interrupt handler. <code class="japi">IntHandler</code>
    is a pointer to a function prototype of your choice.
    </li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
When using the basic <code class="japi">WD_xxx</code> API (described in the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) to allocate a Scatter/&#65279;Gather DMA buffer that is larger than 1MB, you
need to set the <code class="japi">DMA_LARGE_BUFFER</code> flag in the call to
<code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> and allocate memory for the additional memory pages,
as explained in the following FAQ: <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/windriver/windriver_faqs/#dma1" target="_top">https://www.jungo.com/st/support/windriver/windriver_faqs/#dma1</a></span>.
However, when using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> to allocate the DMA buffer,
you do not need any special implementation for allocating large buffers, since
the function handles this for you.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ctg_dma_impl"></a>9.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""> Implementing Contiguous-Buffer DMA</span></h3></div></div></div><p>
Following is a sample routine that uses WinDriver's WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>
to allocate a contiguous DMA buffer and perform bus-master DMA transfers.<br>
For more detailed, hardware-specific, contiguous DMA examples, refer to the
following enhanced-support chipset<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a> sample library
files:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    PLX &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/plx/lib/plx_lib.c</strong></span></span>
    and
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/plx/diag_lib/plx_diag_lib.c</strong></span></span>
    (which utilizes the <span class="jprintfilename"><strong>plx_lib.c</strong></span> DMA API)
  </li><li class="listitem" style="list-style-type: disc">
    Xilinx Bus Master DMA (BMD) design &#8212;
    <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design/</strong></span>&#65279;<span class="jprintfilename"><strong>bmd_lib.c</strong></span></li></ul></div><p>
</p><h4><a name="idp46253653727744"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">C Example:</span></div><p>
</p><pre class="screen">BOOL DMARoutine(WDC_DEVICE_HANDLE hDev, DWORD dwDMABufSize,
    UINT32 u32LocalAddr, BOOL fPolling, BOOL fToDev)
{
    PVOID pBuf = NULL;
    WD_DMA *pDma = NULL;
    BOOL fRet = FALSE;

    /* Allocate a DMA buffer and open DMA for the selected channel */
    if (!DMAOpen(hDev, &amp;pBuf, u32LocalAddr, dwDMABufSize, fToDev, &amp;pDma))
        goto Exit;
    
    /* Enable DMA interrupts (if not polling) */
    if (!fPolling)
    {
        if (!MyDMAInterruptEnable(hDev, MyDmaIntHandler, pDma))
            goto Exit; /* Failed enabling DMA interrupts */
    }

    /* Flush the CPU caches (see documentation of WDC_DMASyncCpu()) */
    WDC_DMASyncCpu(pDma);

    /* Start DMA - write to the device to initiate the DMA transfer */
    MyDMAStart(hDev, pDma);

    /* Wait for the DMA transfer to complete */
    MyDMAWaitForCompletion(hDev, pDma, fPolling);

    /* Flush the I/O caches (see documentation of WDC_DMASyncIo()) */
    WDC_DMASyncIo(pDma);

    fRet = TRUE;

Exit:
    DMAClose(hDev, pDma, fPolling);
    return fRet;
}

/* DMAOpen: Allocates and locks a contiguous DMA buffer */
BOOL DMAOpen(WDC_DEVICE_HANDLE hDev, PVOID *ppBuf, UINT32 u32LocalAddr,
    DWORD dwDMABufSize, BOOL fToDev, WD_DMA **ppDma)
{
    DWORD dwStatus;
    DWORD dwOptions = fToDev ? DMA_TO_DEVICE : DMA_FROM_DEVICE;

    /* Allocate and lock a contiguous DMA buffer */
    dwStatus = WDC_DMAContigBufLock(hDev, ppBuf, dwOptions, dwDMABufSize, ppDma);
    if (WD_STATUS_SUCCESS != dwStatus)
    {
        printf("Failed locking a contiguous DMA buffer. Error 0x%lx - %s\n",
            dwStatus, Stat2Str(dwStatus));
        return FALSE;
    }

    /* Program the device's DMA registers for the physical DMA page */
    MyDMAProgram((*ppDma)-&gt;Page, (*ppDma)-&gt;dwPages, fToDev, u32LocalAddr);

    return TRUE;
}

/* DMAClose: Frees a previously allocated contiguous DMA buffer */
void DMAClose(WDC_DEVICE_HANDLE hDev, WD_DMA *pDma, BOOL fPolling)
{
    /* Disable DMA interrupts (if not polling) */
    if (!fPolling)
        MyDMAInterruptDisable(hDev);

    /* Unlock and free the DMA buffer */
    WDC_DMABufUnlock(pDma);
}</pre><h4><a name="idp46253653734480"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">C# Example</span></div><pre class="screen">
bool DMARoutine(PCI_Device dev, DWORD dwDMABufSize, UINT32 u32LocalAddr,
    bool fPolling, bool fToDev, IntHandler MyDmaIntHandler)
{
    bool fRet = false;
    IntPtr pBuf = IntPtr.Zero;
    Log log = new Log(new Log.TRACE_LOG(TraceLog),
        new Log.ERR_LOG(ErrLog));
    WD_DMA wdDma = new WD_DMA();
    DmaBuffer dmaBuf = new DmaBufferContig(dev, log);

    /* Lock the DMA buffer and program the DMA controller */
    if (!DMAOpen(ref dmaBuf, pBuf, u32LocalAddr, dwDMABufSize,
        fToDev, ref wdDma))
    {
        fRet = false;
        goto Exit;
    }

    /* Enable DMA interrupts (if not polling) */
    if (!fPolling)
    {
        if (!MyDMAInterruptEnable(dev, MyDmaIntHandler, ref wdDma))
        {
            fRet = false;
            goto Exit;  /* Failed enabling DMA interrupts */
        }
    }

    /* Flush the CPU caches (see documentation of WDC_DMASyncCpu()) */
    wdc_lib_decl.WDC_DMASyncCpu(dmaBuf.pWdDma);

    /* Start DMA - write to the device to initiate the DMA transfer */
    MyDmaStart(dev, ref wdDma);

    /* Wait for the DMA transfer to complete */
    MyDMAWaitForCompletion(dev, ref wdDma, fPolling);

    /* Flush the I/O caches (see documentation of WDC_DMASyncIo()) */
    wdc_lib_decl.WDC_DMASyncIo(dmaBuf.pWdDma);

    fRet = true;

Exit:
    DMAClose(dev, dmaBuf, fPolling);
    return fRet;
}

/* OpenDMA: Locks a Contiguous DMA buffer */
public bool DMAOpen(ref DmaBuffer dmaBuf, IntPtr pBuf, UINT32 u32LocalAddr,
    DWORD bufSize, bool fToDev, ref WD_DMA wdDma)
{
    IntPtr pDma = dmaBuf.pWdDma;
    WDC_DEVICE_HANDLE hDev = dmaBuf.DeviceHandle;
    DWORD dwOptions = fToDev ? (DWORD)WD_DMA_OPTIONS.DMA_TO_DEVICE :
        (DWORD)WD_DMA_OPTIONS.DMA_FROM_DEVICE;

    wdDma = MarshalDMA(pDma);

    /* Lock a Scatter/Gather DMA buffer */
    if (wdc_lib_decl.WDC_DMAContigBufLock(hDev, ref pBuf, dwOptions,
        bufSize, ref pDma) != (DWORD)wdc_err.WD_STATUS_SUCCESS)
        return false;

    /* Program the device's DMA registers for each physical page */
    MyDMAProgram(fToDev, wdDma.Page[0], wdDma.dwPages, u32LocalAddr);
    return true;
}

/* DMAClose: Unlocks a previously locked Scatter/Gather DMA buffer */
public void DMAClose(PCI_Device dev, DmaBuffer dmaBuf, bool fPolling)
{
    /* Disable DMA interrupts (if not polling) */
    if (!fPolling)
        MyDMAInterruptDisable(dev);

    /* Unlock and free the DMA buffer */
    wdc_lib_decl.WDC_DMABufUnlock(dmaBuf.pWdDma);
}
</pre><h4><a name="idp46253653738960"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">What Should You Implement?</span></div>

In the code sample above, it is up to you to implement the following
<code class="jfunc">MyDMAxxx</code><span class="jfunc">()</span> routines, according to your device's specification:

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><code class="jfunc">MyDMAProgram</code><span class="jfunc">()</span>: Program the device's DMA registers.<br>
    Refer the device's data sheet for the details.</li><li class="listitem" style="list-style-type: disc"><code class="jfunc">MyDMAStart</code><span class="jfunc">()</span>: Write to the device to initiate DMA transfers.
  </li><li class="listitem" style="list-style-type: disc"><code class="jfunc">MyDMAInterruptEnable</code><span class="jfunc">()</span> and
    <code class="jfunc">MyDMAInterruptDisable</code><span class="jfunc">()</span>: Use <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> and
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> (respectively) to enable&#65279;/&#65279;disable the
    software interrupts and write/read the relevant register(s) on the device
    in order to physically enable&#65279;/&#65279;disable the hardware DMA interrupts (see
    <a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a> for details regarding interrupt
    handling with WinDriver.)
  </li><li class="listitem" style="list-style-type: disc"><code class="jfunc">MyDMAWaitForCompletion</code><span class="jfunc">()</span>: Poll the device for completion or
    wait for "DMA DONE" interrupt.
  </li><li class="listitem" style="list-style-type: disc">
    <code class="japi">MyDmaIntHandler</code>: The device's interrupt handler. <code class="japi">IntHandler</code>
    is a pointer to a function prototype of your choice.
    </li></ul></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="ctg_dma_prealloc_win"></a>9.1.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Preallocating Contiguous DMA Buffers on Windows</span></h4></div></div></div><p>
WinDriver doesn't limit the size of the DMA buffer that can be allocated using
its DMA APIs. However, the success of the DMA allocation is dependent on the
amount of available system resources at the time of the allocation. Therefore,
the earlier you try to allocate the buffer, the better your chances of
succeeding.<br>
WinDriver for Windows allows you to configure your device INF file to preallocate
contiguous DMA buffers at boot time, thus increasing the odds that the
allocation(s) will succeed.

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
You may preallocate a maximum of 512 buffers: &#8212; 256
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">host-to-device</span> buffers and/or 256
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">device-to-host</span> buffers. 
</td></tr></table></div><p>
</p><p>
 There are 2 ways to preallocate contiguous DMA buffers on Windows:
 Directly from the DriverWizard, or manually via editing the INF file.
</p><h4><a name="idp46253653757744"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead"> Directly from DriverWizard: </span></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a name="wiz_ctg_dma_prealloc_win_step_inf_cfg"></a>
   In DriverWizard, start a new project, select a device from the list and
   click <strong class="japib"><code>Generate .INF file</code></strong> as shown in the DriverWizard
   Walkthrough <a class="xref" href="#step_dw_wiz_run_n_dev_select"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>.
  </li><li class="listitem">
   Check <strong class="japib"><code>Preallocate Host-To-Device DMA Buffers</code></strong> and/or
   <strong class="japib"><code>Preallocate Device-To-Host DMA Buffers</code></strong> to enable the text
   boxes under each checkbox.
  </li><li class="listitem">
   Adjust the <strong class="japib"><code>Size, Count </code></strong> and <strong class="japib"><code>Flags</code></strong> parameters
   as desired.
   <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The <strong class="japib"><code>Size</code></strong> and <strong class="japib"><code>Flags</code></strong> fields must be hexadecimal
    numbers, formatted with the "0x" prefix, as shown below.
   </td></tr></table></div><div class="figure"><a name="wiz_pci_inf_info_2"></a><p class="title"><b>Figure 9.1. DriverWizard INF File Information</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/wiz_pci_inf_info_2.png" alt="DriverWizard INF File Information"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The supported WinDriver DMA flags are documented in the description of
    <a class="xref" href="#WD_DMA_dwOptions"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dwOptions</fo:inline></a> field of the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_DMA</code></span><span> struct</span><a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a></span>.
    
     To locate the relevant flag values to set in the INF file, look for the
     flag definitions in the
     <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver\include\</strong></span><span class="jprintfilename"><strong>windrvr.h</strong></span></span>
     file; (look for the enum that contains the
     <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag).
    </td></tr></table></div></li><li class="listitem">
   Click <strong class="japib"><code>Next</code></strong>, you will then be prompted to choose a filename
   for your .INF file. After choosing a filename, the INF file will be
   created and ready to use, with your desired parameters.
  </li></ol></div><h4><a name="idp46253653775232"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead"> Manually by editing an existing INF file: </span></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a name="ctg_dma_prealloc_win_step_inf_cfg"></a>
    Add the required configuration under the
    <strong class="japib"><code>[UpdateRegistryDevice]</code></strong> registry key in your device INF file,
    as shown below.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        The examples are for configuring preallocation of eight DMA buffers
        but you may, of-course, select to preallocate just one buffer (or none
        at all).
      </li></ul></div></td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><a name="ctg_dma_prealloc_win_step_inf_cfg_unidir"></a>
        To preallocate unidirectional buffers, add these lines:


<pre class="synopsis">
; Host-to-device DMA buffer:
HKR,, "DmaToDeviceCount",0x00010001,0x04       ; Number of preallocated
                                               ; DMA_TO_DEVICE buffers
HKR,, "DmaToDeviceBytes",0x00010001,0x100000   ; Buffer size, in bytes
HKR,, "DmaToDeviceOptions",0x00010001,0x41     ; DMA flags (0x40=DMA_TO_DEVICE
                                               ; + 0x1=DMA_KERNEL_BUFFER_ALLOC
; Device-to-host DMA buffer:
HKR,, "DmaFromDeviceCount",0x00010001,0x04     ; Number of preallocated
                                               ; DMA_FROM_DEVICE buffers
HKR,, "DmaFromDeviceBytes",0x00010001,0x100000 ; Buffer size, in bytes
HKR,, "DmaFromDeviceOptions",0x00010001,0x21   ; DMA flags (0x20=DMA_FROM_DEVICE
                                               ; + 0x1=DMA_KERNEL_BUFFER_ALLOC)
</pre>
        </li></ul></div></li><li class="listitem"><a name="ctg_dma_prealloc_win_step_inf_cfg_edit"></a>
    Edit the buffer sizes and add flags to the options masks in the INF file,
    as needed.<br>
    Note, however, that the direction flags and the
    <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag must be set as shown in
    <a class="xref" href="#ctg_dma_prealloc_win_step_inf_cfg"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 1</fo:inline></a>.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The supported WinDriver DMA flags are documented in the description of
    <a class="xref" href="#WD_DMA_dwOptions"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dwOptions</fo:inline></a> field of the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_DMA</code></span><span> struct</span><a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a></span>.
    
    To locate the relevant flag values to set in the INF file, look for the
    flag definitions in the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver\include\</strong></span><span class="jprintfilename"><strong>windrvr.h</strong></span></span>
    file; (look for the enum that contains the
    <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag).
    </td></tr></table></div></li><li class="listitem"><a name="step_japi_dma_lock"></a>
    In your code, the first <strong class="japib"><code>n</code></strong> calls (if you configured the
    INF file to preallocate <strong class="japib"><code>n</code></strong> DMA buffers) to the
    contiguous-DMA-lock function &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> &#8212; should set
    parameter values that match the buffer configurations in the INF file:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        For a <span class="b"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">device-to-host</span></strong></span> buffer, the DMA-options
        mask parameter (<strong class="japib"><code>dwOptions / pDma-&gt;dwOptions</code></strong>) should
        contain the same DMA flags set in the <strong class="japib"><code>DmaFromDeviceOptions
        </code></strong> registry key value, and the buffer-size parameter
        (<strong class="japib"><code>dwDMABufSize / pDma-&gt;dwBytes</code></strong>) should be set to the value
        of the <strong class="japib"><code>DmaFromDeviceBytes</code></strong> registry key value.
      </li><li class="listitem" style="list-style-type: disc">
        For a <span class="b"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">host-to-device</span></strong></span> buffer, the DMA-options
        mask parameter (<strong class="japib"><code>dwOptions /<br> pDma-&gt;dwOptions</code></strong>) should
        contain the same flags set in the <strong class="japib"><code>DmaToDeviceOptions</code></strong>
        registry key value, and the buffer-size parameter (<strong class="japib"><code>dwDMABufSize /
        <br>pDma-&gt;dwBytes</code></strong>) should be set to the value of the
        <strong class="japib"><code>DmaToDeviceBytes</code></strong> registry key value.
      </li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        When using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> you don't need to
        explicitly set the <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag (which
        must be set in the INF-file configuration) because the function sets
        this flag automatically.
      </li><li class="listitem" style="list-style-type: disc">
        When using the low-level WinDriver <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> function
        (described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), the DMA options are set in the
        function's <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><code class="japi">pDma-&gt;dwOptions</code></span>
        parameter  &#8212; which must also include the
        <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag &#8212; and the buffer size
        is set in the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><code class="japi">pDma-&gt;dwBytes</code></span>
        parameter.
      </li><li class="listitem" style="list-style-type: disc">
        If the buffer preallocation fails due to insufficient resources, you
        may need to increase the size of the non-paged pool (from which the
        memory is allocated), as explained in 
        WinDriver Technical Document 58
    (<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/tech_docs/td58.html" target="_top">https://www.jungo.com/st/support/tech_docs/td58.html</a></span>).
      </li></ul></div></td></tr></table></div></li></ol></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Handling_Interrupts"></a>9.2. Handling Interrupts</h2></div></div></div>
<p>
WinDriver provides you with API, DriverWizard code generation, and samples, to
simplify the task of handling interrupts from your driver.
</p>

<p>
If you are developing a driver for a device based on one of the
enhanced-support WinDriver chipsets<a class="xref" href="#enhanced_support" title="Chapter 7. Enhanced Support for Specific Chipsets"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [7]</fo:inline></a>, we recommend that
you use the custom WinDriver interrupt APIs for your specific chip in order to
handle the interrupts, since these routines are implemented specifically for
the target hardware.
</p>
<p>
For other chips, we recommend that you use DriverWizard to detect/define the
relevant information regarding the device interrupt (such as the interrupt
request (IRQ) number, its type and its shared state), define commands to be
executed in the kernel when an interrupt occurs (if required), and then
generate skeletal diagnostics code, which includes interrupt routines that
demonstrate how to use WinDriver's API to handle your device's interrupts, based
on the information that you defined in the wizard.
</p><p>
The following sections provide a general overview of PCI/ISA
interrupt handling and explain how to handle interrupts using WinDriver's API. Use
this information to understand the sample and generated DriverWizard interrupt
code or to write your own interrupt handler.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="int_handling_overview"></a>9.2.1. Interrupt Handling &#8212; Overview</h3></div></div></div><p>
PCI and ISA hardware uses interrupts to signal the host.<br>
There are two main methods of PCI interrupt handling:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
    <span class="b"><strong>Legacy Interrupts:</strong></span> The traditional interrupt handling, which uses a
    line-based mechanism. In this method, interrupts are signaled by using
    one or more external pins that are wired "out-of-band", i.e., separately
    from the main bus lines.
    </p><p>
    Legacy interrupts are divided into two groups:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
        <span class="b"><strong>Level-sensitive interrupts:</strong></span> These interrupts are
        generated as long as the physical interrupt signal is high. If the
        interrupt signal is not lowered by the end of the interrupt
        handling in the kernel, the operating system will call the kernel
        interrupt handler repeatedly, causing the host platform to hang.
        To prevent such a situation, the interrupt must be acknowledged
        (cleared) by the kernel interrupt handler immediately when it is
        received.
        </p><p>
        Legacy PCI interrupts are level sensitive.
        </p></li><li class="listitem" style="list-style-type: disc"><p>
        <span class="b"><strong>Edge-triggered interrupts:</strong></span> These are interrupts that
        are generated once, when the physical interrupt signal goes from
        low to high. Therefore, exactly one interrupt is generated. No
        special action is required for acknowledging this type of interrupt.
        </p><p>
        ISA/EISA interrupts are edge triggered.
        </p></li></ul></div><p>
    </p></li><li class="listitem" style="list-style-type: disc"><p>
    <span class="b"><strong>MSI/MSI-&#65279;X:</strong></span> Newer PCI bus technologies, available beginning with
    v2.2 of the PCI bus and in PCI Express, support Message-Signaled Interrupts (<span class="b"><strong>MSI</strong></span>).
    This method uses "in-band" messages instead of pins, and can target
    addresses in the host bridge. A PCI function can request up to 32 MSI
    messages.<br> Note: MSI and MSI-&#65279;X are edge triggered and do not require
    acknowledgment in the kernel.
    </p><p>
    Among the advantages of MSIs:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        MSIs can send data along with the interrupt message.
      </li><li class="listitem" style="list-style-type: disc">
        As opposed to legacy PCI interrupts, MSIs are not shared; i.e., an MSI
        that is assigned to a device is guaranteed to be unique within the
        system.
      </li></ul></div><p>
    </p><p>
    Extended Message-Signaled Interrupts (<span class="b"><strong>MSI-&#65279;X</strong></span>) are available beginning with version 3.0 of
    the PCI bus. This method provides an enhanced version of the MSI mechanism,
    which includes the following advantages:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Supports 2,048 messages instead of 32 messages supported by the
        standard MSI.
      </li><li class="listitem" style="list-style-type: disc">
        Supports independent message address and message data for each
        message.
      </li><li class="listitem" style="list-style-type: disc">
        Supports per-message masking.
      </li><li class="listitem" style="list-style-type: disc">
        Enables more flexibility when software allocates fewer vectors than
        hardware requests. The software can reuse the same MSI-&#65279;X address and
        data in multiple MSI-&#65279;X slots.
      </li></ul></div><p>
    </p><p>
    The newer PCI buses, which support MSI/MSI-&#65279;X, maintain software
    compatibility with the legacy line-based interrupts mechanism by emulating
    legacy interrupts through in-band mechanisms. These emulated interrupts are
    treated as legacy interrupts by the host operating system.
    </p></li></ul></div><p>
WinDriver supports legacy line-based interrupts, both edge triggered and level
sensitive, on all supported operating systems: Windows, and Linux.
</p><p>
WinDriver also supports PCI MSI/MSI-&#65279;X interrupts (when supported by the
hardware) on Linux and Windows 7 and higher (earlier versions of Windows do not support MSI/MSI-&#65279;X), as detailed in
<a class="xref" href="#wd_msi_handling" title="9.2.7. WinDriver MSI/MSI-&#65279;X Interrupt Handling"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.7</fo:inline></a>.
</p><p>
WinDriver provides a single set of APIs for handling both legacy and MSI/MSI-&#65279;X
interrupts, as described in this manual.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_int_seq"></a>9.2.2. WinDriver Interrupt Handling Sequence</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This section describes how to use WinDriver to handle interrupts from a user-mode
application. Since interrupt handling is a performance-critical task, it is
very likely that you may want to handle the interrupts directly in the kernel.
WinDriver's Kernel PlugIn<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a> enables you to
implement kernel-mode interrupt routines.<br>
To find out how to handle interrupts from the Kernel PlugIn, please refer to
<a class="xref" href="#KP_int_handling" title="11.6.5. Handling Interrupts in the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.5</fo:inline></a> of the manual.
</td></tr></table></div><p>
The interrupt handling sequence using WinDriver is as follows:
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    The user calls one of WinDriver's interrupt enable functions &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> or <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions,
    described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> &#8212; to enable interrupts on the
    device.<br> These functions receive an optional array of read/write
    transfer commands to be executed in the kernel when an interrupt occurs
    (see <a class="xref" href="#int_seq_step_trans_cmd"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>).
    </p><p>
    NOTE:
    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        When using WinDriver to handle level-sensitive interrupts, you <span class="b"><strong>must</strong></span>
        set up transfer commands for acknowledging the interrupt, as explained
        in <a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.6</fo:inline></a>.
      </li><li class="listitem" style="list-style-type: disc">
        Memory allocated for the transfer commands must remain available
  until the interrupts are disabled
.
      </li></ul></div><p>
    </p><p>
    When <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the lower-level
    <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> function is called, WinDriver spawns a thread
    for handling incoming interrupts.<br>
    When using the low&#65279;-&#65279;level <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> function you need
    to spawn the thread yourself.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    
  WinDriver must be registered with the OS as the driver of the device before
  enabling interrupts. For Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware (PCI&#65279;/&#65279;PCI Express) on
  Windows platforms, this association is made by installing an INF file for the
  device<span xmlns:fo="http://www.w3.org/1999/XSL/Format"><span><a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline> [15.1]</fo:inline></a></span></span>.
  If the INF file is not installed, <code class="jfunc">the interrupt enable function</code><span class="jfunc">()</span>
  will fail with a <code class="japi">WD_NO_DEVICE_OBJECT</code> error<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.

    </td></tr></table></div></li><li class="listitem">
    The interrupt thread runs an infinite loop that waits for an interrupt to
    occur.
  </li><li class="listitem"><a name="int_seq_step_trans_cmd"></a>
    When an interrupt occurs, WinDriver executes, in the kernel, any transfer
    commands that were prepared in advance by the user and passed to
    WinDriver's interrupt-enable functions (see
    <a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.6</fo:inline></a>).<br>
    When the control returns to the user mode, the driver's user-mode interrupt
    handler routine (as passed to WinDriver when enabling the interrupts with
    <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> or <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>) is called.
  </li><li class="listitem">
    When the user-mode interrupt handler returns, the wait loop continues.
  </li><li class="listitem">
    When the user no longer needs to handle interrupts, or before the user-mode
    application exits, the relevant WinDriver interrupt disable function should be
    called &#8212; <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> or <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> functions,
    described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> (depending on the function used to
    enable the interrupts).
  </li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The low&#65279;-&#65279;level <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> WinDriver function (described in
    the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which is used by the high&#65279;-&#65279;level interrupt
    enable functions to wait on interrupts from the device, puts the thread to
    sleep until an interrupt occurs. <span class="b"><strong>There is no CPU consumption while
    waiting for an interrupt.</strong></span> Once an interrupt occurs, it is first handled
    by the WinDriver kernel, then <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> wakes up the interrupt
    handler thread and returns, as explained above.
  </li><li class="listitem" style="list-style-type: disc">
    Since your interrupt handler runs in the user mode, you may call any OS API
    from this function, including file-handling and GDI functions.
  </li></ul></div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_win_isa_irq_reg"></a>9.2.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Registering IRQs for Non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play Hardware on Windows 7 and Higher</span></h3></div></div></div><p>
On Windows 7 and higher, you may need to register an interrupt request (IRQ) with WinDriver
before you can assign it to your non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play device (e.g., your ISA card).<br>
To register an IRQ with WinDriver on Windows, follow these steps:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Open the Device Manager and select
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jmenupath"><strong>View --&gt; Resources by type</strong></span></span>.
    </li><li class="listitem">
    Select a free IRQ from among those listed in the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><em class="guilabel">Interrupt request (IRQ)</em></span> section.
    </li><li class="listitem">
    Register the selected IRQ with WinDriver:
      <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
          Back up the files in the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory.
          </li><li class="listitem">
          Edit <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>:
          <div class="orderedlist"><ol class="orderedlist" type="i"><li class="listitem">
              Add the following line in the <code class="japi">[DriverInstall.NT]</code>
              section:<br>
              <code class="code">LogConfig=config_irq</code>
              </li><li class="listitem">
              Add a <code class="japi">config_irq</code> section (where "<span class="b"><strong>&lt;IRQ&gt;</strong></span>"
              signifies your selected IRQ number &#8212; e.g., 10):
              <br>
              <code class="code">
              [config_irq]<br>
              IRQConfig=&lt;IRQ&gt;
              </code>
              </li></ol></div></li><li class="listitem">
          Reinstall WinDriver by running the following from a command-line prompt
          (where "<span class="b"><strong>&lt;path to windrvr1281.inf&gt;</strong></span>" is the path to
          your modified WinDriver INF file):<br>
          <strong class="jcmd"><code>wdreg -inf &lt;path to windrvr1281.inf&gt; install</code></strong>
          </li><li class="listitem">
          Verify that that the IRQ was successfully registered with WinDriver:
          Open the Device Manager and locate the WinDriver device. The device
          properties should have a <span class="jmenuitem"><strong>Resources</strong></span> tab with
          the registered IRQ.
          </li></ol></div></li></ol></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This procedure registers the IRQ with the virtual WinDriver device. It is
recommended that you rename the <span class="jprintfilename"><strong>windrvr1281</strong></span> driver module, to avoid
possible conflicts with other instances of WinDriver that may be running on the
same machine<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>.<br>
If you rename your driver, replace references to <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> in the IRQ
registration instructions above with the name of your renamed WinDriver INF file.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_get_sup_int_types"></a>9.2.4. Determining the Interrupt Types Supported by the Hardware</h3></div></div></div><p>
When retrieving resources information for a Plug&#65279;-&#65279;and&#65279;-&#65279;Play device using
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciGetDeviceInfo</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a></span> or the low&#65279;-&#65279;level
<code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>),
the function returns information regarding the interrupt types supported by the
hardware. This information is returned within the <strong class="japib"><code>dwOptions</code></strong> field
of the returned interrupt resource
(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><code class="japi">pDeviceInfo-&gt;Card.Item[i].I.Int.dwOptions</code></span>
for the WDC functions
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><code class="japi">pPciCard-&gt;Card.Item[i].I.Int.dwOptions</code></span>
for the low&#65279;-&#65279;level functions). The interrupt options bit-mask can contain a
combination of any of the following interrupt type flags:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong>: Extended Message-Signaled Interrupts (MSI-&#65279;X).<sup xmlns:fo="http://www.w3.org/1999/XSL/Format" style="
        color:
        red;
      ">*</sup></li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE</code></strong>: Message-Signaled Interrupts (MSI).<sup xmlns:fo="http://www.w3.org/1999/XSL/Format" style="
        color:
        red;
      ">*</sup></li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LEVEL_SENSITIVE</code></strong>: Legacy level-sensitive
    interrupts.
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LATCHED</code></strong>: Legacy edge-triggered interrupts.
      The value of this flag is zero and it is applicable only when no other
      interrupt flag is set.
  </li></ul></div><p>
The <strong class="japib"><code>WDC_GET_INT_OPTIONS</code></strong> macro returns a WDC device's interrupt
options bit-mask<a class="xref" href="#WDC_GET_INT_OPTIONS" title="B.4.9. WDC_GET_INT_OPTIONS Macro"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.9]</fo:inline></a>. You can pass the returned
bit-mask to the <strong class="japib"><code>WDC_INT_IS_MSI</code></strong> macro to check whether the
bit-mask contains the MSI or MSI-&#65279;X flags<a class="xref" href="#WDC_INT_IS_MSI" title="B.4.10. WDC_INT_IS_MSI Macro"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.10]</fo:inline></a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The <strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> and <strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong>
    flags are applicable only to PCI devices<a class="xref" href="#wd_msi_handling" title="9.2.7. WinDriver MSI/MSI-&#65279;X Interrupt Handling"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.7]</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc"><sup xmlns:fo="http://www.w3.org/1999/XSL/Format" style="
        color:
        red;
      ">*</sup> The Windows APIs do not
  distinguish between MSI and MSI-&#65279;X; therefore, on this OS the WinDriver
  functions set the <strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> flag for both MSI and
  MSI-&#65279;X.
      </li></ul></div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_get_enabled_int_type"></a>9.2.5. Determining the Interrupt Type Enabled for a PCI Card</h3></div></div></div><p>
When attempting to enable interrupts for a PCI card on Linux or Windows 7 and higher, WinDriver first
tries to use MSI-&#65279;X or MSI, if supported by the card. If this fails, WinDriver
attempts to enable legacy level-sensitive interrupts.<br>
WinDriver's interrupt-enable functions return information regarding the interrupt
type that was enabled for the card. This information is returned within the
<strong class="japib"><code>dwEnabledIntType</code></strong> field of the <code class="japi">WD_INTERRUPT</code>
structure that was passed to the function. When using the high&#65279;-&#65279;level
<code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> function, the information is stored within the
<code class="japi">Int</code> field of the WDC device structure referred to by the
function's <code class="japi">hDev</code> parameter<a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.48]</fo:inline></a>, and can be
retrieved using the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><strong class="japi"><code>WDC_GET_ENABLED_INT_TYPE</code></strong></span><span> low&#65279;-&#65279;level WDC macro</span><a class="xref" href="#WDC_GET_ENABLED_INT_TYPE" title="B.4.8. WDC_GET_ENABLED_INT_TYPE Macro"><fo:inline> [B.4.8]</fo:inline></a></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_int_trans_cmd"></a>9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands</h3></div></div></div><p>
When handling interrupts you may find the need to perform high-priority tasks
at the kernel-mode level immediately when an interrupt occurs. For example,
when handling level-sensitive interrupts, such as legacy PCI interrupts<a class="xref" href="#int_handling_overview" title="9.2.1. Interrupt Handling &#8212; Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.1]</fo:inline></a>, the interrupt line <span class="b"><strong>must</strong></span> be lowered (i.e.,
the interrupt must be acknowledged) in the kernel, otherwise the operating
system will repeatedly call WinDriver's kernel interrupt handler, causing the host
platform to hang. Acknowledgment of the interrupt is hardware-specific and
typically involves writing or reading from specific runtime registers on the
device.
</p><p>
WinDriver's interrupt enable functions receive an optional pointer to an array
of <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_TRANSFER</code></span><span> structures</span><a class="xref" href="#WD_TRANSFER" title="B.7.10. WD_TRANSFER Structure"><fo:inline> [B.7.10]</fo:inline></a></span>, which can be used to set up
read/write transfer command from/to memory or I/&#65279;O addresses on the device.
<br>
The <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> accepts this pointer and the
number of commands in the array as direct parameters (<code class="japi">pTransCmds</code>
and <code class="japi">dwNumCmds</code>).<br>
The low&#65279;-&#65279;level <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> and
<code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions receive this information within the
<code class="japi">Cmd</code> and <code class="japi">dwCmds</code> fields of the
<code class="japi">WD_INTERRUPT</code> structure that is passed to them (see the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p><p>
When you need to execute performance-critical transfers to/from your device
upon receiving an interrupt &#8212; e.g., when handling level-sensitive
interrupts &#8212; you should prepare an array of <code class="japi">WD_TRANSFER</code>
structures that contain the required information regarding the read/write
operations to perform in the kernel upon arrival of an interrupt, and pass this
array to WinDriver's interrupt enable functions. As explained in
<a class="xref" href="#wd_int_seq" title="9.2.2. WinDriver Interrupt Handling Sequence"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.2</fo:inline></a>, <a class="xref" href="#int_seq_step_trans_cmd"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>, WinDriver's kernel-mode interrupt
handler will execute the transfer commands passed to it within the interrupt
enable function for each interrupt that it handles, before returning the
control to the user mode. Note: Memory allocated for the transfer commands must remain available
  until the interrupts are disabled
.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="int_mask_cmd"></a>9.2.6.1. Interrupt Mask Commands</h4></div></div></div><p>
The interrupt transfer commands array that you pass to WinDriver can also
contain an interrupt mask structure, which will be used to verify the source of
the interrupt. This is done by setting the transfer structure's
<code class="japi">cmdTrans</code> field, which defines the type of the transfer command, to
<strong class="japib"><code>CMD_MASK</code></strong>, and setting the relevant mask in the transfer
structure's <code class="japi">Data</code> field<a class="xref" href="#WD_TRANSFER" title="B.7.10. WD_TRANSFER Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.7.10]</fo:inline></a>. Note that interrupt
mask commands must be set directly after a read transfer command in the
transfer commands array.
</p><p>
When WinDriver's kernel interrupt handler encounters a mask interrupt command, it
masks the value that was read from the device in the preceding read transfer
command in the array, with the mask set in the interrupt mask command. If the
mask is successful, WinDriver will claim control of the interrupt, execute the
rest of the transfer commands in the array, and invoke your user-mode interrupt
handler routine when the control returns to the user mode. However, if the mask
fails, WinDriver will reject control of the interrupt, the rest of the interrupt
transfer commands will not be executed, and your user-mode interrupt handler
routine will not be invoked. (Note: acceptance and rejection of the interrupt
is relevant only when handling legacy interrupts; since MSI/MSI-&#65279;X interrupts
are not shared, WinDriver will always accept control of such interrupts.)

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To correctly handle shared PCI interrupts, you must always include a
    mask command in your interrupt transfer commands array, and set up this
    mask to check whether the interrupt handler should claim ownership of the
    interrupt.
  </li><li class="listitem" style="list-style-type: disc"><p>
    Ownership of the interrupt will be determined according to the result of
    this mask. If the mask fails, no other transfer commands from the transfer
    commands array will be executed &#8212; including commands that preceded
    the mask command in the array. If the mask succeeds, WinDriver will proceed to
    perform any commands that precede the first mask command (and its related
    read command) in the transfer commands array, and then any commands that
    follow the mask command in the array.
    </p></li><li class="listitem" style="list-style-type: disc">
    To gain more flexibility and control over the interrupt handling, you can
    use WinDriver's Kernel PlugIn feature, which enables you to write your own
    kernel-mode interrupt handler routines, as explained in
    <a class="xref" href="#KP_int_handling" title="11.6.5. Handling Interrupts in the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.5</fo:inline></a> of the manual.
   </li></ul></div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wd_trans_cmds_sample"></a>9.2.6.2. Sample WinDriver Transfer Commands Code</h4></div></div></div><p>
This section provides sample code for setting up interrupt transfer commands
using the WinDriver Card (WDC) library API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>.
<br>
The sample code is provided for the following scenario: Assume you have a PCI
card that generates level-sensitive interrupts. When an interrupt occurs you
expect the value of your card's interrupt command-status register
(<code class="japi">INTCSR</code>), which is mapped to an I/&#65279;O port address
(<code class="japi">pAddr</code>), to be <code class="japi">intrMask</code>.<br>
In order to clear and acknowledge the interrupt you need to write 0 to the
<code class="japi">INTCSR</code>.
</p><p>
The code below demonstrates how to define an array of transfer commands that
instructs WinDriver's kernel-mode interrupt handler to do the following:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Read your card's <code class="japi">INTCSR</code> register and save its value.
  </li><li class="listitem">
    Mask the read <code class="japi">INTCSR</code> value against the given mask
    (<code class="japi">intrMask</code>) to verify the source of the interrupt.
  </li><li class="listitem">
    If the mask was successful, write 0 to the <code class="japi">INTCSR</code> to
    acknowledge the interrupt.
  </li></ol></div><p>

Note: all commands in the example are performed in modes of DWORD.
</p>
<h5><a name="idp46253653962896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>

<pre class="screen">WD_TRANSFER trans[3]; /* Array of 3 WinDriver transfer command structures */
BZERO(trans);

/* 1st command: Read a DWORD from the INTCSR I/O port */
trans[0].cmdTrans = RP_DWORD;
/* Set address of IO port to read from: */
trans[0].pPort = pAddr; /* Assume pAddr holds the address of the INTCSR */

/* 2nd command: Mask the interrupt to verify its source */
trans[1].cmdTrans = CMD_MASK;
trans[1].Data.Dword = intrMask; /* Assume intrMask holds your interrupt mask */

/* 3rd command: Write DWORD to the INTCSR I/O port.
   This command will only be executed if the value read from INTCSR in the
   1st command matches the interrupt mask set in the 2nd command. */
trans[2].cmdTrans = WP_DWORD;
/* Set the address of IO port to write to: */
trans[2].pPort = pAddr; /* Assume pAddr holds the address of INTCSR */
/* Set the data to write to the INTCSR IO port: */
trans[2].Data.Dword = 0;
</pre>
<p>
After defining the transfer commands, you can proceed to enable the interrupts.
<br>
Note that memory allocated for the transfer commands must remain available
  until the interrupts are disabled
, as explained above.<br>
The following code demonstrates how to use the <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span>
function to enable the interrupts using the transfer commands prepared above:
</p><pre class="screen">/* Enable the interrupts:
   hDev: WDC_DEVICE_HANDLE received from a previous call to WDC_PciDeviceOpen().
   INTERRUPT_CMD_COPY: Used to save the read data - see WDC_IntEnable().
   interrupt_handler: Your user-mode interrupt handler routine.
   pData: The data to pass to the interrupt handler routine. */
WDC_IntEnable(hDev, &amp;trans, 3, INTERRUPT_CMD_COPY, interrupt_handler,
    pData, FALSE);
</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_msi_handling"></a>9.2.7. WinDriver MSI/MSI-&#65279;X Interrupt Handling</h3></div></div></div><p>
As indicated in <a class="xref" href="#int_handling_overview" title="9.2.1. Interrupt Handling &#8212; Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.1</fo:inline></a>, WinDriver supports
PCI Message-Signaled Interrupts (MSI) and Extended Message-Signaled Interrupts (MSI-&#65279;X) on Linux and Windows 7 and higher (earlier versions of Windows do not support MSI/MSI-&#65279;X).
</p><p>
The same APIs are used for handling both legacy and MSI/MSI-&#65279;X interrupts,
including APIs for retrieving the interrupt types supported by your
hardware<a class="xref" href="#wd_get_sup_int_types" title="9.2.4. Determining the Interrupt Types Supported by the Hardware"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.4]</fo:inline></a> and the interrupt type that was
enabled for it<a class="xref" href="#wd_get_enabled_int_type" title="9.2.5. Determining the Interrupt Type Enabled for a PCI Card"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.5]</fo:inline></a>.
</p><p>
When enabling interrupts for a PCI device on an OS that supports MSI/MSIx,
WinDriver first tries to enable MSI-&#65279;X or MSI &#8212; if supported by the device
&#8212; and if this fails, it attempts to enable legacy level-sensitive
interrupts.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
On <span class="b"><strong>Windows</strong></span>, enabling MSI or MSIx interrupts requires that a relevant INF
file first be installed for the device, as explained in
<a class="xref" href="#win_msi_inf_files" title="9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.7.1</fo:inline></a>.
</td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
On <span class="b"><strong>Linux</strong></span>, you can specify the types of PCI interrupts that may be
enabled for your device, via the <span class="b"><strong><a class="xref" href="#WDC_IntEnable_dwOptions_desc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dwOptions</fo:inline></a></strong></span>
parameter of the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or of the
low-level <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> function (described in the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) &#8212; in which case WinDriver will only attempt to enable
interrupts of the specified types (provided they are supported by the device).
</td></tr></table></div><p>
WinDriver's kernel-mode interrupt handler sets the interrupt message data in the
<strong class="japib"><code>dwLastMessage</code></strong> field of the <code class="japi">WD_INTERRUPT</code> structure
that was passed to the interrupt enable/wait function. If you pass the same
interrupt structure as part of the data to your user-mode interrupt handler
routine, as demonstrated in the sample and generated DriverWizard interrupt
code, you will be able to access this information from your interrupt handler.
When using a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>, the last
message data is passed to your kernel-mode <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span> handler;
on Windows 7 and higher, it is also passed to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span>.<br>
You can use the low&#65279;-&#65279;level <strong class="japib"><code>WDC_GET_ENABLED_INT_LAST_MSG</code></strong> macro
to retrieve the last message data for a given WDC device<a class="xref" href="#WDC_GET_ENABLED_INT_LAST_MSG" title="B.4.11. WDC_GET_ENABLED_INT_LAST_MSG Macro"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.11]</fo:inline></a>.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="win_msi_inf_files"></a>9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files</h4></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The information in this section is relevant only when working on Windows.
</td></tr></table></div><p>
To successfully handle PCI interrupts with WinDriver on Windows, you must first
install an INF file that registers your PCI card to work with WinDriver's
kernel driver, as explained in <a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.1</fo:inline></a>.
</p><p>
To use MSI/MSI-&#65279;X on Windows, the card's INF file must contain specific
<code class="japi">[Install.NT.HW]</code> MSI information, as demonstrated below:
</p><pre class="screen">[Install.NT.HW]
AddReg = Install.NT.HW.AddReg

[Install.NT.HW.AddReg]
HKR, "Interrupt Management", 0x00000010
HKR, "Interrupt Management\MessageSignaledInterruptProperties", 0x00000010
HKR, "Interrupt Management\MessageSignaledInterruptProperties", MSISupported, \
    0x10001, 1</pre><p>
Therefore, to use MSI/MSI-&#65279;X on Windows 7 and higher with WinDriver &#8212; provided your
hardware supports MSI/MSI-&#65279;X &#8212; you need to install an appropriate INF
file.
</p><p>
When using DriverWizard on Windows 7 and higher to generate an INF file for a PCI
device that supports MSI/MSI-&#65279;X, the INF generation dialogue allows you to
select to generate an INF file that supports MSI/MSI-&#65279;X (see
<a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>, <a class="xref" href="#step_dw_inf_gen_install"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>).
</p><p>
In addition, the WinDriver sample code for the Xilinx Bus Master DMA (BMD) design, which
demonstrates MSI handling, includes a sample MSI INF file for this design
&#8212; <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design/</strong></span><span class="jprintfilename"><strong>xilinx_bmd.inf</strong></span>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If your card's INF file does not include MSI/MSI-&#65279;X information, as detailed
above, WinDriver will attempt to handle your card's interrupts using the legacy
level-sensitive interrupt handling method, even if your hardware supports
MSI/MSI-&#65279;X.
</td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_int_samp_user_code"></a>9.2.8. Sample User-Mode WinDriver Interrupt Handling Code</h3></div></div></div><p>
The sample code below demonstrates how you can use the WDC library's<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a> interrupt APIs (described in
<a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections B.3.48&#8211;</fo:inline></a><a class="xref" href="#WDC_IntIsEnabled" title="B.3.50. WDC_IntIsEnabled()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.3.50</fo:inline></a>
of the manual) to implement a simple user-mode interrupt handler.<br>
For complete interrupt handler source code that uses the WDC interrupt
functions, refer, for example, to the WinDriver
<span class="jprintfilename"><strong>pci_diag</strong></span>
(<span class="jdirectory"><strong>WinDriver/samples/pci_diag</strong></span>) and PLX
(<span class="jdirectory"><strong>WinDriver/plx</strong></span>) samples, and to the generated
DriverWizard PCI/ISA code. For a sample of MSI interrupt handling,
using the same APIs, refer to the Xilinx Bus Master DMA (BMD) design sample
(<span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span>), or to the code generated by DriverWizard for PCI
hardware that supports MSI/MSI-&#65279;X on the supported operating systems
(Linux or Windows 7 and higher).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The following sample code demonstrates interrupt handling for an
    edge-triggered ISA card. The code does not set up any kernel-mode interrupt
    transfer commands<a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.6]</fo:inline></a>, which is acceptable in the
    case of edge-triggered or MSI/MSI-&#65279;X interrupts<a class="xref" href="#int_handling_overview" title="9.2.1. Interrupt Handling &#8212; Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.1]</fo:inline></a>. Note that when using WinDriver to handle
    level-sensitive interrupts from the user mode, you must set up
    transfer commands for acknowledging the interrupt in the kernel, as
    explained above and as demonstrated in
    <a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.6</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    As mentioned above<a class="xref" href="#wd_msi_handling" title="9.2.7. WinDriver MSI/MSI-&#65279;X Interrupt Handling"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.7]</fo:inline></a>, WinDriver provides a single set
    of APIs for handling both legacy and MSI/MSI-&#65279;X interrupts. You can
    therefore also use the following code to handle MSI/MSI-&#65279;X PCI interrupts
    (if supported by your hardware), on Linux or Windows 7 and higher, by simply replacing the use
    of <code class="jfunc">WDC_IsaDeviceOpen</code><span class="jfunc">()</span> in the sample with
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span>.
  </li></ul></div></td></tr></table></div><pre class="screen">VOID DLLCALLCONV interrupt_handler (PVOID pData)
{
    PWDC_DEVICE pDev = (PWDC_DEVICE)pData;

    /* Implement your interrupt handler routine here */

    printf("Got interrupt %d\n", pDev-&gt;Int.dwCounter);
}

...

int main()
{
    DWORD dwStatus;
    WDC_DEVICE_HANDLE hDev;
    ...
    WDC_DriverOpen(WDC_DRV_OPEN_DEFAULT, NULL);
    ...

    hDev = WDC_IsaDeviceOpen(...);
    ...
    /* Enable interrupts. This sample passes the WDC device handle as the data
        for the interrupt handler routine */
    dwStatus = WDC_IntEnable(hDev, NULL, 0, 0,
        interrupt_handler, (PVOID)hDev, FALSE);
    /* WDC_IntEnable() allocates and initializes the required WD_INTERRUPT
        structure, stores it in the WDC_DEVICE structure, then calls
        InterruptEnable(), which calls WD_IntEnable() and creates an interrupt
        handler thread. */
    if (WD_STATUS_SUCCESS != dwStatus)
    {
       printf ("Failed enabling interrupt. Error: 0x%x - %s\n",
           dwStatus, Stat2Str(dwStatus));
    }
    else
    {
        printf("Press Enter to uninstall interrupt\n");
        fgets(line, sizeof(line), stdin);

        WDC_IntDisable(hDev);
        /* WDC_IntDisable() calls InterruptDisable();
           InterruptDisable() calls WD_IntDisable(). */
    }

    ...
    WDC_IsaDeviceClose(hDev);
    ...
    WDC_DriverClose();
}</pre></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="sharing_buffer"></a>9.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Buffer sharing between multiple processes</span></h2></div></div></div>
This section describes how to share a contiguous DMA buffer or a kernel buffer
between multiple processes.<br>
The buffer sharing mechanism can be used to improve the work of multiple 
processes by allowing the developer avoiding unnecessary buffer copying.<br>
Coupled with the WinDriver IPC mechanism it might also be used as a way for two 
processes to convey large messages/data.
<p>
Currently WinDriver supports sharing DMA contiguous buffer (See 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span>) and Kernel buffer (See 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span>).<br>
</p><p>
In order to share a buffer the developer must first pass its global handle to
the other process(es). See Macros <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferGetGlobalHandle</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferGetGlobalHandle" title="B.6.4. WDS_SharedBufferGetGlobalHandle Macro"><fo:inline> [B.6.4]</fo:inline></a></span>
and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAGetGlobalHandle</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAGetGlobalHandle" title="B.3.45. WDC_DMAGetGlobalHandle Macro"><fo:inline> [B.3.45]</fo:inline></a></span> for getting a buffer's global
handle.<br>
Than, the handle should be passed to the other process(es). E.g. by WinDriver IPC
calls: <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcUidUnicast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcUidUnicast" title="C.2.8. WDS_IpcUidUnicast()"><fo:inline> [C.2.8]</fo:inline></a></span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcSubGroupMulticast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcSubGroupMulticast" title="C.2.7. WDS_IpcSubGroupMulticast()"><fo:inline> [C.2.7]</fo:inline></a></span> 
or <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcMulticast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcMulticast" title="C.2.6. WDS_IpcMulticast()"><fo:inline> [C.2.6]</fo:inline></a></span>.
</p><p>
After a process gets the global buffer handle, it should use 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMABufGet</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufGet" title="B.3.44. WDC_DMABufGet()"><fo:inline> [B.3.44]</fo:inline></a></span> or <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferGet</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferGet" title="B.6.3. WDS_SharedBufferGet()"><fo:inline> [B.6.3]</fo:inline></a></span> to retrieve 
the buffer. WinDriver will re-map the buffer to the new process virtual memory (I.e. 
user-space) and will fill all the necessary information as though the buffer was 
allocated from the calling process.
</p><p>
Once the process no longer needs the shared buffer it should use the regular
unlock/free calls - <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span>, 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferFree</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferFree" title="B.6.2. WDS_SharedBufferFree()"><fo:inline> [B.6.2]</fo:inline></a></span> appropriately.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
WinDriver manages all system resources, hence the call to 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferFree</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferFree" title="B.6.2. WDS_SharedBufferFree()"><fo:inline> [B.6.2]</fo:inline></a></span> will not
remove system resources until all processes no longer use the buffer.
</td></tr></table></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="performance_improve"></a>Chapter 10. Improving Performance</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wdpci_perf_imprv_overview"></a>10.1. Overview</h2></div></div></div>
<p>
Once your user-mode driver has been written and debugged, you might find that
certain modules in your code do not operate fast enough (for example: an
interrupt handler or accessing I/&#65279;O-mapped regions). If this is the case, try
to improve performance in one of the following ways:
</p>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Improve the performance of your user-mode driver<a class="xref" href="#perf_user_impr" title="10.2. Improving the Performance of a User&#65279;-&#65279;Mode Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [10.2]</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc"><p>
    Create a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a> and move
    the performance-critical portions of your code to the Kernel PlugIn.
    </p></li></ul></div>

<p>
Use the following checklist to determine how to best improve the performance
of your driver.
</p>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="pci_wd_perf_checklist"></a>10.1.1. Performance Improvement Checklist</h3></div></div></div><p>
The following checklist will help you determine how to improve
the performance of your driver:
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Problem</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Solution</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ISA Card &#8212; accessing an I/&#65279;O-mapped range on the card</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    When transferring a large amount of data, use block (string) transfers
    and/or group several data transfer function calls into a single
    multi-transfer function call, as explained in
    <a class="xref" href="#perf_block_multi_trans" title="10.2.2. Block Transfers and Grouping Multiple Transfers"><fo:inline>Section 10.2.2</fo:inline></a> below.
    </p>
    <p>
    If this does not solve the problem, handle the I/&#65279;O at kernel mode by
    writing a Kernel PlugIn driver, as explained in
    <a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline>Chapters 11</fo:inline></a> and<a class="xref" href="#kp_create" title="Chapter 12. Creating a Kernel PlugIn Driver"><fo:inline> 12</fo:inline></a> of the manual.
   </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PCI Card &#8212; accessing an I/&#65279;O-mapped range on the card</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Avoid using I/&#65279;O ranges in your hardware design. Use Memory mapped ranges
    instead as they are accessed significantly faster.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Accessing a memory-mapped range on the card</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    Try to access memory directly instead of using function calls, as explained
    in <a class="xref" href="#mem_direct_access" title="10.2.1. Using Direct Access to Memory-Mapped Regions"><fo:inline>Section 10.2.1</fo:inline></a> below.
    <br>
    When transferring large amounts of data, consider also the solution to
    problem #1 above.
    </p>
    <p>
    If the problem persists, then there is a hardware design problem. You will
    not be able to increase performance by using any software design method,
    writing a Kernel PlugIn, or even by writing a full kernel driver.
    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    Interrupt latency &#8212; missing interrupts, receiving interrupts too late
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Handle the interrupts in the kernel mode by writing a Kernel PlugIn
    driver, as explained in <a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline>Chapters 11</fo:inline></a>
    and<a class="xref" href="#kp_create" title="Chapter 12. Creating a Kernel PlugIn Driver"><fo:inline> 12</fo:inline></a>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">PCI target access vs. master access</td><td style="" align="left" valign="top">
    PCI target access is usually slower than PCI master access (bus-master
    DMA). For large data transfers, bus-master DMA access is preferable.
    <a class="xref" href="#advanced_issues_dma" title="9.1. Performing Direct Memory Access (DMA)"><fo:inline>Section 9.1</fo:inline></a> of the manual explains how to use
    WinDriver to implement bus-master DMA.
  </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="perf_user_impr"></a>10.2. Improving the Performance of a User&#65279;-&#65279;Mode Driver</h2></div></div></div><p>
As a general rule, transfers to memory-mapped regions are faster than transfers
to I/&#65279;O-mapped regions, because WinDriver enables you to access memory-mapped
regions directly from the user mode, without the need for a function call, as
explained in <a class="xref" href="#mem_direct_access" title="10.2.1. Using Direct Access to Memory-Mapped Regions"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 10.2.1</fo:inline></a>.
</p><p>
In addition, the WinDriver APIs enable you to improve the performance of your
I/&#65279;O and memory data transfers by using block (string) transfers and by
grouping several data transfers into a single function call, as explained in
<a class="xref" href="#perf_block_multi_trans" title="10.2.2. Block Transfers and Grouping Multiple Transfers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 10.2.2</fo:inline></a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="mem_direct_access"></a>10.2.1. Using Direct Access to Memory-Mapped Regions</h3></div></div></div><p>
When registering a PCI card, using <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) or the
low&#65279;-&#65279;level <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function (see the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), WinDriver returns both user-mode and kernel-mode mappings of
the card's physical memory regions. These addresses can then be used to access
the memory regions on the card directly, either from the user mode or from the
kernel mode (respectively), thus eliminating the context switches between the
user and kernel modes and the function calls overhead for accessing the memory.
</p><p>
The <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MEM_DIRECT_ADDR</code></span><span> macro</span><a class="xref" href="#WDC_MEM_DIRECT_ADDR" title="B.4.4. WDC_MEM_DIRECT_ADDR Macro"><fo:inline> [B.4.4]</fo:inline></a></span> provides the relevant direct
memory access base address &#8212; user-mode mapping when called from the
user-mode / kernel-mode mapping when called from a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a> &#8212; for a given memory address region on
the card. You can then pass the mapped base address to the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadMem8/16/32/64</code></span><a class="xref" href="#WDC_ReadMemXXX" title="B.3.24. WDC_ReadMemXXX()"><fo:inline> [B.3.24]</fo:inline></a></span> and
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteMem8/16/32/64</code></span><a class="xref" href="#WDC_WriteMemXXX" title="B.3.25. WDC_WriteMemXXX()"><fo:inline> [B.3.25]</fo:inline></a></span> macros, along with the
desired offset within the selected memory region, to directly access a specific
memory address on the card, either from the user mode or in the kernel.<br>
In addition, all the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadAddrXXX</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrXXX" title="B.3.26. WDC_ReadAddrXXX()"><fo:inline> [B.3.26]</fo:inline></a></span> and
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteAddrXXX</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrXXX" title="B.3.27. WDC_WriteAddrXXX()"><fo:inline> [B.3.27]</fo:inline></a></span> functions &#8212; with the exception of
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrBlock" title="B.3.28. WDC_ReadAddrBlock()"><fo:inline> [B.3.28]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrBlock" title="B.3.29. WDC_WriteAddrBlock()"><fo:inline> [B.3.29]</fo:inline></a></span> &#8212;
access memory addresses directly, using the correct mapping, based on the
calling context (user mode/kernel mode).
</p><p>
When using the low&#65279;-&#65279;level <code class="jfunc">WD_xxx</code><span class="jfunc">()</span> APIs, described in the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>, the user-mode and kernel-mode mappings of the card's
physical memory regions are returned by <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> within
the <code class="japi">pTransAddr</code> and <code class="japi">pUserDirectAddr</code> fields of the
<code class="japi">pCardReg-&gt;Card.Item[i]</code> card resource item structures. The
<code class="japi">pTransAddr</code> result should be used as a base address in calls to
<code class="jfunc">WD_Transfer</code><span class="jfunc">()</span>or <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span> or when accessing
memory directly from a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>.
To access the memory directly from your user-mode process, use
<code class="japi">pUserDirectAddr</code> as a regular pointer.
</p><p>
Whatever the method you select to access the memory on your card, it is
important to align the base address according to the size of the data type,
especially when issuing string transfer commands. Otherwise, the transfers are
split into smaller portions. <br>
The easiest way to align data is to use basic types when defining a buffer,
i.e.:
</p><pre class="screen">BYTE buf[len];      /* for BYTE transfers - not aligned */
WORD buf[len];      /* for WORD transfers - aligned on a 2-byte boundary */
UINT32 buf[len];    /* for DWORD transfers - aligned on a 4-byte boundary */
UINT64 buf[len];    /* for QWORD transfers - aligned on a 8-byte boundary */</pre></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="perf_block_multi_trans"></a>10.2.2. Block Transfers and Grouping Multiple Transfers</h3></div></div></div><p>
To transfer large amounts of data to/from memory addresses or I/&#65279;O addresses
(which by definition cannot be accessed directly, as opposed to memory
addresses &#8212; see <a class="xref" href="#mem_direct_access" title="10.2.1. Using Direct Access to Memory-Mapped Regions"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 10.2.1</fo:inline></a>), use the
following methods to improve performance by reducing the function calls
overhead and context switches between the user and kernel modes:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Perform block (string) transfers using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrBlock" title="B.3.28. WDC_ReadAddrBlock()"><fo:inline> [B.3.28]</fo:inline></a></span> /
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrBlock" title="B.3.29. WDC_WriteAddrBlock()"><fo:inline> [B.3.29]</fo:inline></a></span>, or the low&#65279;-&#65279;level
    <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span> function (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </li><li class="listitem" style="list-style-type: disc">
    Group several transfers into a single function call, using
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MultiTransfer</code><span class="japi">()</span></span><a class="xref" href="#WDC_MultiTransfer" title="B.3.30. WDC_MultiTransfer()"><fo:inline> [B.3.30]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="64_bit_data_transfers"></a>10.2.3. Performing 64-&#65279;Bit Data Transfers</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The ability to perform actual 64-&#65279;bit transfers is dependent on the existence
of support for such transfers by the hardware, CPU, bridge, etc., and can be
affected by any of these factors or their specific combination.
</td></tr></table></div><p>
WinDriver supports 64-&#65279;bit PCI data transfers on the supported Windows
and Linux 64-&#65279;bit platforms (see <a class="xref" href="#64bit_os_sup" title="Appendix A. 64-&#65279;Bit Operating Systems Support"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Appendix A</fo:inline></a>
for a full list), as well as on Windows and Linux 32-&#65279;bit x86
platforms.
</p><p>
If your PCI hardware (card and bus) is 64-&#65279;bit, the ability to perform
64-&#65279;bit data transfers on 32-&#65279;bit platforms will enable you to utilize your
hardware's broader bandwidth, even if your host operating system is only
32-&#65279;bit.
</p><p>
This innovative technology makes possible data transfer rates previously
unattainable on 32-&#65279;bit platforms. Drivers developed using WinDriver will attain
significantly better performance results than drivers written with the WDK or
other driver development tools. To date, such tools do not enable 64-&#65279;bit data
transfer on x86 platforms running 32-&#65279;bit operating systems. Jungo's
benchmark performance testing results for 64-&#65279;bit data transfer indicate a
significant improvement of data transfer rates compared to 32-&#65279;bit data
transfer, guaranteeing that drivers developed with WinDriver will achieve far
better performance than 32-&#65279;bit data transfer normally allows.
</p><p>
You can perform 64-&#65279;bit data transfers using any of the following methods:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadAddr64</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrXXX" title="B.3.26. WDC_ReadAddrXXX()"><fo:inline> [B.3.26]</fo:inline></a></span> or
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteAddr64</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrXXX" title="B.3.27. WDC_WriteAddrXXX()"><fo:inline> [B.3.27]</fo:inline></a></span>.
  </li><li class="listitem" style="list-style-type: disc">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ReadAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrBlock" title="B.3.28. WDC_ReadAddrBlock()"><fo:inline> [B.3.28]</fo:inline></a></span> or <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_WriteAddrBlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrBlock" title="B.3.29. WDC_WriteAddrBlock()"><fo:inline> [B.3.29]</fo:inline></a></span>
    with an access mode of <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_SIZE_64</code></span><a class="xref" href="#WDC_ADDR_MODE" title="B.3.1.4. WDC_ADDR_MODE Enumeration"><fo:inline> [B.3.1.4]</fo:inline></a></span>.
  </li><li class="listitem" style="list-style-type: disc">
    Call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MultiTransfer</code><span class="japi">()</span></span><a class="xref" href="#WDC_MultiTransfer" title="B.3.30. WDC_MultiTransfer()"><fo:inline> [B.3.30]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span> or <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span> functions
    (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) with QWORD read/write transfer commands (see the
    documentation of these functions for details).
  </li></ul></div><p>
</p><p>
You can also perform 64-&#65279;bit transfers to/from the PCI configuration space
using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciReadCfg64</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciReadCfgXXX" title="B.3.38. WDC_PciReadCfgXXX()"><fo:inline> [B.3.38]</fo:inline></a></span> /
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciWriteCfg64</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciWriteCfgXXX" title="B.3.39. WDC_PciWriteCfgXXX()"><fo:inline> [B.3.39]</fo:inline></a></span>
and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciReadCfgBySlot64</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciReadCfgBySlotXXX" title="B.3.36. WDC_PciReadCfgBySlotXXX()"><fo:inline> [B.3.36]</fo:inline></a></span> /
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciWriteCfgBySlot64</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciWriteCfgBySlotXXX" title="B.3.37. WDC_PciWriteCfgBySlotXXX()"><fo:inline> [B.3.37]</fo:inline></a></span>.
</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="WinDriver_Kernel_PlugIn"></a>Chapter 11. Understanding the Kernel PlugIn</h1></div></div></div><p>
This chapter provides a description of WinDriver's Kernel PlugIn feature.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_background"></a>11.1. Background</h2></div></div></div><p>
The creation of drivers in user mode imposes a fair amount of function call
overhead from the kernel to user mode, which may cause performance to drop to
an unacceptable level. In such cases, the Kernel PlugIn feature allows critical
sections of the driver code to be moved to the kernel while keeping most of the
code intact. Using WinDriver's Kernel PlugIn feature, your driver will operate
without any degradation in performance.
</p><p>
Writing a Kernel PlugIn driver provides the following advantages over a
standard OS kernel-mode driver:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    All the driver code is written and debugged in the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    The code segments that are moved to the kernel mode remain essentially the
    same, and therefore typically no kernel debugging is needed.
  </li><li class="listitem" style="list-style-type: disc">
    The parts of the code that will run in the kernel through the Kernel PlugIn
    are platform-independent, and therefore will run on every platform
    supported by WinDriver and the Kernel PlugIn. A standard kernel-mode driver
    will run only on the platform it was written for.
  </li></ul></div><p>
</p><p>
Using WinDriver's Kernel PlugIn feature, your driver will operate without any
performance degradation.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_when_needed"></a>11.2. Do I Need to Write a Kernel PlugIn Driver?</h2></div></div></div><p>
Not every performance problem requires you to write a Kernel PlugIn driver.
Some performance problems can be solved in the user-mode driver by better
utilization of the features that WinDriver provides. For further information,
please refer to <a class="xref" href="#performance_improve" title="Chapter 10. Improving Performance"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 10</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_perf"></a>11.3. What Kind of Performance Can I Expect?</h2></div></div></div><p>
Since you can write your own interrupt handler in the kernel with the WinDriver
Kernel PlugIn, you can expect to handle about 100,000 interrupts per second
without missing any one of them.

</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_dev_process"></a>11.4. Overview of the Development Process</h2></div></div></div><p>
Using the WinDriver Kernel PlugIn, you normally first develop and debugs the
driver in the user mode, using with the standard WinDriver tools. After
identifying the performance-critical parts of the code (such as the interrupt
handling or access to I/&#65279;O-mapped memory ranges), you can create a
Kernel PlugIn driver, which runs in kernel mode, and drop the
performance-critical portions of your code into the Kernel PlugIn driver, thus
eliminating the calling overhead and context switches that occur when
implementing the same tasks in the user mode.
</p><p>
This unique architecture allows the developer to start with quick and easy
development in the user mode, and progress to performance-oriented code
only where needed, thus saving development time and providing for virtually
zero performance degradation.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_arch"></a>11.5. The Kernel PlugIn Architecture</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_arch_overview"></a>11.5.1. Architecture Overview</h3></div></div></div><p>
A driver written in user mode uses WinDriver's API (<code class="japi">WDC_xxx</code> and/or
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_xxx</code></span><a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a></span>) to access devices. If a certain function
that was implemented in the user mode requires kernel performance (the
interrupt handler, for example), that function is moved to the WinDriver Kernel
PlugIn. Generally it should be possible to move code that uses <code class="japi">WDC_xxx /
WD_xxx</code> function calls from the user mode to the kernel without
modification, since the same WinDriver API is supported both in the user mode and
in the Kernel PlugIn.
</p><div class="figure"><a name="KPArch"></a><p class="title"><b>Figure 11.1. Kernel PlugIn Architecture</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/KPArch.png" height="" alt="Kernel PlugIn Architecture"></div></div></div><br class="figure-break"></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_kp_inter"></a>11.5.2. WinDriver's Kernel and Kernel PlugIn Interaction</h3></div></div></div><p>
There are two types of interaction between the WinDriver kernel and the WinDriver
Kernel PlugIn:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Interrupt handling:</strong></span> When WinDriver receives an interrupt, by default it
    will activate the caller's user-mode interrupt handler. However, if the
    interrupt was set to be handled by a Kernel PlugIn driver, then once WinDriver
    receives the interrupt, it activates the Kernel PlugIn driver's kernel-mode
    interrupt handler. Your Kernel PlugIn interrupt handler could essentially
    consist of the same code that you wrote and debugged in the user-mode
    interrupt handler, before moving to the Kernel PlugIn, although some of the
    user-mode code should be modified. We recommend that you rewrite the
    interrupt acknowledgment and handling code in the Kernel PlugIn to utilize
    the flexibility offered by the Kernel PlugIn (see
    <a class="xref" href="#KP_int_handling" title="11.6.5. Handling Interrupts in the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.5</fo:inline></a>).
  </li><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Message passing:</strong></span> To execute functions in kernel mode (such as I/&#65279;O
    processing functions), the user-mode driver simply passes a message to the
    WinDriver Kernel PlugIn. The message is mapped to a specific function, which
    is then executed in the kernel. This function can typically contain the
    same code as it did when it was written and debugged in user mode.<br>
    You can also use messages to pass data from the user-mode application to
    the Kernel PlugIn driver.
  </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_comp"></a>11.5.3. Kernel PlugIn Components</h3></div></div></div><p>
At the end of your Kernel PlugIn development cycle, your driver will have the
following components:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    User-mode driver application
    (<span class="jprintfilename"><strong>&lt;application name&gt;/.exe</strong></span>), written
    with the <code class="japi">WDC_xxx / WD_xxx</code> API.
  </li><li class="listitem" style="list-style-type: disc">
    The WinDriver kernel module &#8212;
    <span class="jprintfilename"><strong><span class="jprintfilename"><strong>windrvr1281</strong></span>.sys/.o/.ko</strong></span>,
    depending on the operating system.
  </li><li class="listitem" style="list-style-type: disc">
    Kernel PlugIn driver
    (<span class="jprintfilename"><strong>&lt;Kernel PlugIn driver name&gt;/.sys/.o/.ko<span xmlns:fo="http://www.w3.org/1999/XSL/Format">/.kext</span></strong></span>), which was also written
    with the <code class="japi">WDC_xxx / WD_xxx</code> API, and contains the driver
    functionality that you have selected to bring down to the kernel level.
  </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Event_Sequence"></a>11.5.4. Kernel PlugIn Event Sequence</h3></div></div></div><p>
The following is a typical event sequence that covers all the functions that
you can implement in your Kernel PlugIn:
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_open_handle_from_user"></a>11.5.4.1. Opening a Handle from the User Mode to a Kernel PlugIn Driver</h4></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event/Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Notes</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event:</strong></span> Windows loads your Kernel PlugIn driver.</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This takes place at boot time, by dynamic loading, or as instructed by the
    registry.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your <span style=""><span style=""><code class="japi">KP_Init</code></span><span> Kernel PlugIn routine</span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> is
    called
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">KP_Init</code> informs WinDriver of the name(s) of your
    <span style=""><span style=""><code class="japi">KP_Open</code></span><span> routine(s)</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>. WinDriver calls the relevant open
    routine when there is a user-mode request to open a handle to your Kernel
    PlugIn driver.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Event:</strong></span> Your user-mode driver application requests a handle to your
    Kernel PlugIn driver, by calling one of the following functions:<br>
    &#8226; <span style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span><br>
    &#8226; <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>) with the name of the Kernel PlugIn driver<br>
    &#8226; <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> &#8212; when using the
    low&#65279;-&#65279;level WinDriver API (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td><td class="auto-generated" style="border-bottom: 0.5pt solid ; "> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> The relevant
    <span style=""><span style=""><code class="japi">KP_Open</code></span><span> Kernel PlugIn callback routine</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> is called.
  </td><td style="" align="left" valign="top">
    The <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> callback is used to inform WinDriver of the names of
    all the callback functions that you have implemented in your Kernel PlugIn
    driver, and to initiate the Kernel PlugIn driver, if needed.
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_handle_user_requests"></a>11.5.4.2. Handling User-Mode Requests from the Kernel PlugIn</h4></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event/Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Notes</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <span class="b"><strong>Event:</strong></span> Your application calls <span style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span>, or
    the low&#65279;-&#65279;level <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
    
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Your application calls <code class="jfunc">WDC_CallKerPlug</code><span class="jfunc">()</span> /
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> to execute code in the kernel mode (in
    the Kernel PlugIn driver). The application passes a message to the Kernel
    PlugIn driver. The Kernel PlugIn driver will select the code to execute
    according to the message sent.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your <span style=""><span style=""><code class="japi">KP_Call</code></span><span> Kernel PlugIn routine</span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> is
    called.
  </td><td style="" align="left" valign="top">
    <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> executes code according to the message passed to it
    from the user mode.
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_ints_enable_disable_highirql"></a>11.5.4.3. Interrupt Handling &#8212; Enable&#65279;/&#65279;Disable and
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">High Interrupt Request Level Processing</span></h4></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event/Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Notes</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <span class="b"><strong>Event:</strong></span> Your application calls <span style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> with the
    <code class="japi">fUseKP</code> parameter set to <code class="japi">TRUE</code> (after having opened
    a handle to the Kernel PlugIn), or calls the low&#65279;-&#65279;level
    <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> or <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions
    (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) with a handle to a Kernel PlugIn driver (set in
    the <code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_INTERRUPT</code>
    structure passed to the function).
    
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your
    <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><span> Kernel PlugIn routine</span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> is called.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This function should contain any initialization required for your Kernel
    PlugIn interrupt handling.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event:</strong></span> Your hardware creates an interrupt.</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <span class="b"><strong>Callback:</strong></span> Your high-IRQL Kernel PlugIn interrupt handler routine
    &#8212; <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; is called.
    
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a> and <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a> run at a high priority, and therefore should
    perform only the basic interrupt handling, such as lowering the HW
    interrupt signal of level-sensitive interrupts to acknowledge the
    interrupt.<br>
    If more interrupt processing is required,
    <code class="japi">KP_IntAtIrql</code>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code>
    (MSI/MSI-&#65279;X) can return <code class="japi">TRUE</code> in order
    to defer additional processing to the relevant deferred processing
    interrupt handler &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a>.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <span class="b"><strong>Event:</strong></span> Your application calls <span style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span>, or the
    low&#65279;-&#65279;level <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> or
    <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), when
    the interrupts were previously enabled in the Kernel PlugIn (see the
    description of the interrupt enable event above).
    
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your
    <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><span> Kernel PlugIn routine</span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span> is called.
  </td><td style="" align="left" valign="top">
    This function should free any memory that was allocated by the
    <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><span> callback</span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>.
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_int_dpc"></a>11.5.4.4. Interrupt Handling &#8212; Deferred Procedure Calls</h4></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event/Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Notes</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Event:</strong></span> The Kernel PlugIn high-IRQL interrupt handler &#8212;
    <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a> or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a> &#8212; returns <code class="japi">TRUE</code>.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This informs WinDriver that additional interrupt processing is required as a
    Deferred Procedure Call (DPC) in the kernel.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your Kernel PlugIn DPC interrupt handler &#8212;
    <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; is called.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Processes the rest of the interrupt code, but at a lower priority than the
    high-IRQL interrupt handler.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Event:</strong></span> The DPC interrupt handler &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a> &#8212;
    returns a value greater than 0.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This informs WinDriver that additional user-mode interrupt processing is
    required.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
    returns.
  </td><td style="" align="left" valign="top">Your user-mode interrupt handler routine is executed.</td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_pnp"></a>11.5.4.5. Plug&#65279;-&#65279;and&#65279;-&#65279;Play and Power Management Events</h4></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Event/Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Notes</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    <span class="b"><strong>Event:</strong></span> Your application registers to receive Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power
    management notifications using a Kernel PlugIn driver, by calling
    <span style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span> with the with the <code class="japi">fUseKP</code>
    parameter set to <code class="japi">TRUE</code> (after having opened the device with a
    Kernel PlugIn), or calls the low&#65279;-&#65279;level <code class="jfunc">EventRegister</code><span class="jfunc">()</span>
    (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) or <code class="jfunc">WD_EventRegister</code><span class="jfunc">()</span> functions
    with a handle to a Kernel PlugIn driver (set in the
    <code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_EVENT</code> structure
    that is passed to the function).
    
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Event:</strong></span> A Plug&#65279;-&#65279;and&#65279;-&#65279;Play or power management event (to which the application
    registered to listen) occurs.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> Your <span style=""><span style=""><code class="japi">KP_Event</code></span><span> Kernel PlugIn routine</span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span>
    is called.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">KP_Event</code> receives information about the event that occurred
    and can proceed to handle it as needed.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Event:</strong></span> <span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span> returns <code class="japi">TRUE</code>.
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This informs WinDriver that the event also requires user-mode handling.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    <span class="b"><strong>Callback:</strong></span> <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
    returns.
  </td><td style="" align="left" valign="top">Your user-mode event handler routine is executed.</td></tr></tbody></table></div></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_how_does_it_work"></a>11.6. How Does Kernel PlugIn Work?</h2></div></div></div><p>
The following sections take you through the development cycle of a Kernel
PlugIn driver.
</p><p>
It is recommended that you first write and debug your entire driver code in the
user mode. Then, if you encounter performance problems or require greater
flexibility, port portions of your code to a Kernel PlugIn driver.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_min_requirements"></a>11.6.1. Minimal Requirements for Creating a Kernel PlugIn Driver</h3></div></div></div><p>
To build a Kernel PlugIn driver you need the following tools:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    On Windows: The Windows Driver Kit (WDK), including its C build tools.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The WDK is available as part of a Microsoft Development Network (MSDN) subscription, or from
    Microsoft Connect. For more information, refer to Microsoft's
    Windows Driver Kit (WDK) page &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://msdn.microsoft.com/en-us/library/windows/hardware/gg487428.aspx" target="_top">https://msdn.microsoft.com/en-us/library/windows/hardware/gg487428.aspx</a></span>.
      </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    On <span class="b"><strong>Linux</strong></span>:<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="jprintfilename"><strong>GCC</strong></span>,
        <span class="jprintfilename"><strong>gmake</strong></span> or
        <span class="jprintfilename"><strong>make</strong></span></li></ul></div></li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
While this is not a minimal requirement, when developing a Kernel PlugIn driver
it is highly recommended that you use two computers: set up one computer as
your host platform and the other as your target platform. The host computer is
the computer on which you develop your driver and the target computer is the
computer on which you run and test the driver you develop.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_implementation"></a>11.6.2. Kernel PlugIn Implementation</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_before_you_begin"></a>11.6.2.1. Before You Begin</h4></div></div></div><p>
The functions described in this section are callback functions, implemented in
the Kernel PlugIn driver, which are called when their calling event occurs
&#8212; see <a class="xref" href="#KP_Event_Sequence" title="11.5.4. Kernel PlugIn Event Sequence"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.5.4</fo:inline></a> for details. For example,
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> is the callback function that is called when the driver
is loaded.
</p><p>
The name of your driver is given in <code class="japi">KP_Init</code>. The Kernel PlugIn
driver's implementation of this callback must be named <code class="japi">KP_Init</code>.
The names of the other Kernel PlugIn callback functions (which are passed to
<code class="japi">KP_Init</code>) are left to the discretion of the driver developer. It is
the convention of this reference guide to refer to these callbacks using the
format <code class="japi">KP_&lt;Functionality&gt;</code> &#8212; for example,
<code class="japi">KP_Open</code>.<br>
When generating Kernel PlugIn code with the DriverWizard, the names of the
callback functions (apart from <code class="japi">KP_Init</code>) conform to the following
format:
<span class="jprintfilename"><strong>KP_&lt;Driver Name&gt;_&lt;Functionality&gt;</strong></span>.
For example, if you named your project
<span class="jprintfilename"><strong>MyDevice</strong></span>, the name of your Kernel PlugIn
<code class="japi">KP_Call</code> callback will be <code class="japi">KP_MyDevice_Call</code>.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="KP_Init_write"></a>11.6.2.2. Write Your KP_Init Function</h4></div></div></div><p>
Your <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><span> function</span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> should be of the following prototype:

</p><pre class="screen">BOOL __cdecl KP_Init (KP_INIT *kpInit);</pre><p>
</p><p>
This function is called once, when the driver is loaded. The function should
fill the received <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_INIT</code></span><span> structure</span><a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a></span> with the name of the
Kernel PlugIn driver, the name of the WinDriver Kernel PlugIn driver library, and
the driver's <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><span> callback(s)</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> (see example in
<span class="jprintfilename"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/&#65279;<span class="jprintfilename"><strong>kp_pci.c</strong></span></strong></span>).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The name that you select for your Kernel PlugIn driver &#8212; by setting
    it in the <code class="japi">cDriverName</code> field of the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_INIT</code></span><span> structure</span><a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a></span> that is passed to
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> &#8212; should be the name of the driver that you
    wish to create; i.e., if you are creating a driver called
    <span class="jprintfilename"><strong>XXX.sys</strong></span>, you should set the name "XXX" in
    the <code class="japi">cDriverName</code> field of the <code class="japi">KP_INIT</code> structure.
  </li><li class="listitem" style="list-style-type: disc">
    You should verify that the driver name that is used when opening a handle
    to the Kernel PlugIn driver in the user mode<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [12.5]</fo:inline></a> &#8212; in the <code class="japi">pKPOpenData</code> parameter of
    the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span> or <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) functions, or in
    the <code class="japi">pcDriverName</code> field of the <code class="japi">pKernelPlugIn</code>
    parameter passed to the low&#65279;-&#65279;level <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span>
    function &#8212; is identical to the driver name that was set in the
    <code class="japi">cDriverName</code> field of the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_INIT</code></span><span> structure</span><a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a></span>
    that is passed to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span>.<br>
    The best way to implement this is to define the driver name in a header
    file that is shared by the user-mode application and the Kernel PlugIn
    driver and use the defined value in all relevant locations.
  </li></ul></div></td></tr></table></div><p>
From the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample (<span class="jprintfilename"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/&#65279;<span class="jprintfilename"><strong>kp_pci.c</strong></span></strong></span>):

</p><pre class="screen">/* KP_Init is called when the Kernel PlugIn driver is loaded.
   This function sets the name of the Kernel PlugIn driver and the driver's
   open callback function(s). */
BOOL __cdecl KP_Init(KP_INIT *kpInit)
{
    /* Verify that the version of the WinDriver Kernel PlugIn library
        is identical to that of the windrvr.h and wd_kp.h files */
    if (WD_VER != kpInit-&gt;dwVerWD)
    {
        /* Rebuild your Kernel PlugIn driver project with the compatible
           version of the WinDriver Kernel PlugIn library (kp_nt&lt;version&gt;.lib)
           and windrvr.h and wd_kp.h files */
        return FALSE;
    }

    kpInit-&gt;funcOpen = KP_PCI_Open;
    kpInit-&gt;funcOpen_32_64 = KP_PCI_VIRT_Open_32_64;
    strcpy (kpInit-&gt;cDriverName, KP_PCI_DRIVER_NAME);

    return TRUE;
}
</pre><p>
</p><p>
Note that the driver name in the sample is set using a preprocessor definition.
This definition is found in the
<span class="jdirectory"><strong>WinDriver/samples/pci_diag/pci_lib.h</strong></span> header file, which
is shared by the <span class="jprintfilename"><strong>pci_diag</strong></span> user-mode
application and the <span class="jprintfilename"><strong>KP_PCI</strong></span> Kernel PlugIn driver:
</p><pre class="screen">/* Kernel PlugIn driver name (should be no more than 8 characters) */
#define KP_PCI_DRIVER_NAME "KP_PCI"
</pre></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="KP_Open_write"></a>11.6.2.3. Write Your KP_Open Function(s)</h4></div></div></div><p>
You can implement either one or two
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><span> functions, depending on your target configuration</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>.
The <code class="japi">KP_Open</code> function(s) should be of the following prototype:

</p><pre class="screen">BOOL __cdecl KP_Open (
    KP_OPEN_CALL *kpOpenCall,
    HANDLE hWD,
    PVOID pOpenData,
    PVOID *ppDrvContext);
</pre><p>
</p><p>
This callback is called when opening a handle to the Kernel PlugIn driver from
the user mode &#8212; i.e., when <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> is called,
either directly or via <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span> or <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>), as
explained in <a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.5</fo:inline></a>.
</p><p>
In the <code class="japi">KP_Open</code> function, define the callbacks that you wish to
implement in the Kernel PlugIn.
</p><p>
The following is a list of the callbacks that can be implemented:
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Callback</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Functionality</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when the <code class="jfunc">WD_KernelPlugInClose</code><span class="jfunc">()</span> function (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is called from the user mode &#8212; either directly, or
    via one of the high&#65279;-&#65279;level <code class="jfunc">WDC_xxxDeviceClose</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline> [B.3.19]</fo:inline></a> /
    ISA<a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline> [B.3.20]</fo:inline></a>) when called for a device
    that contains an open Kernel PlugIn handle<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline> [12.5]</fo:inline></a>.
    
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when the user-mode application calls the
    <span style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>),
    which is called by the wrapper <code class="jfunc">WDC_CallKerPlug</code><span class="jfunc">()</span> function.
    <br>
    This function implements a Kernel PlugIn message handler.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when the user-mode application enables Kernel PlugIn interrupts, by
    calling <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> with the <code class="japi">fUseKP</code> parameter
    set to <code class="japi">TRUE</code> (after having opened a Kernel PlugIn handle), or
    by calling the low&#65279;-&#65279;level <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> or
    <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) with a
    handle to a Kernel PlugIn driver (set in the <code class="japi">hKernelPlugIn</code>
    field of the <code class="japi">WD_INTERRUPT</code> structure that is passed to the
    function).<br>
    <p></p>
    This function should contain any initialization required for your Kernel
    PlugIn interrupt handling.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when the user-mode application calls <span style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span>,
    or the low&#65279;-&#65279;level <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> or
    <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), if the
    interrupts were previously enabled with a Kernel PlugIn driver (see the
    description of <code class="japi">KP_IntEnable</code> above).<br>
    This function should free any memory that was allocated by the
    <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><span> callback</span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when WinDriver receives a legacy interrupt, provided the received
    interrupt was enabled with a handle to the Kernel PlugIn. This is the
    function that will handle your legacy interrupt in the kernel mode. The
    function runs at high interrupt request level. Additional deferred
    processing of the interrupt can be performed in <code class="japi">KP_IntAtDpc</code>
    and also in the user mode (see below).
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called if the <span style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><span> callback</span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> has requested
    deferred handling of a legacy interrupt by returning
    <code class="japi">TRUE</code>.<br>
    This function should include lower-priority kernel-mode interrupt handler
    code.<br>
    The return value of this function determines the amount of times that the
    application's user-mode interrupt handler routine will be invoked (if at
    all).
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span>
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called when WinDriver receives an MSI or MSI-&#65279;X, provided MSI/MSI-&#65279;X was
    enabled for the received interrupt with a handle to the Kernel PlugIn. This
    is the function that will handle your MSI/MSI-&#65279;X in the kernel mode. The
    function runs at high interrupt request level. Additional deferred
    processing of the interrupt can be performed in <code class="japi">KP_IntAtDpcMSI</code>
    and also in the user mode (see below).<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    <span style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span>
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Called if the <span style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><span> callback</span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span> has requested
    deferred handling of an MSI/MSI-&#65279;X interrupt by returning
    <code class="japi">TRUE</code>.<br>
    This function should include lower-priority kernel-mode MSI/MSI-&#65279;X handler
    code.<br>
    The return value of this function determines the amount of times that the
    application's user-mode interrupt handler routine will be invoked (if at
    all).<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top"><span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span></td><td style="" align="left" valign="top">
    
    Called when a Plug&#65279;-&#65279;and&#65279;-&#65279;Play or power management event occurs, provided the
    user-mode application previously registered to receive notifications for
    this event in the Kernel PlugIn by calling <span style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span>
    with the <code class="japi">fUseKP</code> parameter set to <code class="japi">TRUE</code> (after
    having opened a Kernel PlugIn handle), or by calling the low&#65279;-&#65279;level
    <code class="jfunc">EventRegister</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) or
    <code class="jfunc">WD_EventRegister</code><span class="jfunc">()</span> functions with a handle to a Kernel PlugIn
    driver (set in the <code class="japi">hKernelPlugIn</code> field of the
    <code class="japi">WD_EVENT</code> structure that is passed to the function).
    
  </td></tr></tbody></table></div><p>

As indicated above, these handlers will be called (respectively) when the
user-mode program opens/closes a handle to Kernel PlugIn driver<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [12.5]</fo:inline></a>, sends a message to the Kernel PlugIn driver (by calling
<code class="jfunc">WDC_CallKerPlug</code><span class="jfunc">()</span> / <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span>), enables
interrupts with a Kernel PlugIn driver (by calling <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span>
with the <code class="japi">fUseKP</code> parameter set to <code class="japi">TRUE</code>, after having
opened a handle to the Kernel PlugIn / calling <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>
or <code class="jfunc">WD_InterruptEnable</code><span class="jfunc">()</span> with a handle to the Kernel PlugIn set in
the <code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_INTERRUPT</code> structure
that is passed to function), or disables interrupts
(<code class="jfunc">WDC_IntDisable</code><span class="jfunc">()</span>/ <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> /
<code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span>) that have been enabled using a Kernel PlugIn
driver;<br>


The Kernel PlugIn interrupt handlers will be called when an interrupt occurs,
if the interrupts were enabled using a Kernel PlugIn driver (see above).<br>
The Kernel PlugIn event handler will be called when a Plug&#65279;-&#65279;and&#65279;-&#65279;Play or power
management event occurs, if the application registered to receive notifications
for the event that occurred using a Kernel PlugIn driver (by calling
<code class="jfunc">WDC_EventRegister</code><span class="jfunc">()</span> with the <code class="japi">fUseKP</code> parameter set to
<code class="japi">TRUE</code>, after having opened the device with a Kernel PlugIn /
calling <code class="jfunc">EventRegister</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) or
<code class="jfunc">WD_EventRegister</code><span class="jfunc">()</span> with a handle to a Kernel PlugIn driver set in
the <code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_EVENT</code> structure
that is passed to the function).

</p><p>
In addition to defining the Kernel PlugIn callback functions, you can implement
code to perform any required initialization for the Kernel PlugIn in your
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><span> callback(s)</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>. In the sample <span class="jprintfilename"><strong>KP_PCI</strong></span>
driver and in the generated DriverWizard Kernel PlugIn driver, for example,
the Kernel PlugIn open callbacks also call the shared library's initialization
function and allocate memory for the Kernel PlugIn driver context, which is
then used to store the device information that was passed to the function from
the user mode.
</p><p>
From the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample (<span class="jprintfilename"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/&#65279;<span class="jprintfilename"><strong>kp_pci.c</strong></span></strong></span>):
</p>
<pre class="screen">/* KP_PCI_Open is called when WD_KernelPlugInOpen() is called from the
   user mode.
   pDrvContext will be passed to the rest of the Kernel PlugIn callback
   functions. */
BOOL __cdecl KP_PCI_Open(KP_OPEN_CALL *kpOpenCall, HANDLE hWD, PVOID pOpenData,
    PVOID *ppDrvContext)
{
    PCI_DEV_ADDR_DESC *pDevAddrDesc;
    WDC_ADDR_DESC *pAddrDesc;
    DWORD dwSize;
    DWORD dwStatus;

    /* Initialize the PCI library */
    dwStatus = PCI_LibInit();
    if (WD_STATUS_SUCCESS != dwStatus)
    {
        KP_PCI_Err("KP_PCI_Open: Failed to initialize the PCI library: %s",
            PCI_GetLastErr());
        return FALSE;
    }

    KP_PCI_Trace("KP_PCI_Open entered. PCI library initialized.\n");

    kpOpenCall-&gt;funcClose = KP_PCI_Close;
    kpOpenCall-&gt;funcCall = KP_PCI_Call;
    kpOpenCall-&gt;funcIntEnable = KP_PCI_IntEnable;
    kpOpenCall-&gt;funcIntDisable = KP_PCI_IntDisable;
    kpOpenCall-&gt;funcIntAtIrql = KP_PCI_IntAtIrql;
    kpOpenCall-&gt;funcIntAtDpc = KP_PCI_IntAtDpc;
    kpOpenCall-&gt;funcIntAtIrqlMSI = KP_PCI_IntAtIrqlMSI;
    kpOpenCall-&gt;funcIntAtDpcMSI = KP_PCI_IntAtDpcMSI;
    kpOpenCall-&gt;funcEvent = KP_PCI_Event;

    /* Create a copy of device information in the driver context */
    dwSize = sizeof(PCI_DEV_ADDR_DESC);
    pDevAddrDesc = malloc(dwSize);
    if (!pDevAddrDesc)
        goto malloc_error;

    COPY_FROM_USER(pDevAddrDesc, pOpenData, dwSize);
    dwSize = sizeof(WDC_ADDR_DESC) * pDevAddrDesc-&gt;dwNumAddrSpaces;
    pAddrDesc = malloc(dwSize);
    if (!pAddrDesc)
        goto malloc_error;

    COPY_FROM_USER(pAddrDesc, pDevAddrDesc-&gt;pAddrDesc, dwSize);
    pDevAddrDesc-&gt;pAddrDesc = pAddrDesc;
    *ppDrvContext = pDevAddrDesc;

    KP_PCI_Trace("KP_PCI_Open: Kernel PlugIn driver opened successfully\n");

    return TRUE;

malloc_error:
    KP_PCI_Err("KP_PCI_Open: Failed allocating %ld bytes\n", dwSize);
    if (pDevAddrDesc)
        free(pDevAddrDesc);
    PCI_LibUninit();
    return FALSE;
}</pre>
<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The <span class="jprintfilename"><strong>KP_PCI</strong></span> sample also defines a similar
<code class="japi">KP_PCI_Open_32_64</code> callback, for use when opening a handle to a
64-&#65279;bit Kernel PlugIn from a 32-&#65279;bit application.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_cbs_write"></a>11.6.2.4. Write the Remaining PlugIn Callbacks</h4></div></div></div><p>
Implement the remaining Kernel PlugIn routines that you wish to use (such as
the <code class="japi">KP_Intxxx</code> functions &#8212; for handling interrupts, or
<code class="japi">KP_Event</code> &#8212; for handling Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management
events).
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="samp_gen_KP_code"></a>11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview</h3></div></div></div><p>
You can use DriverWizard to generate a skeletal Kernel PlugIn driver for your
device, and use the generated code as the basis for your Kernel PlugIn driver
development (recommended); alternatively, you can use one of the Kernel PlugIn
WinDriver samples as the basis for your Kernel PlugIn development.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The Kernel PlugIn documentation in this manual focuses on the generated
  DriverWizard code, and the generic PCI Kernel PlugIn sample &#8212;
  <span class="jprintfilename"><strong>KP_PCI</strong></span>, located in the <span class="jdirectory"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</strong></span> directory.<br>
  If you are using the a PCI Express card with the Xilinx Bus Master DMA (BMD) design, you
  can also use the <span class="jprintfilename"><strong>KP_BMD</strong></span> Kernel PlugIn sample as the
  basis for your development; the <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span> directory
  contains all the relevant sample files &#8212; see the
  <a class="xref" href="#xilinx_bmd_sample_kp_dir_struct" title="Xilinx BMD Kernel PlugIn Directory Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Xilinx BMD Kernel PlugIn directory structure note</fo:inline></a> at the end of
  <a class="xref" href="#pci_diag_kp_pci_dir" title="11.6.4.1. pci_diag and kp_pci Sample Directories"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.4.1</fo:inline></a>.
</td></tr></table></div><p>
The Kernel PlugIn driver is not a standalone module. It requires a user-mode
application that initiates the communication with the driver. A relevant
application will be generated for your driver when using DriverWizard to
generate Kernel PlugIn code. The <span class="jprintfilename"><strong>pci_diag</strong></span>
application (found under the <span class="jdirectory"><strong>WinDriver/samples/pci_diag</strong></span>
directory) communicates with the sample <span class="jprintfilename"><strong>KP_PCI</strong></span> driver.
</p><p>
Both the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample and the wizard-generated code demonstrate
communication between a user-mode application
(<span class="jprintfilename"><strong>pci_diag</strong></span> /
<span class="jprintfilename"><strong>xxx_diag</strong></span> &#8212; where
<span class="jprintfilename"><strong>xxx</strong></span> is the name you selected for your
generated driver project) and a Kernel PlugIn driver
(<span class="jprintfilename"><strong>kp_pci.sys/.o/.ko<span xmlns:fo="http://www.w3.org/1999/XSL/Format">/.kext</span></strong></span> /
  <span class="jprintfilename"><strong>kp_xxx.sys/.o/.ko<span xmlns:fo="http://www.w3.org/1999/XSL/Format">/.kext</span></strong></span> &#8212; depending on the OS).
</p><p>
The sample/generated code demonstrates how to pass data to the Kernel PlugIn's
<code class="japi">KP_Open</code> function, and how to use this function to allocate and
store a global Kernel PlugIn driver context that can be used by other functions
in the Kernel PlugIn.
</p><p>
The sample/generated Kernel PlugIn code implements a message for getting the
driver's version number, in order to demonstrate how to initiate specific
functionality in the Kernel PlugIn from the user mode and how to pass data
between the Kernel PlugIn driver and a user-mode WinDriver application via
messages.
</p><p>
The sample/generated code also demonstrates how to handle interrupts in the
Kernel PlugIn. The Kernel PlugIn implements an interrupt counter and interrupt
handlers, including deferred processing interrupt handling, which is used to
notify the user-mode application of the arrival of every fifth incoming
interrupt.<br>
The <span class="jprintfilename"><strong>KP_PCI</strong></span> sample's <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> and
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span> functions demonstrate legacy level-sensitive PCI
interrupt handling. As indicated in the comments of the sample
<code class="japi">KP_IntAtIrql</code> function, you will need to modify this function in
order to implement the correct code for acknowledging the interrupt on your
specific device, since interrupt acknowledgment is hardware-specific. The
sample <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span> functions
demonstrate handling of Message-Signaled Interrupts (MSI) and Extended Message-Signaled Interrupts (MSI-&#65279;X) (see
detailed information in <a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a>).<br>
The <span class="b"><strong>generated DriverWizard code</strong></span> will include sample interrupt handler
code for the selected device (PCI&#65279;/&#65279;ISA). The generated
<code class="japi">KP_IntAtIrql</code> function will include code to implement any
interrupt transfer commands defined in the wizard (by assigning registers
read/write commands to the card's interrupt in the
<span class="jmenuitem"><strong>Interrupt</strong></span> tab). For legacy PCI interrupts,
which need to be acknowledged in the kernel when the interrupt is received (see
<a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a>), it is recommended that you use the
wizard to define the commands for acknowledging (clearing) the interrupt,
before generating the Kernel PlugIn code, so that the generated code will
already include the required code for executing the commands you defined.
It is also recommended that you prepare such transfer commands when handling
interrupts for hardware that supports MSI/MSI-&#65279;X, in case enabling of
MSI/MSI-&#65279;X fails and the interrupt handling defaults to using level-sensitive
interrupts (if supported by the hardware).<br>

Note: Memory allocated for the transfer commands must remain available
  until the interrupts are disabled
.
</p><p>
In addition, the sample/generated code demonstrates how to receive
notifications of Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management events in the Kernel PlugIn.
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
We recommend that you build and run the sample/generated Kernel PlugIn project
(and corresponding user-mode application) "as-is" before modifying the code
or writing your own Kernel PlugIn driver. Note, however, that you will need to
modify or remove the hardware-specific transfer commands in the sample's
<code class="japi">KP_IntAtIrql</code> function, as explained above.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_dir_structure"></a>11.6.4. Kernel PlugIn Sample/Generated Code Directory Structure</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="pci_diag_kp_pci_dir"></a>11.6.4.1. pci_diag and kp_pci Sample Directories</h4></div></div></div><p>
The <span class="jprintfilename"><strong>KP_PCI</strong></span> Kernel PlugIn sample code is implemented in the
<span class="jprintfilename"><strong>kp_pci.c</strong></span> file. This sample driver is part of the WinDriver PCI
diagnostics sample &#8212; <span class="jprintfilename"><strong>pci_diag</strong></span> &#8212;
which contains, in addition to the <span class="jprintfilename"><strong>KP_PCI</strong></span> driver, a user-mode
application that communicates with the driver
(<span class="jprintfilename"><strong>pci_diag</strong></span>) and a shared library that includes
APIs that can be utilized by both the user-mode application and the
Kernel PlugIn driver. The source files for this sample are implemented in C.
</p><p>
Following is an outline of the files found in the
<span class="jdirectory"><strong>WinDriver/samples/pci_diag</strong></span> directory:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>kp_pci</strong></span> &#8212; Contains the <span class="jprintfilename"><strong>KP_PCI</strong></span> Kernel PlugIn
    driver files:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="jprintfilename"><strong>kp_pci.c</strong></span>: The source code of the <span class="jprintfilename"><strong>KP_PCI</strong></span>
        driver.
      </li><li class="listitem">
        Project and/or make files and related files for building the
        Kernel PlugIn driver.<br>
        
  The Windows project/make files are located in subdirectories for the
  target development environment (<span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span>/<span class="jdirectory"><strong>win_gcc</strong></span>) under
  <span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit) and <span class="jdirectory"><strong>amd64</strong></span>
  (64-&#65279;bit) directories.
  <br>
        The Linux makefile is generated using a
        <span class="jprintfilename"><strong>configure</strong></span> script, located directly
        under the <span class="jdirectory"><strong>kp_pci</strong></span> directory.
        </li><li class="listitem">
        A pre-compiled version of the <span class="jprintfilename"><strong>KP_PCI</strong></span> Kernel PlugIn driver
        for the target OS:
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
            Windows x86 32-&#65279;bit:
            <span class="jprintfilename"><strong>WINNT.i386\kp_pci.sys</strong></span>
            &#8212; a 32-&#65279;bit version of the driver, built for Windows 7 and
            higher.
          </li><li class="listitem">
            Windows x64:
            <span class="jprintfilename"><strong>WINNT.x86_64\kp_pci.sys</strong></span>
            &#8212; a 64-&#65279;bit version of the driver, built for
            Windows Server 2003 and higher.
          </li><li class="listitem">
            Linux: There is no pre-compiled version of the driver for Linux,
            since Linux kernel modules must be compiled with the header files
            from the kernel version installed on the target &#8212; see
            <a class="xref" href="#dist_linux" title="14.3. Linux Driver Distribution"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.3</fo:inline></a>.
          </li></ul></div></li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>pci_lib.c</strong></span>: Implementation of a library for
    accessing PCI devices using WinDriver's WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>. The
    library's API is used both by the user-mode application
    (<span class="jprintfilename"><strong>pci_diag.c</strong></span>) and by the Kernel PlugIn
    driver (<span class="jprintfilename"><strong>kp_pci.c</strong></span>).
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>pci_lib.h</strong></span>: Header file, which provides the
    interface for the <span class="jprintfilename"><strong>pci_lib</strong></span> library.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>pci_diag.c</strong></span>: Implementation of a sample
    diagnostics user-mode console (CUI) application, which demonstrates
    communication with a PCI device using the
    <span class="jprintfilename"><strong>pci_lib</strong></span> and
    <span class="jprintfilename"><strong>WDC</strong></span> libraries.<br>
    The sample also demonstrates how to communicate with a Kernel PlugIn
    driver from a user-mode WinDriver application. By default, the sample
    attempts to open the selected PCI device with a handle to the
    <span class="jprintfilename"><strong>KP_PCI</strong></span> Kernel PlugIn driver. If successful, the sample
    demonstrates how to interact with a Kernel PlugIn driver, as detailed in
    <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.3</fo:inline></a>. If the application fails to open a
    handle to the Kernel PlugIn driver, all communication with the device is
    performed from the user mode.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>pci.inf</strong></span> (Windows): A sample WinDriver PCI INF
    file for Windows. NOTE: To use this file, change the vendor and device IDs
    in the file to comply with those of your specific device.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    To use Message-Signaled Interrupts (MSI) or Extended Message-Signaled Interrupts (MSI-&#65279;X) on Windows 7 and higher (for PCI
    cards that support MSI/MSI-&#65279;X) you will need to modify or replace the
    sample INF file so that your INF file includes specific MSI information;
    otherwise WinDriver will attempt to use legacy level-sensitive interrupt
    handling for your card, as explained in
    <a class="xref" href="#win_msi_inf_files" title="9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.7.1</fo:inline></a> of the manual.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Project and/or make files for building the
    <span class="jprintfilename"><strong>pci_diag</strong></span> user-mode application.<br>
    
  The Windows project/make files are located in subdirectories for the
  target development environment (<span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span>/<span class="jdirectory"><strong>win_gcc</strong></span>) under
  <span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit) and <span class="jdirectory"><strong>amd64</strong></span>
  (64-&#65279;bit) directories.
  
    The <span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span> MS Visual Studio directories also include solution files for building both the
    Kernel PlugIn driver and user-mode application projects.
  <br>
    The Linux makefile is located under a <span class="jdirectory"><strong>LINUX</strong></span>
    subdirectory.
    </li><li class="listitem" style="list-style-type: disc">
    A pre-compiled version of the user-mode application
    (<span class="jprintfilename"><strong>pci_diag</strong></span>) for your target operating
    system:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        Windows:
        <span class="jprintfilename"><strong>WIN32\pci_diag.exe</strong></span></li><li class="listitem">
        Linux:
        <span class="jprintfilename"><strong>LINUX/pci_diag</strong></span></li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>files.txt</strong></span>: A list of the sample
    <span class="jprintfilename"><strong>pci_diag</strong></span> files.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>readme.txt</strong></span>: An overview of the sample
    Kernel PlugIn driver and user-mode application and instructions for
    building and testing the code.
  </li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Xilinx BMD Kernel PlugIn Directory Structure"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"><a name="xilinx_bmd_sample_kp_dir_struct"></a>Xilinx BMD Kernel PlugIn Directory Structure</th></tr><tr><td align="left" valign="top">
The structure of the sample directory for PCI Express cards with the
Xilinx Bus Master DMA (BMD) design &#8212; <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span> &#8212; is similar to
that of the generic PCI sample's <span class="jdirectory"><strong>pci_diag</strong></span> directory,
except for the following issues: the <span class="jprintfilename"><strong>bmd_diag</strong></span> user-mode application
files are located under a <span class="jdirectory"><strong>diag</strong></span> subdirectory, and the
<span class="jdirectory"><strong>kp</strong></span> subdirectory, which contains the Kernel PlugIn driver's
(<span class="jprintfilename"><strong>KP_BMD</strong></span>) source files, currently has make files only for
Windows.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_gen_dir"></a>11.6.4.2. The Generated DriverWizard Kernel PlugIn Directory</h4></div></div></div><p>
The generated DriverWizard Kernel PlugIn code for your device will include a
kernel-mode Kernel PlugIn project and a user-mode application that
communicates with it. As opposed to the generic <span class="jprintfilename"><strong>KP_PCI</strong></span> and
<span class="jprintfilename"><strong>pci_diag</strong></span> sample, the wizard-generated code
will utilize the resources information detected and/or defined for your
specific device, as well as any device-specific information that you define in
the wizard before generating the code.
</p><p>
As indicated in <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.3</fo:inline></a>, when using the driver
to handle legacy PCI interrupts, it is highly recommended that you
define the registers that need to be read/written in order to acknowledge the
interrupt, and set up the relevant read/write commands from/to these registers
in DriverWizard, before generating the code, thus enabling the generated
interrupt handler code to utilize the hardware-specific information that you
defined. It is also recommended that you prepare such transfer commands when
handling interrupts for hardware that supports MSI/MSI-&#65279;X, in case enabling of
MSI/MSI-&#65279;X fails and the interrupt handling defaults to using level-sensitive
interrupts (if supported by the hardware).<br>

Note: Memory allocated for the transfer commands must remain available
  until the interrupts are disabled
.
</p><p>
Following is an outline of the generated DriverWizard files when selecting to
generate Kernel PlugIn code (where <span class="jprintfilename"><strong>xxx</strong></span>
signifies the name that you selected for the driver when generating the code).
NOTE: The outline below relates to the generated C code, but on Windows you can
also generate similar C&#65279;# code, which includes a C Kernel PlugIn driver
(since kernel-mode drivers cannot be implemented in C&#65279;#), a .NET
C&#65279;# library, and a C&#65279;# user-mode application that communicates
with the Kernel PlugIn driver.
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>kermode</strong></span> &#8212; Contains the
    <span class="jprintfilename"><strong>KP_XXX</strong></span> Kernel PlugIn driver files:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="jprintfilename"><strong>kp_xxx.c</strong></span>: The source code of the
        <span class="jprintfilename"><strong>KP_XXX</strong></span> driver.
      </li><li class="listitem">
        Project and/or make files and related files for building the
        Kernel PlugIn driver.<br>
        
  The Windows project/make files are located in subdirectories for the
  target development environment (<span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span>/<span class="jdirectory"><strong>win_gcc</strong></span>) under
  <span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit) and <span class="jdirectory"><strong>amd64</strong></span>
  (64-&#65279;bit) directories.
  <br>
        The Linux makefile is generated using a
        <span class="jprintfilename"><strong>configure</strong></span> script, located in a
        <span class="jdirectory"><strong>linux</strong></span> subdirectory.
        </li></ul></div></li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_lib.c</strong></span>: Implementation of a library for
    accessing your device using WinDriver's WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>. The
    library's API is used both by the user-mode application
    (<span class="jprintfilename"><strong>xxx_diag</strong></span>) and by the Kernel PlugIn driver
    (<span class="jprintfilename"><strong>KP_XXX</strong></span>).
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_lib.h</strong></span>: Header file, which provides the
    interface for the <span class="jprintfilename"><strong>xxx_lib</strong></span> library.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_diag.c</strong></span>: Implementation of a sample
    diagnostics user-mode console (CUI) application, which demonstrates
    communication your device using the
    <span class="jprintfilename"><strong>xxx_lib</strong></span> and
    <span class="jprintfilename"><strong>WDC</strong></span> libraries.<br>
    The application also demonstrates how to communicate with a Kernel PlugIn
    driver from a user-mode WinDriver application. By default, the
    application attempts to open your device with a handle to the
    <span class="jprintfilename"><strong>KP_XXX</strong></span> Kernel PlugIn driver. If
    successful, the application demonstrates how to interact with a Kernel
    PlugIn driver, as detailed in <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.3</fo:inline></a>. If
    the application fails to open a handle to the Kernel PlugIn driver, all
    communication with the device is performed from the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    Project and/or make files for building the
    <span class="jprintfilename"><strong>xxx_diag</strong></span> user-mode application.<br>
    
  The Windows project/make files are located in subdirectories for the
  target development environment (<span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span>/<span class="jdirectory"><strong>win_gcc</strong></span>) under
  <span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit) and <span class="jdirectory"><strong>amd64</strong></span>
  (64-&#65279;bit) directories.
  
    The <span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span> MS Visual Studio directories also include solution files for building both the
    Kernel PlugIn driver and user-mode application projects.
  <br>
    The Linux makefile is located in a <span class="jdirectory"><strong>linux</strong></span>
    subdirectory.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx_files.txt</strong></span>: A list of the generated
    files and instructions for building the code.
  </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>xxx.inf</strong></span> (Windows): A WinDriver INF file for
    your device. This file is required only when creating a Windows driver for
    a Plug&#65279;-&#65279;and&#65279;-&#65279;Play device, such as PCI.
  </li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_int_handling"></a>11.6.5. Handling Interrupts in the Kernel PlugIn</h3></div></div></div><p>
Interrupts will be handled in the Kernel PlugIn driver, if enabled, using a
Kernel PlugIn driver, as explained below<a class="xref" href="#kernel_int_handling_w_kp" title="11.6.5.2. Interrupt Handling in the Kernel (Using the Kernel PlugIn)"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11.6.5.2]</fo:inline></a>.
</p><p>
If Kernel PlugIn interrupts were enabled, when WinDriver receives a hardware
interrupt, it calls the Kernel PlugIn driver's high-IRQL
handler &#8212; <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>
    (MSI/MSI-&#65279;X). If the high-IRQL handler returns
<code class="japi">TRUE</code>, the relevant deferred Kernel PlugIn interrupt
handler &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.9]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.11]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; will be called after the
high-IRQL handler completes its processing and returns. The return value of the
DPC function determines how many times (if at all) the user-mode interrupt
handler routine will be executed. In the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample, for
example, the Kernel PlugIn interrupt handler code counts five interrupts, and
notifies the user mode on every fifth interrupt; thus <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span>
(see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) will return on only one out of every five incoming
interrupts in the user mode. The high-IRQL handler &#8212; <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a> or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>
&#8212; returns <code class="japi">TRUE</code> every five interrupts to activate the DPC
handler &#8212; <code class="japi">KP_IntAtDpc</code> or <code class="japi">KP_IntAtDpcMSI</code> &#8212; and the DPC function
returns the number of accumulated DPC calls from the high-IRQL handler. As a
result, the user-mode interrupt handler will be executed once for every 5
interrupts.
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="user_mode_int_handling"></a>11.6.5.1. Interrupt Handling in the User Mode
  (Without the Kernel PlugIn)</h4></div></div></div><p>
If the Kernel PlugIn interrupt handle is not enabled, then each incoming
interrupt will cause <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> to return, and your user-mode
interrupt handler routine will be invoked once WinDriver completes the kernel
processing of the interrupts (mainly executing the interrupt transfer commands
passed in the call to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the low&#65279;-&#65279;level
<code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> or <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions &#8212;
see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) &#8212; see <a class="xref" href="#int_handling_no_kp" title="Figure 11.2. Interrupt Handling Without Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Figure 11.2</fo:inline></a>.
</p><div class="figure"><a name="int_handling_no_kp"></a><p class="title"><b>Figure 11.2. Interrupt Handling Without Kernel PlugIn</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/int_handling_no_kp.png" height="" alt="Interrupt Handling Without Kernel PlugIn"></div></div></div><br class="figure-break"></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kernel_int_handling_w_kp"></a>11.6.5.2. Interrupt Handling in the Kernel (Using the Kernel PlugIn)</h4></div></div></div><p>
To have the interrupts handled by the Kernel PlugIn, the user-mode application
should open a handle to a Kernel PlugIn driver (as explained in
<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.5</fo:inline></a>), and then call
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> with the <code class="japi">fUseKP</code> parameter set to
<code class="japi">TRUE</code>.
</p><p>
If your are not using the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_xxx</code></span><span> API</span><a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline> [B.2]</fo:inline></a></span>,
your application should pass a handle to the Kernel PlugIn driver to the
<code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> function or the wrapper
<code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> function (which calls
<code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> and <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span>). This enables the
Kernel PlugIn interrupt handler. (The Kernel PlugIn handle is passed within the
<code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_INTERRUPT</code> structure
that is passed to the functions.) For details regarding the low&#65279;-&#65279;level
<code class="jfunc">WD_xxx</code><span class="jfunc">()</span> API, refer to the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p><div class="figure"><a name="int_handling_with_kp"></a><p class="title"><b>Figure 11.3. Interrupt Handling With the Kernel PlugIn</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/int_handling_with_kp.png" height="" alt="Interrupt Handling With the Kernel PlugIn"></div></div></div><br class="figure-break"><p>
When calling <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> / <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> /
<code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> to enable interrupts in the Kernel PlugIn, your
Kernel PlugIn's <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntEnable</code></span><span> callback function</span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> is
activated. In this function you can set the interrupt context that will be
passed to the Kernel PlugIn interrupt handlers, as well as write to the device
to actually enable the interrupts in the hardware and implement any other code
required in order to correctly enable your device's interrupts.
</p><p>
If the Kernel PlugIn interrupt handler is enabled, then the relevant high-IRQL
handler, based on the type of interrupt that was enabled &#8212;
<code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; will be called for each incoming
interrupt. The code in the high-IRQL handler is executed at high interrupt
request level. While this code is running, the system is halted, i.e., there
will be no context switches and no lower-priority interrupts will be handled.
</p><p>
Code running at high IRQL is limited in the following ways:
  
  </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      It may only access non-pageable memory.
    </li><li class="listitem" style="list-style-type: disc">
      It may only call the following functions (or wrapper functions that call
      these functions):
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><code class="jfunc">WDC_xxx</code><span class="jfunc">()</span> read/write address or configuration space
            functions.
          </li><li class="listitem" style="list-style-type: disc"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MultiTransfer</code><span class="japi">()</span></span><a class="xref" href="#WDC_MultiTransfer" title="B.3.30. WDC_MultiTransfer()"><fo:inline> [B.3.30]</fo:inline></a></span>, or the low&#65279;-&#65279;level
            <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span>, <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span>, or
            <code class="jfunc">WD_DebugAdd</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
          </li><li class="listitem" style="list-style-type: disc">
            Specific kernel OS functions (such as WDK functions) that can be
            called from high interrupt request level. Note that the use of such
            functions may break the code's portability to other operating
            systems.
          </li></ul></div></li><li class="listitem" style="list-style-type: disc">
      It may <span class="b"><strong>not</strong></span> call <code class="jfunc">malloc</code><span class="jfunc">()</span>, <code class="jfunc">free</code><span class="jfunc">()</span>, or any
      <code class="japi">WDC_xxx</code> or <code class="japi">WD_xxx</code> API other than those listed
      above.
    </li></ul></div><p>
</p><p>
Because of the aforementioned limitations, the code in the high-IRQL handler
(<code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a> or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>) should be kept to a minimum, such as acknowledgment
(clearing) of level-sensitive interrupts. Other code that you want to run in
the interrupt handler should be implemented in the DPC function
(<code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.11]</fo:inline></a>), which runs at a deferred interrupt level and does not
face the same limitations as the high-IRQL handlers. The DPC function is called
after its matching high-IRQL function returns, provided the high-IRQL handler
returns <code class="japi">TRUE</code>.
</p><p>
You can also leave some additional interrupt handling to the user mode. The
return value of your DPC function &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.11]</fo:inline></a> &#8212;
determines the amount of times (if any) that your user-mode interrupt handler
routine will be called after the kernel-mode interrupt processing is completed.
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_message_passing"></a>11.6.6. Message Passing</h3></div></div></div><p>
The WinDriver architecture enables a kernel-mode function to be activated from the
user mode by passing a message from the user mode to the Kernel PlugIn driver
using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> or the low&#65279;-&#65279;level
<code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
The messages are defined by the developer in a header file that is common to
both the user-mode and kernel-mode plugin parts of the driver. In the
<span class="jprintfilename"><strong>pci_diag</strong></span> <span class="jprintfilename"><strong>KP_PCI</strong></span> sample and the
generated DriverWizard code, the messages are defined in the shared library
header file &#8212; <span class="jprintfilename"><strong>pci_lib.h</strong></span> in the sample or
<span class="jprintfilename"><strong>xxx_lib.h</strong></span> in the generated code.
</p><p>
Upon receiving the message from the user mode, WinDriver will execute the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> Kernel PlugIn callback function, which identifies the
message that has been received and executes the relevant code for this message
(as implemented in the Kernel PlugIn).
</p><p>
The sample/generated Kernel PlugIn code implement a message for getting the
driver's version in order to demonstrate Kernel PlugIn data passing. The
code that sets the version number in <code class="japi">KP_Call</code> is executed in the
Kernel PlugIn whenever the Kernel PlugIn receives a relevant message from
the user-mode application. You can see the definition of the message in the
shared <span class="jprintfilename"><strong>pci_lib.h</strong></span> /
<span class="jprintfilename"><strong>xxx_lib.h</strong></span> shared header file. The user-mode
application (<span class="jprintfilename"><strong>pci_diag.exe</strong></span> /
<span class="jprintfilename"><strong>xxx_diag.exe</strong></span>) sends the message to the Kernel
PlugIn driver via the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span>.
</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="kp_create"></a>Chapter 12. Creating a Kernel PlugIn Driver</h1></div></div></div><p>

<span xmlns:fo="http://www.w3.org/1999/XSL/Format"><a name="kp_create_preface"></a></span>The easiest way to write a Kernel PlugIn driver
is to use <span class="b"><strong>DriverWizard</strong></span> to generate the Kernel PlugIn code for your
hardware (see <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections 11.6.3</fo:inline></a> and<a class="xref" href="#kp_gen_dir" title="11.6.4.2. The Generated DriverWizard Kernel PlugIn Directory"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> 11.6.4.2</fo:inline></a>).  Alternatively, you can use one of the WinDriver
<span class="b"><strong>Kernel PlugIn samples</strong></span> as the basis for your Kernel PlugIn development.
You can also develop your code "from scratch", if you wish.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
As indicated in <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.3</fo:inline></a>, the
Kernel PlugIn documentation in this manual focuses on the generated
  DriverWizard code, and the generic PCI Kernel PlugIn sample &#8212;
  <span class="jprintfilename"><strong>KP_PCI</strong></span>, located in the <span class="jdirectory"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</strong></span> directory.<br>
  If you are using the a PCI Express card with the Xilinx Bus Master DMA (BMD) design, you
  can also use the <span class="jprintfilename"><strong>KP_BMD</strong></span> Kernel PlugIn sample as the
  basis for your development; the <span class="jdirectory"><strong>WinDriver/&#65279;xilinx/&#65279;bmd_design</strong></span> directory
  contains all the relevant sample files &#8212; see the
  <a class="xref" href="#xilinx_bmd_sample_kp_dir_struct" title="Xilinx BMD Kernel PlugIn Directory Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Xilinx BMD Kernel PlugIn directory structure note</fo:inline></a> at the end of
  <a class="xref" href="#pci_diag_kp_pci_dir" title="11.6.4.1. pci_diag and kp_pci Sample Directories"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.4.1</fo:inline></a>.
</td></tr></table></div><p>
The following is a step-by-step guide to creating your Kernel PlugIn driver.
</p><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_decide_if_needed"></a>12.1. Determine Whether a Kernel PlugIn is Needed</h2></div></div></div><p>
The Kernel PlugIn should be used only after your driver code has been written
and debugged in the user mode. This way, all of the logical problems of
creating a device driver are solved in the user mode, where development and
debugging are much easier.
</p><p>
Determine whether a Kernel PlugIn should be written by consulting
<a class="xref" href="#performance_improve" title="Chapter 10. Improving Performance"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 10</fo:inline></a>, which explains how to improve the
performance of your driver. In addition, the Kernel PlugIn affords greater
flexibility, which is not always available when writing the driver in the user
mode (specifically with regard to the interrupt handling).
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_languages"></a>12.2. What programming languages can be used with a Kernel PlugIn?</h2></div></div></div>

The Kernel PlugIn is a kernel module, and therefore must be written in the C
language. The user application that calls the Kernel PlugIn can be of any
langauge supported by WinDriver:
C, C#.NET, Visual Basic.NET, Python.<br>
When generating code in the DriverWizard
in languages other than C with Kernel PlugIn, the Kernel PlugIn code will still
be generated in C.
</div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_prepare_user_code"></a>12.3. Prepare the User-Mode Source Code</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Isolate the functions you need to move into the Kernel PlugIn.
  </li><li class="listitem">
    Remove any platform-specific code from the functions. Use only
    functions that can also be used from the kernel.
  </li><li class="listitem">
    Recompile your driver in the user mode.
  </li><li class="listitem">
    Debug your driver in user mode again to see that your code still works
    after changes have been made.
  </li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Keep in mind that the kernel stack is relatively limited in size.
    Therefore, code that will be moved into the Kernel PlugIn should not
    contain static memory allocations. Use the <code class="jfunc">malloc</code><span class="jfunc">()</span> function
    to allocate memory dynamically instead. This is especially important for
    large data structures.
  </li><li class="listitem" style="list-style-type: disc">
    If the user-mode code that you are porting to the kernel accesses memory
    addresses directly using the user-mode mapping of the physical address
    returned from the low&#65279;-&#65279;level <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span>
    function &#8212; note that in the kernel you will need to use the kernel
    mapping of the physical address instead (the kernel mapping is also
    returned by <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span>). For details, refer to the
    description of <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
    <br>
    When using the API of the <span class="jprintfilename"><strong>WDC</strong></span> library<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a> to access memory, you do not need to worry about this,
    since this API ensures that the correct mapping of the memory is used
    depending on whether the relevant APIs are used from the user mode or from
    the kernel mode.
  </li></ul></div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_create_kp_proj"></a>12.4. Create a New Kernel PlugIn Project</h2></div></div></div><p>
As indicated <a class="link" href="#kp_create_preface">above</a><a class="xref" href="#kp_create" title="Chapter 12. Creating a Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [12]</fo:inline></a>, you can use <span class="b"><strong>DriverWizard</strong></span> to generate a new
Kernel PlugIn project (and a corresponding user-mode project) for your device
(recommended), or use one of the WinDriver Kernel PlugIn samples  as the basis for
your development.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">

  To successfully build a Kernel PlugIn project using MS Visual Studio, the path to
  the project directory must not contain any spaces.
</td></tr></table></div><p>
If you select to start your development with the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample,
follow these steps:
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Make a copy of the <span class="jdirectory"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</strong></span> directory. For example, to
    create a new Kernel PlugIn project called
    <span class="jprintfilename"><strong>KP_MyDrv</strong></span>, copy <span class="jdirectory"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</strong></span>
    to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/samples/mydrv</strong></span></span>.
  </li><li class="listitem">
    Change all instances of "KP_PCI" and "kp_pci", in
    all the Kernel PlugIn files in your new directory, to "KP_MyDrv" and
    "kp_mydrv" (respectively).<br>
    The names of the <code class="jfunc">KP_PCI_xxx</code><span class="jfunc">()</span> functions in the
    <span class="jprintfilename"><strong>kp_pci.c</strong></span> files do not have to be changed, but the code will
    be clearer if you use your selected driver name in the function names.
  </li><li class="listitem">
    Change all occurrences of "KP_PCI" in file names to "kp_mydrv".
  </li><li class="listitem">
    To use the shared <span class="jprintfilename"><strong>pci_lib</strong></span> library API from
    your Kernel PlugIn driver and user-mode application, copy the
    <span class="jprintfilename"><strong>pci_lib.h</strong></span> and
    <span class="jprintfilename"><strong>pci_lib.c</strong></span> files from the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/samples/pci_diag</strong></span></span>
    directory to your new <span class="jdirectory"><strong>mydrv</strong></span> directory. You can
    change the names of the library functions to use your driver's name
    (<span class="jprintfilename"><strong>MyDrv</strong></span>) instead of "PCI", but note that in
    this case you will also need to modify the names in all calls to these
    functions from your Kernel PlugIn project and user-mode application. If you
    do not copy the shared library to your new project, you will need to modify
    the sample Kernel PlugIn code and replace all references to the
    <code class="japi">PCI_xxx</code> library APIs with alternative code.
  </li><li class="listitem">
    Modify the files and directory paths in the project and make files, and the
    #include paths in the source files, as needed (depending on the location in
    which you selected to save your new project directory).
  </li><li class="listitem">
    To use the <span class="jprintfilename"><strong>pci_diag</strong></span> user-mode application,
    copy
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/samples/pci_diag/pci_diag.c</strong></span></span>
    and the relevant pci_diag project, solution, or make files to your
    <span class="jdirectory"><strong>mydrv</strong></span> directory, rename the files (if you wish),
    and replace all "pci_diag" references in the files with your preferred
    user-mode application name. To use the solution files, also replace the
    references to "KP_PCI" in the files with your new Kernel PlugIn
    driver, e.g., "KP_MyDrv". Then modify the sample code to implement your
    desired driver functionality.
  </li></ol></div><p>
For a general description of the sample and generated Kernel PlugIn code and
its structure, see <a class="xref" href="#samp_gen_KP_code" title="11.6.3. Sample/Generated Kernel PlugIn Driver Code Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections 11.6.3</fo:inline></a> and<a class="xref" href="#KP_dir_structure" title="11.6.4. Kernel PlugIn Sample/Generated Code Directory Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> 11.6.4</fo:inline></a> (respectively).
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="kp_handle_open"></a>12.5. Open a Handle to the Kernel PlugIn</h2></div></div></div><p>
To open a handle to a Kernel PlugIn driver, <code class="jfunc">WD_KernelPlugIn</code><span class="jfunc">()</span> (see
the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) needs to be called from the user mode. This
low&#65279;-&#65279;level function is called from <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span> &#8212;
when it is called with the name of a Kernel PlugIn driver.
</p><p>
When using the high&#65279;-&#65279;level WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a> you should use
the following method to open a Kernel PlugIn handle:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    First open a regular device handle &#8212; by calling the relevant
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> function without the name of a Kernel
    PlugIn driver. Then call <code class="jfunc">WDC_KernelPlugInOpen</code><span class="jfunc">()</span>, passing to it
    the handle to the opened device. <code class="jfunc">WDC_KernelPlugInOpen</code><span class="jfunc">()</span> opens
    a handle to the Kernel PlugIn driver, and stores it within the
    <code class="japi">kerPlug</code> field of the provided device structure<a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.2]</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    Open a handle to the device, using the relevant
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> function, and pass the name of a Kernel
    PlugIn driver within the function's <code class="japi">pcKPDriverName</code> parameter.
    The device handle returned by the function will also contain (within the
    <code class="japi">kerPlug</code> field) a Kernel PlugIn handle opened by the function.

    <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    This method <em class="it">cannot</em> be used to open a handle to a 64-&#65279;bit Kernel
    PlugIn driver from a 32-&#65279;bit application, or to open a Kernel PlugIn
    handle from a .NET application.
    </td></tr></table></div></li></ul></div><p>
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To ensure that your code works correctly in all the supported configurations,
use the first method described above.
</td></tr></table></div><p>
The generated DriverWizard and the sample
<span class="jprintfilename"><strong>pci_diag</strong></span> shared library
(<span class="jprintfilename"><strong>xxx_lib.c</strong></span> /
<span class="jprintfilename"><strong>pci_lib.c</strong></span>) demonstrate how to open a handle to
the Kernel PlugIn &#8212; see the generated/sample
<code class="jfunc">XXX_DeviceOpen</code><span class="jfunc">()</span>/<code class="jfunc">PCI_DeviceOpen</code><span class="jfunc">()</span> library function
(which is called from the generated/sample
<span class="jprintfilename"><strong>xxx_diag</strong></span>/<span class="jprintfilename"><strong>pci_diag</strong></span>
user-mode application).

</p><p>
The handle to the Kernel PlugIn driver is closed when the
<code class="jfunc">WD_KernelPlugInClose</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is
called from the user mode. When using the low&#65279;-&#65279;level WinDriver API, this
function is called directly from the user-mode application. When using the
high&#65279;-&#65279;level WDC API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>, the function is called
automatically when calling <code class="jfunc">WDC_xxxDeviceClose</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.19]</fo:inline></a> /
    ISA<a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.20]</fo:inline></a>) with a device handle that contains an
open Kernel PlugIn handle.  The function is also called by WinDriver as part of
the application cleanup, for any identified open Kernel PlugIn handles.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KP_int_handling_set"></a>12.6. Set Interrupt Handling in the Kernel PlugIn</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    When calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> (after having opened a handle to
    the Kernel PlugIn driver, as explained in
    <a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.5</fo:inline></a>), set the <code class="japi">fUseKP</code>
    function parameter to <code class="japi">TRUE</code> to indicate that you wish to enable
    interrupts in the Kernel PlugIn driver with which the device was opened.
    <br>
    The generated DriverWizard and the sample
    <span class="jprintfilename"><strong>pci_diag</strong></span> shared library
    (<span class="jprintfilename"><strong>xxx_lib.c</strong></span> /
    <span class="jprintfilename"><strong>pci_lib.c</strong></span>) demonstrate how this should be
    done &#8212; see the generated/sample
    <code class="jfunc">XXX_IntEnable</code><span class="jfunc">()</span>/<code class="jfunc">PCI_IntEnable</code><span class="jfunc">()</span> library function
    (which is called from the generated/sample
    <span class="jprintfilename"><strong>xxx_diag</strong></span>/<span class="jprintfilename"><strong>pci_diag</strong></span>
    user-mode application).
    </p><p>
    If you are not using the <code class="japi">WDC_xxx</code> API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>,
    in order to enable interrupts in the Kernel PlugIn call
    <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> or <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> (which calls
    <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span>), and pass the handle to the Kernel PlugIn
    driver that you received from <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> (within
    the <code class="japi">hKernelPlugIn</code> field of the <code class="japi">WD_KERNEL_PLUGIN</code>
    structure that was passed to the function). For details regarding these
    APIs, refer to the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
    </p></li><li class="listitem">
    When calling <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> / <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>
    / <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span>, to enable interrupts in the Kernel PlugIn,
    WinDriver will activate your Kernel PlugIn's
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntEnable</code></span><span> callback function</span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>. You can implement this
    function to set the interrupt context that will be passed to the high-IRQL
    and DPC Kernel PlugIn interrupt handler routines, as well as write to the
    device to actually enable the interrupts in the hardware, for example, or
    implement any other code required in order to correctly enable your
    device's interrupts.
  </li><li class="listitem">
    Move the implementation of the user-mode interrupt handler, or the relevant
    portions of this implementation, to the Kernel PlugIn's interrupt handler
    functions. High-priority code, such as the code for acknowledging
    (clearing) level-sensitive interrupts, should be moved to the relevant
    high-IRQL handler &#8212; <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; which runs
    at high interrupt request level. Deferred processing of the interrupt can
    be moved to the relevant DPC handler &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.11]</fo:inline></a> &#8212;
    which will be executed once the high-IRQL handler completes it processing
    and returns <code class="japi">TRUE</code>. You can also modify the code to make it more
    efficient, due to the advantages of handling the interrupts directly in the
    kernel, which provides you with greater flexibility (e.g., you can read
    from a specific register and write back the value that was read, or toggle
    specific register bits). For a detailed explanation on how to handle
    interrupts in the kernel using a Kernel PlugIn, refer to
    <a class="xref" href="#KP_int_handling" title="11.6.5. Handling Interrupts in the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.5</fo:inline></a> of the manual.
  </li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KP_io_handling_set"></a>12.7. Set I/&#65279;O Handling in the Kernel PlugIn</h2></div></div></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Move your I/&#65279;O handling code (if needed) from the user mode to the Kernel
    PlugIn message handler &#8212; <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>.
  </li><li class="listitem">
    To activate the kernel code that performs the I/&#65279;O handling from the user
    mode, call <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
    with a relevant message for each of the different functionality that you
    wish to perform in the Kernel PlugIn.<br>
    Implement a different message for each functionality.
  </li><li class="listitem">
    Define these messages in a header file that is shared by the user-mode
    application (which will send the messages) and the Kernel PlugIn driver
    (that implements the messages).<br>
    In the sample/generated DriverWizard Kernel PlugIn projects, the message
    IDs and other information that should be shared by the user-mode
    application and Kernel PlugIn driver are defined in the
    <span class="jprintfilename"><strong>pci_lib.h</strong></span>/<span class="jprintfilename"><strong>xxx_lib.h</strong></span>
    shared library header file.
  </li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KP_compile"></a>12.8. Compile Your Kernel PlugIn Driver</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The Kernel PlugIn is not backward compatible. Therefore, when switching to a
different version of WinDriver, you need to rebuild your Kernel PlugIn driver
using the new version.
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_compilation_windows"></a>12.8.1. Windows Kernel PlugIn Driver Compilation</h3></div></div></div><p>
The sample <span class="jdirectory"><strong>WinDriver\&#65279;samples\&#65279;pci_diag\&#65279;kp_pci</strong></span> Kernel PlugIn directory and the
generated DriverWizard Kernel PlugIn
<span class="jdirectory"><strong>&lt;project_dir&gt;\&#65279;kermode</strong></span> directory (where
<span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span> is the directory in which you
selected to save the generated driver project) contain the following
<span class="b"><strong>Kernel PlugIn</strong></span> project files (where
<span class="jprintfilename"><strong>xxx</strong></span> is the driver name &#8212;
<span class="jprintfilename"><strong>pci</strong></span> for the sample / the name you selected
when generating the code with the wizard):
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>x86</strong></span> &#8212; 32-&#65279;bit project files:<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>msdev_&lt;version&gt;\kp_xxx.vcproj</strong></span>
        &#8212; 32-&#65279;bit MS Visual Studio project file (where <span class="b"><strong>&lt;version&gt;</strong></span>
        signifies the IDE version &#8212; e.g., "2012")
      </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>win_gcc/makefile</strong></span> &#8212;
        32-&#65279;bit Windows GCC (MinGW/Cygwin) makefile
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    <span class="jdirectory"><strong>amd64</strong></span> &#8212; 64-&#65279;bit project files:<br>
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>msdev_&lt;version&gt;\kp_xxx.vcproj</strong></span>
        &#8212; 64-&#65279;bit MS Visual Studio project file (where <span class="b"><strong>&lt;version&gt;</strong></span>
        signifies the IDE version &#8212; e.g., "2012")
      </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>win_gcc/makefile</strong></span> &#8212;
        64-&#65279;bit Windows GCC (MinGW/Cygwin) makefile
      </li></ul></div>
    </li></ul></div><p>
The sample
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver\samples\pci_diag</strong></span></span>
directory and the generated <span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span>
directory contain the following project files for the <span class="b"><strong>user-mode</strong></span>
application that drives the respective Kernel PlugIn driver (where
<span class="jprintfilename"><strong>xxx</strong></span> is the driver name &#8212;
<span class="jprintfilename"><strong>pci</strong></span> for the sample / the name you selected
when generating the code with the wizard):

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>x86</strong></span> &#8212; 32-&#65279;bit project files:<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>msdev_&lt;version&gt;\xxx_diag.vcproj</strong></span>
        &#8212; 32-&#65279;bit MS Visual Studio project file (where <span class="b"><strong>&lt;version&gt;</strong></span>
        signifies the IDE version &#8212; e.g., "2012")
      </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>win_gcc/makefile</strong></span> &#8212;
        32-&#65279;bit Windows GCC (MinGW/Cygwin) makefile
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    <span class="jdirectory"><strong>amd64</strong></span> &#8212; 64-&#65279;bit project files:<br>
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>msdev_&lt;version&gt;\xxx_diag.vcproj</strong></span>
        &#8212; 64-&#65279;bit MS Visual Studio project file (where <span class="b"><strong>&lt;version&gt;</strong></span>
        signifies the IDE version &#8212; e.g., "2012")
      </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>win_gcc/makefile</strong></span> &#8212;
        64-&#65279;bit Windows GCC (MinGW/Cygwin) makefile
      </li></ul></div>
    </li></ul></div><p>
</p><p>
The <span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span> MS Visual Studio directories listed above also contain
<span class="jprintfilename"><strong>xxx_diag.sln</strong></span> solution files that include both
the <span class="b"><strong>Kernel PlugIn</strong></span> and <span class="b"><strong>user-mode</strong></span> projects.
</p><p>
If you used DriverWizard to generate your code and you selected to generate a
dynamic-link library (DLL)
(<a class="xref" href="#step_dw_code_gen"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 6.</fo:inline></a><a class="xref" href="#step_dw_code_gen_add_drv_opt_pci"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">c</fo:inline></a>), the
generated <span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span> directory will also have
a <span class="jdirectory"><strong>libproj</strong></span> DLL project directory. This directory has
<span class="jdirectory"><strong>x86</strong></span> (32-&#65279;bit) and/or <span class="jdirectory"><strong>amd64</strong></span>
(64-&#65279;bit) directories that contain <span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span> directories for your selected
IDEs, and each IDE directory has an
<span class="jprintfilename"><strong>xxx_libapi.vcproj</strong></span> project file for building
the DLL. The DLL is used from the wizard-generated user-mode diagnostics
project (<span class="jprintfilename"><strong>xxx_diag.vcproj</strong></span>).

</p><p>
  To build your Kernel PlugIn driver and respective user-mode application on
  Windows, follow these steps:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Verify that the Windows Driver Kit (WDK) is installed.
  </li><li class="listitem">
    Set the <span class="b"><strong>BASEDIR</strong></span> environment variable to point to the location of the
    directory in which WDK is installed.
    </li><li class="listitem">
    Build the <span class="b"><strong>Kernel PlugIn SYS driver</strong></span>
    (<span class="jprintfilename"><strong>kp_pci.sys</strong></span> &#8212; sample /
    <span class="jprintfilename"><strong>kp_xxx.sys</strong></span> &#8212; wizard-generated code):
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Using MS Visual Studio &#8212; Start Microsoft Visual Studio, and do the following:

        <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p>
            From your driver project directory, open the Visual Studio
            Kernel PlugIn solution file &#8212;
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;project_dir&gt;\msdev_&lt;version&gt;\xxx_diag.sln</strong></span></span>,
            where <span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span> is your driver
            project directory (<span class="jdirectory"><strong>pci_diag</strong></span> for the sample
            code / the directory in which you selected to save the generated
            DriverWizard code), <span class="jdirectory"><strong>msdev_&lt;version&gt;</strong></span> is your target Visual Studio
            directory (e.g., <span class="jdirectory"><strong>msdev_2012</strong></span>), and
            <span class="jprintfilename"><strong>xxx</strong></span> is the driver name
            (<span class="jprintfilename"><strong>pci</strong></span> for the sample / the name you
            selected when generating the code with the wizard).
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
                When using DriverWizard to generate code for MS Visual Studio, you can
                use the <em class="guilabel">IDE to Invoke</em> option to have the
                wizard automatically open the generated solution file in your
                selected IDE, after generating the code files.
              </li><li class="listitem" style="list-style-type: disc">
                
  To successfully build a Kernel PlugIn project using MS Visual Studio, the path to
  the project directory must not contain any spaces.
              </li></ul></div></td></tr></table></div></li><li class="listitem">
            Set the Kernel PlugIn project
            (<span class="jprintfilename"><strong>kp_pci.vcproj</strong></span> /
            <span class="jprintfilename"><strong>kp_xxx.vcproj</strong></span>) as the active
            project.
            </li><li class="listitem">
            Select the active configuration for your target platform: From the
            <span class="jmenuitem"><strong>Build</strong></span> menu, choose
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jmenuitem"><strong>Configuration Manager...</strong></span></span>,
            and select the desired configuration.

            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
            To build the driver for multiple operating systems, select the
            lowest OS version that the driver must support. For example, to
            support Windows 7 and higher (32-&#65279;bit), select either
            <span class="jmenuitem"><strong>Win32 win7 free</strong></span> (release mode) or
            <span class="jmenuitem"><strong>Win32 win7 checked</strong></span> (debug mode).
            </td></tr></table></div>
            </li><li class="listitem">
            Build your driver: Build the project from the
            <span class="jmenuitem"><strong>Build</strong></span> menu or using the relevant shortcut
            key (e.g., <span class="jmenuitem"><strong>F7</strong></span> in Visual Studio 2008).
            </li></ol></div></li><li class="listitem" style="list-style-type: disc">
        Using Windows GCC &#8212; Do the following from your selected
        Windows GCC development environment (MinGW/Cygwin):

        <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
            Change directory to your target Windows GCC Kernel PlugIn
            project directory &#8212;
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>&lt;project_dir&gt;/&lt;kernel_dir&gt;/&lt;CPU&gt;/win_gcc</strong></span></span>,
            where <span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span> is your driver
            project directory (<span class="jdirectory"><strong>pci_diag</strong></span> for the sample
            code / the directory in which you selected to save the generated
            DriverWizard code), <span class="jdirectory"><strong>&lt;kernel_dir&gt;</strong></span> is
            the project's Kernel PlugIn directory (<span class="jdirectory"><strong>kp_pci</strong></span>
            for the sample code / <span class="jdirectory"><strong>kermode</strong></span> for the
            generated code), and <span class="b"><strong>&lt;CPU&gt;</strong></span> is the target CPU
            architecture (<span class="b"><strong>x86</strong></span> for x86 platforms, and <span class="b"><strong>amd64</strong></span> for
            x64 platforms).
            <p>
            For example:

            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
                When building a 32-&#65279;bit version of the sample <span class="jprintfilename"><strong>KP_PCI</strong></span>
                driver &#8212;<br>
                <strong class="jcmd"><code>$ cd WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/x86/win_gcc
                </code></strong>
                </li><li class="listitem" style="list-style-type: disc">
                When building a 64-&#65279;bit wizard-generated
                Kernel PlugIn driver &#8212;<br>
                <strong class="jcmd"><code>
                  $ cd &lt;project_dir&gt;/kermode/amd64/win_gcc
                </code></strong><br>
                &#8212; where <span class="b"><strong>&lt;project_dir&gt;</strong></span> signifies the path to
                your generated DriverWizard project directory (for example,
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>~/WinDriver/wizard/my_projects/my_kp</strong></span></span>).
                </li></ul></div><p>
            </p></li><li class="listitem">
            Edit the <span class="jprintfilename"><strong>ddk_make.bat</strong></span> command in
            the Kernel PlugIn makefile, to set the desired build
            configuration &#8212; namely, the target OS and build mode
            (release &#8212; <code class="japi">free</code>, or debug &#8212;
            <code class="japi">checked</code>). By default, the WinDriver sample and
            wizard-generated makefiles set the target OS parameter to
            Windows 7 (<code class="japi">win7</code> for 32-&#65279;bit / <code class="japi">x64</code> for
            64-&#65279;bit), and the build mode to release (<code class="japi">free</code>).
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   The <span class="jprintfilename"><strong>ddk_make.bat</strong></span> utility is provided
   under the <span class="jdirectory"><strong>WinDriver\util</strong></span> directory, and should be
   automatically identified by Windows when running the build command.
   Run <strong class="jcmd"><code>ddk_make.bat</code></strong> with no parameters to view the available
   options for this utility.
  </li><li class="listitem" style="list-style-type: disc">
    The selected build OS must match the CPU architecture of your WinDriver
    installation. For example, you cannot select the 64-&#65279;bit
    <code class="japi">win7_x64</code> OS flag when using a 32-&#65279;bit WinDriver installation.
  </li><li class="listitem" style="list-style-type: disc">
              To build the driver for multiple operating systems, select the
              lowest OS version that the driver must support. For example, to
              support Windows 7 and higher, set the OS parameter to
              <code class="japi">win7</code> (for 32-&#65279;bit) or <code class="japi">x64</code> (for
              64-&#65279;bit).
            </li></ul></div></td></tr></table></div></li><li class="listitem">
            Build the Kernel PlugIn driver using the <strong class="jcmd"><code>make</code></strong> command.
          </li></ol></div></li></ul></div></li><li class="listitem">
    Build the <span class="b"><strong>user-mode application</strong></span> that drives the Kernel PlugIn
    driver (<span class="jprintfilename"><strong>pci_diag.exe</strong></span> &#8212; sample /
    <span class="jprintfilename"><strong>xxx_diag.exe</strong></span> &#8212; wizard-generated
    code):
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Using MS Visual Studio &#8212;

        <div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
            Set the user-mode project
            (<span class="jprintfilename"><strong>pci_diag.vcproj</strong></span> &#8212;
            sample / <span class="jprintfilename"><strong>xxx_diag.vcproj</strong></span>
            &#8212; wizard-generated code) as the active project.
            </li><li class="listitem">
            Build the application: Build the project from the
            <span class="jmenuitem"><strong>Build</strong></span> menu or using the relevant shortcut
            key (e.g., <span class="jmenuitem"><strong>F7</strong></span> in Visual Studio 2008).
            </li></ol></div></li><li class="listitem" style="list-style-type: disc">
        Using Windows GCC &#8212; Do the following from your selected
        Windows GCC development environment (MinGW/Cygwin):

        <div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">
            Change directory to your target Windows GCC application directory
            &#8212;
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>&lt;project_dir&gt;/&lt;CPU&gt;/win_gcc</strong></span></span>,
            where <span class="jdirectory"><strong>&lt;project_dir&gt;</strong></span> is your driver
            project directory (<span class="jdirectory"><strong>pci_diag</strong></span> for the sample
            code / the directory in which you selected to save the generated
            DriverWizard code), and <span class="b"><strong>&lt;CPU&gt;</strong></span> is the target CPU
            architecture (<span class="b"><strong>x86</strong></span> for x86 platforms, and <span class="b"><strong>amd64</strong></span> for
            x64 platforms).
            <p>
            For example:

            </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
                When building a 32-&#65279;bit version of the sample
                <span class="jprintfilename"><strong>pci_diag</strong></span> application, which
                drives the sample <span class="jprintfilename"><strong>KP_PCI</strong></span> driver &#8212;<br>
                <strong class="jcmd"><code>$ cd
                  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">WinDriver/samples/pci_diag/x86/win_gcc</span>
                  
                </code></strong>
                </li><li class="listitem" style="list-style-type: disc">
                When building a 64-&#65279;bit wizard-generated user-mode
                application that drivers a wizard-generated Kernel PlugIn
                driver &#8212;<br>
                <strong class="jcmd"><code>$ cd &lt;project_dir&gt;/amd64/win_gcc
                </code></strong><br>
                &#8212; where <span class="b"><strong>&lt;project_dir&gt;</strong></span> signifies the path to
                your generated DriverWizard project directory (for example,
                <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>~/WinDriver/wizard/my_projects/my_kp</strong></span></span>).
                </li></ul></div><p>
            </p></li><li class="listitem">
            Build the application using the <strong class="jcmd"><code>make</code></strong> command.
          </li></ol></div>
        </li></ul></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_compilation_linux"></a>12.8.2. Linux Kernel PlugIn Driver Compilation</h3></div></div></div><p>
  To build your Kernel PlugIn driver and respective user-mode application on
  Linux, follow these steps:
  </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Open a shell terminal.
  </li><li class="listitem"><p>
    Change directory to your Kernel PlugIn directory.
    </p><p>
    For example:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        When building the sample <span class="jprintfilename"><strong>KP_PCI</strong></span> driver &#8212;<br>
        <strong class="jcmd"><code>$ cd WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</code></strong>
        </li><li class="listitem" style="list-style-type: disc">
        When building a wizard-generated Kernel PlugIn driver &#8212;<br>
        <strong class="jcmd"><code>$ cd &lt;project_dir&gt;/kermode/linux/</code></strong><br>
        &#8212; where
        <span class="b"><strong>&lt;project_dir&gt;</strong></span> signifies the path to your generated
        DriverWizard project directory (for example,
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>~/WinDriver/wizard/my_projects/my_kp</strong></span></span>).
        </li></ul></div><p>
    </p></li><li class="listitem">
    Generate the <span class="jprintfilename"><strong>makefile</strong></span> using the
    <span class="jprintfilename"><strong>configure</strong></span> script:<br>
    <strong class="jcmd"><code>$ ./configure</code></strong>
    <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If you have renamed the WinDriver kernel
  module<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>, be sure to uncomment the following line
  in your Kernel PlugIn configuration script (by removing the pound sign
  &#8212; "#"), before executing the script, in order to build the driver with
  the <strong class="japib"><code>-&#65279;DWD_DRIVER_NAME_CHANGE</code></strong> flag (see <a class="xref" href="#wd_rename_driver_linux" title="15.2.2. Linux Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.2</fo:inline></a>, <a class="xref" href="#wd_rename_driver_linux_step_kp_cfg_edit_for_renamed_wd"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>):<br><code class="japi"># ADDITIONAL_FLAGS="-DWD_DRIVER_NAME_CHANGE"</code></td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      The configuration script creates a makefile based on the running kernel.
      You may select to use another installed kernel source, by executing the
      script with the
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="japib"><code>--with-kernel-source=&lt;path&gt;</code></strong></span>
      option, where <strong class="japib"><code>&lt;path&gt;</code></strong> is the full path to the kernel
      source directory &#8212; e.g.,
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src/linux</strong></span></span>.<br></li><li class="listitem" style="list-style-type: disc">
      If the Linux kernel version is 2.6.26 or
  higher, the configuration script generates makefiles that use
  <span class="jprintfilename"><strong>kbuild</strong></span> to compile the kernel modules. You
  can force the use of <span class="jprintfilename"><strong>kbuild</strong></span> on earlier
  versions of Linux, by executing the configuration script with the
  <strong class="japib"><code>--enable-kbuild</code></strong> flag.
    </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  For a full list of the configuration script options, use the
  <strong class="jcmd"><code>--help</code></strong> option:<br><strong class="jcmd"><code>./configure --help</code></strong></td></tr></table></div></li><li class="listitem"><a name="kp_compile_linux_step_make"></a>
    Build the Kernel PlugIn module using the <strong class="jcmd"><code>make</code></strong> command.<br>
    This command creates a new <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>LINUX.&lt;kernel version&gt;.&lt;CPU&gt;</strong></span></span> directory, which
    contains the created <span class="jprintfilename"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span></strong></span> driver.
    </li><li class="listitem">
    <p>
    Change directory to the directory that holds the makefile for the sample
    user-mode diagnostics application.
    </p>

    <p>
    For the <span class="jprintfilename"><strong>KP_PCI</strong></span> sample driver &#8212;<br>
    <strong class="jcmd"><code>$ cd ../LINUX/</code></strong>
    </p>

    <p>
    For the generated DriverWizard Kernel PlugIn driver &#8212;<br>
    <strong class="jcmd"><code>$ cd ../../linux/</code></strong>
    </p>
    </li><li class="listitem">
    Compile the sample diagnostics program using the <strong class="jcmd"><code>make</code></strong>
    command.
  </li></ol></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KP_install"></a>12.9. Install Your Kernel PlugIn Driver</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_install_win32"></a>12.9.1. Windows Kernel PlugIn Driver Installation</h3></div></div></div>

  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Driver installation on Windows requires administrator privileges.
  </td></tr></table></div>


<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"> The following steps can also be performed with the <span class="jprintfilename"><strong>wdreg_frontend.exe</strong></span> GUI application. For additional information, refer to <a class="xref" href="#wdreg_frontend" title="13.3. The wdreg_frontend utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.3]</fo:inline></a>.
</td></tr></table></div>

<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Copy the driver file (<span class="jprintfilename"><strong>xxx.sys</strong></span>) to the
    target platform's drivers directory:
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>%windir%\system32\drivers</strong></span></span>
    (e.g.,
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>C:\WINDOWS\system32\drivers</strong></span></span>).
  </li><li class="listitem"><p>
    Register/load your driver, using the
    <span class="jprintfilename"><strong>wdreg.exe</strong></span> or
    <span class="jprintfilename"><strong>wdreg_gui.exe</strong></span> utility:
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    In the following instructions, <span class="jprintfilename"><strong>KP_NAME</strong></span>
    stands for your Kernel PlugIn driver's name, <em class="it">without</em> the .sys
    extension.
    </td></tr></table></div><p>
    To install your driver, run this command:<br>
    <strong class="jcmd"><code>WinDriver\util&gt; wdreg -name KP_NAME install</code></strong>
    </p></li></ol></div>

<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">

  Kernel PlugIn drivers are dynamically loadable &#8212; i.e., they can be
  loaded and unloaded without reboot.
  
    For additional information, refer to
    <a class="xref" href="#dyn_kp_load_windows" title="13.2.3. Dynamically Loading/Unloading Your Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.2.3</fo:inline></a>.
  
</td></tr></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_install_linux"></a>12.9.2. Linux Kernel PlugIn Driver Installation</h3></div></div></div>
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    Change directory to your Kernel PlugIn driver directory.
    </p><p>
    For example, when installing the sample <span class="jprintfilename"><strong>KP_PCI</strong></span> driver, run<br>
    <strong class="jcmd"><code>$ cd WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</code></strong>
    </p><p>
    When installing a driver created using the Kernel PlugIn files generated by
    DriverWizard, run the following command, where <span class="b"><strong>&lt;path&gt;</strong></span>
    signifies the path to your generated DriverWizard project directory (e.g.,
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>~/WinDriver/wizard/my_projects/my_kp</strong></span></span>):
    <br>
    <strong class="jcmd"><code>$ cd &lt;path&gt;/kermode/</code></strong>
    </p></li><li class="listitem">
    Execute the following command to install your Kernel PlugIn driver:

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following command must be executed with root privileges.
  </td></tr></table></div><strong class="jcmd"><code># make install</code></strong></li></ol></div>

<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">

  Kernel PlugIn drivers are dynamically loadable &#8212; i.e., they can be
  loaded and unloaded without reboot.
  
    For additional information, refer to
    <a class="xref" href="#dyn_kp_load_linux" title="13.5.1. Dynamically Loading/Unloading Your Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.5.1</fo:inline></a>.
  
</td></tr></table></div>
</div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="Dynamic_Driver_Load"></a>Chapter 13. Dynamically Loading Your Driver</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dyn_load_why"></a>13.1. Why Do You Need a Dynamically Loadable Driver?</h2></div></div></div><p>
When adding a new driver, you may be required to reboot the system in order
for it to load your new driver into the system. WinDriver is a dynamically
loadable driver, which enables your customers to start your application
immediately after installing it, without the need for reboot.
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
You can dynamically load your driver whether you have created a user-mode or a
kernel-mode (Kernel PlugIn<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline> [11]</fo:inline></a>) driver.
</span>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  
  To successfully unload your driver, make sure that
  there are no open handles to the WinDriver service (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span> or
  your renamed driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>), and that there are no
  connected and enabled Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices that are registered with this service.

</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dyn_windows"></a>13.2. Windows Dynamic Driver Loading</h2></div></div></div><p>
Windows 7 and higher uses Windows Driver Model (WDM) drivers<a class="xref" href="#wdm_drivers_overview" title="2.3.1. WDM Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [2.3.1]</fo:inline></a>: Files
with the extension <span class="b"><strong>*.sys</strong></span> (e.g., <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>).<br>
WDM drivers are installed via the installation of an INF file (see below).
</p><p>
The WinDriver Windows kernel module &#8212; <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> &#8212; is a
fully WDM driver, which can be installed using the
<span class="jprintfilename"><strong>wdreg</strong></span> utility, as explained in the following
sections.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dyn_windows_wdreg"></a>13.2.1. The wdreg Utility</h3></div></div></div><p>
WinDriver provides a utility for dynamically loading and unloading your driver,
which replaces the slower manual process using Windows' Device Manager (which
can still be used for the device INF). This utility is provided in two forms:
<span class="jprintfilename"><strong>wdreg</strong></span> and
<span class="jprintfilename"><strong>wdreg_gui</strong></span>. Both versions can be found in the
<span class="jdirectory"><strong>WinDriver\util</strong></span> directory, can be run from the command
line, and provide the same functionality. The difference is that
<span class="jprintfilename"><strong>wdreg_gui</strong></span> displays installation messages
graphically, while <span class="jprintfilename"><strong>wdreg</strong></span> displays them in
console mode.
</p><p>
This section describes the use of <span class="jprintfilename"><strong>wdreg</strong></span>/
<span class="jprintfilename"><strong>wdreg_gui</strong></span> on Windows operating systems.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><span class="jprintfilename"><strong>wdreg</strong></span> is dependent on the Driver Install Frameworks API (<span class="b"><strong>DIFxAPI</strong></span>)
    DLL &#8212; <span class="jprintfilename"><strong>difxapi.dll</strong></span>, unless when run
    with the <strong class="jcmd"><code>-compat</code></strong> option (described below).
    <span class="jprintfilename"><strong>difxapi.dll</strong></span> is provided under the
    <span class="jdirectory"><strong>WinDriver\&#65279;util</strong></span> directory.
  </li><li class="listitem">
    The explanations and examples below refer to
    <span class="jprintfilename"><strong>wdreg</strong></span>, but any references to
    <span class="jprintfilename"><strong>wdreg</strong></span> can be replaced with
    <span class="jprintfilename"><strong>wdreg_gui</strong></span>.
  </li></ol></div></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wdreg_WDM"></a>13.2.1.1. WDM Drivers</h4></div></div></div><p>
This section explains how to use the <span class="jprintfilename"><strong>wdreg</strong></span>
utility to install the WDM <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver, or to install INF
files that register

<span xmlns:fo="http://www.w3.org/1999/XSL/Format">Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices (such as PCI)</span>
to work with this driver, on Windows.
</p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
You can rename the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> kernel module and modify your device
INF file to register with your renamed driver, as explained in
<a class="xref" href="#wd_rename_driver_windows" title="15.2.1. Windows Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.1</fo:inline></a>. To install your modified INF
files using <span class="jprintfilename"><strong>wdreg</strong></span>, simply replace any
references to <span class="jprintfilename"><strong>windrvr1281</strong></span> below with the name of your new driver.
</td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This section is <span class="b"><strong>not relevant</strong></span> for <span class="b"><strong>Kernel PlugIn</strong></span> drivers, since
these are not WDM drivers and are not installed via an INF file. For an
explanation on how to use <span class="jprintfilename"><strong>wdreg</strong></span> to install
Kernel PlugIn drivers on Windows, refer to <a class="xref" href="#wdreg_non_WDM" title="13.2.1.2. Non-WDM Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.2.1.2</fo:inline></a>.
</td></tr></table></div><p>
<span class="b"><strong>Usage:</strong></span> The <span class="b"><strong>wdreg</strong></span> utility can be used in two ways as demonstrated
below:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><strong class="jcmd"><code>wdreg -inf &lt;filename&gt; [-silent] [-log &lt;logfile&gt;]</code></strong><br><strong class="jcmd"><code>[install | preinstall | uninstall | enable | disable]</code></strong></li><li class="listitem"><strong class="jcmd"><code>wdreg -rescan &lt;enumerator&gt; [-silent] [-log
    &lt;logfile&gt;]</code></strong></li></ol></div><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    OPTIONS<br><span class="jprintfilename"><strong>wdreg</strong></span> supports several basic
    OPTIONS from which you can choose one, some, or none:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="b"><strong>-inf</strong></span> &#8212; The path of the INF file to be dynamically
        installed.
      </li><li class="listitem"><span class="b"><strong>-rescan &lt;enumerator&gt;</strong></span> &#8212; Rescan enumerator (ROOT,
        
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format">
          ACPI, PCI,
        </span> etc.) for hardware changes. Only one enumerator can be
        specified.
      </li><li class="listitem"><span class="b"><strong>-silent</strong></span> &#8212; Suppress display of all messages (optional).
      </li><li class="listitem"><span class="b"><strong>-log &lt;logfile&gt;</strong></span> &#8212; Log all messages to the specified
        file (optional).
      </li><li class="listitem"><span class="b"><strong>-compat</strong></span> &#8212; Use the traditional
        <span class="jprintfilename"><strong>SetupDi</strong></span> API instead of the newer
        Driver Install Frameworks API (<span class="b"><strong>DIFxAPI</strong></span>).
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    ACTIONS<br><span class="jprintfilename"><strong>wdreg</strong></span> supports several basic ACTIONS:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="b"><strong>install</strong></span> &#8212; Installs the INF file, copies the relevant files
        to their target locations, and dynamically loads the driver specified
        in the INF file name by replacing the older version (if needed).
      </li><li class="listitem"><span class="b"><strong>preinstall</strong></span> Pre-installs the INF file for a non-present device.
        </li><li class="listitem"><span class="b"><strong>uninstall</strong></span> &#8212; Removes your driver from the registry so that
        it will not load on next boot (see note below).
      </li><li class="listitem"><span class="b"><strong>enable</strong></span> &#8212; Enables your driver.
      </li><li class="listitem"><span class="b"><strong>disable</strong></span> &#8212; Disables your driver, i.e., dynamically unloads
        it, but the driver will reload after system boot (see note below).
      </li></ul></div></li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">

  To successfully disable/uninstall your driver, make sure that
  there are no open handles to the WinDriver service (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span> or
  your renamed driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>), and that there are no
  connected and enabled Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices that are registered with this service.

</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="wdreg_non_WDM"></a>13.2.1.2. Non-WDM Drivers</h4></div></div></div><p>
This section explains how to use the <span class="jprintfilename"><strong>wdreg</strong></span>
utility to install non-WDM drivers, namely Kernel PlugIn drivers, on Windows.
</p><p>
<span class="b"><strong>Usage:</strong></span><br>
<br>
<strong class="jcmd"><code>wdreg [-file &lt;filename&gt;] [-name &lt;drivername&gt;] [-startup
&lt;level&gt;] [-silent]
  [-log &lt;logfile&gt;] Action [Action ...]</code></strong>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    OPTIONS <br><span class="jprintfilename"><strong>wdreg</strong></span> supports several basic OPTIONS from
    which you can choose one, some, or none:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="b"><strong>-startup</strong></span>: Specifies when to start the driver. Requires one of
        the following arguments:
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><span class="b"><strong>boot</strong></span>: Indicates a driver started by the operating system
            loader, and should only be used for drivers that are essential to
            loading the OS (for example, Atdisk).
          </li><li class="listitem"><span class="b"><strong>system</strong></span>: Indicates a driver started during OS initialization.
          </li><li class="listitem"><span class="b"><strong>automatic</strong></span>: Indicates a driver started by the Service Control
            Manager during system startup.
          </li><li class="listitem"><span class="b"><strong>demand</strong></span>: Indicates a driver started by the Service Control
            Manager on demand (i.e., when your device is plugged in).
          </li><li class="listitem"><span class="b"><strong>disabled</strong></span>: Indicates a driver that cannot be started.
          </li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        The default setting for the <span class="b"><strong>-startup</strong></span> option is <span class="b"><strong>automatic</strong></span>.
        </td></tr></table></div></li><li class="listitem"><span class="b"><strong>-name</strong></span> &#8212; Sets the symbolic name of the driver. This name is
        used by the user-mode application to get a handle to the driver. You
        must provide the driver's symbolic name (<em class="it">without</em> the *.sys
        extension) as an argument with this option. The argument should be
        equivalent to the driver name as set in the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span>
        function of your Kernel PlugIn project:
        <strong class="jcmd"><code>strcpy(kpInit-&gt;cDriverName, XX_DRIVER_NAME)</code></strong> .
      </li><li class="listitem"><p>
        <span class="b"><strong>-file</strong></span> &#8212; <span class="jprintfilename"><strong>wdreg</strong></span> allows you
        to install your driver in the registry under a different name than the
        physical file name. This option sets the file name of the driver. You
        must provide the driver's file name (<em class="it">without</em> the *.sys
        extension) as an argument.<br>
        <span class="jprintfilename"><strong>wdreg</strong></span> looks for the driver in the
        Windows installation directory <br>
        (<span class="jdirectory"><strong>%windir%\&#65279;system32\&#65279;drivers</strong></span>).
        Therefore, you should verify that the driver file is located in the
        correct directory before attempting to install the driver.
        </p><p>
        <span class="b"><strong>Usage:</strong></span><br>
        <strong class="jcmd"><code>wdreg -name &lt;Your new driver name&gt; -file &lt;Your original
        driver name&gt; install</code></strong>
        </p></li><li class="listitem"><span class="b"><strong>-silent</strong></span> &#8212; Suppresses the display of messages of any kind.
      </li><li class="listitem"><span class="b"><strong>-log &lt;logfile&gt;</strong></span> &#8212; Logs all messages to the specified
        file.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    ACTIONS<br><span class="jprintfilename"><strong>wdreg</strong></span> supports several basic ACTIONS:
    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="b"><strong>create</strong></span> &#8212; Instructs Windows to load your driver next time
        it boots, by adding your driver to the registry.
      </li><li class="listitem"><span class="b"><strong>delete</strong></span> &#8212; Removes your driver from the registry so that it
        will not load on next boot.
      </li><li class="listitem"><span class="b"><strong>start</strong></span> &#8212; Dynamically loads your driver into memory for use.
        You must create your driver before starting it.
      </li><li class="listitem"><span class="b"><strong>stop</strong></span> &#8212; Dynamically unloads your driver from memory.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    Shortcuts<br><span class="jprintfilename"><strong>wdreg</strong></span> supports a few shortcut operations
    for your convenience:<br><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="b"><strong>install</strong></span> &#8212; Creates and starts your driver.<br>
        This is the same as first using the wdreg <strong class="jcmd"><code>stop</code></strong> action (if
        a version of the driver is currently loaded) or the wdreg
        <strong class="jcmd"><code>create</code></strong> action (if no version of the driver is currently
        loaded), and then the wdreg <strong class="jcmd"><code>start</code></strong> action.
      </li><li class="listitem"><span class="b"><strong>preinstall</strong></span> &#8212; Creates and starts your driver for a
        non-connected device.
        </li><li class="listitem"><span class="b"><strong>uninstall</strong></span> &#8212; Unloads your driver from memory and removes it
        from the registry so that it will not load on next boot.<br>
        This is the same as first using the wdreg <strong class="jcmd"><code>stop</code></strong> action and
        then the wdreg <strong class="jcmd"><code>delete</code></strong> action.
      </li></ul></div></li></ul></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dyn_windrvr_inf_load"></a>13.2.2. Dynamically Loading/Unloading windrvr1281.sys INF
  Files</h3></div></div></div><p>
When using WinDriver, you develop a user-mode application that controls and
accesses your hardware by using the generic <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver
(WinDriver's kernel module). Therefore, you might want to dynamically load and
unload the driver <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> &#8212; which you can do using
<span class="jprintfilename"><strong>wdreg</strong></span>.<br>
In addition, in WDM-compatible operating systems, you also need to dynamically
load INF files for your Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices.
<span class="jprintfilename"><strong>wdreg</strong></span> enables you to do so automatically on
Windows.<br>
This section includes <span class="jprintfilename"><strong>wdreg</strong></span> usage examples,
which are based on the detailed description of
<span class="jprintfilename"><strong>wdreg</strong></span> contained in the previous section.
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">Examples:</span>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To load <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> and start the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> service &#8212;
    <br><strong class="jcmd"><code>wdreg -inf &lt;path to windrvr1281.inf&gt; install</code></strong><br></li><li class="listitem" style="list-style-type: disc"><p>
    To load an INF file named <span class="jprintfilename"><strong>device.inf</strong></span>,
    located in the <span class="jdirectory"><strong>c:\tmp</strong></span> directory &#8212;<br>
    <strong class="jcmd"><code>wdreg -inf c:\tmp\device.inf install</code></strong>
    </p><p>
    You can replace the <strong class="jcmd"><code>install</code></strong> option in the example above with
    <strong class="jcmd"><code>preinstall</code></strong> to pre-install the device INF file for a device
    that is not currently connected to the PC.
    
    </p></li></ul></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If the installation fails with an
  <strong class="japib"><code>ERROR_FILE_NOT_FOUND</code></strong> error, inspect the Windows registry to
  see if the <strong class="japib"><code>RunOnce</code></strong> key exists in
  <strong class="japib"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code></strong>.
  This registry key is required by Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play in order to properly install
  drivers using INF files. If the <strong class="japib"><code>RunOnce</code></strong> key is missing, create
  it; then try installing the INF file again.
</td></tr></table></div><p>
To unload the driver/INF file, use the same commands, but simply replace
<strong class="jcmd"><code>install</code></strong> in the examples above with <strong class="jcmd"><code>uninstall</code></strong>.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dyn_kp_load_windows"></a>13.2.3. Dynamically Loading/Unloading Your Kernel PlugIn Driver</h3></div></div></div><p>
If you used WinDriver to develop a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>, you must load this driver only after loading
the generic WinDriver driver &#8212; <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>.<br>
When unloading the drivers, unload your Kernel PlugIn driver before unloading
<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>.
</p><p>

  Kernel PlugIn drivers are dynamically loadable &#8212; i.e., they can be
  loaded and unloaded without reboot.
  
To load/unload your Kernel PlugIn driver
(<span class="jprintfilename"><strong>&lt;Your driver name&gt;.sys</strong></span>) use the
<span class="jprintfilename"><strong>wdreg</strong></span> command as described above for
windrvr1281, with the addition of the 'name' flag, after which
you must add the name of your Kernel PlugIn driver.

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
You should <span class="b"><strong>not</strong></span> add the *.sys extension to the driver name.
</td></tr></table></div><p>
</p><p>
Examples:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To load a Kernel PlugIn driver called
    <span class="jprintfilename"><strong>KPDriver.sys</strong></span>, run this command:<br><strong class="jcmd"><code>wdreg -name KPDriver install</code></strong></li><li class="listitem" style="list-style-type: disc">
    To load a Kernel PlugIn driver called MPEG_Encoder, with file name
    <span class="jprintfilename"><strong>MPEGENC.sys</strong></span>, run this command:<br><strong class="jcmd"><code>wdreg -name MPEG_Encoder -file MPEGENC install</code></strong></li><li class="listitem" style="list-style-type: disc">
    To uninstall a Kernel PlugIn driver called
    <span class="jprintfilename"><strong>KPDriver.sys</strong></span>, run this command:<br><strong class="jcmd"><code>wdreg -name KPDriver uninstall</code></strong></li><li class="listitem" style="list-style-type: disc">
    To uninstall a Kernel PlugIn driver called MPEG_Encoder, with file name
    MPEGENC.sys, run this command:<br><strong class="jcmd"><code>wdreg -name MPEG_Encoder -file MPEGENC uninstall</code></strong></li></ul></div><p>
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wdreg_frontend"></a>13.3. The wdreg_frontend utility</h2></div></div></div>
Under Windows, WinDriver features a GUI frontend utility that is designed to ease installataion/uninstallation of WinDriver and Kernel PlugIn drivers during development phases.
Every operation that can be performed with <strong class="jcmd"><code>wdreg</code></strong> can also be performend from <strong class="jcmd"><code>wdreg_frontend</code></strong> and their output is identical. <strong class="jcmd"><code>wdreg_frontend</code></strong> prints out the complete <strong class="jcmd"><code>wdreg</code></strong> command that it performed, making it easier for the developer to copy the desired command and integrate it in their own installation scripts.


  <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Driver installation on Windows requires administrator privileges.
  </td></tr></table></div>


Loading <strong class="jcmd"><code>wdreg_frontend</code></strong>:
<div class="itemizedlist"><div class="figure"><a name="frontend_icon"></a><p class="title"><b>Figure 13.1. The wdreg_frontend icon</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/frontend_icon.png" height="" alt="The wdreg_frontend icon"></div></div></div><br class="figure-break"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> Click the <strong class="jcmd"><code>wdreg_frontend</code></strong> icon from the <span class="b"><strong>DriverWizard</strong></span> window.</li><li class="listitem"> Run <strong class="jcmd"><code>WinDriver/util/wdreg_frontend.exe</code></strong> directly.</li></ul></div>

    To load/unload a Kernel Plugin:
<div class="itemizedlist"><div class="figure"><a name="copy_driver_file"></a><p class="title"><b>Figure 13.2. The dialog box wdreg_frontend will open if driver file is not located in the         Windows system directory</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/copy_driver_file.png" height="" alt="The dialog box wdreg_frontend will open if driver file is not located in the Windows system directory"></div></div></div><br class="figure-break"><div class="figure"><a name="load_driver"></a><p class="title"><b>Figure 13.3. wdreg_frontend after successfully loading a sys file</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/load_driver.png" height="" alt="wdreg_frontend after successfully loading a sys file"></div></div></div><br class="figure-break"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> Click <span class="b"><strong>File-&gt;Open</strong></span> and open the desired sys file. </li><li class="listitem"> If the sys file is not located in the Windows system directory, a dialog box will appear and ask if you wish <strong class="jcmd"><code>wdreg_frontend</code></strong> to copy the sys file to the Windows system directory. </li><li class="listitem"> If the file loaded correctly, all actions available for .sys files will become enabled:
<span class="b"><strong>Install Driver, Uninstall Driver, Start Driver, Stop Driver, Create Driver, Delete Driver</strong></span> and choice of <span class="b"><strong>Startup level</strong></span>.
Further information on these actions is available on the wdreg section of this document.<a class="xref" href="#wdreg_non_WDM" title="13.2.1.2. Non-WDM Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.2.1.2]</fo:inline></a>:
    </li></ul></div><div class="figure"><a name="digital_sign_fail"></a><p class="title"><b>Figure 13.4. Error message given by Windows when trying to install an unsigned driver</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/digital_sign_fail.png" height="" alt="Error message given by Windows when trying to install an unsigned driver"></div></div></div><br class="figure-break"><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">You may need to either digitally sign your sys file or disable digital signature enforcement for the driver to properly load and work under Windows.
</td></tr></table></div>
To install/uninstall an INF file:
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"> Click <span class="b"><strong>File-&gt;Open</strong></span> and open the desired sys file. </li><li class="listitem">If the file loaded correctly, all actions available for .inf files will become enabled:
        <span class="b"><strong>Install Driver, Uninstall Driver, Enable Driver, Disable Driver, Preinstall Driver</strong></span>
        Further information on these actions is available on the wdreg section 
        of this document.<a class="xref" href="#wdreg_WDM" title="13.2.1.1. WDM Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.2.1.1]</fo:inline></a>:
    </li></ul></div><div class="figure"><a name="driver_install_success"></a><p class="title"><b>Figure 13.5. wdreg_frontend upon successfully installing a sys driver</b></p><div class="figure-contents"><div class="mediaobject"><img src="images/driver_install_success.png" height="" alt="wdreg_frontend upon successfully installing a sys driver"></div></div></div><br class="figure-break"></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dyn_win10iot"></a>13.4. Windows 10 IoT Core Dynamic Driver Loading</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If you can connect your PCI/USB device to your development computer you can
create an INF file as described in <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4.2]</fo:inline></a>. <br>
If you cannot connect your PCI/USB device to your development computer then
do the following:
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Create a project for a <span class="b"><strong>Virtual Device</strong></span>, as described in <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4.2]</fo:inline></a>.
</li><li class="listitem">
Manually enter your VID, PID, Manufacturer and Device name in the INF file
you've created in the previous step.
</li><li class="listitem">
Transfer the project files to your Windows 10 IoT Core target computer.
</li></ol></div></td></tr></table></div>

To load your driver do the following:
<div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Copy the INF file you have created to your Windows 10 IoT Core target compter,
and put it in the directory that holds
<span class="jprintfilename"><strong>wdreg_iot.cmd</strong></span>.
</li><li class="listitem">
Install WinDriver for your PCI/USB device using the
<span class="jprintfilename"><strong>wdreg_iot.cmd</strong></span> script:
<strong class="jcmd"><code>wdreg_iot.cmd install xxx.inf</code></strong></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dyn_linux"></a>13.5. Linux Dynamic Driver Loading</h2></div></div></div>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following commands must be executed with root privileges.
  </td></tr></table></div>

<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To dynamically load WinDriver, run the following command:<br><strong class="jcmd"><code># &lt;path to wdreg&gt; windrvr1281</code></strong></li><li class="listitem" style="list-style-type: disc">
    To dynamically unload WinDriver, run the following command:<br><strong class="jcmd"><code># /sbin/modprobe -r windrvr1281</code></strong>.
  </li></ul></div>

<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><span class="jprintfilename"><strong>wdreg</strong></span> is provided in the
  <span class="jdirectory"><strong>WinDriver/util</strong></span>
  directory.

</td></tr></table></div>

<div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To automatically load WinDriver on each boot, add the following line to the target's Linux boot file (for example,
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/rc.local</strong></span></span>):<br><code class="japi">&lt;path to wdreg&gt; windrvr1281</code></td></tr></table></div>
<div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dyn_kp_load_linux"></a>13.5.1. Dynamically Loading/Unloading Your Kernel PlugIn Driver</h3></div></div></div><p>
If you used WinDriver to develop a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>, you must load this driver only after loading
the generic WinDriver driver &#8212; <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>.<br>
When unloading the drivers, unload your Kernel PlugIn driver before unloading
<span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>.
</p><p>


  Kernel PlugIn drivers are dynamically loadable &#8212; i.e., they can be
  loaded and unloaded without reboot.
   Use the following commands to dynamically
load or unload your Kernel PlugIn driver.

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following commands must be executed with root privileges.
  </td></tr></table></div><p>

</p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><span class="jprintfilename"><strong>xxx</strong></span> in the commands signifies your selected
Kernel PlugIn driver project name.
</td></tr></table></div><p>


</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To dynamically load your Kernel PlugIn driver, run this command:<br>
    <strong class="jcmd"><code># /sbin/insmod &lt;path to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span>&gt;</code></strong>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    When building the Kernel PlugIn driver on the development machine, the
    Kernel PlugIn driver module is created in your Kernel PlugIn
    project's <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>kermode/linux/LINUX.&lt;kernel version&gt;.&lt;CPU&gt;</strong></span></span> directory (see
    <a class="xref" href="#kp_compilation_linux" title="12.8.2. Linux Kernel PlugIn Driver Compilation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.8.2</fo:inline></a>, <a class="xref" href="#kp_compile_linux_step_make"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 4</fo:inline></a>).<br>
    When building the driver on a target distribution machine, the driver
    module is normally created in an
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>xxx_installation/redist/LINUX.&lt;kernel version&gt;.&lt;CPU&gt;.KP</strong></span></span> directory
    (see <a class="xref" href="#dist_linux_build_install_kp_module" title="14.3.3. Building and Installing Your Kernel PlugIn Driver on the Target"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.3.3</fo:inline></a>, <a class="xref" href="#dist_linux_build_install_kp_module_step_build"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 2</fo:inline></a>).
    </td></tr></table></div>
    </li><li class="listitem" style="list-style-type: disc">
    To dynamically unload your Kernel PlugIn, run this command:<br>
    <strong class="jcmd"><code># /sbin/rmmod kp_xxx_module</code></strong>
    </li></ul></div><p>
</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To automatically load your Kernel PlugIn driver on each boot,
add the following line to the target's Linux boot file (for example,
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/rc.local</strong></span></span>), after the WinDriver driver module
(<span class="jprintfilename"><strong>windrvr1281</strong></span>) load command (replace
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="b"><strong>&lt;path to <span style="white-space:nowrap">kp_xxx_module.o/.ko</span>&gt;</strong></span></span>
with the path to your Kernel PlugIn driver module):<br><code class="japi">/sbin/insmod &lt;path to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span>&gt;</code></td></tr></table></div></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="driver_distribution"></a>Chapter 14. Distributing Your Driver</h1></div></div></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Read this chapter in the final stages of driver development. It will guide you
in preparing your driver for distribution.
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="distr_get_valid_lic"></a>14.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Getting a Valid WinDriver License</span></h2></div></div></div><p>
Before distributing your driver you must purchase a WinDriver license, as outlined
in <a class="xref" href="#purchasing_wd" title="Appendix F. Purchasing WinDriver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Appendix F</fo:inline></a>.<br>
Then install the registered version of WinDriver on your development machine by
following the installations in <a class="xref" href="#wd_install_process" title="3.2. WinDriver Installation Process"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.2</fo:inline></a>. If you
have already installed an evaluation version of WinDriver, you can jump directly
to the installation steps for registered users to activate your license.<br>
To register code developed during the evaluation period of WinDriver, follow the
instructions in  <a class="xref" href="#wd_install_upgrade" title="3.3. Upgrading Your Installation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.3</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dist_winpnp"></a>14.2. Windows Driver Distribution</h2></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    All references to <span class="jprintfilename"><strong>wdreg</strong></span> in this section
    can be replaced with <span class="jprintfilename"><strong>wdreg_gui</strong></span>, which
    offers the same functionality as <span class="jprintfilename"><strong>wdreg</strong></span> but
    displays GUI messages instead of console-mode messages.
  </li><li class="listitem" style="list-style-type: disc">
    If you have renamed the WinDriver kernel module (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>), as
    explained in <a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2</fo:inline></a>, replace the relevant
    <span class="jprintfilename"><strong>windrvr1281</strong></span> references with the name of your driver, and replace
    references to the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory with the path to the
    directory that contains your modified installation files. For example, when
    using the generated DriverWizard renamed driver files for your driver
    project, as explained in <a class="xref" href="#wd_rename_driver_windows" title="15.2.1. Windows Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.1</fo:inline></a>,
    you can replace references to the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory with
    references to the generated
    <span class="jdirectory"><strong>xxx_installation\&#65279;redist</strong></span> directory (where
    <span class="jprintfilename"><strong>xxx</strong></span> is the name of your generated driver
    project). Note also the option to simplify the
    installation using the generated DriverWizard
    <span class="jprintfilename"><strong>xxx_install.bat</strong></span> script and the copies of
    the <span class="jdirectory"><strong>WinDriver\&#65279;util</strong></span> installation files in the
    generated <span class="jdirectory"><strong>xxx_installation\&#65279;redist</strong></span> directory,
    as explained in <a class="xref" href="#wd_rename_driver_windows" title="15.2.1. Windows Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.1</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    If you have created new INF and/or catalog files for your driver, replace
    the references to the original WinDriver INF files and/or to the
    <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> catalog file with the names of your new files (see the file
    renaming information in <a class="xref" href="#wd_rename_driver_windows" title="15.2.1. Windows Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections 15.2.1</fo:inline></a>
    and <a class="xref" href="#driver_sign_wd_drivers" title="15.3.2. Driver Signing and Certification of WinDriver-Based Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> 15.3.2</fo:inline></a>).
  </li></ul></div></td></tr></table></div><p>
Distributing the driver you created is a multi-step process. First, create a
distribution package that includes all the files required for the installation
of the driver on the target computer. Second, install the driver on the target
machine. This involves installing <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> and <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>,
 installing the specific INF file for your
device<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
  (for Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware &#8212; PCI&#65279;/&#65279;PCI Express), and installing your
  Kernel PlugIn driver (if you have created one).
</span>
</p><p>
Finally, you need to install and execute the hardware-control application that
you developed with WinDriver. These steps can be performed using
<span class="jprintfilename"><strong>wdreg</strong></span> utility.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_winpnp_pkg_prepare"></a>14.2.1. Preparing the Distribution Package</h3></div></div></div><p>
Prepare a distribution package that includes the following files.

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If you wish to distribute drivers for both 32-&#65279;bit and 64-&#65279;bit target
  platforms, you must prepare separate distribution packages for each platform.
  The required files for each package are provided in the WinDriver installation
  directory for the respective platform.
</td></tr></table></div><p>

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Your hardware-control application/DLL.
  </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>.<br>
    Get this file from the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory of the WinDriver package.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>.<br>
    Get this file from the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory of the WinDriver package.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>windrvr1281.cat</strong></span><br>
    Get this file from the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory of the WinDriver package.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>wdapi1281.dll</strong></span> (for
    distribution of 32-&#65279;bit binaries to 32-&#65279;bit target platforms or for
    distribution of 64-&#65279;bit binaries to 64-&#65279;bit platforms) or
    <span class="jprintfilename"><strong>wdapi1281_32.dll</strong></span> (for
    distribution of 32-&#65279;bit binaries to 64-&#65279;bit platforms<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a>.<br>
    Get this file from the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory of the WinDriver package.
    
    </li><li class="listitem" style="list-style-type: disc">
    <span class="jprintfilename"><strong>difxapi.dll</strong></span> (required by the
    <span class="jprintfilename"><strong>wdreg.exe</strong></span> utility<a class="xref" href="#dyn_windows_wdreg" title="13.2.1. The wdreg Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.2.1]</fo:inline></a>).<br>
    Get this file from the <span class="jdirectory"><strong>WinDriver\&#65279;util</strong></span> directory
    of the WinDriver package.
    </li><li class="listitem" style="list-style-type: disc">
    An INF file for your device<span xmlns:fo="http://www.w3.org/1999/XSL/Format">
      (required for Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices, such as PCI)</span>.<br>
    You can generate this file with DriverWizard, as explained in
    <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>.
    </li><li class="listitem" style="list-style-type: disc">
    If you have created a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>: Your Kernel PlugIn driver &#8212;
    <span class="jprintfilename"><strong>&lt;KP driver name&gt;.sys</strong></span>.
    </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_winpnp_install_on_target"></a>14.2.2. Installing Your Driver on the Target Computer</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Driver installation on Windows requires administrator privileges.
  </td></tr></table></div><p>
Follow the instructions below in the order specified to properly install your
driver on the target computer:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
    <span class="b"><strong>Preliminary Steps:</strong></span><br>
    
  To successfully install your driver, make sure that
  there are no open handles to the WinDriver service (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span> or
  your renamed driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>), and that there are no
  connected and enabled Plug&#65279;-&#65279;and&#65279;-&#65279;Play devices that are registered with this service.

    If the service is being used, attempts to install the new driver using
    <span class="jprintfilename"><strong>wdreg</strong></span> will fail. This is relevant, for
    example, when upgrading from an earlier version of the driver that uses the
    same driver name.
    
    You can disable or uninstall connected devices from the Device Manager
    (<span class="jmenupath"><strong>Properties | Disable/Uninstall</strong></span>) or using
    <span class="jprintfilename"><strong>wdreg</strong></span>, or otherwise physically disconnect
    the device(s) from the PC.
    </p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    Since v11.9.0 of WinDriver, the default driver module name includes the WinDriver
    version, so if you do not rename the driver to a previously-used name there
    should not be conflicts with older drivers.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Install WinDriver's kernel module:</strong></span><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
        Copy <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>, <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>, and <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> to the
        same directory.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><p>
        <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> contains the driver's Authenticode digital signature. To
        maintain the signature's validity this file must be found in the same
        installation directory as the <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file. If you select to 
        distribute the catalog and INF files in different directories, or make 
        any changes to these files or to any other files referred to by the
        catalog file (such as <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>), you will need to do
        either of the following:<br>
          </p><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
              Create a new catalog file and re-sign the driver using this file.
            </li><li class="listitem" style="list-style-type: disc">
              Comment-out or remove the following line in the <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>
              file:<br><strong class="jcmd"><code>CatalogFile=<span class="jprintfilename"><strong>windrvr1281.cat</strong></span></code></strong><br>
              and do not include the catalog file in your driver distribution.
              However, note that this option invalidates the driver's digital
              signature.
            </li></ul></div><p>
        </p><p>
        For more information regarding driver digital signing and certification
        and the signing of your WinDriver-based driver, refer to
        <a class="xref" href="#driver_sign" title="15.3. Windows Digital Driver Signing and Certification"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3</fo:inline></a> of the manual.
        </p></td></tr></table></div></li><li class="listitem"><p>
        Use the utility <span class="jprintfilename"><strong>wdreg</strong></span> to install
        WinDriver's kernel module on the target computer:<br>
        <strong class="jcmd"><code>wdreg -inf &lt;path to windrvr1281.inf&gt; install</code></strong>
        </p><p>
        For example, if <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> and <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> are in the
        <span class="jdirectory"><strong>d:\MyDevice</strong></span> directory on the target computer,
        the command should be:<br>
        <strong class="jcmd"><code>wdreg -inf d:\MyDevice\windrvr1281.inf install</code></strong>
        </p><p>
        You can find the executable of <span class="jprintfilename"><strong>wdreg</strong></span>
        in the WinDriver package under the <span class="jdirectory"><strong>WinDriver\util</strong></span>
        directory. For a general description of this utility and its usage,
        please refer to <a class="xref" href="#Dynamic_Driver_Load" title="Chapter 13. Dynamically Loading Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 13</fo:inline></a>.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>wdreg</strong></span> is dependent on the
            <span class="jprintfilename"><strong>difxapi.dll</strong></span> DLL.
          </li><li class="listitem" style="list-style-type: disc"><span class="jprintfilename"><strong>wdreg</strong></span> is an interactive utility.
            If it fails, it will display a message instructing the user how
            to overcome the problem. In some cases the user may be asked to
            reboot the computer.
          </li></ul></div></td></tr></table></div><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="scripts/images/caution.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        When distributing your driver, you should attempt to ensure that the
        installation does not overwrite a newer version of
        <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> with an older version of the file in Windows
        drivers directory
        (<span class="jdirectory"><strong>%windir%\&#65279;system32\&#65279;drivers</strong></span>)
        &#8212; for example, by configuring your installation program (if you
        are using one) or your INF file so that the installer automatically
        compares the time stamp on these two files and does not overwrite a
        newer version with an older one. The provided <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file uses
        the <code class="japi">COPYFLG_NO_VERSION_DIALOG</code> directive, which is designed
        to avoid overwriting a file in the destination directory with the
        source file if the existing file is newer than the source file. There
        is also a similar <code class="japi">COPYFLG_OVERWRITE_OLDER_ONLY</code> INF
        directive that is designed to ensure that the source file is copied to
        the destination directory only if the destination file is superseded by
        a newer version. <span class="b"><strong>Note</strong></span>, however, that both of these INF
        directives are irrelevant to digitally signed drivers. As explained in
        the Microsoft <em class="it">INF CopyFiles Directive</em> documentation &#8212;
        <a class="ulink" href="https://msdn.microsoft.com/en-us/library/ff546346%28v=vs.85%29.aspx" target="_top">https://msdn.microsoft.com/en-us/library/ff546346%28v=vs.85%29.aspx</a>
        &#8212; if a driver package is digitally signed, Windows installs the
        package as a whole and does not selectively omit files in the package
        based on other versions already present on the computer. The
        <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver provided by Jungo is digitally signed
        (refer to <a class="xref" href="#driver_sign" title="15.3. Windows Digital Driver Signing and Certification"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3</fo:inline></a> for more information).
        </td></tr></table></div></li></ol></div></li><li class="listitem" style="list-style-type: disc"><p>
    <span class="b"><strong>Install the INF file for your device</strong></span> (registering your Plug&#65279;-&#65279;and&#65279;-&#65279;Play
    device with <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>):
    </p><p>
    Run the utility <span class="jprintfilename"><strong>wdreg</strong></span> with the
    <strong class="jcmd"><code>install</code></strong> command to automatically install the INF file and
    update Windows Device Manager:<br>
    <strong class="jcmd"><code>wdreg -inf &lt;path to your INF file&gt; install</code></strong>
    </p><p>
    You can also use the <span class="jprintfilename"><strong>wdreg</strong></span> utility's
    <strong class="jcmd"><code>preinstall</code></strong> command to pre-install an INF file for a device
    that is not currently connected to the PC:<br>
    <strong class="jcmd"><code>wdreg -inf &lt;path to your INF file&gt; preinstall</code></strong>
    
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If the installation fails with an
  <strong class="japib"><code>ERROR_FILE_NOT_FOUND</code></strong> error, inspect the Windows registry to
  see if the <strong class="japib"><code>RunOnce</code></strong> key exists in
  <strong class="japib"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code></strong>.
  This registry key is required by Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play in order to properly install
  drivers using INF files. If the <strong class="japib"><code>RunOnce</code></strong> key is missing, create
  it; then try installing the INF file again.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc"><span class="b"><strong>Install your Kernel PlugIn driver</strong></span>: If you have created a Kernel
    PlugIn driver, install it by following the instructions in
    <a class="xref" href="#dist_winpnp_kp_install_on_target" title="14.2.3. Installing Your Kernel PlugIn on the Target Computer"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.2.3</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc"><p>
    
    <span class="b"><strong>Install <span class="jprintfilename"><strong>wdapi1281.dll</strong></span>:</strong></span>
    <br>
    If your hardware-control application/DLL uses
    <span class="jprintfilename"><strong>wdapi1281.dll</strong></span> (as is the case
    for the sample and generated DriverWizard WinDriver projects), copy this DLL
    to the target's
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>%windir%\system32</strong></span></span>
    directory.<br>
    
    
    If you are distributing a 32-&#65279;bit application/DLL to a target 64-&#65279;bit
    platform<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a>, rename
    <span class="jprintfilename"><strong>wdapi1281_32.dll</strong></span> in your
    distribution package to
    <span class="jprintfilename"><strong>wdapi1281.dll</strong></span>, and copy the
    renamed file to the target's
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>%windir%\sysWOW64</strong></span></span>
    directory.
    
    
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If you attempt to write a 32-&#65279;bit installation program that installs a
    64-&#65279;bit program, and therefore copies the 64-&#65279;bit
    <span class="jprintfilename"><strong>wdapi1281.dll</strong></span> DLL to the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>%windir%\system32</strong></span></span>
    directory, you may find that the file is actually copied to the 32-&#65279;bit
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>%windir%\sysWOW64</strong></span></span>
    directory. The reason for this is that Windows x64 platforms translate
    references to 64-&#65279;bit directories from 32-&#65279;bit commands into references
    to 32-&#65279;bit directories. You can avoid the problem by using 64-&#65279;bit
    commands to perform the necessary installation steps from your 32-&#65279;bit
    installation program. The <span class="jprintfilename"><strong>system64.exe</strong></span>
    program, provided in the <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory of the Windows x64
    WinDriver distributions, enables you to do this.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>Install your hardware-control application/DLL</strong></span>: Copy your
    hardware-control application/DLL to the target and run it!
    </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_winpnp_kp_install_on_target"></a>14.2.3. Installing Your Kernel PlugIn on the Target Computer</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Driver installation on Windows requires administrator privileges.
  </td></tr></table></div><p>
If you have created a Kernel PlugIn driver, follow the additional
instructions below:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Copy your Kernel PlugIn driver (<span class="jprintfilename"><strong>&lt;KP driver
    name&gt;.sys</strong></span>) to Windows drivers directory on the target
    computer (<span class="jdirectory"><strong>%windir%\&#65279;system32\&#65279;drivers</strong></span>).
  </li><li class="listitem"><p>
    Use the utility <span class="jprintfilename"><strong>wdreg</strong></span> to add your
    Kernel PlugIn driver to the list of device drivers Windows loads on boot.
    Use the following installation command:
    </p><p>
    To install a <span class="b"><strong>SYS</strong></span> Kernel PlugIn Driver:<br>
    <strong class="jcmd"><code>wdreg -name &lt;Your driver name, without the *.sys extension&gt;
    install</code></strong>
    </p><p>
    You can find the executable of <span class="jprintfilename"><strong>wdreg</strong></span> in
    the WinDriver package under the <span class="jdirectory"><strong>WinDriver\util</strong></span>
    directory. For a general description of this utility and its usage, please
    refer to <a class="xref" href="#Dynamic_Driver_Load" title="Chapter 13. Dynamically Loading Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 13</fo:inline></a> (see specifically
    <a class="xref" href="#dyn_kp_load_windows" title="13.2.3. Dynamically Loading/Unloading Your Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.2.3</fo:inline></a> for Kernel PlugIn installation).
    </p></li></ol></div><p>
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="dist_linux"></a>14.3. Linux Driver Distribution</h2></div></div></div><p>
To distribute your driver, prepare a distribution package containing the
required files &#8212; as outlined in
<a class="xref" href="#dist_linux_pkg_prepare" title="14.3.1. Preparing the Distribution Package"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.3.1</fo:inline></a> &#8212; and then build and install
the required driver components on the target &#8212; as outlined in
<a class="xref" href="#dist_linux_build_install_wd_modules" title="14.3.2. Building and Installing the WinDriver Driver Module on the Target"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Sections 14.3.2&#8211;</fo:inline></a><a class="xref" href="#dist_linux_install_user_hw_ctrl_app_so" title="14.3.4. Installing the User-Mode Hardware-Control Application or Shared Object"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">14.3.4</fo:inline></a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    If you have renamed the WinDriver driver module<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>,
    replace references to <span class="jprintfilename"><strong>windrvr1281</strong></span> in the following instructions
    with the name of your renamed driver module.
    </li><li class="listitem" style="list-style-type: disc">
    It is recommended that you supply an installation shell script to automate
    the build and installation processes on the target.
  </li></ul></div></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_linux_pkg_prepare"></a>14.3.1. Preparing the Distribution Package</h3></div></div></div><p>
Prepare a distribution package containing the required files, as described
in this section.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    If you wish to distribute drivers for both 32-&#65279;bit and 64-&#65279;bit target
  platforms, you must prepare separate distribution packages for each platform.
  The required files for each package are provided in the WinDriver installation
  directory for the respective platform.
  </li><li class="listitem" style="list-style-type: disc"><a name="dist_linux_note_src_dir"></a>
    In the following instructions, <span class="jdirectory"><strong>&lt;source_dir&gt;</strong></span> represents the source directory
    from which to copy the distribution files. The default source directory is
    your WinDriver installation directory. However, if you have renamed the WinDriver
    driver module<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>, the source directory is a
    directory containing modified files for compiling and installing the
    renamed drivers; when using DriverWizard to generate the driver code, the
    source directory for the renamed driver is the generated
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>xxx_installation</strong></span></span> directory,
    where <span class="jprintfilename"><strong>xxx</strong></span> is the name of your generated
    driver project (see
    <a class="xref" href="#wd_rename_driver_linux" title="15.2.2. Linux Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.2</fo:inline></a>, <a class="xref" href="#wd_rename_driver_linux_step_wiz_gen_files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 1</fo:inline></a>).
  </li></ul></div></td></tr></table></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="dist_linux_pkg_prepare_kernel_modules"></a>14.3.1.1. Kernel Module Components</h4></div></div></div><p>
Your WinDriver-based driver relies on the <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span> kernel driver
module, which implements the WinDriver API. In addition, if you have created a
Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>, the functionality of
this driver is implemented in a <span class="jprintfilename"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span></strong></span> kernel driver module
(where <span class="jprintfilename"><strong>xxx</strong></span> is your selected driver project
name).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Your kernel driver modules cannot be distributed as-is; they must be recompiled
on each target machine, to match the kernel version on the target. This is due
to the following reason: The Linux kernel is continuously under development,
and kernel data structures are subject to frequent changes. To support such a
dynamic development environment, and still have kernel stability, the Linux
kernel developers decided that kernel modules must be compiled with header
files identical to those with which the kernel itself was compiled. They
enforce this by including a version number in the kernel header files, which is
checked against the version number encoded into the kernel. This forces Linux
driver developers to support recompilation of their driver with the target
system's kernel version.
</td></tr></table></div><p>
Following is a list of the components you need to distribute to enable
compilation of your kernel driver modules on the target machine.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
It is recommended that you copy the files to subdirectories in the
distribution directory that match the source subdirectories, such as
<span class="jdirectory"><strong>redist</strong></span> and <span class="jprintfilename"><strong>include</strong></span>, except where
otherwise specified. If you select not do so, you will need to modify the file
paths in the configuration scripts and related makefile templates, to match the
location of the files in your distribution directory.
</td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    From the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="link" href="#dist_linux_note_src_dir">&lt;source_dir&gt;</a><span class="jdirectory"><strong>/include</strong></span></span>
    directory, copy <span class="jprintfilename"><strong>windrvr.h</strong></span>,
    <span class="jprintfilename"><strong>wd_ver.h</strong></span>, and
    <span class="jprintfilename"><strong>windrvr_usb.h</strong></span> &#8212; header files
    required for building the kernel modules on the target.
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format"><br>
      Note that <span class="jprintfilename"><strong>windrvr_usb.h</strong></span> is required also
      for non-USB drivers.
    </span>
    </li><li class="listitem" style="list-style-type: disc">
    From the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>&lt;WinDriver installation
      directory&gt;/util</strong></span></span> directory (or from the
    generated DriverWizard
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>xxx_installation</strong></span>/<span class="jdirectory"><strong>redist</strong></span></span>
    directory), copy <span class="jprintfilename"><strong>wdreg</strong></span> &#8212; a script
    for loading the WinDriver kernel driver module (see
    <a class="xref" href="#dyn_linux" title="13.5. Linux Dynamic Driver Loading"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.5</fo:inline></a>) &#8212; to the <span class="jdirectory"><strong>redist</strong></span> distribution
    directory.
    </li><li class="listitem" style="list-style-type: disc">
    From the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="link" href="#dist_linux_note_src_dir">&lt;source_dir&gt;</a>/<span class="jdirectory"><strong>redist</strong></span></span> directory,
    unless where otherwise specified, copy the following files:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        <span class="jprintfilename"><strong>setup_inst_dir</strong></span> &#8212; a script for
        installing the WinDriver driver module, using
        <span class="jprintfilename"><strong>wdreg</strong></span> (see above).
        </li><li class="listitem">
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>linux_wrappers.c/.h</strong></span></span>
        &#8212; wrapper library source code files that bind the kernel module
        to the Linux kernel.
        </li><li class="listitem"><span class="jprintfilename"><strong>linux_common.h</strong></span> and
        <span class="jprintfilename"><strong>wdusb_interface.h</strong></span> &#8212; header files
        required for building the kernel modules on the target.
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format"><br>
          Note that <span class="jprintfilename"><strong>wdusb_interface.h</strong></span> is
          required also for non-USB drivers.
        </span></li><li class="listitem">
        The compiled object code for building the WinDriver kernel driver module
        &#8212;

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem"><span class="jprintfilename"><strong>windrvr_gcc_v3.a</strong></span> &#8212; for
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation
          </li><li class="listitem"><span class="jprintfilename"><strong>windrvr_gcc_v3_regparm.a</strong></span> &#8212;
            for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation with the
            <span class="b"><strong>regparm</strong></span> flag
          </li><li class="listitem"><span class="jprintfilename"><strong>windrvr_gcc_v2.a</strong></span> &#8212; for
            <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v2.x.x</span> compilation;
            note that this file is not found in the
  64-&#65279;bit WinDriver installations, because 64-&#65279;bit Linux architectures don't use
  GCC v2.
          </li></ul></div>
        </li><li class="listitem">
        Configuration scripts and makefile templates for creating makefiles
        for building and installing the WinDriver kernel driver module.

        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        Files that include <span class="jprintfilename"><strong>.kbuild</strong></span> in their
        names use <span class="jprintfilename"><strong>kbuild</strong></span> for the driver
        compilation.
        </td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: circle; "><li class="listitem">
            <span class="jprintfilename"><strong>configure</strong></span> &#8212; a configuration
            script that uses the <span class="jprintfilename"><strong>makefile.in</strong></span>
            template to create a <span class="jprintfilename"><strong>makefile</strong></span> for
            building and installing the WinDriver driver module, and executes the
            <span class="jprintfilename"><strong>configure.wd</strong></span>
            script
            (see below).
            </li><li class="listitem">
            <span class="jprintfilename"><strong>configure.wd</strong></span> &#8212; a
            configuration script that uses the
            <span class="jprintfilename"><strong>makefile.wd[.kbuild].in</strong></span> template
            to create a <span class="jprintfilename"><strong>makefile.wd[.kbuild]</strong></span>
            makefile for building the <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span> driver module.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>makefile.in</strong></span> &#8212; a template for
            the main <span class="jprintfilename"><strong>makefile</strong></span> for building and
            installing the WinDriver kernel driver module, using
            <span class="jprintfilename"><strong>makefile.wd[.kbuild]</strong></span>.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>makefile.wd.in</strong></span> and
            <span class="jprintfilename"><strong>makefile.wd.kdbuild.in</strong></span> &#8212;
            templates for creating
            <span class="jprintfilename"><strong>makefile.wd[.kbuild]</strong></span> makefiles for
            building and installing the <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span> driver module.
            </li></ul></div></li></ul></div></li></ul></div><p>
<em class="it">If you have created a <span class="b"><strong>Kernel PlugIn driver</strong></span><a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a> &#8212; copy the following files as well:</em>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    From the generated DriverWizard
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>xxx_installation/</strong></span><span class="jdirectory"><strong>redist</strong></span></span>
    directory (where <span class="jprintfilename"><strong>xxx</strong></span> is the name of your
    driver project &#8212; see
    <a class="xref" href="#wd_rename_driver_linux" title="15.2.2. Linux Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.2</fo:inline></a>, <a class="xref" href="#wd_rename_driver_linux_step_wiz_gen_files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 1</fo:inline></a>), copy the
    following configuration script and makefile templates, for creating a
    makefile for building and installing the Kernel PlugIn driver.
    
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    If you did not generate your Kernel PlugIn driver using the DriverWizard,
    copy the files from your Kernel PlugIn project; the files for the
    <span class="jprintfilename"><strong>KP_PCI</strong></span> sample, for example, are found in the
    <span class="jdirectory"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci</strong></span> directory.<br>
    Note: Before copying the files, rename them to add a ".kp" indication
    &#8212; as in the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>xxx_installation/</strong></span><span class="jdirectory"><strong>redist</strong></span></span>
    file names listed below &#8212; in order to distinguish them from the
    WinDriver driver module files. You will also need to edit the file names and
    paths in the files, to match the structure of the distribution directory.
    </td></tr></table></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        <span class="jprintfilename"><strong>configure.kp</strong></span> &#8212; a
        configuration script that uses the
        <span class="jprintfilename"><strong>makefile.kp[.kbuild].in</strong></span> template (see
        below) to create a <span class="jprintfilename"><strong>makefile.kp</strong></span>
        makefile for building and installing the Kernel PlugIn driver module.
        <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        If you have renamed the WinDriver kernel
  module<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a>, be sure to uncomment the following line
  in your Kernel PlugIn configuration script (by removing the pound sign
  &#8212; "#"), before executing the script, in order to build the driver with
  the <strong class="japib"><code>-&#65279;DWD_DRIVER_NAME_CHANGE</code></strong> flag (see <a class="xref" href="#wd_rename_driver_linux" title="15.2.2. Linux Driver Renaming"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2.2</fo:inline></a>, <a class="xref" href="#wd_rename_driver_linux_step_kp_cfg_edit_for_renamed_wd"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 3</fo:inline></a>):<br><code class="japi"># ADDITIONAL_FLAGS="-DWD_DRIVER_NAME_CHANGE"</code></td></tr></table></div></li><li class="listitem">
        <span class="jprintfilename"><strong>makefile.kp.in</strong></span> and
        <span class="jprintfilename"><strong>makefile.kp.kbuild.in</strong></span> &#8212;
        templates for creating a <span class="jprintfilename"><strong>makefile.kp</strong></span>
        makefile for building and installing the Kernel PlugIn driver module.
        <br>
        The makefile created from
        <span class="jprintfilename"><strong>makefile.kp.build.in</strong></span> uses
        <span class="jprintfilename"><strong>kbuild</strong></span> for the compilation.
        </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    From the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong><a class="link" href="#dist_linux_note_src_dir">&lt;source_dir&gt;</a>/lib</strong></span></span>
    directory, copy the compiled WinDriver-API object code &#8212;

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="jprintfilename"><strong>kp_wdapi1281_gcc_v3.a</strong></span>
        &#8212; for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation
      </li><li class="listitem"><span class="jprintfilename"><strong>kp_wdapi1281_gcc_v3_regparm.a</strong></span>
        &#8212; for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation with the
        <span class="b"><strong>regparm</strong></span> flag
      </li><li class="listitem"><span class="jprintfilename"><strong>kp_wdapi1281_gcc_v2.a</strong></span>
        &#8212; for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v2.x.x</span> compilation;
        note that this file is not found in the
  64-&#65279;bit WinDriver installations, because 64-&#65279;bit Linux architectures don't use
  GCC v2.
      </li></ul></div>
    </li><li class="listitem" style="list-style-type: disc">
    From the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>kermode/linux/LINUX.&lt;kernel version&gt;.&lt;CPU&gt;</strong></span></span> directory that is
    created when building the Kernel PlugIn driver on the development
    machine (see <a class="xref" href="#kp_compilation_linux" title="12.8.2. Linux Kernel PlugIn Driver Compilation"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.8.2</fo:inline></a>, <a class="xref" href="#kp_compile_linux_step_make"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 4</fo:inline></a>), copy to
    the <span class="jdirectory"><strong>lib</strong></span> distribution subdirectory the compiled
    object code for building your Kernel PlugIn driver module (where
    <span class="jprintfilename"><strong>xxx</strong></span> is the name of your Kernel PlugIn
    driver project) &#8212;

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem"><span class="jprintfilename"><strong>kp_xxx_gcc_v3.a</strong></span> &#8212;
        for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation
      </li><li class="listitem"><span class="jprintfilename"><strong>kp_xxx_gcc_v3_regparm.a</strong></span>
        &#8212; for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v3.x.x</span> compilation with the
        <span class="b"><strong>regparm</strong></span> flag
      </li><li class="listitem"><span class="jprintfilename"><strong>kp_xxx_gcc_v2.a</strong></span> &#8212; for
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">GCC v2.x.x</span> compilation;
        note that this file is not found in the
  64-&#65279;bit WinDriver installations, because 64-&#65279;bit Linux architectures don't use
  GCC v2.
      </li></ul></div>
    </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="dist_linux_pkg_prepare_user_hw_ctrl_app_so"></a>14.3.1.2. User-Mode Hardware-Control Application or Shared Object</h4></div></div></div><p>
Copy the user-mode hardware-control application or shared object that you
created with WinDriver, to the distribution package.
</p><p>

If your hardware-control application/shared object uses
<span class="jprintfilename"><strong>libwdapi1281.so</strong></span> &#8212; as is the
case for the WinDriver samples and generated DriverWizard projects &#8212; copy
this file from the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="link" href="#dist_linux_note_src_dir">&lt;source_dir&gt;</a><span class="jdirectory"><strong>/lib</strong></span></span> directory
to your distribution package.<br>


If you are distributing a 32-&#65279;bit application/shared object to a target
64-&#65279;bit platform<a class="xref" href="#32bit_app_on_64bit_arch_win_unix" title="A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux Platforms"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.2]</fo:inline></a> &#8212; copy
<span class="jprintfilename"><strong>libwdapi1281_32.so</strong></span> from the
<span class="jdirectory"><strong>WinDriver/lib</strong></span> directory to your distribution package, and
rename the copy to <span class="jprintfilename"><strong>libwdapi1281.so</strong></span>.

</p><p>
Since your hardware-control application/shared object does not have to be
matched against the Linux kernel version number, you may distribute it as a
binary object (to protect your code from unauthorized copying). If you select
to distribute your driver's source code, note that under the license agreement
with Jungo you may not distribute the source code of the
<span class="jprintfilename"><strong>libwdapi1281.so</strong></span> shared object, or
the WinDriver license string used in your code.
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_linux_build_install_wd_modules"></a>14.3.2. Building and Installing the WinDriver Driver Module on the Target</h3></div></div></div><p>
From the distribution package subdirectory containing the
<span class="jprintfilename"><strong>configure</strong></span> script and related build and
installation files &#8212; normally the <span class="jdirectory"><strong>redist</strong></span> subdirectory<a class="xref" href="#dist_linux_build_install_wd_modules" title="14.3.2. Building and Installing the WinDriver Driver Module on the Target"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [14.3.2]</fo:inline></a> &#8212; perform the following steps
to build and install the driver module on the target:
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Generate the required makefiles:<br>
    <strong class="jcmd"><code>$ </code></strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="jcmd"><code>./configure --disable-usb-support</code></strong></span>

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      The configuration script creates a makefile based on the running kernel.
      You may select to use another installed kernel source, by executing the
      script with the
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="japib"><code>--with-kernel-source=&lt;path&gt;</code></strong></span>
      option, where <strong class="japib"><code>&lt;path&gt;</code></strong> is the full path to the kernel
      source directory &#8212; e.g.,
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src/linux</strong></span></span>.<br></li><li class="listitem" style="list-style-type: disc">
      If the Linux kernel version is 2.6.26 or
  higher, the configuration script generates makefiles that use
  <span class="jprintfilename"><strong>kbuild</strong></span> to compile the kernel modules. You
  can force the use of <span class="jprintfilename"><strong>kbuild</strong></span> on earlier
  versions of Linux, by executing the configuration script with the
  <strong class="japib"><code>--enable-kbuild</code></strong> flag.
    </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  For a full list of the configuration script options, use the
  <strong class="jcmd"><code>--help</code></strong> option:<br><strong class="jcmd"><code>./configure --help</code></strong></td></tr></table></div>
    </li><li class="listitem">
    Build the WinDriver driver module:<br>
    <strong class="jcmd"><code>$ make</code></strong>

    <p>
    This will create a <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>LINUX.&lt;kernel version&gt;.&lt;CPU&gt;</strong></span></span> directory, containing the
    newly compiled driver module &#8212; <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>.
    </p>
    </li><li class="listitem">
    Install the <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>
    
    driver module.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following command must be executed with root privileges.
  </td></tr></table></div>

    <strong class="jcmd"><code># make install</code></strong>
    <p>
    The installation is performed using the
    <span class="jprintfilename"><strong>setup_inst_dir</strong></span> script, which copies the
    driver module to the target's loadable kernel modules directory, and uses
    the <span class="jprintfilename"><strong>wdreg</strong></span> script<a class="xref" href="#dyn_linux" title="13.5. Linux Dynamic Driver Loading"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.5]</fo:inline></a> to
    load the driver module.
    
    </p></li><li class="listitem">
    Change the user and group IDs and give read/write permissions to the device
    file
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/dev/windrvr1281</strong></span></span>,
    depending on how you wish to allow users to access hardware through the
    device. Due to security reasons, by default the device file is created with
    permissions only for the root user. Change the permissions by modifying
    your <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/udev/permissions.d/50-udev.permissions</strong></span></span>
    file. For example, add the following line to provide read and write
    permissions:<br>
    <code class="code">windrvr1281:root:root:0666</code><br>
    </li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Use the <span class="jprintfilename"><strong>wdreg</strong></span> script to dynamically load the
WinDriver driver module on the target after each boot<a class="xref" href="#dyn_linux" title="13.5. Linux Dynamic Driver Loading"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.5]</fo:inline></a>. To
automate this, copy <span class="jprintfilename"><strong>wdreg</strong></span> to the target
machine, and add the following line to the target's Linux boot file (for example,
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/rc.local</strong></span></span>):<br><code class="japi">&lt;path to wdreg&gt; windrvr1281</code></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_linux_build_install_kp_module"></a>14.3.3. Building and Installing Your Kernel PlugIn Driver on the Target</h3></div></div></div><p>
If you have created a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>,
build and install this driver &#8212; <span class="jprintfilename"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span></strong></span> &#8212; on the
target, by performing the following steps from the distribution package
subdirectory containing the <span class="jprintfilename"><strong>configure.kp</strong></span>
script and related build and installation files &#8212; normally the
<span class="jdirectory"><strong>redist</strong></span> subdirectory<a class="xref" href="#dist_linux_build_install_wd_modules" title="14.3.2. Building and Installing the WinDriver Driver Module on the Target"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [14.3.2]</fo:inline></a>.
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Generate the Kernel PlugIn makefile &#8212;
    <span class="jprintfilename"><strong>makefile.kp</strong></span>:<br>
    <strong class="jcmd"><code>$ ./configure.kp</code></strong>
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      The configuration script creates a makefile based on the running kernel.
      You may select to use another installed kernel source, by executing the
      script with the
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><strong class="japib"><code>--with-kernel-source=&lt;path&gt;</code></strong></span>
      option, where <strong class="japib"><code>&lt;path&gt;</code></strong> is the full path to the kernel
      source directory &#8212; e.g.,
      <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/src/linux</strong></span></span>.<br></li><li class="listitem" style="list-style-type: disc">
      If the Linux kernel version is 2.6.26 or
  higher, the configuration script generates makefiles that use
  <span class="jprintfilename"><strong>kbuild</strong></span> to compile the kernel modules. You
  can force the use of <span class="jprintfilename"><strong>kbuild</strong></span> on earlier
  versions of Linux, by executing the configuration script with the
  <strong class="japib"><code>--enable-kbuild</code></strong> flag.
    </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  For a full list of the configuration script options, use the
  <strong class="jcmd"><code>--help</code></strong> option:<br><strong class="jcmd"><code>./configure.kp --help</code></strong></td></tr></table></div></li><li class="listitem"><a name="dist_linux_build_install_kp_module_step_build"></a>
    Build the Kernel PlugIn driver module:<br>
    <strong class="jcmd"><code>$ make -f makefile.kp</code></strong>

    <p>
    This will create a <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>LINUX.&lt;kernel version&gt;.&lt;CPU&gt;.KP</strong></span></span> directory,
    containing the newly compiled driver module &#8212;
    <span class="jprintfilename"><strong><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span></strong></span>.
    </p>
    </li><li class="listitem">
    Install the Kernel PlugIn module.

    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following command must be executed with root privileges.
  </td></tr></table></div>

    <strong class="jcmd"><code># make install -f makefile.kp</code></strong>
    </li></ol></div><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
To automatically load your Kernel PlugIn driver on each boot,
add the following line to the target's Linux boot file (for example,
  <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/etc/rc.local</strong></span></span>), after the WinDriver driver module load command<a class="xref" href="#dyn_kp_load_linux" title="13.5.1. Dynamically Loading/Unloading Your Kernel PlugIn Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.5.1]</fo:inline></a> (replace
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="b"><strong>&lt;path to <span style="white-space:nowrap">kp_xxx_module.o/.ko</span>&gt;</strong></span></span>
with the path to your Kernel PlugIn driver module, which is found in your
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>LINUX.&lt;kernel version&gt;.&lt;CPU&gt;.KP</strong></span></span> distribution directory):<br><code class="japi">/sbin/insmod &lt;path to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap">kp_xxx_module.o/.ko</span>&gt;</code></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="dist_linux_install_user_hw_ctrl_app_so"></a>14.3.4. Installing the User-Mode Hardware-Control Application or
  Shared Object</h3></div></div></div><p>
If your user-mode hardware-control application or shared object uses
<span class="jprintfilename"><strong>libwdapi1281.so</strong></span><a class="xref" href="#dist_linux_pkg_prepare_user_hw_ctrl_app_so" title="14.3.1.2. User-Mode Hardware-Control Application or Shared Object"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [14.3.1.2]</fo:inline></a>, copy
<span class="jprintfilename"><strong>libwdapi1281.so</strong></span> from the
distribution package to the target's library directory:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/lib</strong></span></span> &#8212; when
    distributing a 32-&#65279;bit application/shared object to a 32-&#65279;bit or 64-&#65279;bit
    target
  </li><li class="listitem" style="list-style-type: disc"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/lib64</strong></span></span> &#8212; when
    distributing a 64-&#65279;bit application/shared object to a 64-&#65279;bit target
  </li></ul></div><p>
</p><p>
If you decided to distribute the source code of the application/shared
object<a class="xref" href="#dist_linux_pkg_prepare_user_hw_ctrl_app_so" title="14.3.1.2. User-Mode Hardware-Control Application or Shared Object"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [14.3.1.2]</fo:inline></a>, copy the source
code to the target as well.

</p><div class="caution" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Caution"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Caution]" src="scripts/images/caution.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Remember that you may <em class="it">not</em> distribute the source code of the
<span class="jprintfilename"><strong>libwdapi1281.so</strong></span> shared object or
your WinDriver license string as part of the source code distribution<a class="xref" href="#dist_linux_pkg_prepare_user_hw_ctrl_app_so" title="14.3.1.2. User-Mode Hardware-Control Application or Shared Object"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [14.3.1.2]</fo:inline></a>.
</td></tr></table></div><p>
</p></div></div></div><div class="chapter"><div class="titlepage"><div><div><h1 class="title"><a name="driver_install_advanced"></a>Chapter 15. Driver Installation &#8212; Advanced Issues</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="winpnp_inf"></a>15.1. Windows INF Files</h2></div></div></div><p>
Device information (INF) files are text files that provide information used by
the Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play mechanism to install software that supports a given
hardware device. INF files are required for hardware that identifies itself,
such as USB and PCI. An INF file includes all necessary information about a
device and the files to be installed. When hardware manufacturers introduce new
products, they must create INF files to explicitly define the resources and
files required for each class of device.
</p><p>
In some cases, the INF file for your specific device is supplied by the
operating system. In other cases, you will need to create an INF file for your
device. WinDriver's DriverWizard can generate a specific INF file for your
device. The INF file is used to notify the operating system that WinDriver now
handles the selected device.
</p><p>
You can use DriverWizard to generate the INF file on the development machine
&#8212; as explained in <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>
of the manual &#8212; and then install the INF file on any machine to which you
distribute the driver, as explained in the following sections.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Why_Create_INF"></a>15.1.1. Why Should I Create an INF File?</h3></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    To bind the WinDriver kernel module to a specific <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> device.
  </li><li class="listitem" style="list-style-type: disc">
    To override the existing driver (if any).
  </li><li class="listitem" style="list-style-type: disc">
    To enable WinDriver applications and DriverWizard to access a <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> 
    device.
  </li><li class="listitem" style="list-style-type: disc">
    To enable WinDriver to obtain a Plug&#65279;-&#65279;and&#65279;-&#65279;Play representation of <span xmlns:fo="http://www.w3.org/1999/XSL/Format">PCI</span> device
    resources (I/&#65279;O ranges, memory ranges, and interrupts).
      <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
      Handling of Message-Signaled Interrupts (MSI) or Extended Message-Signaled Interrupts (MSI-&#65279;X) requires specific
      configuration of the INF file &#8212; see further details in
      <a class="xref" href="#win_msi_inf_files" title="9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.7.1</fo:inline></a>.
      </td></tr></table></div></li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="INF_install_no_driver"></a>15.1.2. How Do I Install an INF File When No Driver Exists?</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
You must have administrative privileges in order to install an INF file.
</td></tr></table></div><p>
You can use the <span class="jprintfilename"><strong>wdreg</strong></span> utility with the
<strong class="jcmd"><code>install</code></strong> command to automatically install the INF file:<br>
<strong class="jcmd"><code>wdreg -inf &lt;path to the INF file&gt; install</code></strong><br>
(For more information, refer to
<a class="xref" href="#dyn_windows_wdreg" title="13.2.1. The wdreg Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.2.1</fo:inline></a> of the manual.)
</p><p>
On the development PC, you can have the INF file automatically installed when
selecting to generate the INF file with DriverWizard, by checking the
<span class="jmenuitem"><strong>Automatically Install the INF file</strong></span> option in the
DriverWizard's INF generation window (refer to
<a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>).
</p><p>
    On the development PC, you can also use the <span class="jprintfilename"><strong>wdreg_frontned</strong></span> <a class="xref" href="#wdreg_frontend" title="13.3. The wdreg_frontend utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.3]</fo:inline></a> utility to install/uninstall INFs and perform other advanced tasks.
</p><p>
It is also possible to install the INF file manually, using either of the
following methods:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Windows <span class="jmenuitem"><strong>Found New Hardware Wizard</strong></span>: This wizard is
    activated when the device is plugged in or, if the device was already
    connected, when scanning for hardware changes from the Device Manager.
  </li><li class="listitem" style="list-style-type: disc">
    Windows <span class="jmenuitem"><strong>Add/Remove Hardware Wizard</strong></span>: Right-click the
    mouse on <span class="jmenuitem"><strong>My Computer</strong></span>, select
    <span class="jmenuitem"><strong>Properties</strong></span>, choose the
    <span class="jmenuitem"><strong>Hardware</strong></span> tab and click on
    <span class="jmenuitem"><strong>Hardware Wizard...</strong></span>.
  </li><li class="listitem" style="list-style-type: disc">
    Windows <span class="jmenuitem"><strong>Upgrade Device Driver Wizard</strong></span>: Locate the
    device in the <span class="jmenuitem"><strong>Device Manager</strong></span> devices list and select
    the <span class="jmenuitem"><strong>Update Driver...</strong></span> option from the right-click
    mouse menu or from the Device Manager's <span class="jmenuitem"><strong>Action</strong></span> menu.
  </li></ul></div><p>
</p><p>
In all the manual installation methods above you will need to point Windows to
the location of the relevant INF file during the installation.<br>
We recommend using the <span class="jprintfilename"><strong>wdreg</strong></span> utility to
install the INF file automatically, instead of installing it manually.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If the installation fails with an
  <strong class="japib"><code>ERROR_FILE_NOT_FOUND</code></strong> error, inspect the Windows registry to
  see if the <strong class="japib"><code>RunOnce</code></strong> key exists in
  <strong class="japib"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code></strong>.
  This registry key is required by Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play in order to properly install
  drivers using INF files. If the <strong class="japib"><code>RunOnce</code></strong> key is missing, create
  it; then try installing the INF file again.
</td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="INF_replace_driver"></a>15.1.3. How Do I Replace an Existing Driver Using the INF File?</h3></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
You must have administrative privileges in order to replace a driver.
</td></tr></table></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p>
    Install your INF file.
    </p><p>
    You can use the <span class="jprintfilename"><strong>wdreg</strong></span> utility with the
    <strong class="jcmd"><code>install</code></strong> command to automatically install the INF file:<br>
    <strong class="jcmd"><code>wdreg -inf &lt;path to INF file&gt; install</code></strong> <br>
    (For more information, refer to
    <a class="xref" href="#dyn_windows_wdreg" title="13.2.1. The wdreg Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 13.2.1</fo:inline></a> of the manual.)
    </p><p>
    On the development PC, you can have the INF file automatically installed
    when selecting to generate the INF file with DriverWizard, by checking the
    <span class="jmenuitem"><strong>Automatically Install the INF file</strong></span> option in the
    DriverWizard's INF generation window (refer to
    <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>).
</p><p>
    On the development PC, you can also use the <span class="jprintfilename"><strong>wdreg_frontned</strong></span> <a class="xref" href="#wdreg_frontend" title="13.3. The wdreg_frontend utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.3]</fo:inline></a> utility to install/uninstall INFs and perform other advanced tasks.
    </p><p>
    It is also possible to install the INF file manually, using either of the
    following methods:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Windows <span class="jmenuitem"><strong>Found New Hardware Wizard</strong></span>: This wizard
        is activated when the device is plugged in or, if the device was
        already connected, when scanning for hardware changes from the Device
        Manager.
        </li><li class="listitem" style="list-style-type: disc">
        Windows <span class="jmenuitem"><strong>Add/Remove Hardware Wizard</strong></span>:
        Right-click on <span class="jmenuitem"><strong>My Computer</strong></span>, select
        <span class="jmenuitem"><strong>Properties</strong></span>, choose the
        <span class="jmenuitem"><strong>Hardware</strong></span> tab and click on
        <span class="jmenuitem"><strong>Hardware Wizard...</strong></span>.
        </li><li class="listitem" style="list-style-type: disc">
        Windows <span class="jmenuitem"><strong>Upgrade Device Driver Wizard</strong></span>: Locate
        the device in the <span class="jmenuitem"><strong>Device Manager</strong></span> devices list
        and select the <span class="jmenuitem"><strong>Update Driver...</strong></span> option from
        the right-click mouse menu or from the Device Manager's
        <span class="jmenuitem"><strong>Action</strong></span> menu.
        </li></ul></div><p>
    </p><p>
    In the manual installation methods above you will need to point Windows to
    the location of the relevant INF file during the installation. If the
    installation wizard offers to install an INF file other than the one you
    have generated, select
    <span class="jmenuitem"><strong>Install one of the other drivers</strong></span> and choose your
    specific INF file from the list.
    </p><p>
    We recommend using the <span class="jprintfilename"><strong>wdreg</strong></span> utility to
    install the INF file automatically, instead of installing it manually.
    </p></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
If the installation fails with an
  <strong class="japib"><code>ERROR_FILE_NOT_FOUND</code></strong> error, inspect the Windows registry to
  see if the <strong class="japib"><code>RunOnce</code></strong> key exists in
  <strong class="japib"><code>HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion</code></strong>.
  This registry key is required by Windows Plug&#65279;-&#65279;and&#65279;-&#65279;Play in order to properly install
  drivers using INF files. If the <strong class="japib"><code>RunOnce</code></strong> key is missing, create
  it; then try installing the INF file again.
</td></tr></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="wd_rename_driver"></a>15.2. Renaming the WinDriver Kernel Driver</h2></div></div></div><p>
The WinDriver APIs are implemented within the WinDriver kernel driver module
(<span class="jprintfilename"><strong>windrvr1281.sys/.dll/.o/.ko</strong></span> &#8212; depending on the OS), which provides the main driver functionality and enables
you to code your specific driver logic from the user mode<a class="xref" href="#WD_arch" title="1.6. WinDriver Architecture"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [1.6]</fo:inline></a>.
</p><p>
On Windows and Linux you can change the name of the WinDriver kernel module
to your preferred driver name, and then distribute the renamed driver instead
of the default kernel module &#8212; <span class="jprintfilename"><strong>windrvr1281.sys/.dll/.o/.ko</strong></span>. The following
sections explain how to rename the driver for each of the supported operating
systems.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
For information on how to use the Debug Monitor to log debug messages from your
renamed driver, refer to <a class="xref" href="#wddebug_gui_renamed_driver" title="6.2.1.3. Running wddebug_gui for a Renamed Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 6.2.1.3: <span style="">Running wddebug_gui for a Renamed Driver</span></fo:inline></a>.
</td></tr></table></div><p>
A renamed WinDriver kernel driver can be installed on the same machine as the
original kernel module. You can also install multiple renamed WinDriver drivers on
the same machine, simultaneously.



</p><div class="tip" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Tip"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Tip]" src="scripts/images/tip.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Try to give your driver a unique name in order to avoid a potential conflict
with other drivers on the target machine on which your driver will be
installed.
</td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_rename_driver_windows"></a>15.2.1. Windows Driver Renaming</h3></div></div></div><p>
DriverWizard automates most of the work of renaming the Windows WinDriver kernel
driver &#8212; <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    When renaming the driver, the CPU architecture (32-&#65279;/64-&#65279;bit) of the
    development platform and its WinDriver installation, should match the target
    platform.
    </li><li class="listitem" style="list-style-type: disc">
    Renaming the signed <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver nullifies its signature.
    In such cases you can select either to sign your new driver, or to
    distribute an unsigned driver. For more information on driver signing and
    certification, refer to <a class="xref" href="#driver_sign" title="15.3. Windows Digital Driver Signing and Certification"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3</fo:inline></a>. For guidelines
    for signing and certifying your renamed driver, refer to
    <a class="xref" href="#driver_sign_wd_drivers" title="15.3.2. Driver Signing and Certification of WinDriver-Based Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3.2</fo:inline></a>.
  </li></ul></div></td></tr></table></div><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
References to
  <span class="jprintfilename"><strong>xxx</strong></span> in this section should be replaced with
  the name of your generated DriverWizard driver project.
</td></tr></table></div><p>
To rename your Windows WinDriver kernel driver, follow these steps:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a name="wd_rename_driver_windows_step_wiz_gen_files"></a>
    Use the DriverWizard utility to generate driver code for your hardware on
    Windows (refer to <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>, <a class="xref" href="#step_dw_code_gen"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 6</fo:inline></a>), using your
    preferred driver name (<span class="jprintfilename"><strong>xxx</strong></span>) as the name of
    the generated driver project. The generated project directory
    (<span class="jdirectory"><strong>xxx</strong></span>) will include an
    <span class="jdirectory"><strong>xxx_installation</strong></span> directory with the following
    files and directories:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="jdirectory"><strong>redist</strong></span> directory:

        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
            <span class="jprintfilename"><strong>xxx.sys</strong></span> &#8212; Your new driver,
            which is actually a renamed copy of the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>
            driver. Note: The properties of the generated driver file (such
            as the file's version, company name, etc.) are identical to the
            properties of the original <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver. You can
            rebuild the driver with new properties using the files from the
            generated <span class="jdirectory"><strong>xxx_installation sys</strong></span> directory,
            as explained below.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>xxx_driver.inf</strong></span> &#8212; A
            modified version of the <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file, which will be used
            to install your new <span class="jprintfilename"><strong>xxx.sys</strong></span>
            driver.<br>
            You can make additional modifications to this file, if you
            wish &#8212; namely, changing the string definitions and/or
            comments in the file.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>xxx_device.inf</strong></span> &#8212; A
            modified version of the standard generated DriverWizard INF file
            for your device, which registers your device with your driver
            (<span class="jprintfilename"><strong>xxx.sys</strong></span>).<br>
            You can make additional modifications to this file, if you wish,
            such as changing the manufacturer or driver provider strings.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>wdapi1281.dll</strong></span> &#8212;
            A copy of the WinDriver-API DLL. The DLL is copied here in order to
            simplify the driver distribution, allowing you to use the generated
            <span class="jdirectory"><strong>xxx\&#65279;redist</strong></span> directory as the main
            installation directory for your driver, instead of the original
            <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist</strong></span> directory.
            </li><li class="listitem">
            <span class="jprintfilename"><strong>wdreg.exe</strong></span>,
            <span class="jprintfilename"><strong>wdreg_gui.exe</strong></span>, and
            <span class="jprintfilename"><strong>difxapi.dll</strong></span> &#8212; Copies of the
            CUI and GUI versions of the
            <span class="jprintfilename"><strong>wdreg</strong></span> WinDriver driver installation
            utility, and the Driver Install Frameworks API (<span class="b"><strong>DIFxAPI</strong></span>) DLL required by this utility<a class="xref" href="#dyn_windows_wdreg" title="13.2.1. The wdreg Utility"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [13.2.1]</fo:inline></a>, (respectively). These files are copied
            from the <span class="jdirectory"><strong>WinDriver\util</strong></span> directory, to
            simplify the installation of the renamed driver.
            </li><li class="listitem"><a name="wd_wiz_win_gen_files_xxx_install_script"></a>
            <span class="jprintfilename"><strong>xxx_install.bat</strong></span> &#8212; An
            installation script that executes the
            <span class="jprintfilename"><strong>wdreg</strong></span> commands for installing the
            <span class="jprintfilename"><strong>xxx_driver.inf</strong></span> and
            <span class="jprintfilename"><strong>xxx_device.inf</strong></span> files. This script
            is designed to simplify the installation of the renamed
            <span class="jprintfilename"><strong>xxx_driver.sys</strong></span> driver, and the
            registration of your device with this driver.
            </li></ul></div></li><li class="listitem" style="list-style-type: disc"><p>
        <span class="jdirectory"><strong>sys</strong></span> directory: This directory contains files
        for advanced users, who wish to change the properties of their driver
        file. Note: Changing the file's properties requires rebuilding of the
        driver module using the Windows Driver Kit (<span class="b"><strong>WDK</strong></span>).<br>
        To modify the properties of your
        <span class="jprintfilename"><strong>xxx.sys</strong></span> driver file:

        </p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
            Verify that the WDK is installed on your development PC, or
            elsewhere on its network, and set the <span class="b"><strong>BASEDIR</strong></span> environment
            variable to point to the WDK installation directory.
            </li><li class="listitem">
           Modify the <span class="jprintfilename"><strong>xxx.rc</strong></span> resources file in
           the generated <span class="jdirectory"><strong>sys</strong></span> directory in order to set
           different driver file properties.
            </li><li class="listitem">
            Rebuild the driver by running the following command:<br>
            <strong class="jcmd"><code>ddk_make &lt;OS&gt; &lt;build mode (free/checked)&gt;</code></strong>
            <br>
            For example, to build a release version of the driver for Windows 7:
            <br>
            <strong class="jcmd"><code>ddk_make win7 free</code></strong>
            <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   The <span class="jprintfilename"><strong>ddk_make.bat</strong></span> utility is provided
   under the <span class="jdirectory"><strong>WinDriver\util</strong></span> directory, and should be
   automatically identified by Windows when running the build command.
   Run <strong class="jcmd"><code>ddk_make.bat</code></strong> with no parameters to view the available
   options for this utility.
  </li><li class="listitem" style="list-style-type: disc">
    The selected build OS must match the CPU architecture of your WinDriver
    installation. For example, you cannot select the 64-&#65279;bit
    <code class="japi">win7_x64</code> OS flag when using a 32-&#65279;bit WinDriver installation.
  </li></ul></div></td></tr></table></div></li></ol></div><p>
        </p><p>
        After rebuilding the <span class="jprintfilename"><strong>xxx.sys</strong></span> driver,
        copy the new driver file to the generated
        <span class="jdirectory"><strong>xxx_installation\&#65279;redist</strong></span> directory.
        </p></li></ul></div></li><li class="listitem">
    
  Verify that your user-mode application calls the <code class="jfunc">WD_DriverName</code><span class="jfunc">()</span>
  function<a class="xref" href="#WD_DriverName" title="B.1. WD_DriverName"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.1]</fo:inline></a> with your new driver name before calling
  any other WinDriver function.<br>
  Note that the sample and generated DriverWizard WinDriver applications already
  include a call to this function, but with the default driver name
  (<span class="jprintfilename"><strong>windrvr1281</strong></span>),
  
  so all you need to do is replace the driver name that is passed to the
  function in the code with your new driver name.

    </li><li class="listitem">
    
  Verify that your user-mode driver project is built with the
  <code class="japi">WD_DRIVER_NAME_CHANGE</code> preprocessor flag
  (e.g., <code class="japi">-DWD_DRIVER_NAME_CHANGE</code>).<br>
  Note: The sample and generated DriverWizard WinDriver kernel projects/makefiles
  already set this preprocessor flag by default.

    </li><li class="listitem">
    
  Install your new driver by following the instructions in
  <a class="xref" href="#dist_winpnp" title="14.2. Windows Driver Distribution"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.2</fo:inline></a> of the manual, using the modified files from the generated
  <span class="jdirectory"><strong>xxx_installation</strong></span> directory instead of the
  installation files from the original WinDriver distribution.
  
    Note that you can use the generated
    <a class="link" href="#wd_wiz_win_gen_files_xxx_install_script"><span class="jprintfilename"><strong>xxx_install.bat</strong></span></a> installation
   script (see <a class="xref" href="#wd_rename_driver_windows_step_wiz_gen_files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 1</fo:inline></a>) to
   simplify the installation.
  
    </li></ol></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_rename_driver_linux"></a>15.2.2. Linux Driver Renaming</h3></div></div></div><p>
DriverWizard automates most of the work of renaming the Linux WinDriver kernel
driver &#8212; <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>.
</p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
References to
  <span class="jprintfilename"><strong>xxx</strong></span> in this section should be replaced with
  the name of your generated DriverWizard driver project.
</td></tr></table></div><p>
To rename your Linux WinDriver kernel driver, follow these steps:

</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><a name="wd_rename_driver_linux_step_wiz_gen_files"></a>
    Use the DriverWizard utility to generate driver code for your hardware on
    Linux (refer to <a class="xref" href="#DriverWizard_Walkthrough" title="4.2. DriverWizard Walkthrough"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 4.2</fo:inline></a>, <a class="xref" href="#step_dw_code_gen"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Step 6</fo:inline></a>), using your
    preferred driver name (<span class="jprintfilename"><strong>xxx</strong></span>) as the name of
    the generated driver project. The generated project directory
    (<span class="jdirectory"><strong>xxx</strong></span>) will include an
    <span class="jdirectory"><strong>xxx_installation</strong></span> directory with the following
    files and directories:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        <span class="jdirectory"><strong>redist</strong></span> directory: This directory contains copies of the files
        from the original <span class="jdirectory"><strong>WinDriver&#65279;/&#65279;redist</strong></span> installation directory, but with the
        required modifications for building your
        <span class="jprintfilename"><strong>xxx.o/&#65279;.ko</strong></span> driver instead of
        <span class="jprintfilename"><strong>windrvr1281.o/.ko</strong></span>.
        
        </li><li class="listitem" style="list-style-type: disc">
        <span class="jdirectory"><strong>lib</strong></span> and <span class="jdirectory"><strong>include</strong></span>
        directories: Copies of the library and include directories from the
        original WinDriver distribution. These copies are created since the
        supported Linux WinDriver kernel driver build method relies on the
        existence of these directories directly under the same parent directory
        as the <span class="jdirectory"><strong>redist</strong></span> directory.
        </li></ul></div></li><li class="listitem">
    
  Verify that your user-mode application calls the <code class="jfunc">WD_DriverName</code><span class="jfunc">()</span>
  function<a class="xref" href="#WD_DriverName" title="B.1. WD_DriverName"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.1]</fo:inline></a> with your new driver name before calling
  any other WinDriver function.<br>
  Note that the sample and generated DriverWizard WinDriver applications already
  include a call to this function, but with the default driver name
  (<span class="jprintfilename"><strong>windrvr1281</strong></span>),
  
  so all you need to do is replace the driver name that is passed to the
  function in the code with your new driver name.

    </li><li class="listitem"><a name="wd_rename_driver_linux_step_kp_cfg_edit_for_renamed_wd"></a>
    
  Verify that your user-mode driver project is built with the
  <code class="japi">WD_DRIVER_NAME_CHANGE</code> preprocessor flag
  (<code class="japi">-DWD_DRIVER_NAME_CHANGE</code>).<br>
  Note: The sample and generated DriverWizard WinDriver kernel projects/makefiles
  already set this preprocessor flag by default.
<span xmlns:fo="http://www.w3.org/1999/XSL/Format">If you have created a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline> [11]</fo:inline></a>, you will need to add this flag by
      uncommenting the following line in the Kernel PlugIn driver's
      configuration script:<br>
      <code class="japi"># ADDITIONAL_FLAGS="-DWD_DRIVER_NAME_CHANGE"</code>
    </span>
    </li><li class="listitem">
    
  Install your new driver by following the instructions in
  <a class="xref" href="#dist_linux" title="14.3. Linux Driver Distribution"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.3</fo:inline></a> of the manual, using the modified files from the generated
  <span class="jdirectory"><strong>xxx_installation</strong></span> directory instead of the
  installation files from the original WinDriver distribution.
  <br>
    As part of the installation, build your new kernel driver module(s) by
  following the instructions in <a class="xref" href="#dist_linux" title="14.3. Linux Driver Distribution"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 14.3</fo:inline></a>, using the
  files from your new installation directory.
    </li></ol></div><p>
</p></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="driver_sign"></a>15.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Windows Digital Driver Signing and Certification</span></h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="driver_sign_n_cert_overview"></a>15.3.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Overview</span></h3></div></div></div><p>

Before distributing your driver, you may digitally sign it using Microsoft's
Authenticode mechanism, and/or certify it by submitting it to Microsoft's Windows Certification Program 
(HLK/HCK/WLP).<br>


Some Windows operating systems, such as Windows 7, do not require installed
drivers to be digitally signed or certified. Only a popup with a warning will 
appear


There are, however, advantages to getting your driver digitally signed or fully
certified, including the following:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Driver installation on systems where installing unsigned drivers has been
    blocked
  </li><li class="listitem" style="list-style-type: disc">
    Avoiding warnings during driver installation
    </li><li class="listitem" style="list-style-type: disc">
    Full pre-installation of INF files<a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.1]</fo:inline></a> on
    Windows 7 and higher
  </li></ul></div><p>

</p><p>
64-&#65279;bit versions of Windows 8 and higher require Kernel-Mode Code Signing
(KMCS) of software that loads in kernel mode. This has the following
implications for WinDriver-based drivers:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Drivers that are installed via an INF file must be distributed together
    with a signed catalog file (see details in
    <a class="xref" href="#driver_sign_wd_drivers" title="15.3.2. Driver Signing and Certification of WinDriver-Based Drivers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3.2</fo:inline></a>).
  </li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
During driver development, please configure your Windows OS to temporarily
allow the installation of unsigned drivers.
</td></tr></table></div><p>
For more information about digital driver signing and certification, refer to
the following documentation in the Microsoft Development Network (MSDN) library:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <em class="it">Driver Signing Requirements for Windows</em>
    
    </li><li class="listitem" style="list-style-type: disc">
    <em class="it">Introduction to Code Signing</em>
    
    </li><li class="listitem" style="list-style-type: disc">
    <em class="it">Digital Signatures for Kernel Modules on Windows</em><br>
    
    This white paper contains information about kernel-mode code signing, test
    signing, and disabling signature enforcement during development.
    </li><li class="listitem" style="list-style-type: disc">
    <a class="ulink" href="https://msdn.microsoft.com/en-us/windows-drivers/develop/signing_a_driver" target="_top">https://msdn.microsoft.com/en-us/windows-drivers/develop/signing_a_driver</a>
    </li></ul></div><p>

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"><a name="ms_driver_certif_n_sign_term_note"></a></th></tr><tr><td align="left" valign="top">
Some of the documentation may still use old terminology. For example,
references to the <em class="it">Windows Logo Program (<span class="b"><strong>WLP</strong></span>)</em> or to the <em class="it">Windows Hardware Quality Labs (<span class="b"><strong>WHQL</strong></span>)</em> or
to the <em class="it">Windows Certification Program</em> or to the <em class="it">Windows Hardware Certification Kit (<span class="b"><strong>HCK</strong></span>)</em>
should be replaced with the <em class="it">Windows Hardware Lab Kit (<span class="b"><strong>HLK</strong></span>)</em>, and references to the
<em class="it">Windows Quality Online Services (<span class="b"><strong>Winqual</strong></span>)</em> should be replaced with the
<em class="it">Windows Dev Center Hardware Dashboard Services
                                (the <span class="b"><strong>Hardware Dashboard</strong></span>)</em>.
</td></tr></table></div><p>
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="authenticode_overview"></a>15.3.1.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Authenticode Driver Signature</span></h4></div></div></div><p>
The Microsoft Authenticode mechanism verifies the authenticity of a driver's
provider. It allows driver developers to include information about themselves
and their code with their programs through the use of digital signatures, and
informs users of the driver that the driver's publisher is participating in an
infrastructure of trusted entities.<br>
The Authenticode signature does not, however, guarantee the code's safety or
functionality.
</p><p>
The <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist&#65279;\</strong></span><span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver has an Authenticode
digital signature.
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="whql_overview"></a>15.3.1.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Windows Certification Program</span></h4></div></div></div><p>
Microsoft's Windows Certification Program (previously known as the Windows Logo Program (WLP)), lays out procedures for
submitting hardware and software modules, including drivers, for Microsoft
quality assurance tests. Passing the tests qualifies the hardware/software for
Microsoft certification, which verifies both the driver provider's authenticity
and the driver's safety and functionality.
</p><p>
To digitally sign and certify a device driver, a Windows Hardware Lab Kit (<span class="b"><strong>HLK</strong></span>) package, which
includes the driver and the related hardware, should be submitted to the
Windows Certification Program for testing, using the Windows Dev Center Hardware Dashboard Services
                                (the <span class="b"><strong>Hardware Dashboard</strong></span>).
</p><div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Jungo's professional services unit provides a complete Windows driver
certification service for Jungo-based drivers. Professional engineers
efficiently perform all the tests required by the Windows Certification Program, relieving customers
of the expense and stress of in-house testing. Jungo prepares an HLK / HCK
submission package containing the test results, and delivers the package to the
customer, ready for submission to Microsoft.<br>
For more information, refer to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/services/windows_drivers_certification/" target="_top">https://www.jungo.com/st/services/windows_drivers_certification/</a></span>.
</td></tr></table></div><p>
For detailed information regarding Microsoft's Windows Certification Program and the certification process,
refer to the MSDN <em class="it">Windows Hardware Certification</em> page &#8212; <a class="ulink" href="https://msdn.microsoft.com/library/windows/hardware/gg463010.aspx" target="_top">https://msdn.microsoft.com/library/windows/hardware/gg463010.aspx</a> &#8212; and to the documentation referenced from that
page, including the MSDN <em class="it">Windows Dev Center &#8212; Hardware Dashboard Services page</em> page &#8212; <a class="ulink" href="https://msdn.microsoft.com/library/windows/hardware/gg463091" target="_top">https://msdn.microsoft.com/library/windows/hardware/gg463091</a>.
</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="driver_sign_wd_drivers"></a>15.3.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">Driver Signing and Certification of WinDriver-Based Drivers</span></h3></div></div></div><p>
As indicated above<a class="xref" href="#authenticode_overview" title="15.3.1.1. Authenticode Driver Signature"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.3.1.1]</fo:inline></a>, The
<span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist&#65279;\</strong></span><span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver has an embedded 
Authenticode signature. Since WinDriver's kernel module (<span class="jprintfilename"><strong>windrvr1281.sys</strong></span>) is
a generic driver, which can be used as a driver for different types of hardware
devices, it cannot be submitted to Microsoft's Windows Certification Program as a standalone driver. However,
once you have used WinDriver to develop a Windows driver for your selected
hardware, you can submit both the hardware and driver for Microsoft
certification, as explained below.
</p><p>
The driver certification and signature procedures &#8212; either via
Authenticode or the Windows Certification Program &#8212; require the creation of a catalog file
for the driver. This file is a sort of hash, which describes other files. The
signed <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver is provided with a matching catalog file
&#8212;
<span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist&#65279;\</strong></span><span class="jprintfilename"><strong>windrvr1281.cat</strong></span>.
This file is assigned to the <code class="japi">CatalogFile</code> entry in the
<span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file (provided as well in the <span class="jdirectory"><strong>redist</strong></span> directory). This
entry is used to inform Windows of the driver's signature and the relevant
catalog file during the driver's installation.
</p><p>
When the name, contents, or even the date of the files described in a driver's
catalog file is modified, the catalog file, and consequently the driver
signature associated with it, become invalid. Therefore, if you select to
rename the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [15.2]</fo:inline></a> and/or the
related <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file, the <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> catalog file and the related
driver signature will become invalid.
</p><p>
In addition, when using WinDriver to develop a driver for your Plug&#65279;-&#65279;and&#65279;-&#65279;Play device, you
normally also create a device-specific INF file that registers your device to
work with the <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> driver module (or a renamed version of this
driver). Since this INF file is created at your site, for your specific
hardware, it is not referenced from the <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> catalog file and cannot
be signed by Jungo a priori.
</p><p>
When renaming <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> and/or creating a device-specific INF file
for your device, you have two alternative options regarding your driver's
digital signing:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Do not digitally sign your driver. If you select this option, remove or
    comment-out the reference to the <span class="jprintfilename"><strong>windrvr1281.cat</strong></span> file from the
    <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> file (or your renamed version of this file).
    </li><li class="listitem" style="list-style-type: disc"><p>
    Submit your driver to the Windows Certification Program, or have it Authenticode signed.<br>
    Note that while renaming <span class="jdirectory"><strong>WinDriver&#65279;\&#65279;redist&#65279;\</strong></span><span class="jprintfilename"><strong>windrvr1281.sys</strong></span>
    nullifies the driver's digital signature, the driver is still compliant
    with the certification requirements of the Windows Certification Program.
    </p><p>
    
    To digitally sign/certify your driver, follow these steps:

    </p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        Create a new catalog file for your driver, as explained in the Windows Certification Program
        documentation. The new file should reference both <span class="jprintfilename"><strong>windrvr1281.sys</strong></span>
        (or your renamed driver) and any INF files used in your driver's
        installation.
        </li><li class="listitem">
        Assign the name of your new catalog file to the
        <code class="japi">CatalogFile</code> entry in your driver's INF file(s). (You can
        either change the <code class="japi">CatalogFile</code> entry in the <span class="jprintfilename"><strong>windrvr1281.inf</strong></span>
        file to refer to your new catalog file, and add a similar entry in your
        device-specific INF file; or incorporate both <span class="jprintfilename"><strong>windrvr1281.inf</strong></span> and your
        device INF file into a single INF file that contains such a
        <code class="japi">CatalogFile</code> entry).
        </li><li class="listitem"><p>
        Submit your driver to Microsoft's Windows Certification Program or for an Authenticode signature.
        If you wish to submit your driver to the Windows Certification Program, refer to the
        additional guidelines in <a class="xref" href="#hck_test_notes" title="15.3.2.1. HCK Test Notes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.3.2.1</fo:inline></a>.
        </p><p>
        Note that many WinDriver customers have already successfully digitally
        signed and certified their WinDriver-based drivers.
        </p></li></ul></div><p>
    </p></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="hck_test_notes"></a>15.3.2.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">HCK Test Notes</span></h4></div></div></div><p>
As indicated in Microsoft's documentation, before submitting the driver for
testing and certification you need to download the Windows Hardware Certification Kit (<span class="b"><strong>HCK</strong></span>), and run the
relevant tests for your hardware/software. After you have verified that you can
successfully pass the HCK tests, create the required logs package and
proceed according to Microsoft's documentation. For more information, refer to
the MSDN <em class="it">Windows Hardware Certification Kit (HCK)</em> page &#8212; <a class="ulink" href="https://msdn.microsoft.com/library/windows/hardware/hh833788" target="_top">https://msdn.microsoft.com/library/windows/hardware/hh833788</a>.
</p></div></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="64bit_os_sup"></a>Appendix A. 64-&#65279;Bit Operating Systems Support</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="64bit_arch_sup"></a>A.1. Supported 64-&#65279;Bit Architectures</h2></div></div></div><p>
WinDriver supports the following 64-&#65279;bit platforms:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Linux AMD64 or Intel EM64T (<span class="b"><strong>x86_64</strong></span>).<br>
    For a full list of the Linux platforms supported by WinDriver, refer to
    <a class="xref" href="#sys_req_linux" title="3.1.3. Linux System Requirements"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.1.3</fo:inline></a>.
  </li><li class="listitem" style="list-style-type: disc">
    Windows AMD64 or Intel EM64T (<span class="b"><strong>x64</strong></span>).<br>
    For a full list of the Windows platforms supported by WinDriver, refer to
    <a class="xref" href="#sys_req_windows" title="3.1.1. Windows System Requirements"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 3.1.1</fo:inline></a>.
  </li></ul></div><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The project or makefile for a 64-&#65279;bit driver project must include the
<strong class="japib"><code>KERNEL_64BIT</code></strong> preprocessor definition.
In the makefiles, the definition is
  added using the <code class="japi">-D</code> flag: <code class="japi">-&#65279;DKERNEL_64BIT</code>.<br>
The sample and
  wizard-generated Linux and Windows GCC makefiles and the Windows MS Visual Studio
  projects, in the 64-&#65279;bit WinDriver toolkit, already include this definition.
</td></tr></table></div><p>
For information regarding performing 64-&#65279;bit data transfers with WinDriver,
including on 32-&#65279;bit platforms, refer to
<a class="xref" href="#64_bit_data_transfers" title="10.2.3. Performing 64-&#65279;Bit Data Transfers"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 10.2.3</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="32bit_app_on_64bit_arch_win_unix"></a>A.2. Support for 32-&#65279;Bit Applications on 64-&#65279;Bit Windows and Linux
  Platforms</h2></div></div></div><p>
By default, applications created using the 64-&#65279;bit versions of WinDriver are
64-&#65279;bit applications. Such applications are more efficient than 32-&#65279;bit
applications. However, you can also use the 64-&#65279;bit WinDriver versions to create
32-&#65279;bit applications that will run on the supported Windows and Linux
64-&#65279;bit platforms<a class="xref" href="#64bit_arch_sup" title="A.1. Supported 64-&#65279;Bit Architectures"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [A.1]</fo:inline></a>.
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
In the following documentation, <span class="jdirectory"><strong>&lt;WD64&gt;</strong></span> signifies
the path to a 64-&#65279;bit WinDriver installation directory for your target operating
system, and <span class="jdirectory"><strong>&lt;WD32&gt;</strong></span> signifies the path to a
32-&#65279;bit WinDriver installation directory for the same operating system.
</td></tr></table></div><p>
To create a 32-&#65279;bit application for 64-&#65279;bit Windows or Linux platforms,
using the 64-&#65279;bit version of WinDriver, do the following:
</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
    Create a WinDriver application, as outlined in this manual (e.g., by
    generating code with DriverWizard, or using one of the WinDriver samples).
  </li><li class="listitem">
    Build the application with an appropriate 32-&#65279;bit compiler for your target
    OS, using the following configuration:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><p>
        Add a <strong class="japib"><code>KERNEL_64BIT</code></strong> preprocessor definition to your
        project or makefile.
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
        In the makefiles, the definition is
  added using the <code class="japi">-D</code> flag: <code class="japi">-&#65279;DKERNEL_64BIT</code>.
        </td></tr></table></div><p>
        The sample and
  wizard-generated Linux and Windows GCC makefiles and the Windows MS Visual Studio
  projects, in the 64-&#65279;bit WinDriver toolkit, already include this definition.
        </p></li><li class="listitem" style="list-style-type: disc"><p>
        Link the application with the specific version of the
        WinDriver-API library/shared object for 32-&#65279;bit applications executed on
        64-&#65279;bit platforms &#8212;
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;\lib\amd64\x86\wdapi1281.lib</strong></span></span>
        on Windows /
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;/lib/libwdapi1281_32.so</strong></span></span>
        on Linux.
        </p><p>
        The sample and wizard-generated project and make files for 32-&#65279;bit
        applications in the 64-&#65279;bit WinDriver toolkit already link to the correct
        library:<br>
        On Windows, the MS Visual Studio project files and Windows GCC makefiles are
        defined to link with
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;\lib\amd64\x86\wdapi1281.lib</strong></span></span>.
        
        <br>
        On Linux, the installation of the 64-&#65279;bit WinDriver toolkit on the
        development machine creates a
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>libwdapi1281.so</strong></span></span>
        symbolic link in the
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>/usr/lib</strong></span></span>
        directory &#8212; which links to
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;/lib/libwdapi1281_32.so</strong></span></span>
        &#8212; and in the
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/lib64</strong></span></span> directory
        &#8212; which links to
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;/lib/libwdapi1281.so</strong></span></span>
        (the 64-&#65279;bit version of this shared object).<br>
        The sample and wizard-generated WinDriver makefiles rely on these symbolic
        links to link with the appropriate shared object, depending on whether
        the code is compiled using a 32-&#65279;bit or 64-&#65279;bit compiler.
        
        </p></li></ul></div></li></ol></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    When distributing your application to target 64-&#65279;bit platforms, you need
    to provide with it the WinDriver-API DLL/shared object for 32-&#65279;bit
    applications executed on 64-&#65279;bit platforms &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;\redist\wdapi1281_32.dll</strong></span></span>
    on Windows /
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD64&gt;/lib/libwdapi1281_32.so</strong></span></span>
    on Linux. Before distributing this file, rename the copy of the file
    in your distribution package by removing the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>_32</strong></span></span> portion. The
    installation on the target should copy the renamed DLL/shared object to the
    relevant OS directory &#8212;
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>\%windir%\&#65279;sysWOW64</strong></span></span>
    on Windows or <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>/usr/lib</strong></span></span> on
    Linux. All other distribution files are the same as for any other
    64-&#65279;bit WinDriver driver distribution, as detailed in
    <a class="xref" href="#driver_distribution" title="Chapter 14. Distributing Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 14</fo:inline></a>.
    </li><li class="listitem" style="list-style-type: disc">
    An application created using the method described in this section will
    <em class="it">not</em> work on 32-&#65279;bit platforms. A WinDriver application for 32-&#65279;bit
    platforms needs to be compiled without the <code class="japi">KERNEL_64BIT</code>
    definition; it needs to be linked with the standard 32-&#65279;bit version of the
    WinDriver-API library/shared object from the 32-&#65279;bit WinDriver installation
    (<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD32&gt;\lib\x86\wdapi1281.lib</strong></span></span>
    on Windows /
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD32&gt;/lib/libwdapi1281.so</strong></span></span>
    on Linux); and it should be distributed with the standard 32-&#65279;bit
    WinDriver-API DLL/shared object
    (<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD32&gt;\redist\wdapi1281.dll</strong></span></span>
    on Windows /
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>&lt;WD32&gt;/lib/libwdapi1281.so</strong></span></span>
    on Linux) and any other required 32-&#65279;bit distribution file, as
    outlined in <a class="xref" href="#driver_distribution" title="Chapter 14. Distributing Your Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Chapter 14</fo:inline></a>.
  </li></ul></div></td></tr></table></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="64bit_bit_data_types"></a>A.3. 64-&#65279;Bit and 32-&#65279;Bit Data Types</h2></div></div></div>
<p>
In general, DWORD is unsigned long. While any 32-&#65279;bit compiler treats this
type as 32 bits wide, 64-&#65279;bit compilers treat this type differently. With
Windows 64-&#65279;bit compilers the size of this type is still 32 bits. However,
with UNIX 64-&#65279;bit compilers (e.g., GCC<span xmlns:fo="http://www.w3.org/1999/XSL/Format">, SUN
Forte</span>) the size of this type is 64 bits. In order to avoid compiler
dependency issues, use the UINT32 and UINT64 cross-platform types when you want
to refer to a 32-&#65279;bit or 64-&#65279;bit address, respectively.
</p>
</div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="API_REF"></a>Appendix B. API Reference</h1></div></div></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
     This function reference is C oriented. The WinDriver C&#65279;#
     
     APIs have been implemented as closely as possible to the C APIs, therefore
     .NET programmers can also use this reference to better understand the
     WinDriver APIs for their selected development language. For the exact API
     implementation and usage examples for your selected language, refer to the
     WinDriver .NET source code.
   </td></tr></table></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_DriverName"></a>B.1. WD_DriverName</h2></div></div></div>
<h5><a name="idp46253655793760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets the name of the WinDriver kernel module, which will be used by the calling
application.
</p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The default driver name, which is used if the function is not called, is
    <span class="jprintfilename"><strong>windrvr1281</strong></span>.
  </li><li class="listitem" style="list-style-type: disc">
    This function must be called once, and only once, from the beginning
    of your application, before calling any other WinDriver function
    (including <code class="jfunc">WD_Open</code><span class="jfunc">()</span> / <span xmlns:fo="http://www.w3.org/1999/XSL/Format"><code class="jfunc">WDC_DriverOpen</code><span class="jfunc">()</span> /
      <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span></span>),
    as demonstrated in the sample and generated DriverWizard WinDriver
    applications, which include a call to this function with the default driver
    name &#8212; <span class="jprintfilename"><strong>windrvr1281</strong></span>.
  </li><li class="listitem" style="list-style-type: disc">
    On Windows and Linux, if you select to modify the name of the WinDriver
    kernel module (<span class="jprintfilename"><strong>windrvr1281.sys/.dll/.o/.ko</strong></span>), as explained in
    <a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2</fo:inline></a>, you must ensure that your
    application calls <code class="jfunc">WD_DriverName</code><span class="jfunc">()</span> with your new driver name.
  </li><li class="listitem" style="list-style-type: disc">
    In order to use the <code class="jfunc">WD_DriverName</code><span class="jfunc">()</span> function, your user-mode
    driver project must be built with <code class="japi">WD_DRIVER_NAME_CHANGE</code>
    preprocessor flag (e.g.: <code class="japi">-DWD_DRIVER_NAME_CHANGE</code> &#8212; for
    MS Visual Studio, Windows GCC, and GCC).<br>
    The sample and generated DriverWizard Windows and Linux WinDriver
    projects/makefiles already set this preprocessor flag.
  </li></ul></div>
<h5><a name="idp46253655804336"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">const char* DLLCALLCONV WD_DriverName(const char* sName);</pre>

<h5><a name="idp46253655806144"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sName</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const char*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253655815264"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sName</td><td style="" align="left" valign="top">
    The name of the WinDriver kernel module to be used by the application.<br>
    NOTE: The driver name should be indicated without the driver file's
    extension. For example, use <span class="jprintfilename"><strong>windrvr1281</strong></span>, not
    <span class="jprintfilename"><strong>windrvr1281.sys</strong></span> or
    <span class="jprintfilename"><strong>windrvr1281.o</strong></span>.
  </td></tr></tbody></table></div>

<h5><a name="idp46253655824160"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the selected driver name on success; returns NULL on failure (e.g., if
the function is called twice from the same application)long.
</p>

<h5><a name="idp46253655826016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
The ability to rename the WinDriver kernel module is supported on
Windows and Linux, as explained in
<a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2</fo:inline></a>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDC_OVERVIEW"></a>B.2. WDC Library Overview</h2></div></div></div><p>
The <em class="it">"WinDriver Card"</em> &#8212; <span class="b"><strong>WDC</strong></span> &#8212; API provides convenient
user-mode wrappers to the basic WinDriver PCI&#65279;/&#65279;ISA
<code class="japi">WD_xxx</code> API, which is described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p><p>
The WDC wrappers are designed to simplify the usage of WinDriver for communicating
with PCI&#65279;/&#65279;ISA devices. While you can still use the basic
<code class="japi">WD_xxx</code> PCI&#65279;/&#65279;ISA WinDriver API from your code, we
recommend that you refrain from doing so and use the high&#65279;-&#65279;level WDC API
instead.
</p><p>
<span class="b"><strong>NOTE:</strong></span> Most of the WDC API can be used both from the user mode and
from the kernel mode (from a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>).
</p><p>
The generated DriverWizard PCI&#65279;/&#65279;ISA diagnostics driver code, as
well as the PLX sample code, and the <span class="jprintfilename"><strong>pci_diag</strong></span>,
Kernel PlugIn <span class="jprintfilename"><strong>pci_diag</strong></span> and
<span class="jprintfilename"><strong>pci_dump</strong></span> samples, for example, utilize the WDC
API.
</p><p>
The WDC API is part of <span class="jprintfilename"><strong>wdapi1281</strong></span>
DLL/shared object:<br>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver\redist\wdapi1281.dll</strong></span></span>
(Windows) / <span class="jdirectory"><strong>WinDriver/lib/libwdapi1281.so</strong></span>
(Linux).<br>
The source code for the WDC API is found in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/src/wdapi</strong></span></span> directory.
</p><p>
The WDC interface is provided in the <span class="jprintfilename"><strong>wdc_lib.h</strong></span>
and <span class="jprintfilename"><strong>wdc_defs.h</strong></span> header files (both found under
the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/includes</strong></span></span> directory).
<br>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    [<span class="jprintfilename"><strong>wdc_lib.h</strong></span>] declares the "high&#65279;-&#65279;level"
    WDC API (type definitions, function declarations, etc.).
  </li><li class="listitem" style="list-style-type: disc">
    [<span class="jprintfilename"><strong>wdc_defs.h</strong></span>] declares the "low&#65279;-&#65279;level"
    WDC API. This file includes definitions and type information that is
    encapsulated by the high&#65279;-&#65279;level
    <span class="jprintfilename"><strong>wdc_lib.h</strong></span> file.
  </li></ul></div><p>
</p><p>
The WinDriver PCI/ISA samples and generated DriverWizard code that
utilize the WDC API, for example, consist of a "library" for the specific
device, and a diagnostics application that uses it. The high&#65279;-&#65279;level
diagnostics code only utilizes the <span class="jprintfilename"><strong>wdc_lib.h</strong></span>
API, while the library code also uses the low&#65279;-&#65279;level API from the
<span class="jprintfilename"><strong>wdc_defs.h</strong></span> file, thus maintaining the desired
level of encapsulation.
</p><p>
The following sections describe the WDC high&#65279;-&#65279;level<a class="xref" href="#WDC_LIB_API" title="B.3. WDC High&#65279;-&#65279;Level API"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3]</fo:inline></a>
and low&#65279;-&#65279;level<a class="xref" href="#WDC_DEFS_API" title="B.4. WDC Low&#65279;-&#65279;Level API"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4]</fo:inline></a> API.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDC_LIB_API"></a>B.3. WDC High&#65279;-&#65279;Level API</h2></div></div></div><p>
This section describes the WDC API defined in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/include/wdc_lib.h</strong></span></span>
header file.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_LIB_TYPES"></a>B.3.1. Structures, Types and General Definitions</h3></div></div></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_DEVICE_HANDLE"></a>B.3.1.1. WDC_DEVICE_HANDLE</h4></div></div></div>
<p>
Handle to a WDC device information structure<a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.2]</fo:inline></a>.
</p>

<p>
</p><pre class="screen">typedef void * WDC_DEVICE_HANDLE;</pre><p>
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_DRV_OPEN_OPTIONS"></a>B.3.1.2. WDC_DRV_OPEN_OPTIONS Definitions</h4></div></div></div>
<pre class="screen">typedef DWORD WDC_DRV_OPEN_OPTIONS;</pre>

<p>
Preprocessor definitions of flags that describe tasks to be performed when
opening a handle to the WDC library (see <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>).
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_CHECK_VER</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Compare the version of the WinDriver source files used by the code with the
    version of the loaded WinDriver kernel
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_REG_LIC</td><td style="" align="left" valign="top">Register a WinDriver license registration string</td></tr></tbody></table></div>

<p>
The following preprocessor definitions provide convenient WDC driver open
options, which can be passed to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>:
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_BASIC</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    Instructs <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span> to perform only the basic WDC open
    tasks, mainly open a handle to WinDriver's kernel module.
    </p>
    <p>
    NOTE: The value of this option is zero (&lt;=&gt; no driver open flags),
    therefore this option cannot be combined with any of the other WDC driver
    open options.
    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_KP</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Convenience option when calling <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span> from the
    Kernel PlugIn. This option is equivalent to setting the
    <code class="japi">WDC_DRV_OPEN_BASIC</code> flag, which is the recommended option to
    set when opening a handle to the WDC library from the Kernel PlugIn.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_ALL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A convenience mask of all the basic WDC driver open flags &#8212;
    <code class="japi">WDC_DRV_OPEN_CHECK_VER</code> and
    <code class="japi">WDC_DRV_OPEN_REG_REG_LIC</code>. (The basic functionality of opening
    a handle to WinDriver's kernel module is always performed by
    <span style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>, so there is no need to also set the
    <code class="japi">WDC_DRV_OPEN_BASIC</code> flag).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_DEFAULT</td><td style="" align="left" valign="top">
    Use the default WDC open options:<br>
    &#8226; For <span class="b"><strong>user-mode</strong></span> applications: equivalent to setting
      <code class="japi">WDC_DRV_OPEN_ALL</code> ;<br>
    &#8226; For a <span class="b"><strong>Kernel PlugIn</strong></span>: equivalent to setting
      <code class="japi">WDC_DRV_OPEN_KP</code>
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_DIRECTION"></a>B.3.1.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_DIRECTION Enumeration</span></h4></div></div></div>
<p>
Enumeration of a device's address/register access directions.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Enum Value</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_READ</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Read from the address</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_WRITE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Write to the address</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_READ_WRITE</td><td style="" align="left" valign="top">
    Read from the address or write to it.<br>
    This value is used, for example, in the WinDriver samples and generated
    DriverWizard diagnostics code in order to describe a register's access
    mode, indicating that the register can either be read from or written to.
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_ADDR_MODE"></a>B.3.1.4. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_MODE Enumeration</span></h4></div></div></div>
<p>
Enumeration of memory or I/&#65279;O addresses/registers read/write modes.<br>
The enumeration values are used to determine whether a memory or I/&#65279;O
address/register is read/written in multiples of 8, 16, 32 or 64 bits (i.e., 1,
2, 4 or 8 bytes).
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Enum Value</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_MODE_8</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">8 bits (1 byte) mode</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_MODE_16</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">16 bits (2 bytes) mode</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_MODE_32</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">32 bits (4 bytes) mode</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_MODE_64</td><td style="" align="left" valign="top">64 bits (8 bytes) mode</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_ADDR_RW_OPTIONS"></a>B.3.1.5. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_RW_OPTIONS Enumeration</span></h4></div></div></div>
<p>
Enumeration of flags that are used to determine how a memory or I/&#65279;O address
will be read/written.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Enum Value</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_RW_DEFAULT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    Use the default read/write options: memory addresses are accessed
    directly from the calling process; block transfers are performed from
    subsequent addresses (automatic increment).
    </p>
    <p>
    NOTE: The value of this flag is zero (&lt;=&gt; no read/write flags),
    therefore it <span class="b"><strong>can not</strong></span> be combined in a bit-mask with any of the other
    read/write options flags.<br>
    </p>
    <p>
    This option is used by the
    <span style=""><span style=""><code class="japi">WDC_ReadAddr8/16/32/64</code><span class="japi">()</span></span><a class="xref" href="#WDC_ReadAddrXXX" title="B.3.26. WDC_ReadAddrXXX()"><fo:inline> [B.3.26]</fo:inline></a></span> and
    <span style=""><span style=""><code class="japi">WDC_WriteAddr8/16/32/64</code><span class="japi">()</span></span><a class="xref" href="#WDC_WriteAddrXXX" title="B.3.27. WDC_WriteAddrXXX()"><fo:inline> [B.3.27]</fo:inline></a></span> functions.
    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_RW_NO_AUTOINC</td><td style="" align="left" valign="top">
    Do no automatically increment the read/write address in block transfers,
    i.e., hold the device address constant while reading/writing a block of
    memory or I/&#65279;O addresses (relevant only for block (string) transfers).
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_ADDR_SIZE_"></a>B.3.1.6. WDC_ADDR_SIZE Definitions</h4></div></div></div>
<pre class="screen">typedef DWORD WDC_ADDR_SIZE;</pre>

<p>
Preprocessor definitions that depict memory or I/&#65279;O address/register sizes.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_SIZE_8</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">8 bits (1 byte)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_SIZE_16</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">16 bits (2 bytes)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_SIZE_32</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">32 bits (4 bytes)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_SIZE_64</td><td style="" align="left" valign="top">64 bits (8 bytes)</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_SLEEP_OPTIONS"></a>B.3.1.7. WDC_SLEEP_OPTIONS Definitions</h4></div></div></div>
<pre class="screen">typedef DWORD WDC_SLEEP_OPTIONS;</pre>

<p>
Preprocessor definitions that depict the sleep options that can be passed to
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_Sleep</code><span class="japi">()</span></span><a class="xref" href="#WDC_Sleep" title="B.3.61. WDC_Sleep()"><fo:inline> [B.3.61]</fo:inline></a></span>.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_SLEEP_BUSY</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Delay execution by consuming CPU cycles
    <span style="white-space:nowrap">(busy sleep)</span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_SLEEP_NON_BUSY</td><td style="" align="left" valign="top">
    Delay execution without consuming CPU cycles
    <span style="white-space:nowrap">(non-busy sleep)</span>.<br>
    
    Note: The accuracy of non-busy sleep is
    <span style="white-space:nowrap">machine-dependent</span> and cannot be guaranteed for short
    sleep intervals <span style="white-space:nowrap">(&lt; 1 millisecond)</span>.
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_DBG_OPTIONS"></a>B.3.1.8. WDC_DBG_OPTIONS Definitions</h4></div></div></div>
<pre class="screen">typedef DWORD WDC_DBG_OPTIONS;</pre>

<p>
Preprocessor definitions that depict the possible debug options for the WDC
library, which are passed to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_SetDebugOptions</code><span class="japi">()</span></span><a class="xref" href="#WDC_SetDebugOptions" title="B.3.55. WDC_SetDebugOptions()"><fo:inline> [B.3.55]</fo:inline></a></span>.
</p>

<p>
The following flags determine the output file for the WDC library's
debug messages:
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_OUT_DBM</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Send debug messages from the WDC library to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DBG_OUT_FILE</td><td style="" align="left" valign="top">
    Send debug messages from the WDC library to a debug file. By default, the
    debug file will be <span class="jprintfilename"><strong>stderr</strong></span>, unless a
    different file is set in the <strong class="japib"><code>sDbgFile</code></strong> parameter of the
    <span style=""><span style=""><code class="japi">WDC_SetDebugOptions</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_SetDebugOptions" title="B.3.55. WDC_SetDebugOptions()"><fo:inline> [B.3.55]</fo:inline></a></span>.<br>
    This option is only supported from the user mode (as opposed to the Kernel
    PlugIn).
  </td></tr></tbody></table></div>

<p>
The following flags determine the debug level &#8212; i.e., what type of WDC
debug messages to display, if at all:
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_LEVEL_ERR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Display only WDC error debug messages</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_LEVEL_TRACE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Display both error and trace WDC debug messages</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DBG_NONE</td><td style="" align="left" valign="top">Do not display WDC debug messages</td></tr></tbody></table></div>

<p>
The following preprocessor definitions provide convenient debug flags
combinations, which can be passed to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_SetDebugOptions</code><span class="japi">()</span></span><a class="xref" href="#WDC_SetDebugOptions" title="B.3.55. WDC_SetDebugOptions()"><fo:inline> [B.3.55]</fo:inline></a></span>:
</p>

<p>
&#8226; User-mode and Kernel PlugIn convenience debug options:

</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_DEFAULT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_LEVEL_TRACE</code>:<br>
    Use the default debug options &#8212; send WDC error and trace messages to
    the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_DBM_ERR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_LEVEL_ERR</code>:<br>
    Send WDC error debug messages to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_DBM_TRACE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_LEVEL_TRACE</code>:<br>
    Send WDC error and trace debug messages to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DBG_FULL</td><td style="" align="left" valign="top">
    Full WDC debugging:<br>
    &#8226; From the <span class="b"><strong>user mode</strong></span>:<br>
      <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_OUT_FILE | WDC_DBG_LEVEL_TRACE</code>:
      <br>
      Send WDC error and trace debug messages both to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a> and to a debug output file (default file:
      <span class="jprintfilename"><strong>stderr</strong></span>)<br>
    &#8226; From the <span class="b"><strong>Kernel PlugIn</strong></span>:<br>
      <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_LEVEL_TRACE</code>:<br>
      Send WDC error and trace messages to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a>
  </td></tr></tbody></table></div><p>
</p>

<p>
&#8226; User-mode only convenience debug options:

</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_FILE_ERR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_FILE | WDC_DBG_LEVEL_ERR</code>:<br>
    Send WDC error debug messages to a debug file (default file:
    <span class="jprintfilename"><strong>stderr</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_FILE_TRACE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_FILE | WDC_DBG_LEVEL_TRACE</code>:<br>
    Send WDC error and trace debug messages to a debug file (default file:
    <span class="jprintfilename"><strong>stderr</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_DBM_FILE_ERR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_OUT_FILE | WDC_DBG_LEVEL_ERR</code>:<br>
    Send WDC error debug messages both to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a> and to a debug file (default file:
    <span class="jprintfilename"><strong>stderr</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DBG_DBM_FILE_TRACE</td><td style="" align="left" valign="top">
    <code class="japi">WDC_DBG_OUT_DBM | WDC_DBG_OUT_FILE | WDC_DBG_LEVEL_TRACE</code>:<br>
    Send WDC error and trace debug messages both to the Debug Monitor<a class="xref" href="#Debug_Monitor" title="6.2. Debug Monitor"><fo:inline> [6.2]</fo:inline></a> and to a debug file (default file:
    <span class="jprintfilename"><strong>stderr</strong></span>)
  </td></tr></tbody></table></div><p>
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_PCI_SCAN_RESULT"></a>B.3.1.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PCI_SCAN_RESULT Structure</span></h4></div></div></div>
<p>
Structure for holding the results of a PCI bus scan (see
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>).
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwNumDevices</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Number of devices found on the PCI bus that match the search criteria
    (vendor &amp; device IDs)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">deviceId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_ID[WD_PCI_CARDS]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Array of matching vendor and device IDs found on the PCI bus<a class="xref" href="#WD_PCI_ID" title="B.7.3. WD_PCI_ID Structure"><fo:inline> [B.7.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">deviceSlot</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT[WD_PCI_CARDS]</td><td style="" align="left" valign="top">
    Array of PCI device location information structures<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>
    for the detected devices matching the search criteria
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="WDC_PCI_SCAN_CAPS_RESULT"></a>B.3.1.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PCI_SCAN_CAPS_RESULT Structure</span></h4></div></div></div>
<p>
Structure for holding the results of a PCI capabilities scan (see
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanCaps</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanCaps" title="B.3.7. WDC_PciScanCaps()"><fo:inline> [B.3.7]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanExtCaps</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanExtCaps" title="B.3.9. WDC_PciScanExtCaps()"><fo:inline> [B.3.9]</fo:inline></a></span>).
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwNumCaps</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Number of capabilities found that match the search criteria (capability ID
    and capabilities group &#8212; basic<a class="xref" href="#WDC_PciScanCaps" title="B.3.7. WDC_PciScanCaps()"><fo:inline> [B.3.7]</fo:inline></a> or
    extended<a class="xref" href="#WDC_PciScanExtCaps" title="B.3.9. WDC_PciScanExtCaps()"><fo:inline> [B.3.9]</fo:inline></a>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pciCaps</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_PCI_CAP[WD_PCI_MAX_CAPS]</td><td style="" align="left" valign="top">Array of matching PCI capabilities<a class="xref" href="#WD_PCI_CAP" title="B.7.5. WD_PCI_CAP Structure"><fo:inline> [B.7.5]</fo:inline></a></td></tr></tbody></table></div>
</div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DriverOpen"></a>B.3.2. WDC_DriverOpen()</h3></div></div></div>
<h5><a name="idp46253656080688"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Opens and stores a handle to WinDriver's kernel module and initializes the WDC
library according to the open options passed to it.<br>
This function should be called once before calling any other WDC API.
</p>

<h5><a name="idp46253656082240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DriverOpen(
    WDC_DRV_OPEN_OPTIONS openOptions,
    const CHAR *sLicense);
</pre>

<h5><a name="idp46253656083696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">openOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DRV_OPEN_OPTIONS</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sLicense</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656094064"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">openOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A mask of any of the supported open flags<a class="xref" href="#WDC_DRV_OPEN_OPTIONS" title="B.3.1.2. WDC_DRV_OPEN_OPTIONS Definitions"><fo:inline> [B.3.1.2]</fo:inline></a>,
    which determines the initialization actions that will be performed by the
    function.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sLicense</td><td style="" align="left" valign="top">
    WinDriver license registration string.<br>
    This argument is ignored if the <code class="japi">WDC_DRV_OPEN_REG_LIC</code> flag is
    not<a class="xref" href="#WDC_DRV_OPEN_OPTIONS" title="B.3.1.2. WDC_DRV_OPEN_OPTIONS Definitions"><fo:inline> [B.3.1.2]</fo:inline></a> set in the <strong class="japib"><code>openOptions</code></strong>
    argument.<br>
    If this parameter is a <code class="japi">NULL</code> pointer or an empty string, the function
    will attempt to register the demo WinDriver evaluation license. Therefore,
    when evaluating WinDriver pass <code class="japi">NULL</code> as this parameter. After registering
    your WinDriver toolkit, modify the code to pass your WinDriver license
    registration string.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656106272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DriverClose"></a>B.3.3. WDC_DriverClose()</h3></div></div></div>
<h5><a name="idp46253656110528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Closes the WDC WinDriver handle (acquired and stored by a previous call to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>) and uninitializes the WDC library.
</p>

<p>
Every <code class="jfunc">WDC_DriverOpen</code><span class="jfunc">()</span> call should have a matching
<code class="jfunc">WDC_DriverClose</code><span class="jfunc">()</span> call, which should be issued when you no longer
need to use the WDC library.
</p>

<h5><a name="idp46253656115648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DriverClose(void);</pre>

  <h5><a name="idp46253656117440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanDevices"></a>B.3.4. WDC_PciScanDevices()</h3></div></div></div>
<h5><a name="idp46253656122208"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the PCI bus for all devices with the specified vendor and device ID
combination and returns information regarding the matching devices that were
found and their locations. The function performs the scan by iterating through
all possible PCI buses on the host platform, then through all possible PCI
slots, and then through all possible PCI functions.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note: Scan-By-Topology Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"><a name="WDC_PciScanDevicesByTopology_ref_note"></a>Scan-By-Topology Note</th></tr><tr><td align="left" valign="top">
On rare occasions, as a result of malfunctioning hardware, the scan information
may contain repeated instances of the same device. As a result, the function
might fail to return valid scan data. In such cases, if you cannot remove the
malfunctioning device, you can scan the PCI bus using
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanDevicesByTopology</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevicesByTopology" title="B.3.5. WDC_PciScanDevicesByTopology()"><fo:inline> [B.3.5]</fo:inline></a></span> or
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanRegisteredDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanRegisteredDevices" title="B.3.6. WDC_PciScanRegisteredDevices()"><fo:inline> [B.3.6]</fo:inline></a></span>.
</td></tr></table></div>
<h5><a name="idp46253656131408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanDevices(
    DWORD dwVendorId,
    DWORD dwDeviceId,
    WDC_PCI_SCAN_RESULT *pPciScanResult);
</pre>

<h5><a name="idp46253656133280"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656145664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Vendor ID to search for, or 0 to search for all vendor IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Device ID to search for, or 0 to search for all device IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the PCI bus scan<a class="xref" href="#WDC_PCI_SCAN_RESULT" title="B.3.1.9. WDC_PCI_SCAN_RESULT Structure"><fo:inline> [B.3.1.9]</fo:inline></a>
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656155920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253656158464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   If you set both the vendor and device IDs to zero, the function will return
   information regarding all connected PCI devices.
 </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanDevicesByTopology"></a>B.3.5. WDC_PciScanDevicesByTopology()</h3></div></div></div>
<h5><a name="idp46253656162496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the PCI bus for all devices with the specified vendor and device ID
combination and returns information regarding the matching devices that were
found and their locations. The function performs the scan by topology &#8212;
i.e., for each located bridge the function scans the connected devices and
functions reported by the bridge, and only then proceeds to scan the next
bridge.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    In the case of multiple host controllers,
    <code class="jfunc">WDC_PciScanDevicesByTopology</code><span class="jfunc">()</span> will perform the scan only for
    the first host controller.
  </li><li class="listitem" style="list-style-type: disc">
    By default, use <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span> to scan the PCI bus,
    unless a device malfunction intererferes &#8212; refer to the note in the
    description of <code class="jfunc">PciScanDevices</code><span class="jfunc">()</span>.
  </li></ul></div></td></tr></table></div>
<h5><a name="idp46253656170624"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanDevicesByTopology(
    DWORD dwVendorId,
    DWORD dwDeviceId,
    WDC_PCI_SCAN_RESULT *pPciScanResult);
</pre>

<h5><a name="idp46253656172496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656184880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Vendor ID to search for, or 0 to search for all vendor IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Device ID to search for, or 0 to search for all device IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the PCI bus scan<a class="xref" href="#WDC_PCI_SCAN_RESULT" title="B.3.1.9. WDC_PCI_SCAN_RESULT Structure"><fo:inline> [B.3.1.9]</fo:inline></a>
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656195136"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253656197680"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   If you set both the vendor and device IDs to zero, the function will return
   information regarding all connected PCI devices.
 </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanRegisteredDevices"></a>B.3.6. WDC_PciScanRegisteredDevices()</h3></div></div></div>
<h5><a name="idp46253656201712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the PCI bus for all devices with the specified vendor and device ID
combination that have been registered to work with WinDriver, and returns
information regarding the matching devices that were found and their locations.
The function performs the scan by iterating through all possible PCI buses on
the host platform, then through all possible PCI slots, and then through all
possible PCI functions.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    By default, use <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span> to scan the PCI bus,
    unless a device malfunction intererferes &#8212; refer to the note in the
    description of <code class="jfunc">PciScanDevices</code><span class="jfunc">()</span>.
  </li></ul></div></td></tr></table></div>
<h5><a name="idp46253656208528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanRegisteredDevices(
    DWORD dwVendorId,
    DWORD dwDeviceId,
    WDC_PCI_SCAN_RESULT *pPciScanResult);
</pre>

<h5><a name="idp46253656210400"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656222784"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Vendor ID to search for, or 0 to search for all vendor IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Device ID to search for, or 0 to search for all device IDs</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciScanResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the PCI bus scan<a class="xref" href="#WDC_PCI_SCAN_RESULT" title="B.3.1.9. WDC_PCI_SCAN_RESULT Structure"><fo:inline> [B.3.1.9]</fo:inline></a>
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656233040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253656235584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   If you set both the vendor and device IDs to zero, the function will return
   information regarding all connected PCI devices that are registered with
   WinDriver.
 </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanCaps"></a>B.3.7. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanCaps()</span></h3></div></div></div>
<h5><a name="idp46253656240352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the basic PCI capabilities of the given device for the specified
capability (or for all capabilities).
</p>

<h5><a name="idp46253656241552"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanCaps(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwCapId,
    WDC_PCI_SCAN_CAPS_RESULT *pScanCapsResult);
</pre>

<h5><a name="idp46253656243040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_CAPS_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656255008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    ID of the basic PCI capability for which to search, or
    <code class="japi">WD_PCI_CAP_ID_ALL</code> to search for all basic PCI capabilities
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the basic PCI capabilities scan<a class="xref" href="#WDC_PCI_SCAN_CAPS_RESULT" title="B.3.1.10. WDC_PCI_SCAN_CAPS_RESULT Structure"><fo:inline> [B.3.1.10]</fo:inline></a>
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253656268016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanCapsBySlot"></a>B.3.8. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanCapsBySlot()</span></h3></div></div></div>
<h5><a name="idp46253656272704"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the basic PCI capabilities of the given device for the specified
capability (or for all capabilities).
</p>

<h5><a name="idp46253656273904"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanCapsBySlot(
    WD_PCI_SLOT *pSlot,
    DWORD dwCapId,
    WDC_PCI_SCAN_CAPS_RESULT *pScanCapsResult);
</pre>

<h5><a name="idp46253656275392"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_CAPS_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656287360"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pSlot</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    ID of the basic PCI capability for which to search, or
    <code class="japi">WD_PCI_CAP_ID_ALL</code> to search for all basic PCI capabilities
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the basic PCI capabilities scan<a class="xref" href="#WDC_PCI_SCAN_CAPS_RESULT" title="B.3.1.10. WDC_PCI_SCAN_CAPS_RESULT Structure"><fo:inline> [B.3.1.10]</fo:inline></a>
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253656301088"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciScanExtCaps"></a>B.3.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciScanExtCaps()</span></h3></div></div></div>
<h5><a name="idp46253656305792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans the extended (PCI Express) PCI capabilities of the given device for the
specified capability (or for all capabilities).
</p>

<h5><a name="idp46253656307008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciScanExtCaps(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwCapId,
    WDC_PCI_SCAN_CAPS_RESULT *pScanCapsResult);
</pre>

<h5><a name="idp46253656308496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_SCAN_CAPS_RESULT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656320464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    ID of the extended PCI capability for which to search, or
    <code class="japi">WD_PCI_CAP_ID_ALL</code> to search for all extended PCI capabilities
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pScanCapsResult</td><td style="" align="left" valign="top">
    A pointer to a structure that will be updated by the function with the
    results of the extended (PCI Express) PCI capabilities scan<a class="xref" href="#WDC_PCI_SCAN_CAPS_RESULT" title="B.3.1.10. WDC_PCI_SCAN_CAPS_RESULT Structure"><fo:inline> [B.3.1.10]</fo:inline></a>
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253656333488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciGetExpressGen"></a>B.3.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressGen()</span></h3></div></div></div>
<h5><a name="idp46253656338672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves the PCI Express generation of a device.
</p>

<h5><a name="idp46253656339808"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciGetExpressGen(
    WDC_DEVICE_HANDLE hDev);
</pre>

<h5><a name="idp46253656341232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656349968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr></tbody></table></div>
<h5><a name="idp46253656359104"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
Returns 0 if device is not a PCI Express device, otherwise returns the
PCI Express generation of the device;
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciGetExpressGenBySlot"></a>B.3.11. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressGenBySlot()</span></h3></div></div></div>
<h5><a name="idp46253656362272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves the PCI Express generation of a device.
</p>

<h5><a name="idp46253656363408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciGetExpressGenBySlot(
    WD_PCI_SLOT *pPciSlot);
</pre>

<h5><a name="idp46253656364848"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656373584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="" align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr></tbody></table></div>
<h5><a name="idp46253656383440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
Returns 0 if device is not a PCI Express device, otherwise returns the
PCI Express generation of the device;
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciGetExpressOffset"></a>B.3.12. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetExpressOffset()</span></h3></div></div></div>
<h5><a name="idp46253656386640"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
    Retrieves the PCI Express configuration registers' offset in the device's
    configuration space. This offset varies between devices and needs to be
    added to any extended configuration space register's fixed address. The
    fixed addresses were defined in the PCI Express Base Specification.
</p>

<h5><a name="idp46253656388032"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciGetExpressOffset(
    WDC_DEVICE_HANDLE hDev,
    DWORD *pdwOffset);
</pre>

<h5><a name="idp46253656389488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOffset</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656399856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOffset</td><td style="" align="left" valign="top">Pointer to the DWORD where the offset value will be written.</td></tr></tbody></table></div>


  
  <h5><a name="idp46253656410512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciGetHeaderType"></a>B.3.13. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_PciGetHeaderType()</span></h3></div></div></div>
<h5><a name="idp46253656415216"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
    Retrieves the PCI device's configuration space header type.
    The header type is hardware dependent and determines how the configuration
    space is arranged.
</p>

<h5><a name="idp46253656416464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciGetHeaderType(
    WDC_DEVICE_HANDLE hDev,
    WDC_PCI_HEADER_TYPE *header_type);
</pre>

<h5><a name="idp46253656417936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">header_type</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_PCI_HEADER_TYPE *</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656428272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">header_type</td><td style="" align="left" valign="top">A pointer to the structure where the header type will be updated.
      WDC_PCI_HEADER_TYPE definition and available values can be seen in
      <span class="jprintfilename"><strong>WinDriver/include/pci_regs.h</strong></span></td></tr></tbody></table></div>


  
  <h5><a name="idp46253656439312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="PciConfRegData2Str"></a>B.3.14. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">PciConfRegData2Str()</span></h3></div></div></div>
<h5><a name="idp46253656444016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
    Reads data from a PCI device's configuration space and parses the data
    to a string, if such a parsing is available. The parsing is based upon
    information obtained from the official PCI Specification, 3rd Generation.
</p>

<h5><a name="idp46253656445328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen"> DWORD DLLCALLCONV PciConfRegData2Str(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset,
    PCHAR pBuf,
    DWORD dwInLen,
    DWORD *pdwOutLen);
</pre>

<h5><a name="idp46253656446832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PCHAR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwInLen</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOutLen</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD *</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656462096"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Offset of a register in the configuration space to be read
  and parsed to a string, if a parsing is available.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">A pointer to a user preallocated buffer to be filled by the function.
      The buffer will not be filled if no parsing is available.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwInLen</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Size of the user preallocated buffer.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOutLen</td><td style="" align="left" valign="top">A pointer to a DWORD which will hold the actual length of the string the function
      wrote to the buffer. If the buffer is too small for the text written by the function
      then the text will be truncated. We recommend preallocating a 1024 byte buffer to
      avoid any truncation.</td></tr></tbody></table></div>


  
  <h5><a name="idp46253656476800"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="PciExpressConfRegData2Str"></a>B.3.15. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">PciExpressConfRegData2Str()</span></h3></div></div></div>
<h5><a name="idp46253656481488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
    Reads data from a PCI Express device's extended configuration space and
    parses the data to a string, if such a parsing is available. The parsing
    is based upon information obtained from the official PCI Specification,
    3rd Generation.
</p>

<h5><a name="idp46253656482832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen"> DWORD DLLCALLCONV PciExpressConfRegData2Str(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset,
    PCHAR pBuf,
    DWORD dwInLen,
    DWORD *pdwOutLen);
</pre>

<h5><a name="idp46253656484352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PCHAR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwInLen</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOutLen</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD *</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656499616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
      Offset of a register in the configuration space to be read
      and parsed to a string, if a parsing is available.
      Offset should be the sum of the value obtained from
      WDC_PciGetExpressOffset() <span style=""><span style=""><code class="japi">WDC_PciGetExpressOffset</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciGetExpressOffset" title="B.3.12. WDC_PciGetExpressOffset()"><fo:inline> [B.3.12]</fo:inline></a></span>
      and the desired PCI Express offset.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">A pointer to a user preallocated buffer to be filled by the function.
      The buffer will not be filled if no parsing is available.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwInLen</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Size of the user preallocated buffer.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwOutLen</td><td style="" align="left" valign="top">A pointer to a DWORD which will hold the actual length of the string the function
      wrote to the buffer. If the buffer is too small for the text written by the function
      then the text will be truncated. We recommend preallocating a 1024 byte buffer to
      avoid any truncation.</td></tr></tbody></table></div>


  
  <h5><a name="idp46253656517040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciGetDeviceInfo"></a>B.3.16. WDC_PciGetDeviceInfo()</h3></div></div></div>
<h5><a name="idp46253656521504"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves a PCI device's resources information (memory and I/&#65279;O ranges and
interrupt information).
</p>

<h5><a name="idp46253656522800"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciGetDeviceInfo(
    WD_PCI_CARD_INFO *pDeviceInfo);
</pre>

<h5><a name="idp46253656524240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_CARD_INFO*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pciSlot</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Card</span></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_CARD</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656537776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="" align="left" valign="top">
    Pointer to a PCI device information structure<a class="xref" href="#WD_PCI_CARD_INFO" title="B.7.8. WD_PCI_CARD_INFO Structure"><fo:inline> [B.7.8]</fo:inline></a>
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253656545312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

<h5><a name="idp46253656547600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The resources information is obtained from the operating system's
    Plug&#65279;-&#65279;and&#65279;-&#65279;Play manager, unless the information is not available, in which case it
    is read directly from the PCI configuration registers.<br>
    Note: On Windows, you must install an <span class="jprintfilename"><strong>INF
      file</strong></span> file, which registers your device with WinDriver,
    before calling this function (see <a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.1</fo:inline></a>
    regarding creation of INF files with WinDriver).
  </li><li class="listitem" style="list-style-type: disc">
    If the interrupt request (IRQ) number is obtained from the Plug&#65279;-&#65279;and&#65279;-&#65279;Play manager, it is
    mapped, and therefore may differ from the physical IRQ number.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciDeviceOpen"></a>B.3.17. WDC_PciDeviceOpen()</h3></div></div></div>
<h5><a name="idp46253656555360"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Allocates and initializes a WDC PCI device structure, registers the device with
WinDriver, and returns a handle to the device.
</p>
<p>
This function

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Verifies that none of the registered device resources (set in
    <strong class="japib"><code>pDeviceInfo-&#65279;&gt;Card.Item</code></strong>) are already locked for
    exclusive use.

    <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    A resource can be locked for exclusive use by setting the
    <code class="japi">fNotSharable</code> field of its <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_ITEMS</code></span><span> structure</span><a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline> [B.7.6]</fo:inline></a></span>
    to 1, before calling <code class="jfunc">WDC_PciDeviceOpen</code><span class="jfunc">()</span>.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Maps the physical memory ranges found on the device both to kernel-mode and
    user-mode address space, and stores the mapped addresses in the allocated
    device structure for future use.
  </li><li class="listitem" style="list-style-type: disc">
    Saves device resources information required for supporting the
    communication with the device. For example, the function saves the
    interrupt request (IRQ) number and the interrupt type, as well as retrieves and saves
    an interrupt handle, and this information is later used when the user calls
    functions to handle the device's interrupts.
  </li><li class="listitem" style="list-style-type: disc">
    If the caller selects to use a Kernel PlugIn driver to communicate with the
    device, the function opens a handle to this driver and stores it for future
    use.
  </li></ul></div><p>
</p>
<h5><a name="idp46253656565600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciDeviceOpen(
    WDC_DEVICE_HANDLE *phDev,
    const WD_PCI_CARD_INFO *pDeviceInfo,
    const PVOID pDevCtx);
</pre>
<h5><a name="idp46253656567472"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const WD_PCI_CARD_INFO*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pciSlot</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Card</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_CARD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwItems</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">Item</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_ITEMS[WD_CARD_ITEMS]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">item</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">fNotSharable</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">I</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">union</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">Mem</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pPhysicalAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PHYS_ADDR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">qwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pTransAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pUserDirectAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pReserved</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">IO</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">Int</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">hInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwReserved1</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">pReserved2</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">Bus</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwBusType</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_TYPE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwBusNum</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">    &#8226; <span style="">dwSlotFunc</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDevCtx</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const PVOID</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>
<h5><a name="idp46253656650864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a handle to the WDC device allocated by the function
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device information structure<a class="xref" href="#WD_PCI_CARD_INFO" title="B.7.8. WD_PCI_CARD_INFO Structure"><fo:inline> [B.7.8]</fo:inline></a>,
    which contains information regarding the device to open
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDevCtx</td><td style="" align="left" valign="top">
    Pointer to device context information, which will be stored in the device
    structure
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656661168"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  <h5><a name="idp46253656663456"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
      This function may be called only from the <span class="b"><strong>user mode</strong></span>.
    </li><li class="listitem"><p><a name="pci_dev_open_remark_WD_ITEM_MEM_DO_NOT_MAP_KERNEL"></a>
    If your card has a large memory range that cannot be fully mapped to the
    kernel address space, you can set the
    <strong class="japib"><code>WD_ITEM_MEM_DO_NOT_MAP_KERNEL</code></strong> flag in the
    <code class="japi">I.Mem.dwOptions</code> field of the relevant <code class="japi">WD_ITEMS</code>
    memory resource structure<a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.7.6]</fo:inline></a>
        (<code class="japi">pDeviceInfo-&#65279;&gt;Card.Item[i].I.Mem.dwOptions</code>), received from <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span>,
        
        before passing it to the device&#65279;-&#65279;open function.
      
    This flag instructs the function to map the memory range only to the
    user-mode virtual address space, and not to the kernel address space.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    Note that if you select to set the
    <code class="japi">WD_ITEM_MEM_DO_NOT_MAP_KERNEL</code> flag,
    
        the device information structure that will be created by the function
        will not hold a kernel-mapped address for this resource (the
        <code class="japi">pAddrDesc[i].pAddr</code> base address kernel mapping field of
        the relevant memory range in the
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DEVICE</code></span><span> structure</span><a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline> [B.4.2]</fo:inline></a></span>
        will not be updated),
      
    and you will therefore not be able to rely on this mapping in calls to
    WinDriver APIs &#8212; namely interrupt handling APIs or any API called from a
    Kernel PlugIn driver.
    </td></tr></table></div></li></ol></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IsaDeviceOpen"></a>B.3.18. WDC_IsaDeviceOpen()</h3></div></div></div>
<h5><a name="idp46253656677776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Allocates and initializes a WDC ISA device structure, registers the device with
WinDriver, and returns a handle to the device.
</p>
<p>
This function

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Verifies that none of the registered device resources (set in
    <strong class="japib"><code>pDeviceInfo-&#65279;&gt;Card.Item</code></strong>) are already locked for
    exclusive use.

    <div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    A resource can be locked for exclusive use by setting the
    <code class="japi">fNotSharable</code> field of its <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_ITEMS</code></span><span> structure</span><a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline> [B.7.6]</fo:inline></a></span>
    to 1, before calling <code class="jfunc">WDC_IsaDeviceOpen</code><span class="jfunc">()</span>.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Maps the device's physical memory ranges device both to kernel-mode and
    user-mode address space, and stores the mapped addresses in the allocated
    device structure for future use.
    </li><li class="listitem" style="list-style-type: disc">
    Saves device resources information required for supporting the
    communication with the device. For example, the function saves the
    interrupt request (IRQ) number and the interrupt type, as well as retrieves and saves
    an interrupt handle, and this information is later used when the user calls
    functions to handle the device's interrupts.
    </li><li class="listitem" style="list-style-type: disc">
    If the caller selects to use a Kernel PlugIn driver to communicate with the
    device, the function opens a handle to this driver and stores it for future
    use.
    </li></ul></div><p>
</p>
<h5><a name="idp46253656689168"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_IsaDeviceOpen(
    WDC_DEVICE_HANDLE *phDev,
    const WD_CARD *pDeviceInfo,
    const PVOID pDevCtx);
</pre>
<h5><a name="idp46253656690784"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const WD_CARD*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwItems</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Item</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_ITEMS[WD_CARD_ITEMS]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">item</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">fNotSharable</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">I</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">union</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">Mem</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pPhysicalAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PHYS_ADDR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">qwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pTransAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pUserDirectAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pReserved</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">IO</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">Int</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">hInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwReserved1</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">pReserved2</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">N/&#65279;A</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">  &#8226; <span style="">Bus</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwBusType</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_TYPE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwBusNum</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">   * <span style="">dwSlotFunc</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDevCtx</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const PVOID</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>
<h5><a name="idp46253656769072"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to a handle to the WDC device allocated by the function</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDeviceInfo</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a card information structure<a class="xref" href="#WD_CARD" title="B.7.7. WD_CARD Structure"><fo:inline> [B.7.7]</fo:inline></a>, which contains
    information regarding the device to open
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDevCtx</td><td style="" align="left" valign="top">
    Pointer to device context information, which will be stored in the device
    structure
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656779376"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253656781920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
      This function may be called only from the <span class="b"><strong>user mode</strong></span>.
    </li><li class="listitem"><p><a name="isa_dev_open_remark_WD_ITEM_MEM_DO_NOT_MAP_KERNEL"></a>
    If your card has a large memory range that cannot be fully mapped to the
    kernel address space, you can set the
    <strong class="japib"><code>WD_ITEM_MEM_DO_NOT_MAP_KERNEL</code></strong> flag in the
    <code class="japi">I.Mem.dwOptions</code> field of the relevant <code class="japi">WD_ITEMS</code>
    memory resource structure<a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.7.6]</fo:inline></a>
        (<code class="japi">pDeviceInfo-&#65279;&gt;Card.Item[i].I.Mem.dwOptions</code>)
        before passing it to the device&#65279;-&#65279;open function.
      
    This flag instructs the function to map the memory range only to the
    user-mode virtual address space, and not to the kernel address space.
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    Note that if you select to set the
    <code class="japi">WD_ITEM_MEM_DO_NOT_MAP_KERNEL</code> flag,
    
        the device information structure that will be created by the function
        will not hold a kernel-mapped address for this resource (the
        <code class="japi">pAddrDesc[i].pAddr</code> base address kernel mapping field of
        the relevant memory range in the
        <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DEVICE</code></span><span> structure</span><a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline> [B.4.2]</fo:inline></a></span>
        will not be updated),
      
    and you will therefore not be able to rely on this mapping in calls to
    WinDriver APIs &#8212; namely interrupt handling APIs or any API called from a
    Kernel PlugIn driver.
    </td></tr></table></div></li></ol></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciDeviceClose"></a>B.3.19. WDC_PciDeviceClose()</h3></div></div></div>
<h5><a name="idp46253656795952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Uninitializes a WDC PCI device structure and frees the memory allocated for it.
</p>

<h5><a name="idp46253656797120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciDeviceClose(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253656798544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656807280"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr></tbody></table></div>


  
  <h5><a name="idp46253656816672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

<h5><a name="idp46253656818960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IsaDeviceClose"></a>B.3.20. WDC_IsaDeviceClose()</h3></div></div></div>
<h5><a name="idp46253656823328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Uninitializes a WDC ISA device structure and frees the memory allocated for it.
</p>

<h5><a name="idp46253656824496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_IsaDeviceClose(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253656825920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656834624"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC ISA device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_IsaDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a></span></td></tr></tbody></table></div>


  
  <h5><a name="idp46253656844016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

<h5><a name="idp46253656846304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_CardCleanupSetup"></a>B.3.21. WDC_CardCleanupSetup()</h3></div></div></div>
<h5><a name="idp46253656851424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets a list of transfer cleanup commands to be performed for the specified card
on any of the following occasions:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The application exits abnormally.
  </li><li class="listitem" style="list-style-type: disc">
    The application exits normally but without closing the specified card.
  </li><li class="listitem" style="list-style-type: disc">
    If the <code class="japi">bForceCleanup</code> parameter is set to <code class="japi">TRUE</code>,
    the cleanup commands will also be performed when the specified card is
    closed.
  </li></ul></div><p>
</p>

<h5><a name="idp46253656855984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD WDC_CardCleanupSetup(
    WDC_DEVICE_HANDLE hDev,
    WD_TRANSFER *Cmd,
    DWORD dwCmds,
    BOOL bForceCleanup);
</pre>

<h5><a name="idp46253656857856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Cmd</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TRANSFER*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCmds</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">bForceCleanup</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BOOL</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656871840"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Cmd</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to an array of cleanup transfer commands to be performed<a class="xref" href="#WD_TRANSFER" title="B.7.10. WD_TRANSFER Structure"><fo:inline> [B.7.10]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCmds</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Number of cleanup commands in the <code class="japi">Cmd</code> array</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">bForceCleanup</td><td style="" align="left" valign="top">
    <p>
    If <strong class="japib"><code>FALSE</code></strong>: The cleanup transfer commands (<code class="japi">Cmd</code>)
    will be performed in either of the following cases:<br>
    &#8226; When the application exits abnormally.<br>
    &#8226; When the application exits normally without closing the card by
      calling one of the <code class="jfunc">WDC_xxxDeviceClose</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline> [B.3.19]</fo:inline></a> /
    ISA<a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline> [B.3.20]</fo:inline></a>).
    </p>
    <p>
    If <strong class="japib"><code>TRUE</code></strong>: The cleanup transfer commands will be performed
    both in the two cases described above, as well as in the following
    case:<br>
    &#8226; When the relevant <code class="jfunc">WD_xxxDeviceClose</code><span class="jfunc">()</span> function is
      called for the card.
    </p>
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656890560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_KernelPlugInOpen"></a>B.3.22. WDC_KernelPlugInOpen()</h3></div></div></div>
<h5><a name="idp46253656895344"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Opens a handle to a Kernel PlugIn driver.
</p>

<h5><a name="idp46253656896864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_KernelPlugInOpen(
    WDC_DEVICE_HANDLE hDev,
    const CHAR *pcKPDriverName,
    PVOID pKPOpenData);
</pre>

<h5><a name="idp46253656898736"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcKPDriverName</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pKPOpenData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656911120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcKPDriverName</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Kernel PlugIn driver name</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pKPOpenData</td><td style="" align="left" valign="top">
    Kernel PlugIn driver open data to be passed to
    <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656923184"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253656925728"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
It's also possible to use the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) to open a handle to a Kernel
PlugIn driver, as part of the device-open operation. However, this method
cannot be used to open a handle to a 64-&#65279;bit Kernel PlugIn driver from a
32-&#65279;bit user-mode application. Therefore, to ensure that your code works in
all the supported configurations, it is recommended that you use
<code class="jfunc">WDC_KernelPlugInOpen</code><span class="jfunc">()</span> to open the Kernel PlugIn driver handle.
This is also the only supported method for opening a Kernel PlugIn handle from
a .NET application. (See detailed information in
<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.5</fo:inline></a>.)
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_CallKerPlug"></a>B.3.23. WDC_CallKerPlug()</h3></div></div></div>
<h5><a name="idp46253656932656"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sends a message from a user-mode application to a Kernel PlugIn driver. The
function passes a message ID from the application to the Kernel PlugIn's
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> function, which should be implemented to handle the
specified message ID, and returns the result from the Kernel PlugIn to the
user-mode application.
</p>

<h5><a name="idp46253656936944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_CallKerPlug(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwMsg,
    PVOID pData,
    PDWORD pdwResult);
</pre>

<h5><a name="idp46253656938816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsg</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwResult</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253656952832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsg</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A message ID to pass to the Kernel PlugIn driver (specifically to
    <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to data to pass between the Kernel PlugIn driver and the user-mode
    application
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwResult</td><td style="" align="left" valign="top">
    Result returned by the Kernel PlugIn driver (<code class="japi">KP_Call</code>) for
    the operation performed in the kernel as a result of the message that was
    sent
  </td></tr></tbody></table></div>

  <h5><a name="idp46253656968336"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_ReadMemXXX"></a>B.3.24. WDC_ReadMemXXX()</h3></div></div></div>
<h5><a name="idp46253656973232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_ReadMem8/16/32/64</code><span class="jfunc">()</span> reads 1 byte (8 bits) / 2 bytes (16 bits)
/ 4 bytes (32 bits) / 8 bytes (64 bits), respectively, from a specified memory
address. The address is read directly in the calling context (user mode /
kernel mode).
</p>

<h5><a name="idp46253656976176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BYTE WDC_ReadMem8(addr, off);
WORD WDC_ReadMem16(addr, off);
UINT32 WDC_ReadMem32(addr, off);
UINT64 WDC_ReadMem64(addr, off);
</pre>
<p>
Note: The <code class="japi">WDC_ReadMemXXX</code> APIs are implemented as macros. The
prototypes above use functions declaration syntax to emphasize the expected
return values.
</p>
<h5><a name="idp46253656978992"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">addr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">off</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253656989712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">addr</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory address space to read from</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">off</td><td style="" align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">addr</code>) to read from
  </td></tr></tbody></table></div>

<h5><a name="idp46253656998512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the data that was read from the specified address.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_WriteMemXXX"></a>B.3.25. WDC_WriteMemXXX()</h3></div></div></div>
<h5><a name="idp46253657002160"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_WriteMem8/16/32/64</code><span class="jfunc">()</span> writes 1 byte (8 bits) / 2 bytes (16
bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, to a specified
memory address. The address is written to directly in the calling context (user
mode / kernel mode).
</p>

<h5><a name="idp46253657005104"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void WDC_WriteMem8(addr, off, val);
void WDC_WriteMem16(addr, off, val);
void WDC_WriteMem32(addr, off, val);
void WDC_WriteMem64(addr, off, val);
</pre>
<p>
Note: The <code class="japi">WDC_WriteMemXXX</code> APIs are implemented as macros. The
prototypes above use functions declaration syntax to emphasize the expected
return values.
</p>
<h5><a name="idp46253657007936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">addr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">off</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE / WORD / UINT32 / UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657020272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">addr</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory address space to read from</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">off</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">addr</code>) to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">The data to write to the specified address</td></tr></tbody></table></div>

  <h5><a name="idp46253657030288"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_ReadAddrXXX"></a>B.3.26. WDC_ReadAddrXXX()</h3></div></div></div>
<h5><a name="idp46253657034096"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_ReadAddr8/16/32/64</code><span class="jfunc">()</span> reads 1 byte (8 bits) / 2 bytes (16 bits)
/ 4 bytes (32 bits) / 8 bytes (64 bits), respectively, from a specified memory
or I/&#65279;O address.
</p>

<h5><a name="idp46253657037120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_ReadAddr8(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, BYTE *val);

DWORD DLLCALLCONV WDC_ReadAddr16(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, WORD *val);

DWORD DLLCALLCONV WDC_ReadAddr32(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, UINT32 *val);

DWORD DLLCALLCONV WDC_ReadAddr64(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, UINT64 *val);
</pre>

<h5><a name="idp46253657039696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE* / WORD* / UINT32* / UINT64*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657053696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory or I/&#65279;O address space to read from</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">dwAddrSpace</code>) to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the
    specified address
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657066544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_WriteAddrXXX"></a>B.3.27. WDC_WriteAddrXXX()</h3></div></div></div>
<h5><a name="idp46253657071024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_WriteAddr8/16/32/64</code><span class="jfunc">()</span> writes 1 byte (8 bits) / 2 bytes (16
bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, to a specified
memory or I/&#65279;O address.
</p>

<h5><a name="idp46253657074064"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_WriteAddr8(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, BYTE val)

DWORD DLLCALLCONV WDC_WriteAddr16(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, WORD val);

DWORD DLLCALLCONV WDC_WriteAddr32(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, UINT32 val);

DWORD DLLCALLCONV WDC_WriteAddr64(WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace, KPTR dwOffset, UINT64 val);
</pre>

<h5><a name="idp46253657076208"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">
    BYTE / WORD /
    UINT32 / UINT64
  </td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657090224"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory or I/&#65279;O address space to write to</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">dwAddrSpace</code>) to write to
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">The data to write to the specified address</td></tr></tbody></table></div>

  <h5><a name="idp46253657103056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_ReadAddrBlock"></a>B.3.28. WDC_ReadAddrBlock()</h3></div></div></div>
<h5><a name="idp46253657107712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Reads a block of data from the device.
</p>

<h5><a name="idp46253657109232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_ReadAddrBlock(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace,
    KPTR dwOffset,
    DWORD dwBytes,
    PVOID pData,
    WDC_ADDR_MODE mode,
    WDC_ADDR_RW_OPTIONS options);
</pre>

<h5><a name="idp46253657111184"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">mode</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_MODE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_RW_OPTIONS</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657130096"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory or I/&#65279;O address space to read from</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">dwAddrSpace</code>) to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The number of bytes to read</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the device
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">mode</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The read access mode &#8212; see <span style=""><span style=""><code class="japi">WDC_ADDR_MODE</code></span><a class="xref" href="#WDC_ADDR_MODE" title="B.3.1.4. WDC_ADDR_MODE Enumeration"><fo:inline> [B.3.1.4]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="" align="left" valign="top">
    A bit mask that determines how the data will be read &#8212; see
    <span style=""><span style=""><code class="japi">WDC_ADDR_RW_OPTIONS</code></span><a class="xref" href="#WDC_ADDR_RW_OPTIONS" title="B.3.1.5. WDC_ADDR_RW_OPTIONS Enumeration"><fo:inline> [B.3.1.5]</fo:inline></a></span>.<br>
    The function automatically sets the <code class="japi">WDC_RW_BLOCK</code> flag.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657152496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_WriteAddrBlock"></a>B.3.29. WDC_WriteAddrBlock()</h3></div></div></div>
<h5><a name="idp46253657156816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Writes a block of data to the device.
</p>

<h5><a name="idp46253657158272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_WriteAddrBlock(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace,
    KPTR dwOffset,
    DWORD dwBytes,
    PVOID pData,
    WDC_ADDR_MODE mode,
    WDC_ADDR_RW_OPTIONS options);
</pre>

<h5><a name="idp46253657160224"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">mode</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_MODE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_RW_OPTIONS</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657179136"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The memory or I/&#65279;O address space to write to</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the specified address space
    (<code class="japi">dwAddrSpace</code>) to write to
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The number of bytes to write</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to a buffer that holds the data to write to the device</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">mode</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The write access mode &#8212; see <span style=""><span style=""><code class="japi">WDC_ADDR_MODE</code></span><a class="xref" href="#WDC_ADDR_MODE" title="B.3.1.4. WDC_ADDR_MODE Enumeration"><fo:inline> [B.3.1.4]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="" align="left" valign="top">
    A bit mask that determines how the data will be written &#8212; see
    <span style=""><span style=""><code class="japi">WDC_ADDR_RW_OPTIONS</code></span><a class="xref" href="#WDC_ADDR_RW_OPTIONS" title="B.3.1.5. WDC_ADDR_RW_OPTIONS Enumeration"><fo:inline> [B.3.1.5]</fo:inline></a></span>.<br>
    The function automatically sets the <code class="japi">WDC_RW_BLOCK</code> flag.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657201568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_MultiTransfer"></a>B.3.30. WDC_MultiTransfer()</h3></div></div></div>
<h5><a name="idp46253657206240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Performs a group of memory and/or I/&#65279;O read/write transfers.
</p>

<h5><a name="idp46253657207840"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_MultiTransfer(
    WD_TRANSFER *pTrans,
    DWORD dwNumTrans);
</pre>

<h5><a name="idp46253657209664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pTrans</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TRANSFER*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwNumTrans</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657220256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pTrans</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to an array of transfer commands information structures<a class="xref" href="#WD_TRANSFER" title="B.7.10. WD_TRANSFER Structure"><fo:inline> [B.7.10]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwNumTrans</td><td style="" align="left" valign="top">Number of transfer commands in the <code class="japi">pTrans</code> array</td></tr></tbody></table></div>

  <h5><a name="idp46253657229568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253657232112"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The transfers are performed using the low&#65279;-&#65279;level
    <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span> WinDriver function, which reads/writes the
    specified addresses in the kernel (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> for details).
  </li><li class="listitem" style="list-style-type: disc">
    Memory addresses are read/written in the kernel (like I/&#65279;O addresses)
    and NOT directly in the user mode, therefore the port addresses passed
    to this function, for both memory and I/&#65279;O addresses, must be the
    kernel-mode mappings of the physical addresses, which are stored in the
    device structure<a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.2]</fo:inline></a>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_AddrSpaceIsActive"></a>B.3.31. WDC_AddrSpaceIsActive()</h3></div></div></div>
<h5><a name="idp46253657239088"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Checks if the specified memory or I/&#65279;O address space is active &#8212; i.e.,
if its size is not zero.
</p>

<h5><a name="idp46253657240768"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL DLLCALLCONV WDC_AddrSpaceIsActive(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwAddrSpace);
</pre>

<h5><a name="idp46253657242608"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657253360"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="" align="left" valign="top">The memory or I/&#65279;O address space to look for</td></tr></tbody></table></div>

<h5><a name="idp46253657263312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if the specified address space is active; otherwise
returns <code class="japi">FALSE</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciReadCfgBySlot"></a>B.3.32. WDC_PciReadCfgBySlot()</h3></div></div></div>
<h5><a name="idp46253657268352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Reads data from a specified offset in a PCI device's configuration space or a
PCI Express device's extended configuration space.<br>
The device is identified by its location on the PCI bus.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657271328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciReadCfgBySlot(
    WD_PCI_SLOT *pPciSlot,
    DWORD dwOffset,
    PVOID pData,
    DWORD dwBytes);
</pre>

<h5><a name="idp46253657273200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657287216"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the PCI
    configuration space
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="" align="left" valign="top">The number of bytes to read</td></tr></tbody></table></div>

  <h5><a name="idp46253657301232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciWriteCfgBySlot"></a>B.3.33. WDC_PciWriteCfgBySlot()</h3></div></div></div>
<h5><a name="idp46253657305568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Write data to a specified offset in a PCI device's configuration space or a PCI
Express device's extended configuration space.<br>
The device is identified by its location on the PCI bus.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657308544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciWriteCfgBySlot(
    WD_PCI_SLOT *pPciSlot,
    DWORD dwOffset,
    PVOID pData,
    DWORD dwBytes);
</pre>

<h5><a name="idp46253657310416"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657324432"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to write to
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to a data buffer that holds the data to write</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="" align="left" valign="top">The number of bytes to write</td></tr></tbody></table></div>

  <h5><a name="idp46253657338384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciReadCfg"></a>B.3.34. WDC_PciReadCfg()</h3></div></div></div>
<h5><a name="idp46253657343120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Reads data from a specified offset in a PCI device's configuration space or a
PCI Express device's extended configuration space.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657345760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciReadCfg(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset,
    PVOID pData,
    DWORD dwBytes);
</pre>

<h5><a name="idp46253657347616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657361632"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the PCI
    configuration space
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="" align="left" valign="top">The number of bytes to read</td></tr></tbody></table></div>

  <h5><a name="idp46253657374944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciWriteCfg"></a>B.3.35. WDC_PciWriteCfg()</h3></div></div></div>
<h5><a name="idp46253657379200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Writes data to a specified offset in a PCI device's configuration space or a
PCI Express device's extended configuration space.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657381840"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciWriteCfg(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset,
    PVOID pData,
    DWORD dwBytes);
</pre>

<h5><a name="idp46253657383712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657397728"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to write to
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to a data buffer that holds the data to write</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="" align="left" valign="top">The number of bytes to write</td></tr></tbody></table></div>

  <h5><a name="idp46253657411008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciReadCfgBySlotXXX"></a>B.3.36. WDC_PciReadCfgBySlotXXX()</h3></div></div></div>
<h5><a name="idp46253657415872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_PciReadCfgBySlot8/16/32/64</code><span class="jfunc">()</span> reads 1 byte (8 bits) / 2 bytes
(16 bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, from a
specified offset in a PCI device's configuration space or a PCI Express
device's extended configuration space.<br>
The device is identified by its location on the PCI bus.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657420256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciReadCfgRegBySlot8(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, BYTE *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg1BySlot6(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, WORD *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg32BySlot(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, UINT32 *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg64BySlot(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, UINT64 *val);
</pre>

<h5><a name="idp46253657422368"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE* / WORD* / UINT32* / UINT64*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657434736"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the PCI
    configuration space
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657447536"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciWriteCfgBySlotXXX"></a>B.3.37. WDC_PciWriteCfgBySlotXXX()</h3></div></div></div>
<h5><a name="idp46253657452016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_PciWriteCfgBySlot8/16/32/64</code><span class="jfunc">()</span> writes 1 byte (8 bits) / 2 bytes
(16 bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, to a specified
offset in a PCI device's configuration space or a PCI Express device's extended
configuration space.<br>
The device is identified by its location on the PCI bus.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657456400"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciWriteCfgRegBySlot8(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, BYTE val);

DWORD DLLCALLCONV WDC_PciWriteCfgRegBySlot16(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, WORD val);

DWORD DLLCALLCONV WDC_PciWriteCfgRegBySlot32(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, UINT32 val);

DWORD DLLCALLCONV WDC_PciWriteCfgRegBySlot64(
    WD_PCI_SLOT *pPciSlot, DWORD dwOffset, UINT64 val);
</pre>

<h5><a name="idp46253657458512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE / WORD / UINT32 / UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657470880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPciSlot</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can be acquired by calling
    <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">The data to write to the PCI configuration space</td></tr></tbody></table></div>

  <h5><a name="idp46253657483616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciReadCfgXXX"></a>B.3.38. WDC_PciReadCfgXXX()</h3></div></div></div>
<h5><a name="idp46253657488512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_PciReadCfg8/16/32/64</code><span class="jfunc">()</span> reads 1 byte (8 bits) / 2 bytes (16
bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, from a specified
offset in a PCI device's configuration space or a PCI Express device's extended
configuration space.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657492512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciReadCfgReg8(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, BYTE *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg16(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, WORD *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg32(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, UINT32 *val);

DWORD DLLCALLCONV WDC_PciReadCfgReg64(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, UINT64 *val);
</pre>

<h5><a name="idp46253657494576"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE* / WORD* / UINT32* / UINT64*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657506944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    Pointer to a buffer to be filled with the data that is read from the PCI
    configuration space
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657519024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_PciWriteCfgXXX"></a>B.3.39. WDC_PciWriteCfgXXX()</h3></div></div></div>
<h5><a name="idp46253657523504"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
<code class="jfunc">WDC_PciWriteCfg8/16/32/64</code><span class="jfunc">()</span> writes 1 byte (8 bits) / 2 bytes (16
bits) / 4 bytes (32 bits) / 8 bytes (64 bits), respectively, to a specified
offset in a PCI device's configuration space or a PCI Express device's extended
configuration space.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  Access to the PCI Express extended configuration space is supported on
target platforms that support such access (e.g., Windows and Linux). For such platforms, all <em class="it">PCI</em> references in the
  following documentation include PCI Express as well.
  </td></tr></table></div>
<h5><a name="idp46253657527488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_PciWriteCfgReg8(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, BYTE val);

DWORD DLLCALLCONV WDC_PciWriteCfgReg16(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, WORD val);

DWORD DLLCALLCONV WDC_PciWriteCfgReg32(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, UINT32 val);

DWORD DLLCALLCONV WDC_PciWriteCfgReg64(WDC_DEVICE_HANDLE hDev,
    DWORD dwOffset, UINT64 val);
</pre>

<h5><a name="idp46253657529552"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BYTE / WORD / UINT32 / UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657541920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC PCI device structure, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOffset</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The offset from the beginning of the PCI configuration space to read from
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">The data to write to the PCI configuration space</td></tr></tbody></table></div>

  <h5><a name="idp46253657553936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMAContigBufLock"></a>B.3.40. WDC_DMAContigBufLock()</h3></div></div></div>
<h5><a name="idp46253657558688"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Allocates a contiguous DMA buffer, locks it in physical memory, and returns
mappings of the allocated buffer to physical address space and to user-mode and
kernel virtual address spaces.
</p>

<h5><a name="idp46253657560352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMAContigBufLock(
    WDC_DEVICE_HANDLE hDev,
    PVOID *ppBuf,
    DWORD dwOptions,
    DWORD dwDMABufSize,
    WD_DMA **ppDma);
</pre>

<h5><a name="idp46253657562256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657577904"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>).</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a pointer to be filled by the function with the user-mode mapped
    address of the allocated DMA buffer
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A bit mask of any of the following flags (defined in an enumeration in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>):<br>
    &#8226; <strong class="japib"><code>DMA_FROM_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from the device to memory.<br>
    &#8226; <strong class="japib"><code>DMA_TO_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from memory to the device.<br>
    &#8226; <strong class="japib"><code>DMA_TO_FROM_DEVICE</code></strong>: Synchronize the DMA buffer
      for transfers in both directions &#8212; i.e., from the device to memory
      and from memory to the device (&lt;=&gt; <code class="japi">DMA_FROM_DEVICE |
      DMA_TO_DEVICE</code>).<br>
    &#8226; <strong class="japib"><code>DMA_ALLOW_CACHE</code></strong>: Allow caching of the memory.
    <br>
    &#8226; <strong class="japib"><code>DMA_KBUF_BELOW_16M</code></strong>: Allocate the physical DMA
      buffer within the lower 16MB of the main memory.<br>
    &#8226; <strong class="japib"><code>DMA_ALLOW_64BIT_ADDRESS</code></strong>: Allow allocation of
      64-&#65279;bit DMA addresses. This flag is supported on Windows
      and Linux.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The size (in bytes) of the DMA buffer</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="" align="left" valign="top">
    Pointer to a pointer to a DMA buffer information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, which is allocated by the function.<br>
    The pointer to this structure (<code class="japi">*ppDma</code>) should be passed to
    <span style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span> when the DMA buffer is no longer needed.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657602192"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  <h5><a name="idp46253657604480"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    When calling this function you do <span class="b"><strong>not</strong></span> need to set the<br>
    <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag, since the function sets this
    flag automatically.
    </li><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    On Windows x86 and x86_64 platforms, you should normally set the
    <code class="japi">DMA_ALLOW_CACHE</code> flag in the DMA options bitmask parameter
    (<code class="japi">dwOptions</code>).
    </li><li class="listitem" style="list-style-type: disc">
    If the device supports 64-&#65279;bit DMA addresses, it is recommended to set the
    <code class="japi">DMA_ALLOW_64BIT_ADDRESS</code> flag in
    <code class="japi">dwOptions</code>.
    Otherwise, when the physical memory on the target platform is larger than
    4GB, the operating system may only allow allocation of relatively small
    32-bit DMA buffers (such as 1MB buffers, or even smaller).
    </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMASGBufLock"></a>B.3.41. WDC_DMASGBufLock()</h3></div></div></div>
<h5><a name="idp46253657613920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Locks a pre-allocated user-mode memory buffer for DMA and returns the
corresponding physical mappings of the locked DMA pages. On Windows the
function also returns a kernel-mode mapping of the buffer.
</p>

<h5><a name="idp46253657615600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMASGBufLock(
    WDC_DEVICE_HANDLE hDev,
    PVOID pBuf,
    DWORD dwOptions,
    DWORD dwDMABufSize,
    WD_DMA **ppDma);
</pre>

<h5><a name="idp46253657617488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657633136"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a user-mode buffer to be mapped to the allocated physical DMA
    buffer(s)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A bit mask of any of the following flags (defined in an enumeration in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>):<br>
    &#8226; <strong class="japib"><code>DMA_FROM_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from the device to memory.<br>
    &#8226; <strong class="japib"><code>DMA_TO_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from memory to the device.<br>
    &#8226; <strong class="japib"><code>DMA_TO_FROM_DEVICE</code></strong>: Synchronize the DMA buffer
      for transfers in both directions &#8212; i.e., from the device to memory
      and from memory to the device (&lt;=&gt; <code class="japi">DMA_FROM_DEVICE |
      DMA_TO_DEVICE</code>).<br>
    &#8226; <strong class="japib"><code>DMA_ALLOW_CACHE</code></strong>:
      Allow caching of the memory.<br>
    &#8226; <strong class="japib"><code>DMA_ALLOW_64BIT_ADDRESS</code></strong>: Allow allocation of
      64-&#65279;bit DMA addresses. This flag is supported on Windows
      and Linux.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The size (in bytes) of the DMA buffer</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="" align="left" valign="top">
    Pointer to a pointer to a DMA buffer information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, which is allocated by the function.<br>
    The pointer to this structure (<code class="japi">*ppDma</code>) should be passed to
    <span style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span> when the DMA buffer is no longer needed.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657656224"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  <h5><a name="idp46253657658512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    When calling the function to allocate large buffers (&gt; 1MB) you do
    <span class="b"><strong>not</strong></span> need to set the <code class="japi">DMA_LARGE_BUFFER</code> flag, which is
    used for allocation of large Scatter/&#65279;Gather DMA buffers using the low&#65279;-&#65279;level
    WinDriver <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>),
    since <code class="jfunc">WDC_DMASGBufLock</code><span class="jfunc">()</span> handles this for you.
    </li><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    On Windows x86 and x86_64 platforms, you should normally set the
    <code class="japi">DMA_ALLOW_CACHE</code> flag in the DMA options bitmask parameter
    (<code class="japi">dwOptions</code>).
    </li><li class="listitem" style="list-style-type: disc">
    If the device supports 64-&#65279;bit DMA addresses, it is recommended to set the
    <code class="japi">DMA_ALLOW_64BIT_ADDRESS</code> flag in
    <code class="japi">dwOptions</code>.
    Otherwise, when the physical memory on the target platform is larger than
    4GB, the operating system may only allow allocation of relatively small
    32-bit DMA buffers (such as 1MB buffers, or even smaller).
    </li></ul></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMAReservedBufLock"></a>B.3.42. WDC_DMAReservedBufLock()</h3></div></div></div>
<h5><a name="idp46253657669328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Locks a physical reserved memory buffer for DMA and returns the
corresponding user mode address of locked DMA buffer.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The physical address returned from this API (ppDma-&gt;Page[0].pPhysicalAddr) may
be different then the address supplied by the caller (qwAddr) when the system 
uses IOMMU. When performing DMA transfer using this mapped buffer, make sure to
use the returned address. 
</td></tr></table></div>
<h5><a name="idp46253657671952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMAReservedBufLock(
    WDC_DEVICE_HANDLE hDev,
    PHYS_ADDR qwAddr,
    PVOID *ppBuf,
    DWORD dwOptions,
    DWORD dwDMABufSize,
    WD_DMA **ppDma);
</pre>

<h5><a name="idp46253657673872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">qwAddr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PHYS_ADDR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID *</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657691152"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">qwAddr</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Physical address of the reserved buffer to lock</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a pointer to be filled by the function with the user-mode mapped
    address of the locked DMA buffer
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A bit mask of any of the following flags (defined in an enumeration in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>):<br>
    &#8226; <strong class="japib"><code>DMA_FROM_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from the device to memory.<br>
    &#8226; <strong class="japib"><code>DMA_TO_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from memory to the device.<br>
    &#8226; <strong class="japib"><code>DMA_TO_FROM_DEVICE</code></strong>: Synchronize the DMA buffer
      for transfers in both directions &#8212; i.e., from the device to memory
      and from memory to the device (&lt;=&gt; <code class="japi">DMA_FROM_DEVICE |
      DMA_TO_DEVICE</code>).<br>
    &#8226; <strong class="japib"><code>DMA_ALLOW_64BIT_ADDRESS</code></strong>: Allow allocation of
      64-&#65279;bit DMA addresses. This flag is supported on Windows
      and Linux.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwDMABufSize</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The size (in bytes) of the DMA buffer</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="" align="left" valign="top">
    Pointer to a pointer to a DMA buffer information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, which is allocated by the function.<br>
    The pointer to this structure (<code class="japi">*ppDma</code>) should be passed to
    <span style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span> when the DMA buffer is no longer needed.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253657714464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMABufUnlock"></a>B.3.43. WDC_DMABufUnlock()</h3></div></div></div>

<h5><a name="idp46253657719056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Unlocks and frees the memory allocated for a DMA buffer by a previous call to
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> or
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMAReservedBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAReservedBufLock" title="B.3.42. WDC_DMAReservedBufLock()"><fo:inline> [B.3.42]</fo:inline></a></span>.
</p>



<h5><a name="idp46253657728176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMABufUnlock(WD_DMA *pDma);</pre>



<h5><a name="idp46253657729968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>



<h5><a name="idp46253657739088"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="" align="left" valign="top">
    Pointer to a DMA information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, received from a
    previous call to <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> (for a contiguous DMA buffer)
    or <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> (for a Scatter/&#65279;Gather DMA buffer) &#8212;
    <code class="japi">*ppDma</code> returned by these functions
  </td></tr></tbody></table></div>



  
  <h5><a name="idp46253657752400"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  


<h5><a name="idp46253657754944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li></ul></div>

</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMABufGet"></a>B.3.44. WDC_DMABufGet()</h3></div></div></div>
<h5><a name="idp46253657758976"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves a contiguous DMA buffer which was allocated by another process.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253657761504"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMABufGet(DWORD hDma, WD_DMA **ppDma);</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Before calling this API, the calling process should recieve the global buffer
handle via WinDriver IPC mechanism from the process that allocated the buffer. 
</td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Once the process finish using the shared buffer, it should release it using the
regular unlock method- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DMABufUnlock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMABufUnlock" title="B.3.43. WDC_DMABufUnlock()"><fo:inline> [B.3.43]</fo:inline></a></span>.
</td></tr></table></div>
<h5><a name="idp46253657766896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDma</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253657777648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDma</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    DMA buffer handle.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDma</td><td style="" align="left" valign="top">
    Pointer to a pointer to a DMA buffer information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, which is associated with hDma. 
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253657786480"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMAGetGlobalHandle"></a>B.3.45. WDC_DMAGetGlobalHandle Macro</h3></div></div></div>
<h5><a name="idp46253657791152"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that returns a contiguous DMA global handle that can be used for
buffer sharing between multiple processes.
</p>

<h5><a name="idp46253657792752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_DMAGetGlobalHandle(pDma)</pre>

<h5><a name="idp46253657794528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253657803648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="" align="left" valign="top">
    Pointer to a DMA information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, received from a
    previous call to <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span>
  </td></tr></tbody></table></div>

<h5><a name="idp46253657813872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
DMA buffer handle of pDma.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMASyncCpu"></a>B.3.46. WDC_DMASyncCpu()</h3></div></div></div>

<h5><a name="idp46253657817648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Synchronizes the cache of all CPUs with the DMA buffer, by flushing the data
from the CPU caches.
</p>


<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This function should be called before performing a DMA transfer (see Remarks
below).
</td></tr></table></div>


<h5><a name="idp46253657819696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMASyncCpu(WD_DMA *pDma);</pre>



<h5><a name="idp46253657821488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>



<h5><a name="idp46253657830608"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="" align="left" valign="top">
    Pointer to a DMA information structure<a class="xref" href="#WD_DMA" title="B.7.9. WD_DMA Structure"><fo:inline> [B.7.9]</fo:inline></a>, received from a
    previous call to <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> (for a contiguous DMA buffer)
    or <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> (for a Scatter/&#65279;Gather DMA buffer) &#8212;
    <code class="japi">*ppDma</code> returned by these functions
  </td></tr></tbody></table></div>



  
  <h5><a name="idp46253657843920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  


<h5><a name="idp46253657846464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    An asynchronous DMA read or write operation accesses data in memory, not in
    the processor (CPU) cache, which resides between the CPU and the host's
    physical memory. Unless the CPU cache has been flushed, by calling
    <code class="jfunc">WDC_DMASyncCpu</code><span class="jfunc">()</span>, just before a read transfer, the data
    transferred into system memory by the DMA operation could be overwritten
    with stale data if the CPU cache is flushed later. Unless the CPU cache has
    been flushed by calling <code class="jfunc">WDC_DMASyncCpu</code><span class="jfunc">()</span> just before a write
    transfer, the data in the CPU cache might be more up-to-date than the copy
    in memory.
  </li><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li></ul></div>

</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DMASyncIo"></a>B.3.47. WDC_DMASyncIo()</h3></div></div></div>

<h5><a name="idp46253657852592"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Synchronizes the I/&#65279;O caches with the DMA buffer, by flushing the data from
the I/&#65279;O caches and updating the CPU caches.
</p>


<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This function should be called after performing a DMA transfer (see Remarks
below).
</td></tr></table></div>


<h5><a name="idp46253657854800"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_DMASyncIo(WD_DMA *pDma);</pre>



<h5><a name="idp46253657856592"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_DMA*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>



<h5><a name="idp46253657865712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDma</td><td style="" align="left" valign="top">
    Pointer to a DMA information structure, received from a previous call to
    <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> (for a contiguous DMA buffer) or
    <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> (for a Scatter/&#65279;Gather DMA buffer) &#8212;
    <code class="japi">*ppDma</code> returned by these functions
  </td></tr></tbody></table></div>



  
  <h5><a name="idp46253657878528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  


<h5><a name="idp46253657881072"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    After a DMA transfer has been completed, the data can still be in the
    I/&#65279;O cache, which resides between the host's physical memory and the
    bus-master DMA device, but not yet in the host's main memory. If the CPU
    accesses the memory, it might read the wrong data from the CPU cache. To
    ensure a consistent view of the memory for the CPU, you should call
    <code class="jfunc">WDC_DMASyncIo</code><span class="jfunc">()</span> after a DMA transfer in order to flush the
    data from the I/&#65279;O cache and update the CPU cache with the new data. The
    function also flushes additional caches and buffers between the device
    and memory, such as caches associated with bus extenders or bridges.
  </li><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li></ul></div>

</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IntEnable"></a>B.3.48. WDC_IntEnable()</h3></div></div></div>
<h5><a name="idp46253657888560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Enables interrupt handling for the device.
</p>

<p>
On Linux and Windows 7 and higher, when attempting to enable interrupts for a PCI device that
supports Extended Message-Signaled Interrupts (MSI-&#65279;X) or Message-Signaled Interrupts (MSI) (and was installed with a
relevant INF file &#8212; on <span class="b"><strong>Windows</strong></span><a class="xref" href="#win_msi_inf_files" title="9.2.7.1. Windows MSI/MSI-&#65279;X Device INF Files"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [9.2.7.1]</fo:inline></a>), the
function first tries to enable MSI-&#65279;X or MSI; if this fails, or if the target
OS does not support MSI/MSI-&#65279;X, the function attempts to enable legacy
level-sensitive interrupts (if supported by the device).<br>
On <span class="b"><strong>Linux</strong></span>, you can use the function's
<span class="b"><strong><a class="xref" href="#WDC_IntEnable_dwOptions_desc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">dwOptions</fo:inline></a></strong></span> parameter to specify the types
of PCI interrupts that may be enabled for the device (see the
<a class="link" href="#int_enable_dwOptions_int_type_flags">explanation</a> in the
parameter description).<br>
For other types of hardware (PCI with no MSI/MSI-&#65279;X support / ISA),
the function attempts to enable the legacy interrupt type supported by the
device (Level Sensitive / Edge Triggered) &#8212; see further information in
<a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2</fo:inline></a>.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
When enabling interrupts using a <span class="b"><strong>Kernel PlugIn</strong></span> driver
(<code class="japi">fUseKP=TRUE</code>), the Kernel PlugIn functions used to handle the
interrupts are derived from the type of interrupts enabled for the device: for
MSI/MSI-&#65279;X, the <code class="japi">KP_IntAtIrqlMSI</code> and <code class="japi">KP_IntAtDpcMSI</code>
functions are used; otherwise, the <code class="japi">KP_IntAtIrql</code> and
<code class="japi">KP_IntAtDpc</code> functions are used.
</td></tr></table></div><p>
If the caller selects to handle the interrupts in the kernel, using a <span class="b"><strong>Kernel
PlugIn</strong></span> driver, the Kernel PlugIn <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a>
    (MSI/MSI-&#65279;X) function,
which runs at high interrupt request level (IRQL), will be invoked immediately when an interrupt
is received.
</p><p>
The function can receive transfer commands information, which will be performed
by WinDriver at the kernel, at high IRQ level, when an interrupt is received (see
further information in <a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 9.2.6</fo:inline></a>). If a
<span class="b"><strong>Kernel PlugIn</strong></span> driver is used to handle the interrupts, any transfer
commands set by the caller will be executed by WinDriver after the Kernel PlugIn
<code class="japi">KP_IntAtDpc</code> or <code class="japi">KP_IntAtDpcMSI</code> function completes its execution.<br>
When handling level-sensitive interrupts (such as legacy PCI interrupts) from
the <span class="b"><strong>user mode</strong></span>, without a Kernel PlugIn driver, you must prepare and pass
to the function transfer commands for acknowledging the interrupt. When using a
<span class="b"><strong>Kernel PlugIn</strong></span> driver, the information for acknowledging the interrupts
should be implemented in the Kernel PlugIn
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><span> function</span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span>, so the transfer commands in the
call to <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> are not required (although they can still
be used).
</p><p>
The function receives a user-mode interrupt handler routine, which will be
called by WinDriver after the kernel-mode interrupt processing is completed.<br>
If the interrupts are handled using a <span class="b"><strong>Kernel PlugIn</strong></span> driver, the return
value of the Kernel PlugIn deferred interrupt handler function &#8212;
<code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.9]</fo:inline></a>
    (legacy interrupts) or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.11]</fo:inline></a>
    (MSI/MSI-&#65279;X) &#8212; will determine how many times (if at all)
the user-mode interrupt handler will be called (provided
<code class="japi">KP_IntAtDpc</code> or <code class="japi">KP_IntAtDpcMSI</code> itself is executed &#8212; which is determined by
the return value of the Kernel PlugIn <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.8]</fo:inline></a> or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.10]</fo:inline></a> function).
</p>
<h5><a name="idp46253657916368"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_IntEnable(
    WDC_DEVICE_HANDLE hDev,
    WD_TRANSFER *pTransCmds,
    DWORD dwNumCmds,
    DWORD dwOptions,
    INT_HANDLER funcIntHandler,
    PVOID pData,
    BOOL fUseKP);
</pre>

<h5><a name="idp46253657918304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pTransCmds</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TRANSFER*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwNumCmds</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntHandler</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    typedef void (*INT_HANDLER)(<br>
    &#8195; PVOID pData);
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fUseKP</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BOOL</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>
<h5><a name="idp46253657937296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pTransCmds</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    An array of transfer commands information structures that define the
    operations to be performed at the kernel level upon the detection of an
    interrupt, or <code class="japi">NULL</code> if no transfer commands are required.
    </p>
    <p>
    NOTE:<br>
    &#8226; Memory allocated for the transfer commands must remain available
  until the interrupts are disabled
.<br>
    &#8226; When handling level-sensitive interrupts (such as legacy PCI
      interrupts) without a Kernel PlugIn<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline> [11]</fo:inline></a>,
      you must use this array to define the hardware-specific commands for
      acknowledging the interrupts in the kernel, immediately when they are
      received &#8212; see further information in
      <a class="xref" href="#Handling_Interrupts" title="9.2. Handling Interrupts"><fo:inline>Section 9.2</fo:inline></a>.
    </p>
    <p>
    For an explanation on how to set the transfer commands, refer to the
    description of <code class="japi">WD_TRANSFER</code> in
    <a class="xref" href="#WD_TRANSFER" title="B.7.10. WD_TRANSFER Structure"><fo:inline>Section B.7.10</fo:inline></a>, and to the explanation in
    <a class="xref" href="#wd_int_trans_cmd" title="9.2.6. Setting Up Kernel-Mode Interrupt Transfer Commands"><fo:inline>Section 9.2.6</fo:inline></a>.
    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwNumCmds</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Number of transfer commands in the <code class="japi">pTransCmds</code> array
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><a name="WDC_IntEnable_dwOptions_desc"></a><span style="">dwOptions</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    A bit mask of interrupt handling flags &#8212; can be set to zero for no
    options, or to a combination of any of the following flags:
    <div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_CMD_COPY</code></strong>: If set, WinDriver will copy any data
        read in the kernel as a result of a read transfer command, and return
        it to the user within the relevant transfer command structure.<br>
        The user will be able to access the data from his user-mode interrupt
        handler routine<span>
          (<strong class="japib"><code>funcIntHandler</code></strong>).
        </span></li></ul></div>
    
    
    The following flags are applicable only to PCI interrupts on <span class="b"><strong>Linux</strong></span>.
    If set, these flags determine the types of interrupts that may be enabled
    for the device &#8212; the function will attempt to enable only interrupts
    of the specified types, using the following precedence order, provided the
    type is reported as supported by the device:
    
    <div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong>: Extended Message-Signaled Interrupts (MSI-&#65279;X)
      </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE</code></strong>: Message-Signaled Interrupts (MSI)
      </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LEVEL_SENSITIVE</code></strong> &#8212; Legacy level-sensitive
        interrupts<br></li></ul></div>
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntHandler</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A user-mode interrupt handler callback function, which will be executed
    after an interrupt is received and processed in the kernel. (The prototype
    of the interrupt handler &#8212; <code class="japi">INT_HANDLER</code> &#8212; is
    defined in <span class="jprintfilename"><strong>windrvr_int_thread.h</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Data for the user-mode interrupt handler callback routine
    (<strong class="japib"><code>funcIntHandler</code></strong>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fUseKP</td><td style="" align="left" valign="top">
    If <strong class="japib"><code>TRUE</code></strong> &#8212; The device's Kernel PlugIn driver's
    <code class="japi">KP_IntAtIrql</code><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a> or <code class="japi">KP_IntAtIrqlMSI</code><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a> function, which runs at high interrupt request level (IRQL), will be
    executed immediately when an interrupt is received. The Kernel PlugIn
    driver to be used for the device is passed to
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> and stored in the WDC device structure.
    <br>
    If the caller also passes transfer commands to the function
    (<strong class="japib"><code>pTransCmds</code></strong>), these commands will be executed by WinDriver at
    the kernel, at high IRQ level, after <code class="japi">KP_IntAtIrql</code> or <code class="japi">KP_IntAtIrqlMSI</code> completes
    its execution.<br>
    If the high-IRQL handler returns <code class="japi">TRUE</code>, the Kernel PlugIn
    deferred interrupt processing routine &#8212; <code class="japi">KP_IntAtDpc</code><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a> or <code class="japi">KP_IntAtDpcMSI</code><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a> &#8212;
    will be invoked. The return value of this function determines how many
    times (if at all) the user-mode interrupt handler
    (<strong class="japib"><code>funcIntHandler</code></strong>) will be executed once the control returns
    to the user mode.<br>
    If <strong class="japib"><code>FALSE</code></strong> &#8212; When an interrupt is received, any transfer
    commands set by the user in <strong class="japib"><code>pTransCmds</code></strong> will be executed by
    WinDriver at the kernel, at high IRQ level, and the user-mode interrupt
    handler routine (<strong class="japib"><code>funcIntHandler</code></strong>) will be executed when the
    control returns to the user mode.
  </td></tr></tbody></table></div>
  <h5><a name="idp46253657985200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253657987744"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li><li class="listitem" style="list-style-type: disc">
    The function enables interrupt handling in the software. After it
    returns successfully you must physically enable generation of interrupts
    in the hardware (you should be able to do so by writing to the device
    from the code).
  </li><li class="listitem" style="list-style-type: disc">
    A successful call to this function must be followed with a call to
    <code class="jfunc">WDC_IntDisable</code><span class="jfunc">()</span> later on in the code, in order to disable the
    interrupts.<br>
    The <code class="jfunc">WDC_xxxDriverClose</code><span class="jfunc">()</span> functions
    (PCI:<a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.19]</fo:inline></a>,
    ISA:<a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.20]</fo:inline></a>) call <code class="jfunc">WDC_IntDisable</code><span class="jfunc">()</span> if
    the device's interrupts are enabled.
  </li><li class="listitem" style="list-style-type: disc">
    
  WinDriver must be registered with the OS as the driver of the device before
  enabling interrupts. For Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware (PCI&#65279;/&#65279;PCI Express) on
  Windows platforms, this association is made by installing an INF file for the
  device<span xmlns:fo="http://www.w3.org/1999/XSL/Format"><span><a class="xref" href="#winpnp_inf" title="15.1. Windows INF Files"><fo:inline> [15.1]</fo:inline></a></span></span>.
  If the INF file is not installed, <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span>
  will fail with a <code class="japi">WD_NO_DEVICE_OBJECT</code> error<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.

  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IntDisable"></a>B.3.49. WDC_IntDisable()</h3></div></div></div>
<h5><a name="idp46253657999760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Disables interrupt interrupt handling for the device, pursuant to a previous
call to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span>.
</p>

<h5><a name="idp46253658003440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_IntDisable(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658004864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658013600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr></tbody></table></div>


  
  <h5><a name="idp46253658022128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

<h5><a name="idp46253658024416"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IntIsEnabled"></a>B.3.50. WDC_IntIsEnabled()</h3></div></div></div>
<h5><a name="idp46253658028816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Checks if a device's interrupts are currently enabled.
</p>

<h5><a name="idp46253658029968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL DLLCALLCONV WDC_IntIsEnabled(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658031392"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658040128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr></tbody></table></div>

<h5><a name="idp46253658048352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if the device's interrupts are enabled; otherwise
returns <code class="japi">FALSE</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IntType2Str"></a>B.3.51. WDC_IntType2Str()</h3></div></div></div>
<h5><a name="idp46253658052704"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Converts interrupt type to string.
</p>

<h5><a name="idp46253658053824"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">const CHAR * DLLCALLCONV WDC_IntType2Str(DWORD dwIntType);</pre>

<h5><a name="idp46253658055248"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwIntType</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658063984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwIntType</td><td style="" align="left" valign="top">Interrupt types bit-mask</td></tr></tbody></table></div>

<h5><a name="idp46253658070720"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the string representation that corresponds to the specified numeric 
code.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_EventRegister"></a>B.3.52. WDC_EventRegister()</h3></div></div></div>
<h5><a name="idp46253658074752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Registers the application to receive Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management events
notifications for the device.
</p>

<h5><a name="idp46253658076080"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_EventRegister(
    WDC_DEVICE_HANDLE hDev,
    DWORD dwActions,
    EVENT_HANDLER funcEventHandler,
    PVOID pData,
    BOOL fUseKP);
</pre>

<h5><a name="idp46253658077600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwActions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcEventHandler</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    typedef void (*EVENT_HANDLER)(<br>
    &#8195; WD_EVENT *pEvent,<br>
    &#8195; void *pData);
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fUseKP</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BOOL</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658093856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a Plug&#65279;-&#65279;and&#65279;-&#65279;Play WDC device, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwActions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A bit mask of flags indicating which events to register to:<br>
    <span class="b"><strong>Plug&#65279;-&#65279;and&#65279;-&#65279;Play events:</strong></span><br>
    &#8226; <strong class="japib"><code>WD_INSERT</code></strong>
      &#8212; Device inserted<br>
    &#8226; <strong class="japib"><code>WD_REMOVE</code></strong> &#8212; Device removed<br>
      <span class="b"><strong>Device power state change events:</strong></span><br>
    &#8226; <strong class="japib"><code>WD_POWER_CHANGED_D0</code></strong> &#8212; Full power<br>
    &#8226; <strong class="japib"><code>WD_POWER_CHANGED_D1</code></strong> &#8212; Low sleep<br>
    &#8226; <strong class="japib"><code>WD_POWER_CHANGED_D2</code></strong> &#8212; Medium sleep<br>
    &#8226; <strong class="japib"><code>WD_POWER_CHANGED_D3</code></strong> &#8212; Full sleep<br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_WORKING</code></strong> &#8212; Fully on<br>
    <span class="b"><strong>Systems power state:</strong></span><br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_SLEEPING1</code></strong> &#8212; Fully on but
      sleeping<br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_SLEEPING2</code></strong> &#8212; CPU off,
      memory on, PCI on<br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_SLEEPING3</code></strong> &#8212; CPU off,
      Memory is in refresh, PCI on aux power<br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_HIBERNATE</code></strong> &#8212; OS saves
      context before shutdown<br>
    &#8226; <strong class="japib"><code>WD_POWER_SYSTEM_SHUTDOWN</code></strong> &#8212; No context
      saved
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcEventHandler</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A user-mode event handler callback function, which will be called when an
    event for which the caller registered to receive notifications (see
    <strong class="japib"><code>dwActions</code></strong>) occurs. (The prototype of the event handler
    &#8212; <span><code class="japi">EVENT_HANDLER</code> &#8212;  is defined
    in <span class="jprintfilename"><strong>windrvr_events.h</strong></span>.</span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Data for the user-mode event handler callback routine
    (<strong class="japib"><code>funcEventHandler</code></strong>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fUseKP</td><td style="" align="left" valign="top">
    If <strong class="japib"><code>TRUE</code></strong> &#8212; When an event for which the caller
    registered to receive notifications (<strong class="japib"><code>dwActions</code></strong>) occurs, the
    device's Kernel PlugIn driver's <span style=""><span style=""><code class="japi">KP_Event</code></span><span> function</span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span> will
    be called. (The Kernel PlugIn driver to be used for the device is passed to
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> and stored in the WDC device
    structure).<br>
    If this function returns <code class="japi">TRUE</code>, the user-mode events handler
    callback function (<strong class="japib"><code>funcEventHandler</code></strong>) will be called when the
    kernel-mode event processing is completed.<br>
    If <strong class="japib"><code>FALSE</code></strong> &#8212; When an event for which the caller
    registered to receive notifications (<strong class="japib"><code>dwActions</code></strong>) occurs, the
    user-mode events handler callback function will be called.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253658129584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253658132128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li><li class="listitem" style="list-style-type: disc">
    A successful call to this function must be followed with a call to
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventUnregister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventUnregister" title="B.3.53. WDC_EventUnregister()"><fo:inline> [B.3.53]</fo:inline></a></span> later on in the code, in order to
    unregister from receiving Plug-and-play and power management notifications
    from the device.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_EventUnregister"></a>B.3.53. WDC_EventUnregister()</h3></div></div></div>
<h5><a name="idp46253658139680"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Unregisters an application from a receiving Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management
notifications for a device, pursuant to a previous call to
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span>.
</p>

<h5><a name="idp46253658143968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_EventUnregister(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658145776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658154896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a Plug&#65279;-&#65279;and&#65279;-&#65279;Play WDC device, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr></tbody></table></div>

  <h5><a name="idp46253658164496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253658167040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function can be called from the <span class="b"><strong>user mode only</strong></span>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_EventIsRegistered"></a>B.3.54. WDC_EventIsRegistered()</h3></div></div></div>
<h5><a name="idp46253658171408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Checks if the application is currently registered to receive Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power
management notifications for the device.
</p>

<h5><a name="idp46253658173152"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL DLLCALLCONV WDC_EventIsRegistered(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658174960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658184080"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a Plug&#65279;-&#65279;and&#65279;-&#65279;Play WDC device, returned by
  <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span></td></tr></tbody></table></div>

<h5><a name="idp46253658193648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if the application is currently registered to receive
Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management notifications for the device; otherwise returns
<code class="japi">FALSE</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_SetDebugOptions"></a>B.3.55. WDC_SetDebugOptions()</h3></div></div></div>
<h5><a name="idp46253658198768"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets debug options for the WDC library &#8212; see the description of <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DBG_OPTIONS</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span> for details regarding the possible debug options to set.
</p>
<p>
This function is typically called at the beginning of the application, after
the call to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverOpen" title="B.3.2. WDC_DriverOpen()"><fo:inline> [B.3.2]</fo:inline></a></span>, and can be re-called at any time
while the WDC library is in use (i.e., <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverClose</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverClose" title="B.3.3. WDC_DriverClose()"><fo:inline> [B.3.3]</fo:inline></a></span> has not
been called) in order to change the debug settings.
</p><p>
Until the function is called, the WDC library uses the default debug options
&#8212; see <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DBG_DEFAULT</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span>.
</p><p>
When the function is recalled, it performs any required cleanup for the
previous debug settings and sets the default debug options before attempting
to set the new options specified by the caller.
</p>
<h5><a name="idp46253658212336"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_SetDebugOptions(
    WDC_DBG_OPTIONS dbgOptions,
    const CHAR *sDbgFile);
</pre>

<h5><a name="idp46253658214176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dbgOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_DBG_OPTIONS</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sDbgFile</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658224928"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dbgOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A bit mask of flags indicating the desired debug settings &#8212; see
    <span style=""><span style=""><code class="japi">WDC_DBG_OPTIONS</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span>.<br>
    If this parameter is set to zero, the default debug options will be used
    &#8212; see <span style=""><span style=""><code class="japi">WDC_DBG_DEFAULT</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sDbgFile</td><td style="" align="left" valign="top">
    WDC debug output file.<br>
    This parameter is relevant only if the <code class="japi">WDC_DBG_OUT_FILE</code> flag
    is set in the debug options (<code class="japi">dbgOptions</code>) (either directly or
    via one of the convenience debug options combinations &#8212; see
    <span style=""><span style=""><code class="japi">WDC_DBG_OPTIONS</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span>).<br>
    If the <code class="japi">WDC_DBG_OUT_FILE</code> debug flag is set and
    <code class="japi">sDbgFile</code> is <code class="japi">NULL</code>, WDC debug messages will be logged to the
    default debug file &#8212; <span class="jprintfilename"><strong>stderr</strong></span>.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253658244992"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_Err"></a>B.3.56. WDC_Err()</h3></div></div></div>
<h5><a name="idp46253658249648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Displays debug error messages according to the WDC debug options &#8212; see
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DBG_OPTIONS</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_SetDebugOptions</code><span class="japi">()</span></span><a class="xref" href="#WDC_SetDebugOptions" title="B.3.55. WDC_SetDebugOptions()"><fo:inline> [B.3.55]</fo:inline></a></span>.
</p>

<h5><a name="idp46253658256320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void DLLCALLCONV WDC_Err(
    const CHAR *format
    [, argument] ...);
</pre>

<h5><a name="idp46253658258144"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="border-right: 0.5pt solid ; " align="left" valign="top"> </td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658268736"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Format-control string, which contains the error message to display. The
    string is limited to 256 characters (CHAR)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top"> argument</td><td style="" align="left" valign="top">Optional arguments for the format string</td></tr></tbody></table></div>

  <h5><a name="idp46253658277200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_Trace"></a>B.3.57. WDC_Trace()</h3></div></div></div>
<h5><a name="idp46253658280400"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Displays debug trace messages according to the WDC debug options &#8212; see
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DBG_OPTIONS</code></span><a class="xref" href="#WDC_DBG_OPTIONS" title="B.3.1.8. WDC_DBG_OPTIONS Definitions"><fo:inline> [B.3.1.8]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_SetDebugOptions</code><span class="japi">()</span></span><a class="xref" href="#WDC_SetDebugOptions" title="B.3.55. WDC_SetDebugOptions()"><fo:inline> [B.3.55]</fo:inline></a></span>.
</p>

<h5><a name="idp46253658287072"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void DLLCALLCONV WDC_Trace(
    const CHAR *format
    [, argument] ...);
</pre>

<h5><a name="idp46253658288896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="border-right: 0.5pt solid ; " align="left" valign="top"> </td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658299488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Format-control string, which contains the trace message to display. The
    string is limited to 256 characters (CHAR)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="" align="left" valign="top">Optional arguments for the format string</td></tr></tbody></table></div>

  <h5><a name="idp46253658307952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GetWDHandle"></a>B.3.58. WDC_GetWDHandle()</h3></div></div></div>
<h5><a name="idp46253658311568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Returns a handle to WinDriver's kernel module, which is required by the basic
<code class="japi">WD_xxx</code> WinDriver PCI&#65279;/&#65279;ISA API, described in the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> (see Remarks below).
</p>

<h5><a name="idp46253658314160"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">HANDLE DLLCALLCONV WDC_GetWDHandle(void);</pre>

<h5><a name="idp46253658315952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns a handle to WinDriver's kernel module, or
<code class="japi">INVALID_HANDLE_VALUE</code> in case of a failure
</p>

<h5><a name="idp46253658318160"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    When using only the WDC API, you do not need to get a handle to WinDriver,
    since the WDC library encapsulates this for you. This function enables you
    to get the WinDriver handles used by the WDC library so you can pass it to
    low&#65279;-&#65279;level <code class="japi">WD_xxx</code> API, if such APIs are used from your
    code. In such cases, take care <span class="b"><strong>not</strong></span> to close the handle you received
    (using <code class="jfunc">WD_Close</code><span class="jfunc">()</span>). The handle will be closed by the WDC
    library when it is closed, using <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DriverClose</code><span class="japi">()</span></span><a class="xref" href="#WDC_DriverClose" title="B.3.3. WDC_DriverClose()"><fo:inline> [B.3.3]</fo:inline></a></span>. The
    low&#65279;-&#65279;level <code class="japi">WD_xxx</code> API is described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GetDevContext"></a>B.3.59. WDC_GetDevContext()</h3></div></div></div>
<h5><a name="idp46253658327568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Returns the device's user context information.
</p>

<h5><a name="idp46253658329088"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">PVOID DLLCALLCONV WDC_GetDevContext(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658330896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658340016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr></tbody></table></div>
<h5><a name="idp46253658348496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div><p>
  Returns
  a pointer to the device's user
  context, or <code class="japi">NULL</code> if no context has been set.
  </p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GetBusType"></a>B.3.60. WDC_GetBusType()</h3></div></div></div>
<h5><a name="idp46253658351952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Returns the device's bus type: <code class="japi">WD_BUS_PCI</code>,
<code class="japi">WD_BUS_ISA</code> or <code class="japi">WD_BUS_UNKNOWN</code>.
</p>

<h5><a name="idp46253658354736"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WD_BUS_TYPE DLLCALLCONV WDC_GetBusType(WDC_DEVICE_HANDLE hDev);</pre>

<h5><a name="idp46253658356544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_DEVICE_HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658365664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hDev</td><td style="" align="left" valign="top">Handle to a WDC device, returned by
  <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)</td></tr></tbody></table></div>

<h5><a name="idp46253658374320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the device's bus type<a class="xref" href="#WD_BUS_TYPE" title="B.7.1. WD_BUS_TYPE Enumeration"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.7.1]</fo:inline></a>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_Sleep"></a>B.3.61. WDC_Sleep()</h3></div></div></div>
<h5><a name="idp46253658378304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Delays execution for the specified duration of time (in microseconds).<br>
By default the function performs a busy sleep (consumes CPU cycles).
</p>

<h5><a name="idp46253658380176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_Sleep(
    DWORD dwMicroSecs,
    WDC_SLEEP_OPTIONS options);
</pre>

<h5><a name="idp46253658382000"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMicroSecs</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_SLEEP_OPTIONS</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658392752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMicroSecs</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The number of microseconds to sleep</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">options</td><td style="" align="left" valign="top">Sleep options<a class="xref" href="#WDC_SLEEP_OPTIONS" title="B.3.1.7. WDC_SLEEP_OPTIONS Definitions"><fo:inline> [B.3.1.7]</fo:inline></a></td></tr></tbody></table></div>

  <h5><a name="idp46253658401488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_Version"></a>B.3.62. WDC_Version()</h3></div></div></div>
<h5><a name="idp46253658405744"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Returns the version number of the WinDriver kernel module used by the WDC library.
</p>

<h5><a name="idp46253658407296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDC_Version(
    CHAR *sVersion,
    DWORD *pdwVersion);
</pre>

<h5><a name="idp46253658409120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sVersion</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwVersion</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253658419872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sVersion</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a pre-allocated buffer to be filled by the function with the
    driver's version information string.<br>
    The size of the version string buffer must be at least 128 bytes
    (characters).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pdwVersion</td><td style="" align="left" valign="top">
    Pointer to a value indicating the version number of the WinDriver kernel
    module used by the WDC library
  </td></tr></tbody></table></div>

  <h5><a name="idp46253658428752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDC_DEFS_API"></a>B.4. WDC Low&#65279;-&#65279;Level API</h2></div></div></div><p>
This section described the WDC types and preprocessor definitions defined in
the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/include/wdc_defs.h</strong></span></span>
header file.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_ADDR_DESC"></a>B.4.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_ADDR_DESC Structure</span></h3></div></div></div>
<p>
PCI/ISA device memory or I/&#65279;O address space information structure.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The address space number</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">fIsMemory</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">BOOL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    &#8226; <strong class="japib"><code>TRUE</code></strong>: memory address space.<br>
    &#8226; <strong class="japib"><code>FALSE</code></strong>: I/&#65279;O address space.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwItemIndex</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The index of the <span style=""><span style=""><code class="japi">WD_ITEMS</code></span><span> structure</span><a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline> [B.7.6]</fo:inline></a></span> for the address
    space, which is retrieved and stored by <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> in
    the <code class="japi">cardReg.Card.Item</code> array of the relevant WDC device
    information structure<a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline> [B.4.2]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The address space's size (in bytes)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pAddr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The kernel-mode mapping of the address space's physical base address.<br>
    This address is used by the WDC API for accessing a memory or I/&#65279;O region
    using the low&#65279;-&#65279;level <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span> or
    <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span> APIs (described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>),
    or when accessing memory address directly in the kernel.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pUserDirectMemAddr</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">UPTR</td><td style="" align="left" valign="top">
    The user-mode mapping of a memory address space's physical base address.
    <br>
    This address is used for accessing memory addresses directly from the user
    mode.
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_DEVICE"></a>B.4.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WDC_DEVICE Structure</span></h3></div></div></div><p>
PCI/ISA device information structure.<br>
The <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) allocate and return device structures of this type.
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">id</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_ID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Device ID information structure (relevant for PCI devices) &#8212;
    see<a class="xref" href="#WD_PCI_ID" title="B.7.3. WD_PCI_ID Structure"><fo:inline> [B.7.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">slot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Device location information structure &#8212; see description of
    <code class="japi">WD_PCI_SLOT</code> in <a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline>Section B.7.4</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwNumAddrSpaces</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Number of address spaces found on the device</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pAddrDesc</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_DESC*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Array of memory and I/IO address spaces information structures<a class="xref" href="#WDC_ADDR_DESC" title="B.4.1. WDC_ADDR_DESC Structure"><fo:inline> [B.4.1]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">cardReg</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_CARD_REGISTER</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    WinDriver device resources information structure, returned by the low&#65279;-&#65279;level
    <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which
    is called by the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kerPlug</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_PLUGIN</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel PlugIn driver information structure<a class="xref" href="#WD_KERNEL_PLUGIN" title="B.9.1. WD_KERNEL_PLUGIN"><fo:inline> [B.9.1]</fo:inline></a>.
    <br>
    This structure is filled by the functions used to open a handle to a Kernel
    PlugIn for a <code class="japi">WDC_DEVICE</code><a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline> [12.5]</fo:inline></a> &#8212;
    either <span style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span>, or one of the
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>) when called with the name of a Kernel PlugIn driver
    &#8212; and is maintained by the WDC library.<br>
    If no Kernel PlugIn handle was opened for the device, this structure is not
    used.
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Int</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INTERRUPT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Interrupt information structure.<br>
    This structure is filled by the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions
    for devices that have interrupts, and is maintained by the WDC library.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hIntThread</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Handle to the interrupt thread that is spawn when interrupts are
    enabled.<br>
    This handle is passed by WDC to the low&#65279;-&#65279;level WinDriver interrupt APIs.
    When using the WDC API you do not need to access this handle directly.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Event</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_EVENT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    WinDriver Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power management events information structure &#8212;
    see <code class="jfunc">EventRegister</code><span class="jfunc">()</span> description in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span> for
    details.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hEvent</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Handle used by the WinDriver <code class="jfunc">EventRegister</code><span class="jfunc">()</span> /
    <code class="jfunc">EventUnregister</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)<br>
    When using the WDC API you do not need to access this handle directly.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pCtx</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">
    Device context information.<br>
    This information is received as a parameter by the
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions and stored in the device
    structure for future use by the calling application (optional)
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="PWDC_DEVICE"></a>B.4.3. PWDC_DEVICE</h3></div></div></div>
<p>
Pointer to a <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DEVICE</code></span><span> structure</span><a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline> [B.4.2]</fo:inline></a></span>.
</p>

<p>
</p><pre class="screen">typedef WDC_DEVICE *PWDC_DEVICE</pre><p>
</p>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The <span class="jprintfilename"><strong>wdc_defs.h</strong></span> macros cast WDC device pointer
parameters (<code class="japi">pDev</code>) to <code class="japi">PWDC_DEVICE</code>. You may also pass
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_DEVICE_HANDLE</code></span><a class="xref" href="#WDC_DEVICE_HANDLE" title="B.3.1.1. WDC_DEVICE_HANDLE"><fo:inline> [B.3.1.1]</fo:inline></a></span> variables for such parameters.
</td></tr></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_MEM_DIRECT_ADDR"></a>B.4.4. WDC_MEM_DIRECT_ADDR Macro</h3></div></div></div>
<h5><a name="idp46253658521792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that returns a pointer that can be used for direct access to a
specified memory address space from the context of the calling process.
</p>

<h5><a name="idp46253658523408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_MEM_DIRECT_ADDR(pAddrDesc)</pre>

<h5><a name="idp46253658525184"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pAddrDesc</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_DESC*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658534304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pAddrDesc</td><td style="" align="left" valign="top">
    Pointer to a WDC memory address space information structure<a class="xref" href="#WDC_ADDR_DESC" title="B.4.1. WDC_ADDR_DESC Structure"><fo:inline> [B.4.1]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658541984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
When called from the user mode, returns the user-mode mapping of the physical
memory address (<code class="japi">pAddrDesc-&#65279;&gt;pUserDirectMemAddr</code>);<br>
When called from the kernel mode, returns the kernel-mode mapping of the
physical memory address (<code class="japi">pAddrDesc-&#65279;&gt;pAddr</code>).<br>
The returned pointer can be used for accessing the memory directly from the
user mode or kernel mode, respectively.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_ADDR_IS_MEM"></a>B.4.5. WDC_ADDR_IS_MEM Macro</h3></div></div></div>
<h5><a name="idp46253658547248"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that checks if a given address space is a memory or I/&#65279;O
address space.
</p>

<h5><a name="idp46253658548896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_ADDR_IS_MEM(pAddrDesc)</pre>

<h5><a name="idp46253658550624"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pAddrDesc</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WDC_ADDR_DESC*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658559744"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pAddrDesc</td><td style="" align="left" valign="top">
    Pointer to a WDC memory address space information structure<a class="xref" href="#WDC_ADDR_DESC" title="B.4.1. WDC_ADDR_DESC Structure"><fo:inline> [B.4.1]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658567424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">pAddrDesc-&#65279;&gt;fIsMemory</code>, which is set to
<code class="japi">TRUE</code> for a memory address space and to <code class="japi">FALSE</code>
otherwise.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GET_ADDR_DESC"></a>B.4.6. WDC_GET_ADDR_DESC Macro</h3></div></div></div>
<h5><a name="idp46253658572304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that retrieves a WDC address space information structure
(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ADDR_DESC</code></span><a class="xref" href="#WDC_ADDR_DESC" title="B.4.1. WDC_ADDR_DESC Structure"><fo:inline> [B.4.1]</fo:inline></a></span>), which complies to the specified address space
number.
</p>

<h5><a name="idp46253658576448"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_GET_ADDR_DESC(
    pDev,
    dwAddrSpace)
</pre>

<h5><a name="idp46253658578240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658588992"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="" align="left" valign="top">Address space number</td></tr></tbody></table></div>

<h5><a name="idp46253658597840"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns a pointer to the device's address information structure
(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_ADDR_DESC</code></span><a class="xref" href="#WDC_ADDR_DESC" title="B.4.1. WDC_ADDR_DESC Structure"><fo:inline> [B.4.1]</fo:inline></a></span>) for the specified address space number &#8212;
<code class="japi">pDev-&#65279;&gt;pAddrDesc[dwAddrSpace]</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GET_ADDR_SPACE_SIZE"></a>B.4.7. WDC_GET_ADDR_SPACE_SIZE Macro</h3></div></div></div>
<h5><a name="idp46253658604464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that retrieves a WDC address space size
</p>

<h5><a name="idp46253658605984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_GET_ADDR_DESC(
    pDev,
    dwAddrSpace)
</pre>

<h5><a name="idp46253658607776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658618528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwAddrSpace</td><td style="" align="left" valign="top">Address space number</td></tr></tbody></table></div>

<h5><a name="idp46253658627408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the size of the specified address space number </p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GET_ENABLED_INT_TYPE"></a>B.4.8. WDC_GET_ENABLED_INT_TYPE Macro</h3></div></div></div>
<h5><a name="idp46253658630960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro for retrieving the value of a WDC device's
<strong class="japib"><code>dwEnabledIntType</code></strong> <code class="japi">WD_INTERRUPT</code> field. This field is
updated by <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> to indicate the interrupt type enabled
for the device, as detailed in the description of the macro's return value
below.
</p>

<h5><a name="idp46253658636032"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_GET_ENABLED_INT_TYPE(pDev)</pre>

<h5><a name="idp46253658637808"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658646928"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="" align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658654592"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the interrupt type enabled for the device:<br>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong> &#8212; Extended Message-Signaled Interrupts (MSI-&#65279;X)
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> &#8212; Message-Signaled Interrupts (MSI)
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LEVEL_SENSITIVE</code></strong> &#8212; Legacy level-sensitive
    interrupts
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LATCHED</code></strong> &#8212; Legacy edge-triggered interrupts.
    <br>
    The value of this flag is zero and it is applicable only when no other
    interrupt flag is set.
  </li></ul></div><p>
</p>

<h5><a name="idp46253658661296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
   The Windows APIs do not
  distinguish between MSI and MSI-&#65279;X; therefore, on this OS the WinDriver
  functions set the <strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> flag for both MSI and
  MSI-&#65279;X.
 </li><li class="listitem" style="list-style-type: disc">
   Call this macro only after calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> to enable
   interrupts on your PCI card.
 </li><li class="listitem" style="list-style-type: disc">
   This macro is normally relevant only in the case of PCI devices that
   support more than one type of interrupt.
  </li><li class="listitem" style="list-style-type: disc">
    You can pass the returned value to the <code class="japi">WDC_INT_IS_MSI</code> macro to
    check if MSI or MSI-&#65279;X was enabled<a class="xref" href="#WDC_INT_IS_MSI" title="B.4.10. WDC_INT_IS_MSI Macro"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.10]</fo:inline></a>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GET_INT_OPTIONS"></a>B.4.9. WDC_GET_INT_OPTIONS Macro</h3></div></div></div>
<h5><a name="idp46253658671008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro for retrieving the value of a WDC device's interrupt options,
which indicate the types of interrupts supported by the device, as detailed in
the description of the macro's return value below.
</p>

<h5><a name="idp46253658672688"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_GET_INT_OPTIONS(pDev)</pre>

<h5><a name="idp46253658674464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658683584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="" align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658691248"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns a bit-mask indicating the types of interrupts supported by the device:
<br>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong>: Extended Message-Signaled Interrupts (MSI-&#65279;X).
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_MESSAGE</code></strong>: Message-Signaled Interrupts (MSI).
  </li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LEVEL_SENSITIVE</code></strong>: Legacy level-sensitive
    interrupts.<br></li><li class="listitem" style="list-style-type: disc"><strong class="japib"><code>INTERRUPT_LATCHED</code></strong>: Legacy edge-triggered interrupts.<br>
    The value of this flag is zero and it is applicable only when no other
    interrupt flag is set.
  </li></ul></div><p>
</p>

<h5><a name="idp46253658698496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    You can pass the returned options to the <code class="japi">WDC_INT_IS_MSI</code> macro
    to check whether they include the <code class="japi">INTERRUPT_MESSAGE</code> (MSI)
    and/or <code class="japi">INTERRUPT_MESSAGE_X</code> (MSI-&#65279;X) flags<a class="xref" href="#WDC_INT_IS_MSI" title="B.4.10. WDC_INT_IS_MSI Macro"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.4.10]</fo:inline></a>.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_INT_IS_MSI"></a>B.4.10. WDC_INT_IS_MSI Macro</h3></div></div></div>
<h5><a name="idp46253658704288"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that checks whether a given interrupt type bit-mask contains the
Message-Signaled Interrupts (MSI) or Extended Message-Signaled Interrupts (MSI-&#65279;X) interrupt type flags.
</p>

<h5><a name="idp46253658706128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_INT_IS_MSI(dwIntType)</pre>

<h5><a name="idp46253658707856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwIntType</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658716976"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwIntType</td><td style="" align="left" valign="top">Interrupt types bit-mask</td></tr></tbody></table></div>

<h5><a name="idp46253658724096"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if the provided interrupt type bit-mask includes the
<strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> (MSI) and/or
<strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong> (MSI-&#65279;X) flags; otherwise returns
<code class="japi">FALSE</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_GET_ENABLED_INT_LAST_MSG"></a>B.4.11. WDC_GET_ENABLED_INT_LAST_MSG Macro</h3></div></div></div>
<h5><a name="idp46253658729440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that retrieves the message data of the last received interrupt
for the Message-Signaled Interrupts (MSI) / Extended Message-Signaled Interrupts (MSI-&#65279;X) enabled for the device (on
Linux and Windows 7 and higher).

</p>

<h5><a name="idp46253658731824"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_GET_ENABLED_INT_LAST_MSG(pDev)</pre>

<h5><a name="idp46253658733568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658742688"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="" align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658750352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
If MSI or MSI-&#65279;X was enabled for the given device, the macro returns the
message data of the last message received for the device's interrupt; otherwise
returns zero.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDC_IS_KP"></a>B.4.12. WDC_IS_KP Macro</h3></div></div></div>
<h5><a name="idp46253658754176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that checks whether a WDC device uses a Kernel PlugIn driver.
</p>

<h5><a name="idp46253658755728"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDC_IS_KP(pDev)</pre>

<h5><a name="idp46253658757488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PWDC_DEVICE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658766608"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDev</td><td style="" align="left" valign="top">
    Pointer to a WDC device information structure<a class="xref" href="#PWDC_DEVICE" title="B.4.3. PWDC_DEVICE"><fo:inline> [B.4.3]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658774272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if the device uses a Kernel PlugIn driver; otherwise
returns <code class="japi">FALSE</code>.
</p>
</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDS_OVERVIEW"></a>B.5. WDS Library Overview</h2></div></div></div><p>
The <em class="it">"WinDriver Shared"</em> &#8212; <span class="b"><strong>WDS</strong></span> &#8212; API provides convenient
user-mode wrappers to the basic WinDriver Shared <code class="japi">WD_xxx</code> API, which is
described in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p><p>
The WDS wrappers are designed to simplify the usage of WinDriver. While you can 
still use the basic <code class="japi">WD_xxx</code> WinDriver API from your code, we
recommend that you refrain from doing so and use the high&#65279;-&#65279;level WDS API
instead.
</p><p>
<span class="b"><strong>NOTE:</strong></span> Some of the WDS API can be used both from the user mode and
from the kernel mode (from a Kernel PlugIn driver<a class="xref" href="#WinDriver_Kernel_PlugIn" title="Chapter 11. Understanding the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [11]</fo:inline></a>).
</p><p>
The pci_diag sample utilize the WDS API, it also uses it through the 
high-level diagnostics code (<span class="jprintfilename"><strong>wds_diag_lib/.c/.h</strong></span>).
</p><p>
The WDS API is part of <span class="jprintfilename"><strong>wdapi1281</strong></span>
DLL/shared object:<br>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver\redist\wdapi1281.dll</strong></span></span>
(Windows) / <span class="jdirectory"><strong>WinDriver/lib/libwdapi1281.so</strong></span>
(Linux).<br>
The source code for the WDS API is found in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/src/wdapi</strong></span></span> directory.
</p><p>
The WDS interface is provided in the <span class="jprintfilename"><strong>wds_lib.h</strong></span>
(found under the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/includes</strong></span></span> directory).
<br>
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    [<span class="jprintfilename"><strong>wds_lib.h</strong></span>] declares the "high&#65279;-&#65279;level"
    WDS API (type definitions, function declarations, etc.).
  </li></ul></div><p>
</p><p>
The following sections describe the WDS high&#65279;-&#65279;level<a class="xref" href="#WDS_LIB_API" title="B.6. WDS High&#65279;-&#65279;Level API"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.6]</fo:inline></a>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDS_LIB_API"></a>B.6. WDS High&#65279;-&#65279;Level API</h2></div></div></div><p>
This section describes the WDS API defined in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/include/wds_lib.h</strong></span></span>
header file.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_SharedBufferAlloc"></a>B.6.1. WDS_SharedBufferAlloc()</h3></div></div></div>
<h5><a name="idp46253658797664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Allocates a memory buffer that can be shared between the user mode and the
kernel mode (<span class="b"><strong>"shared buffer"</strong></span>), and returns user-mode and kernel-mode
virtual address space mappings of the allocated buffer.
</p>

<div class="info" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/info.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
This function provides a useful method for sharing data between a user-mode
application and a Kernel PlugIn driver.
</td></tr></table></div>

<h5><a name="idp46253658800272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_SharedBufferAlloc(
    UINT64 qwBytes,
    DWORD dwOptions,
    WD_KERNEL_BUFFER **ppBuf);
</pre>

<h5><a name="idp46253658802128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">qwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_BUFFER**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253658814512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">qwBytes</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The size of the buffer to allocate, in bytes</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
  <p>
    Kernel buffer options bit-mask, which can consist of a combination of the
    enumeration values listed below.<br>
  </p>
  <p>
  
    &#8226; <strong class="japib"><code>KER_BUF_ALLOC_NON_CONTIG</code></strong>:Allocates a non contiguous 
      buffer<br>
  
  
    &#8226; <strong class="japib"><code>KER_BUF_ALLOC_CONTIG</code></strong>:Allocates a physically 
      contiguous buffer<br>
  
  
    &#8226; <strong class="japib"><code>KER_BUF_ALLOC_CACHED</code></strong>:Allocates a cached buffer. This
      option can be set with KER_BUF_ALLOC_NON_CONTIG or KER_BUF_ALLOC_CONTIG
      buffer<br>
  
  </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppBuf</td><td style="" align="left" valign="top">
    Pointer to a WD_KERNEL_BUFFER<a class="xref" href="#WD_KERNEL_BUFFER" title="B.7.11. WD_KERNEL_BUFFER Structure"><fo:inline> [B.7.11]</fo:inline></a> pointer, to be
    filled by the function.<br>
    The caller should use *ppBuf-&gt;pUserAddr usermode mapped address.
    When the buffer is no longer needed, (<code class="japi">*ppBuf</code>) should be passed
    to <span style=""><span style=""><code class="japi">WDS_SharedBufferFree</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferFree" title="B.6.2. WDS_SharedBufferFree()"><fo:inline> [B.6.2]</fo:inline></a></span>.
  </td></tr></tbody></table></div>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The KER_BUF_ALLOC_NON_CONTIG option is valid only as part of 
  "WinDriver for Server" API and requires "WinDriver for Server" license. Note 
  that "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
</td></tr></table></div>


  <h5><a name="idp46253658834272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253658836816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    This function is supported only for Windows and Linux.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_SharedBufferFree"></a>B.6.2. WDS_SharedBufferFree()</h3></div></div></div>
<h5><a name="idp46253658841264"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Frees a shared buffer that was allocated by a previous call to
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span>.
</p>

<h5><a name="idp46253658845312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_SharedBufferFree(
    WD_KERNEL_BUFFER *pBuf);
</pre>

<h5><a name="idp46253658847120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_BUFFER *</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658856240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pBuf</td><td style="" align="left" valign="top">
    Pointer to a WD_KERNEL_BUF<a class="xref" href="#WD_KERNEL_BUFFER" title="B.7.11. WD_KERNEL_BUFFER Structure"><fo:inline> [B.7.11]</fo:inline></a> structure, received
    within the <code class="japi">*ppBuf</code> parameter of a previous call to 
    <span style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span>
  </td></tr></tbody></table></div>

  <h5><a name="idp46253658866880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253658869424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    This function is currently only supported from the user mode.
  </li><li class="listitem" style="list-style-type: disc">
    This function is supported only for Windows and Linux.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_SharedBufferGet"></a>B.6.3. WDS_SharedBufferGet()</h3></div></div></div>
<h5><a name="idp46253658873872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves a shared buffer which was allocated by another process.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253658876384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_SharedBufferGet(
    DWORD hKerBuf, 
    WD_KERNEL_BUFFER **ppKerBuf);</pre>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Before calling this API, the calling process should recieve the global buffer
handle via WinDriver IPC mechanism from the process that allocated the buffer. 
</td></tr></table></div><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
Once the process finish using the shared buffer, it should release it using the
regular free method- <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_SharedBufferFree</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferFree" title="B.6.2. WDS_SharedBufferFree()"><fo:inline> [B.6.2]</fo:inline></a></span>.
</td></tr></table></div>
<h5><a name="idp46253658881792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hKerBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppKerBuf</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_BUFFER**</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253658892544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hKerBuf</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel buffer handle.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppKerBuf</td><td style="" align="left" valign="top">
    Pointer to a pointer to a kernel buffer information structure<a class="xref" href="#WD_KERNEL_BUFFER" title="B.7.11. WD_KERNEL_BUFFER Structure"><fo:inline> [B.7.11]</fo:inline></a>, which is associated with hKerBuf. 
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253658901328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_SharedBufferGetGlobalHandle"></a>B.6.4. WDS_SharedBufferGetGlobalHandle Macro</h3></div></div></div>
<h5><a name="idp46253658905776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Utility macro that returns a kernel buffer global handle that can be used for
buffer sharing between multiple processes.
</p>

<h5><a name="idp46253658907376"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">WDS_SharedBufferGetGlobalHandle(pKerBuf)</pre>

<h5><a name="idp46253658909168"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pKerBuf</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_BUFFER*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253658918288"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pKerBuf</td><td style="" align="left" valign="top">
    Pointer to a kernel buffer information structure<a class="xref" href="#WD_KERNEL_BUFFER" title="B.7.11. WD_KERNEL_BUFFER Structure"><fo:inline> [B.7.11]</fo:inline></a>
  </td></tr></tbody></table></div>

<h5><a name="idp46253658925952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Kernel buffer handle of pKerBuf.
</p>
</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDC_WD_TYPES"></a>B.7. WD_xxx Structures, Types and General Definitions</h2></div></div></div><p>
This section describes basic <code class="japi">WD_xxx</code> structures and types, which
are used by the <code class="japi">WDC_xxx</code> &amp; <code class="japi">WDS_xxx</code> APIs. The APIs
described in this section are defined in the 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/include/windrvr.h</strong></span></span>
header file.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_BUS_TYPE"></a>B.7.1. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_BUS_TYPE Enumeration</span></h3></div></div></div>
<p>
Bus types enumeration.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Enum Value</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_USB</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Universal Serial Bus (USB)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_UNKNOWN</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Unknown bus</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_ISA</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">ISA bus</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_EISA</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">EISA (ISA Plug&#65279;-&#65279;and&#65279;-&#65279;Play) bus</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_BUS_PCI</td><td style="" align="left" valign="top">PCI bus</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ITEM_TYPE"></a>B.7.2. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">ITEM_TYPE Enumeration</span></h3></div></div></div>
<p>
Enumeration of card item types.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Enum Value</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ITEM_NONE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Unknown item type</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ITEM_INTERRUPT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Interrupt item</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ITEM_MEMORY</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Memory item</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ITEM_IO</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">I/&#65279;O item</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ITEM_BUS</td><td style="" align="left" valign="top">Bus item</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_PCI_ID"></a>B.7.3. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_ID Structure</span></h3></div></div></div>
<p>
PCI device identification information structure.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVendorId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Vendor ID</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwDeviceId</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Device ID</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_PCI_SLOT"></a>B.7.4. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_SLOT Structure</span></h3></div></div></div>
<p>
PCI device location information structure.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBus</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">PCI Bus number (0 based)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Slot number (0 based)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwFunction</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Function number (0 based)</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_PCI_CAP"></a>B.7.5. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_CAP Structure</span></h3></div></div></div>
<p>
PCI capability information structure.
</p>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCapId</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">PCI capability ID</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwCapOffset</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">PCI capability register offset</td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_ITEMS"></a>B.7.6. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_ITEMS Structure</span></h3></div></div></div><p>
Card resources information structure.
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">item</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Item type &#8212; see the <span style=""><span style=""><code class="japi">ITEM_TYPE</code></span><span> enumeration</span><a class="xref" href="#ITEM_TYPE" title="B.7.2. ITEM_TYPE Enumeration"><fo:inline> [B.7.2]</fo:inline></a></span>.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function 
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a>, or the 
    low&#65279;-&#65279;level<code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> functions (see the 
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">fNotSharable</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"><div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><span class="b"><strong>1</strong></span> &#8212;
          Non-sharable resource; should be locked for exclusive use</li><li class="listitem" style="list-style-type: disc"><span class="b"><strong>0</strong></span> &#8212;
          Sharable resource</li></ul></div>This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span>
      function <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
      <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function, and can be modified
      manually before registering the resources using the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>) or
      the low&#65279;-&#65279;level <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function; (the
      low&#65279;-&#65279;level functions are documented in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">I</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">union</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Union of resources data, based on the item's type (<strong class="japib"><code>item</code></strong>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Mem</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Memory-item descriptor
    <span style="white-space:nowrap">(<strong class="japib"><code>item</code></strong>=<code class="japi">ITEM_MEMORY</code>)</span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pPhysicalAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PHYS_ADDR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    First address of the physical memory range.<br>
    For Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware (PCI) this field is updated by the
    <code class="jfunc">WDC_PCIGetDeviceInfo</code><span class="jfunc">()</span> function 
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low-level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
    NOTE: In the case of a 64-&#65279;bit memory BAR the value set in this
    field by may be incorrect, due to the 32-&#65279;bit field size. For this reason,
    <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span> ignores this field and retrieves the
    physical address directly from the card (as does the low-level
    <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function).
      
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">qwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Length (in bytes) of the memory range.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pTransAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel-mode mapping of the memory range's physical base address.<br>
    This field is updated by <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which is called from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pUserDirectAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    User-mode mapping of the memory range's physical base address.<br>
    This field is updated by <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which is called from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Base Address Register (BAR) number.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pReserved</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Reserved for internal use</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    A bit-mask of memory-item registration flags<span>,
      applicable when calling one of the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>) or the low&#65279;-&#65279;level
      <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
    </span> &#8212; a combination of any of the of the following
    <code class="japi">WD_ITEM_MEM_OPTIONS</code> enumeration values:
    
    <div class="itemizedlist"><ul class="itemizedlist compact" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        <strong class="japib"><code>WD_ITEM_MEM_DO_NOT_MAP_KERNEL</code></strong>: Avoid mapping the item's
        physical memory to the kernel address space
        (<code class="japi">I.Mem.pTransAddr</code> not set); map the memory only to the
        user-mode virtual address space (mapped base address:
        <code class="japi">I.Mem.pUserDirectAddr</code>). For more information, refer to
        
        <span>
          <a class="xref" href="#pci_dev_open_remark_WD_ITEM_MEM_DO_NOT_MAP_KERNEL"><fo:inline>Remark 2</fo:inline></a> in the documentation of
          <span style=""><span style=""><code class="japi">WDC_PciDeviceOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a></span>; (a similar remark is found in the
          documentation of the other device-open functions).
        </span>
        <br>
        NOTE: This flag is applicable only to memory items.
        </li><li class="listitem" style="list-style-type: disc">
        <strong class="japib"><code>WD_ITEM_MEM_ALLOW_CACHE</code></strong> (Windows): Map the item's
        physical memory (base address: <code class="japi">I.Mem.pPhysicalAddr</code>) as
        cached.<br>
        NOTE: This flag is applicable only to memory items that pertain to the
        host's RAM, as opposed to local memory on the card.
        </li></ul></div>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">IO</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    I/&#65279;O-item descriptor
    <span style="white-space:nowrap">(<strong class="japib"><code>item</code></strong>=<code class="japi">ITEM_IO</code>)</span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    First address of the I/&#65279;O range.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwBytes</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Length (in bytes) of the I/&#65279;O range.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwBar</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Base Address Register (BAR) number.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Int</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">struct</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Interrupt-item descriptor
    <span style="white-space:nowrap">(<strong class="japib"><code>item</code></strong>=<code class="japi">ITEM_INTERRUPT</code>)</span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Physical interrupt request (IRQ) number.<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    
    Interrupt bit-mask, which can consist of a combination of any of the
    following flags:<br>
    <span class="b"><strong><span class="underline">Interrupt type flags:</span></strong></span><br>
    &#8226; <strong class="japib"><code>INTERRUPT_MESSAGE_X</code></strong> &#8212;
  Indicates that the hardware supports Extended Message-Signaled Interrupts (MSI-&#65279;X).<br>
  This option is applicable only to PCI cards on Linux &#8212; see
  information in <span>
    <a class="xref" href="#wd_get_sup_int_types" title="9.2.4. Determining the Interrupt Types Supported by the Hardware"><fo:inline>Section 9.2.4</fo:inline></a></span>.<br>
    &#8226; <strong class="japib"><code>INTERRUPT_MESSAGE</code></strong> &#8212; On
  Linux, indicates that the hardware supports Message-Signaled Interrupts (MSI).<br>
  On Windows, indicates that the hardware supports MSI or
  MSI-&#65279;X.<br>
  This option is applicable only to PCI cards on Linux and Windows 7 and higher &#8212; see
  information in <span>
    <a class="xref" href="#wd_get_sup_int_types" title="9.2.4. Determining the Interrupt Types Supported by the Hardware"><fo:inline>Section 9.2.4</fo:inline></a></span>.<br>
    &#8226; <strong class="japib"><code>INTERRUPT_LEVEL_SENSITIVE</code></strong>
  &#8212; Indicates that the hardware supports level-sensitive interrupts.<br>
    &#8226; <strong class="japib"><code>INTERRUPT_LATCHED</code></strong> &#8212; indicates that the
      device supports legacy edge-triggered interrupts. The value of this flag
      is zero, therefore it is applicable only when no other interrupt flag is
      set.<br>
    
    
    <span class="b"><strong>NOTE:</strong></span><br>
    For Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware (PCI), use WinDriver's
    <span style=""><span style=""><code class="japi">WDC_PciGetDeviceInfo</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a></span> (or the low&#65279;-&#65279;level 
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function) to retrieve the Plug&#65279;-&#65279;and&#65279;-&#65279;Play
    hardware information, including the supported interrupt types.<br>
    
    
    For non-Plug&#65279;-&#65279;and&#65279;-&#65279;Play hardware, the relevant interrupt type flag (normally
    &#8212; <code class="japi">INTERRUPT_LATCHED</code>) should be set by the user in the
    call to <code class="jfunc">WDC_IsaDeviceOpen</code><span class="jfunc">()</span> or to the low&#65279;-&#65279;level
    <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> function.
    <span class="b"><strong><span class="underline">Miscellaneous interrupt
    options:</span></strong></span><br>
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">hInterrupt</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Handle to an internal WinDriver interrupt structure, required by the
    low&#65279;-&#65279;level <code class="jfunc">WD_xxx</code><span class="jfunc">()</span> WinDriver interrupt APIs (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
    This field is updated by <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span> (see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which is called from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwReserved1</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Reserved for internal use</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">pReserved2</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Reserved for internal use</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Bus</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Bus-item descriptor
    <span style="white-space:nowrap">(<strong class="japib"><code>item</code></strong>=<code class="japi">ITEM_BUS</code>)</span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwBusType</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_BUS_TYPE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Device's bus type &#8212; see the <span style=""><span style=""><code class="japi">WD_BUS_TYPE</code></span><span> enumeration</span><a class="xref" href="#WD_BUS_TYPE" title="B.7.1. WD_BUS_TYPE Enumeration"><fo:inline> [B.7.1]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwBusNum</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Bus Number</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwSlotFunc</span></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">
    Slot/socket and function information for the device: The lower three bits
    represent the function number and the remaining bits represent the
    slot/socket number. For example: a value of 0x80 (&lt;=&gt; 10000000
    binary) corresponds to a function number of 0 (lower 3 bits: 000) and a
    slot/socket number of 0x10 (remaining bits: 10000).<br>
    This field is updated by the <code class="jfunc">WDC_PciGetDeviceInfo</code><span class="jfunc">()</span> function
    <a class="xref" href="#WDC_PciGetDeviceInfo" title="B.3.16. WDC_PciGetDeviceInfo()"><fo:inline> [B.3.16]</fo:inline></a> or the low&#65279;-&#65279;level
    <code class="jfunc">WD_PciGetCardInfo</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_CARD"></a>B.7.7. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_CARD Structure</span></h3></div></div></div>
<p>
Card information structure.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwItems</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Number of items (resources) on the card</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">Item</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_ITEMS[WD_CARD_ITEMS]</td><td style="" align="left" valign="top">
    Array of card resources (items) information structures<a class="xref" href="#WD_ITEMS" title="B.7.6. WD_ITEMS Structure"><fo:inline> [B.7.6]</fo:inline></a>
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_PCI_CARD_INFO"></a>B.7.8. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_PCI_CARD_INFO Structure</span></h3></div></div></div>
<p>
PCI card information structure.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pciSlot</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_PCI_SLOT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    PCI device location information structure<a class="xref" href="#WD_PCI_SLOT" title="B.7.4. WD_PCI_SLOT Structure"><fo:inline> [B.7.4]</fo:inline></a>, which can
    be acquired by calling <span style=""><span style=""><code class="japi">WDC_PciScanDevices</code><span class="japi">()</span></span><a class="xref" href="#WDC_PciScanDevices" title="B.3.4. WDC_PciScanDevices()"><fo:inline> [B.3.4]</fo:inline></a></span> (or the
    low&#65279;-&#65279;level <code class="jfunc">WD_PciScanCards</code><span class="jfunc">()</span> function &#8212; see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">Card</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_CARD</td><td style="" align="left" valign="top">Card information structure<a class="xref" href="#WD_CARD" title="B.7.7. WD_CARD Structure"><fo:inline> [B.7.7]</fo:inline></a></td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_DMA"></a>B.7.9. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_DMA Structure</span></h3></div></div></div><p>
Direct Memory Access (DMA) information structure.
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hDma</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    DMA buffer handle (or 0 for a failed allocation). This handle is returned
    from <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> and <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span>
    (or from the low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> function &#8212; see
    the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pUserAddr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    User-mode mapped address of the DMA buffer. This mapping is returned from
    <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> and <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> (in
    this function the <code class="japi">pBuf</code> user-mode buffer provided by the caller
    is used), or from the low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> function (see
    the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>). Note: if the <code class="japi">DMA_KERNEL_ONLY</code> flag was
    set in the DMA options bit-mask field (<strong class="japib"><code>dwOptions</code></strong>), this
    field is not updated.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pKernelAddr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel-mode mapped address of the DMA buffer. This mapping is returned from
    <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> and <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> (on
    Windows), or from the low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> function (for
    contiguous-buffer DMA and for Scatter/&#65279;Gather DMA on Windows &#8212; see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The size of the DMA buffer (in bytes)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><a name="WD_DMA_dwOptions"></a><span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    DMA options bit-mask, which can consist of a combination of any of the
    enumeration values listed below.<br>
    </p>
    <p>
    <span class="b"><strong>NOTE:</strong></span> Options that are also applicable to the
    <code class="jfunc">WDC_DMASGBufLock</code><span class="jfunc">()</span> and <code class="jfunc">WDC_DMAContigBufLock</code><span class="jfunc">()</span>
    functions (according to the descriptions below) should be set within these
    functions' <code class="japi">dwOptions</code> parameter. The <code class="japi">dwOptions</code>
    field of the <code class="japi">WD_DMA</code> structure returned by these functions will
    be updated accordingly.<br>
    DMA flags:
    </p>
    
    &#8226; <strong class="japib"><code>DMA_FROM_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from the device to memory.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_TO_DEVICE</code></strong>: Synchronize the DMA buffer for
      transfers from memory to the device.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_TO_FROM_DEVICE</code></strong>: Synchronize the DMA buffer
      for transfers in both directions &#8212; i.e., from the device to memory
      and from memory to the device (&lt;=&gt; <code class="japi">DMA_FROM_DEVICE |
      DMA_TO_DEVICE</code>).<br>
    
    
    &#8226; <strong class="japib"><code>DMA_KERNEL_BUFFER_ALLOC</code></strong>: Allocate a contiguous
      DMA buffer in the physical memory.<br>
      The default behavior (when this flag is not set) is to allocate a
      Scatter/&#65279;Gather DMA buffer.<br>
      Set this flag when calling the low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span>
      function to allocate a contiguous DMA buffer (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
      When using the WDC APIs there is no need to set this flag, since
      <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> sets it automatically, and
      <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> is used to allocate Scatter/&#65279;Gather DMA buffers,
      for which this flag is not applicable.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_KBUF_BELOW_16M</code></strong>: Allocate the physical DMA
      buffer within the first 16MB of the main memory.<br>
      This flag is applicable only to contiguous-buffer DMA &#8212; i.e., when
      calling <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> or when calling the
      low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span> flag with the
      <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag (see the
      <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
    
    
    &#8226; <strong class="japib"><code>DMA_LARGE_BUFFER</code></strong>: Enable locking of a large DMA
      buffer &#8212; <code class="japi">dwBytes &gt; 1MB</code>.<br>
      This flag is applicable only to Scatter/&#65279;Gather DMA.<br>
      Set this flag when calling the low&#65279;-&#65279;level <code class="jfunc">WD_DMALock</code><span class="jfunc">()</span>
      function to allocate a large DMA buffer (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
      When using the WDC APIs there is no need to set this flag, since
      <span style=""><span style=""><code class="japi">WDC_DMASGBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMASGBufLock" title="B.3.41. WDC_DMASGBufLock()"><fo:inline> [B.3.41]</fo:inline></a></span> sets it automatically when called to
      allocate a large DMA buffer, and <span style=""><span style=""><code class="japi">WDC_DMAContigBufLock</code><span class="japi">()</span></span><a class="xref" href="#WDC_DMAContigBufLock" title="B.3.40. WDC_DMAContigBufLock()"><fo:inline> [B.3.40]</fo:inline></a></span> is
      used to allocate contiguous DMA buffers, for which this flag is not
      applicable.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_ALLOW_CACHE</code></strong>: Allow caching of the DMA
      buffer.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_KERNEL_ONLY_MAP</code></strong>: Do not map the allocated
      DMA buffer to the user mode (i.e., map it to kernel-mode only).<br>
      This flag is applicable only in cases where the
      <code class="japi">DMA_KERNEL_BUFFER_ALLOC</code> flag is applicable &#8212; see
      above.<br>
    
    
    &#8226; <strong class="japib"><code>DMA_ALLOW_64BIT_ADDRESS</code></strong>: Allow allocation of
      64-&#65279;bit DMA addresses. This flag is supported on Windows
      and Linux.
    
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwPages</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Number of physical memory blocks used for the allocated buffer.<br>
    For contiguous-buffer DMA this field is always set to 1.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hCard</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Low&#65279;-&#65279;level WinDriver card handle, which is acquired by
    <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> (by calling <code class="jfunc">WD_CardRegister</code><span class="jfunc">()</span>
    &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) and stored in the WDC device structure
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Page</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_DMA_PAGE[WD_DMA_PAGES]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Array of physical memory pages information structures.<br>
    For contiguous buffer DMA this array always holds only one element (see
    <code class="japi">dwPages</code>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pPhysicalAddr</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DMA_ADDR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The page's physical address</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwBytes</span></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">The page's size (in bytes)</td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_TRANSFER"></a>B.7.10. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_TRANSFER Structure</span></h3></div></div></div><p>
Memory/IO read/write transfer command information structure.
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">cmdTrans</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    A value indicating the type of transfer to perform &#8212; refer to the
    definition of the <code class="japi">WD_TRANSFER_CMD</code> enumeration in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>.
    </p>
    <p>
    The transfer command can be of either of the following types:<br>
    </p>
    <p>
    &#8226; A read/write transfer command that conforms to the following
  format: <strong class="japib"><code>&lt;dir&gt;&lt;p&gt;_[S]&lt;size&gt;</code></strong><br>
  Explanation:<br><strong class="japib"><code>&lt;dir&gt;</code></strong>: <strong class="japib"><code>R</code></strong> for read, <strong class="japib"><code>W</code></strong> for
  write <br><strong class="japib"><code>&lt;p&gt;</code></strong>: <strong class="japib"><code>P</code></strong> for I/&#65279;O, <strong class="japib"><code>M</code></strong> for
  memory <br><strong class="japib"><code>&lt;S&gt;</code></strong>: signifies a string (block) transfer, as opposed to
  a single transfer <br><strong class="japib"><code>&lt;size&gt;</code></strong>: BYTE, WORD, DWORD or QWORD
<br>
    </p>
    <p>
    &#8226; <strong class="japib"><code>CMD_MASK</code></strong>: This command is applicable when
      passing interrupt transfer commands to the interrupt enable functions
      (<span style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the low&#65279;-&#65279;level
      <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> or <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions
      &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).<br>
      <code class="japi">CMD_MASK</code> is 
  an interrupt mask command for determining the source of the interrupt: When
  this command is set, upon the arrival of an interrupt in the kernel WinDriver
  masks the value of the previous read command in the <code class="japi">WD_TRANSFER</code>
  commands array with the mask that is set in the relevant <code class="japi">Data</code>
  field union member of the mask transfer command. For example, for a
  <code class="japi">pTransCmds </code><code class="japi">WD_TRANSFER</code> array, if
  <code class="japi">pTransCmds[i-1].cmdTrans</code>
  is <code class="japi">RM_BYTE</code>, WinDriver performs the following mask:
   <span style="white-space:nowrap"><code class="japi">pTransCmds[i-1].Data.Byte
    &amp;
  pTransCmds[i].Data.Byte</code></span>.
  If the mask is successful, the driver claims ownership of the interrupt and
  when the control is returned to the user mode, the interrupt handler routine
  that was passed to the interrupt enable function is invoked; otherwise, the
  driver rejects ownership of the interrupt, the interrupt handler routine is
  not invoked and the subsequent transfer commands in the array are not
  executed.<br>
  (Acceptance and rejection of the interrupt is relevant only when handling
  legacy interrupts; since MSI/MSI-&#65279;X interrupts are not shared, WinDriver will
  always accept control of such interrupts.)<br>
  NOTE: A <code class="japi">CMD_MASK</code> command must be preceded by a read transfer
  command (<code class="japi">RM_XXX</code> / <code class="japi">RP_XXX</code>).

    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pPort</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The I/&#65279;O port address or the kernel-mapped virtual memory address, which
    has been stored in the relevant device (<span style=""><span style=""><code class="japi">WDC_DEVICE</code></span><a class="xref" href="#WDC_DEVICE" title="B.4.2. WDC_DEVICE Structure"><fo:inline> [B.4.2]</fo:inline></a></span>):
    <code class="japi">dev.pAddrDesc[i].pAddr</code> (where <em class="it">i</em> is the index of the
    desired address space). (When using the low&#65279;-&#65279;level <code class="jfunc">WD_xxx</code><span class="jfunc">()</span>
    APIs, these values are stored within the <code class="japi">pAddr</code> (I/&#65279;O) and
    <code class="japi">pTransAddr</code> (memory) fields of the relevant
    <code class="japi">cardReg.Card.Item[i]</code> item &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The number of bytes to transfer</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">fAutoinc</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Relevant only for string (block) transfers:<br>
    If <strong class="japib"><code>TRUE</code></strong>, the I/&#65279;O or memory port/address will be
    incremented after each block that is transferred;<br>
    If <strong class="japib"><code>FALSE</code></strong>, all data is transferred to/from the same
    port/address.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwOptions</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Must be zero</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">Data</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">union</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The data buffer for the transfer (input for write commands, output for read
    commands):
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Byte</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">BYTE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Used for 8-bit transfers</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Word</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Used for 16-bit transfers</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Dword</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT32</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Used for 32-&#65279;bit transfers</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">Qword</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Used for 64-&#65279;bit transfers</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pBuffer</span></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">
    Used for string (block) transfers &#8212; a pointer to the data buffer for
    the transfer
  </td></tr></tbody></table></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_KERNEL_BUFFER"></a>B.7.11. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="">WD_KERNEL_BUFFER Structure</span></h3></div></div></div><p>
Kernel buffer information structure.
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hKerBuf</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel buffer handle (or 0 for a failed allocation). This handle is returned
    from <span style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span> (or from the low&#65279;-&#65279;level 
    <code class="jfunc">WD_KernelBufLock</code><span class="jfunc">()</span> function &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><a name="WD_KERNEL_BUFFER_dwOptions"></a><span style="">dwOptions</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    <p>
    Kernel buffer options bit-mask, which can consist of a combination of any of
    the enumeration values listed below.<br>
    </p>
    <p>
    
    &#8226; <strong class="japib"><code>ALLOCATE_CONTIG_BUFFER</code></strong>:Allocates a physically 
      contiguous buffer<br>
    
    
    &#8226; <strong class="japib"><code>ALLOCATE_CACHED_BUFFER</code></strong>:Allocates a cached 
      buffer<br>
    
    </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">qwBytes</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The requested buffer size (in bytes)</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pKernelAddr</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KPTR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Kernel-mode mapped address of the kernel buffer. This mapping is returned from
    <span style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span>, or from the low&#65279;-&#65279;level 
    <code class="jfunc">WD_KernelBufLock</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pUserAddr</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">UPTR</td><td style="" align="left" valign="top">
    User-mode mapped address of the kernel buffer. This mapping is returned from
    <span style=""><span style=""><code class="japi">WDS_SharedBufferAlloc</code><span class="japi">()</span></span><a class="xref" href="#WDS_SharedBufferAlloc" title="B.6.1. WDS_SharedBufferAlloc()"><fo:inline> [B.6.1]</fo:inline></a></span> (or from the low&#65279;-&#65279;level 
    <code class="jfunc">WD_KernelBufLock</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
  </td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KPKERNELFUNC"></a>B.8. Kernel PlugIn Kernel-Mode Functions</h2></div></div></div><p>
The following functions are callback functions which are implemented in your
Kernel PlugIn driver, and which will be called when their calling event occurs.
For example: <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> is the callback function that is called when
the driver is loaded. Any code that you want to execute upon loading should be
in this function.
</p><p>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span> sets the name of the driver and the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> function(s).
</p><p>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> sets the rest of the driver's callback functions.
</p><p>
For example:<br>

</p><pre class="screen">kpOpenCall-&gt;funcClose = KP_Close;
    kpOpenCall-&gt;funcCall = KP_Call;
    kpOpenCall-&gt;funcIntEnable = KP_IntEnable;
    kpOpenCall-&gt;funcIntDisable = KP_IntDisable;
    kpOpenCall-&gt;funcIntAtIrql = KP_IntAtIrql;
    kpOpenCall-&gt;funcIntAtDpc = KP_IntAtDpc;
    kpOpenCall-&gt;funcIntAtIrqlMSI = KP_IntAtIrqlMSI;
    kpOpenCall-&gt;funcIntAtDpcMSI = KP_IntAtDpcMSI;
    kpOpenCall-&gt;funcEvent = KP_Event;
</pre><p>
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
As explained in <a class="xref" href="#kp_before_you_begin" title="11.6.2.1. Before You Begin"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 11.6.2.1</fo:inline></a>, it is the convention
of this reference guide to mark the Kernel PlugIn callback functions as
<code class="japi">KP_&lt;functionality&gt;</code> &#8212; e.g., <code class="japi">KP_Open</code>.
However, you are free to select any name that you wish for your Kernel PlugIn
callback functions, apart from <code class="japi">KP_Init</code>. The generated DriverWizard
Kernel PlugIn code, for example, uses the selected driver name in the callback
function names (e.g., for a &lt;MyKP&gt; driver it creates callbacks named
<code class="japi">KP_MyKP_Open</code>, <code class="japi">KP_MyKP_Call</code>, etc.).
</td></tr></table></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Init"></a>B.8.1. KP_Init</h3></div></div></div>
<h5><a name="idp46253659393760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Kernel PlugIn initialization function.<br>
This function is called when the Kernel PlugIn driver is loaded.<br>
The function sets the name of the Kernel PlugIn driver and the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><span> callback function(s)</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>.
</p>

<h5><a name="idp46253659398896"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_Init(KP_INIT *kpInit);</pre>

<h5><a name="idp46253659400672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">kpInit</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INIT*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253659409792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">kpInit</td><td style="" align="left" valign="top">
    Pointer to a pre-allocated Kernel PlugIn initialization information
    structure<a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a>, whose fields should be updated by the
    function
  </td></tr></tbody></table></div>

<h5><a name="idp46253659417552"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
<code class="japi">TRUE</code> if successful. Otherwise <code class="japi">FALSE</code>.
</p>

<h5><a name="idp46253659419888"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
You must define the <code class="japi">KP_Init</code> function in your code in order to link
the Kernel PlugIn driver to WinDriver. <code class="japi">KP_Init</code> is called when the
driver is loaded. Any code that you want to execute upon loading should be in
this function.
</p>

<h5><a name="idp46253659422672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>

<pre class="screen">BOOL __cdecl KP_Init(KP_INIT *kpInit)
{
    /* Check if the version of the WinDriver Kernel
       PlugIn library is the same version
       as windrvr.h and wd_kp.h */
    if (kpInit-&gt;dwVerWD != WD_VER)
    {
        /* You need to recompile your Kernel PlugIn
           with the compatible version of the WinDriver
           Kernel PlugIn library, windrvr.h and wd_kp.h */
       return FALSE;
    }

    kpInit-&gt;funcOpen = KP_Open;
    kpInit-&gt;funcOpen_32_64 = KP_PCI_VIRT_Open_32_64;
    strcpy (kpInit-&gt;cDriverName, "KPDriver"); /* Up to 12 chars */

  return TRUE;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Open"></a>B.8.2. KP_Open</h3></div></div></div>
<h5><a name="idp46253659427328"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Kernel PlugIn open function.<br>
This function sets the rest of the Kernel PlugIn callback functions
(<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>, <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>, etc.) and performs any
other desired initialization (such as allocating memory for the driver context
and filling it with data passed from the user mode).<br>
The returned driver context (<code class="japi">*ppDrvContext</code>) will be passed to rest
of the Kernel PlugIn callback functions.
</p>
<p>
The <code class="japi">KP_Open</code> callback is called when the
<code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is
called from the user mode &#8212; either directly (when using the low&#65279;-&#65279;level
WinDriver API<a class="xref" href="#WDC_OVERVIEW" title="B.2. WDC Library Overview"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.2]</fo:inline></a>), or via a call to a high&#65279;-&#65279;level WDC
function.<br>
<code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> is called from the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span>, and from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) when they
are called with the name of a valid Kernel PlugIn driver (set in the
<code class="japi">pcKPDriverName</code> parameter).

</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions cannot be used to open a handle
to a 64-&#65279;bit Kernel PlugIn function from a 32-&#65279;bit application. For this
purpose, use <code class="jfunc">WDC_KernelPlugInOpen</code><span class="jfunc">()</span> (or the low&#65279;-&#65279;level
<code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> function).
</td></tr></table></div><p>
</p><p>
The Kernel PlugIn driver can implement two types of <code class="japi">KP_Open</code>
callback functions &#8212;
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    A "standard" Kernel PlugIn open function, which is used whenever a
    user-mode application opens a handle to a Kernel PlugIn driver,
    <em class="it">except</em> when a 32-&#65279;bit applications opens a handle to a 64-&#65279;bit
    driver.<br>
    This callback function is set in the <code class="japi">funcOpen</code> field of the
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_INIT</code></span><span> structure</span><a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a></span> that is passed as a parameter to
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span>.
  </li><li class="listitem" style="list-style-type: disc">
    A function that will be used when a 32-&#65279;bit user-mode application opens a
    handle to a 64-&#65279;bit Kernel PlugIn driver.<br>
    This callback function is set in the <code class="japi">funcOpen_32_64</code> field of
    the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_INIT</code></span><span> structure</span><a class="xref" href="#KP_INIT" title="B.9.4. KP_INIT"><fo:inline> [B.9.4]</fo:inline></a></span> that is passed as a parameter to
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span>.
  </li></ul></div><p>
</p><p>
A Kernel PlugIn driver can provide either one or both of these
<code class="japi">KP_Open</code> callbacks, depending on the target configuration(s).
</p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
The <span class="jprintfilename"><strong>KP_PCI</strong></span> sample (<span class="jprintfilename"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/&#65279;<span class="jprintfilename"><strong>kp_pci.c</strong></span></strong></span>) implements both
types of <code class="japi">KP_Open</code> callbacks &#8212; <code class="jfunc">KP_PCI_Open</code><span class="jfunc">()</span>
(standard) and <code class="jfunc">KP_PCI_Open_32_64</code><span class="jfunc">()</span> (for opening a handle to a
64-&#65279;bit Kernel PlugIn from a 32-&#65279;bit application).<br>
The generated DriverWizard Kernel PlugIn code always implements a standard
Kernel PlugIn open function &#8212; <code class="jfunc">KP_XXX_Open</code><span class="jfunc">()</span>.
When selecting the <em class="guilabel">32-&#65279;bit application for a 64-&#65279;bit Kernel PlugIn</em> DriverWizard code-generation
option (see <a class="xref" href="#wiz_pci_driver_options" title="Figure 4.10. Additional Driver Options"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Figure 4.10</fo:inline></a>), the wizard also implements a
<code class="jfunc">KP_XXX_Open_32_64</code><span class="jfunc">()</span> function, for opening a handle to a 64-&#65279;bit
Kernel PlugIn driver from a 32-&#65279;bit application.
</td></tr></table></div>
<h5><a name="idp46253659469520"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_Open(
    KP_OPEN_CALL *kpOpenCall,
    HANDLE hWD,
    PVOID pOpenData,
    PVOID *ppDrvContext);
</pre>

<h5><a name="idp46253659471376"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpOpenCall</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_OPEN_CALL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hWD</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pOpenData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDrvContext</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253659485408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpOpenCall</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Structure to fill in the addresses of the
    <span style=""><span style=""><code class="japi">KP_xxx</code></span><span> callback functions</span><a class="xref" href="#KP_OPEN_CALL" title="B.9.5. KP_OPEN_CALL"><fo:inline> [B.9.5]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hWD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The WinDriver handle that <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> was called with
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pOpenData</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to data passed from user mode</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppDrvContext</td><td style="" align="left" valign="top">
    Pointer to driver context data with which the <span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span>,
    <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>, <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> and <span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span>
    functions will be called. Use this to keep driver-specific information that
    will be shared among these callbacks.
  </td></tr></tbody></table></div>

<h5><a name="idp46253659509968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
<code class="japi">TRUE</code> if successful. If <code class="japi">FALSE</code>, the call to
<code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> from the user mode will fail.
</p>

<h5><a name="idp46253659513024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">BOOL __cdecl KP_Open(KP_OPEN_CALL *kpOpenCall, HANDLE hWD,
            PVOID pOpenData, PVOID *ppDrvContext)
{
    kpOpenCall-&gt;funcClose = KP_Close;
    kpOpenCall-&gt;funcCall = KP_Call;
    kpOpenCall-&gt;funcIntEnable = KP_IntEnable;
    kpOpenCall-&gt;funcIntDisable = KP_IntDisable;
    kpOpenCall-&gt;funcIntAtIrql = KP_IntAtIrql;
    kpOpenCall-&gt;funcIntAtDpc = KP_IntAtDpc;
    kpOpenCall-&gt;funcIntAtIrqlMSI = KP_IntAtIrqlMSI;
    kpOpenCall-&gt;funcIntAtDpcMSI = KP_IntAtDpcMSI;
    kpOpenCall-&gt;funcEvent = KP_Event;

    /* You can allocate driver context memory here: */
    *ppDrvContext = malloc(sizeof(MYDRV_STRUCT));
    return *ppDrvContext!=NULL;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Close"></a>B.8.3. KP_Close</h3></div></div></div>
<h5><a name="idp46253659518016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Called when <code class="jfunc">WD_KernelPlugInClose</code><span class="jfunc">()</span> (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is
called from user mode.<br>
The high&#65279;-&#65279;level <code class="jfunc">WDC_xxxDeviceClose</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceClose" title="B.3.19. WDC_PciDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.19]</fo:inline></a> /
    ISA<a class="xref" href="#WDC_IsaDeviceClose" title="B.3.20. WDC_IsaDeviceClose()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.20]</fo:inline></a>) automatically call
<code class="jfunc">WD_KernelPlugInClose</code><span class="jfunc">()</span> for devices that contain an open
Kernel PlugIn handle (see <a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 12.5</fo:inline></a>).
</p>

<p>
This functions can be used to perform any required clean-up for the Kernel
PlugIn (such as freeing memory previously allocated for the driver context,
etc.).
</p>

<h5><a name="idp46253659523904"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void __cdecl KP_Close(PVOID pDrvContext);</pre>
<code class="japi">KP_FUNC_CLOSE</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659525792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659534528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="" align="left" valign="top">Driver context data that was set by <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span></td></tr></tbody></table></div>


  
  <h5><a name="idp46253659543904"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  

<h5><a name="idp46253659545136"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">void __cdecl KP_Close(PVOID pDrvContext)
{
   if (pDrvContext)
        free(pDrvContext); /* Free allocated driver context memory */
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Call"></a>B.8.4. KP_Call</h3></div></div></div>
<h5><a name="idp46253659548720"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Called when the user-mode application calls <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> (or
the low&#65279;-&#65279;level <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function &#8212; see the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<p>
This function is a message handler for your utility functions.
</p>

<h5><a name="idp46253659554480"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void __cdecl KP_Call(
    PVOID pDrvContext,
    WD_KERNEL_PLUGIN_CALL
    *kpCall,
    BOOL fIsKernelMode);
</pre>
<code class="japi">KP_FUNC_CALL</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659556816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpCall</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_PLUGIN_CALL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top"> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwMessage</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pData</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwResult</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fIsKernelMode</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BOOL</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659576240"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Driver context data that was set by <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> and will also be
    passed to <span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span>, <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> and
    <span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpCall</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Structure with user-mode information received from the
    <span style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> (or from the low&#65279;-&#65279;level
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function &#8212; see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) and/or with information to return back to the user
      mode<a class="xref" href="#WD_KERNEL_PLUGIN_CALL" title="B.9.3. WD_KERNEL_PLUGIN_CALL"><fo:inline> [B.9.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">fIsKernelMode</td><td style="" align="left" valign="top">
    This parameter is passed by the WinDriver kernel &#8212; see the
    <a class="xref" href="#fIsKernelMode_remark"><fo:inline>fIsKernelMode remark</fo:inline></a>, below.
  </td></tr></tbody></table></div>

  <h5><a name="idp46253659600832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
<h5><a name="idp46253659602320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span> (or the low&#65279;-&#65279;level
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function &#8212; see the
    <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) in the user mode will call your <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>
    callback function in the kernel mode. The <code class="japi">KP_Call</code> function
    in the Kernel PlugIn will determine which routine to execute according to
    the message passed to it.
  </li><li class="listitem" style="list-style-type: disc"><a name="fIsKernelMode_remark"></a>
    The <code class="japi">fIsKernelMode</code> parameter is passed by the WinDriver kernel to
    the <code class="japi">KP_Call</code> routine. The user is not required to do anything
    about this parameter. However, notice how this parameter is passed in the
    sample code to the macro <code class="japi">COPY_TO_USER_OR_KERNEL</code> &#8212; This
    is required for the macro to function correctly. Please refer to
    <a class="xref" href="#COPY_TO_USER_OR_KERNEL" title="B.8.12. COPY_TO_USER_OR_KERNEL, COPY_FROM_USER_OR_KERNEL"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section B.8.12</fo:inline></a> for more details regarding the
    <code class="japi">COPY_TO_USER_OR_KERNEL</code> and
    <code class="japi">COPY_FROM_USER_OR_KERNEL</code> macros.
  </li></ul></div>

<h5><a name="idp46253659615600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">void __cdecl KP_Call(PVOID pDrvContext,
   WD_KERNEL_PLUGIN_CALL *kpCall, BOOL fIsKernelMode)
{
    kpCall-&gt;dwResult = MY_DRV_OK;
    switch (kpCall-&gt;dwMessage)
    {
        /* In this sample we implement a GetVersion message */
        case MY_DRV_MSG_VERSION:
            {
              DWORD dwVer = 100;
              MY_DRV_VERSION *ver = (MY_DRV_VERSION *)kpCall-&gt;pData;
              COPY_TO_USER_OR_KERNEL(&amp;ver-&gt;dwVer, &amp;dwVer,
                  sizeof(DWORD), fIsKernelMode);
              COPY_TO_USER_OR_KERNEL(ver-&gt;cVer, "My Driver V1.00",
                  sizeof("My Driver V1.00")+1, fIsKernelMode);

              kpCall-&gt;dwResult = MY_DRV_OK;
            }
            break;
        /* You can implement other messages here */
        default:
            kpCall-&gt;dwResult = MY_DRV_NO_IMPL_MESSAGE;
    }
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_Event"></a>B.8.5. KP_Event</h3></div></div></div>
<h5><a name="idp46253659619936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Called when a Plug&#65279;-&#65279;and&#65279;-&#65279;Play or power management event for the device is received,
provided the user-mode application first called <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span>
with <code class="japi">fUseKP = TRUE</code> (or the low&#65279;-&#65279;level
<code class="jfunc">EventRegister</code><span class="jfunc">()</span> function with a Kernel PlugIn handle &#8212; see
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) (see the Remarks below).
</p>

<h5><a name="idp46253659626016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_Event(
    PVOID pDrvContext,
    WD_EVENT *wd_event);
</pre>
<code class="japi">KP_FUNC_EVENT</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659628304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">wd_event</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_EVENT*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659639056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Driver context data that was set by <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> and will also be
    passed to <span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span>, <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> and
    <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">wd_event</td><td style="" align="left" valign="top">
    Pointer to the PnP/power management event information received from the
    user mode
  </td></tr></tbody></table></div>

<h5><a name="idp46253659657616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
<code class="japi">TRUE</code> in order to notify the user about the event.
</p>

<h5><a name="idp46253659659792"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
<code class="japi">KP_Event</code> will be called if the user mode process called
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span> with <code class="japi">fUseKP= TRUE</code> (or of the
low&#65279;-&#65279;level <code class="jfunc">EventRegister</code><span class="jfunc">()</span> function was called with a
Kernel PlugIn handle &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<h5><a name="idp46253659666048"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">BOOL __cdecl KP_Event(PVOID pDrvContext, WD_EVENT *wd_event)
{
    /* Handle the event here */
    return TRUE; /* Return TRUE to notify the user about the event */
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntEnable"></a>B.8.6. KP_IntEnable</h3></div></div></div>
<h5><a name="idp46253659669664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Called when <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is called from
the user mode with a Kernel PlugIn handle.<br>
<code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> is called automatically from
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> and <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> (see
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>
<p>
The interrupt context that is set by this function (<code class="japi">*ppIntContext</code>)
will be passed to the rest of the Kernel PlugIn interrupt functions.
</p>
<h5><a name="idp46253659677536"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_IntEnable (
    PVOID pDrvContext,
    WD_KERNEL_PLUGIN_CALL *kpCall,
    PVOID *ppIntContext);
</pre>
<code class="japi">KP_FUNC_INT_ENABLE</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659679872"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpCall</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_PLUGIN_CALL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwMessage</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">pData</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwResult</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppIntContext</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID*</td><td style="" align="left" valign="top">Input/Output</td></tr></tbody></table></div>

<h5><a name="idp46253659699456"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pDrvContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Driver context data that was set by <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> and will also be
    passed to <span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span>, <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> and
    <span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">kpCall</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Structure with information from <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span><a class="xref" href="#WD_KERNEL_PLUGIN_CALL" title="B.9.3. WD_KERNEL_PLUGIN_CALL"><fo:inline> [B.9.3]</fo:inline></a>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">ppIntContext</td><td style="" align="left" valign="top">
    Pointer to interrupt context data that will be passed to
    <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span> and to the Kernel PlugIn interrupt handler
    functions. Use this context to keep interrupt specific information.
  </td></tr></tbody></table></div>

<h5><a name="idp46253659722672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns <code class="japi">TRUE</code> if enable is successful; otherwise returns
<code class="japi">FALSE</code>.
</p>

<h5><a name="idp46253659725296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
This function should contain any initialization needed for your Kernel PlugIn
interrupt handling.
</p>

<h5><a name="idp46253659727104"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">BOOL __cdecl KP_IntEnable(PVOID pDrvContext,
     WD_KERNEL_PLUGIN_CALL *kpCall, PVOID *ppIntContext)
{
    DWORD *pIntCount;
    /* You can allocate specific memory for each interrupt
       in *ppIntContext */
    *ppIntContext = malloc(sizeof (DWORD));
    if (!*ppIntContext)
        return FALSE;
    /* In this sample the information is a DWORD used to
       count the incoming interrupts */
    pIntCount = (DWORD *) *ppIntContext;
    *pIntCount = 0; /* Reset the count to zero */
    return TRUE;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntDisable"></a>B.8.7. KP_IntDisable</h3></div></div></div>
<h5><a name="idp46253659731072"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Called when <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is called from
the user mode for interrupts that were enabled in the Kernel PlugIn.<br>
<code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> is called automatically from
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> and <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> (see
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<p>
This function should free any memory that was allocated in
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>.
</p>

<h5><a name="idp46253659740608"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void __cdecl KP_IntDisable(PVOID pIntContext);</pre>
<code class="japi">KP_FUNC_INT_DISABLE</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659742496"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659751232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="" align="left" valign="top">
    Interrupt context data that was set by <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253659760752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  

<h5><a name="idp46253659761984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">void __cdecl KP_IntDisable(PVOID pIntContext)
{
  /* You can free the interrupt specific memory
     allocated to pIntContext here */
  free(pIntContext);
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntAtIrql"></a>B.8.8. KP_IntAtIrql</h3></div></div></div>
<h5><a name="idp46253659765600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
High-priority legacy interrupt handler routine, which is run at high interrupt
request level. This function is called upon the arrival of a legacy interrupt
that has been enabled using a Kernel PlugIn driver &#8212; see the description
of <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the low&#65279;-&#65279;level
<code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> and <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions (see
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<h5><a name="idp46253659771744"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_IntAtIrql(
    PVOID pIntContext,
    BOOL *pfIsMyInterrupt);
</pre>
<code class="japi">KP_FUNC_INT_AT_IRQL</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659774048"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pfIsMyInterrupt</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">BOOL*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253659784800"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to interrupt context data that was set by
    <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> and will also be passed to
    <span style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span> (if executed) and <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pfIsMyInterrupt</td><td style="" align="left" valign="top">
    Set <code class="japi">*pfIsMyInterrupt</code> to <code class="japi">TRUE</code> if the interrupt
    belongs to this driver; otherwise set it to <code class="japi">FALSE</code> in order to
    enable the interrupt service routines of other drivers for the same
    interrupt to be called
  </td></tr></tbody></table></div>

<h5><a name="idp46253659802272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
<code class="japi">TRUE</code> if deferred interrupt processing (DPC) is required; otherwise
<code class="japi">FALSE</code>.
</p>

<h5><a name="idp46253659804880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Code running at IRQL will only be interrupted by higher priority
    interrupts.
  </li><li class="listitem" style="list-style-type: disc">
    Code running at high IRQL is limited in the following ways:
  <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      It may only access non-pageable memory.
    </li><li class="listitem" style="list-style-type: disc">
      It may only call the following functions (or wrapper functions that call
      these functions):
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><code class="jfunc">WDC_xxx</code><span class="jfunc">()</span> read/write address or configuration space
            functions.
          </li><li class="listitem" style="list-style-type: disc"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MultiTransfer</code><span class="japi">()</span></span><a class="xref" href="#WDC_MultiTransfer" title="B.3.30. WDC_MultiTransfer()"><fo:inline> [B.3.30]</fo:inline></a></span>, or the low&#65279;-&#65279;level
            <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span>, <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span>, or
            <code class="jfunc">WD_DebugAdd</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
          </li><li class="listitem" style="list-style-type: disc">
            Specific kernel OS functions (such as WDK functions) that can be
            called from high interrupt request level. Note that the use of such
            functions may break the code's portability to other operating
            systems.
          </li></ul></div></li><li class="listitem" style="list-style-type: disc">
      It may <span class="b"><strong>not</strong></span> call <code class="jfunc">malloc</code><span class="jfunc">()</span>, <code class="jfunc">free</code><span class="jfunc">()</span>, or any
      <code class="japi">WDC_xxx</code> or <code class="japi">WD_xxx</code> API other than those listed
      above.
    </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    The code performed at high interrupt request level should be minimal
    (e.g., only the code that acknowledges level-sensitive interrupts), since
    it is operating at a high priority. The rest of your code should be
    written in <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span>, which runs at the deferred DISPATCH
    level and is not subject to the above restrictions.
  </li></ul></div>

<h5><a name="idp46253659822384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">BOOL __cdecl KP_IntAtIrql(PVOID pIntContext,
    BOOL *pfIsMyInterrupt)
{
    DWORD *pdwIntCount = (DWORD*)pIntContext;

    /* Check your hardware here to see if the interrupt belongs to you.
       If it does, you must set *pfIsMyInterrupt to TRUE.
       Otherwise, set *pfIsMyInterrupt to FALSE. */
    *pfIsMyInterrupt = FALSE;

    /* In this example we will schedule a DPC once in every 5 interrupts */
    (*pdwIntCount) ++;
    if (*pdwIntCount==5)
    {
        *pdwIntCount = 0;
        return TRUE;
    }

    return FALSE;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntAtDpc"></a>B.8.9. KP_IntAtDpc</h3></div></div></div>
<h5><a name="idp46253659826384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Deferred processing legacy interrupt handler routine.<br>
This function is called once the high-priority legacy interrupt handling is
completed, provided that <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> returned <code class="japi">TRUE</code>.
</p>

<h5><a name="idp46253659831472"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD __cdecl KP_IntAtDpc(
    PVOID pIntContext,
    DWORD dwCount);
</pre>
<code class="japi">KP_FUNC_INT_AT_DPC</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659833760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwCount</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659844512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Interrupt context data that was set by <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>, passed
    to <span style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span>, and will be passed to
    <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwCount</td><td style="" align="left" valign="top">
    The number of times <span style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> returned <code class="japi">TRUE</code>
    since the last DPC call. If <code class="japi">dwCount</code> is 1,
    <code class="japi">KP_IntAtIrql</code> requested a DPC only once since the last DPC
    call. If the value is greater than 1, <code class="japi">KP_IntAtIrql</code> has
    already requested a DPC a few times, but the interval was too short,
    therefore <code class="japi">KP_IntAtDpc</code> was not called for each DPC request.
  </td></tr></tbody></table></div>

<h5><a name="idp46253659865488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the number of times to notify user mode (i.e., return from
<code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<h5><a name="idp46253659868208"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Most of the interrupt handling should be implemented within this
    function, as opposed to the high-priority <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span>
    interrupt handler.
  </li><li class="listitem" style="list-style-type: disc">
    If <code class="japi">KP_IntAtDpc</code> returns with a value greater than zero,
    <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> returns and the user-mode interrupt handler will
    be called in the amount of times set in the return value of
    <code class="japi">KP_IntAtDpc</code>. If you do not want the user-mode interrupt
    handler to execute, <code class="japi">KP_IntAtDpc</code> should return zero.
  </li></ul></div>

<h5><a name="idp46253659875392"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">DWORD __cdecl KP_IntAtDpc(PVOID pIntContext, DWORD dwCount)
{
  /* Return WD_IntWait as many times as KP_IntAtIrql
     scheduled KP_IntAtDpc */
  return dwCount;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntAtIrqlMSI"></a>B.8.10. KP_IntAtIrqlMSI</h3></div></div></div>
<h5><a name="idp46253659879008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
High-priority Message-Signaled Interrupts (MSI) / Extended Message-Signaled Interrupts (MSI-&#65279;X) handler routine, which
is run at high interrupt request level. This function is called upon the
arrival of an MSI/MSI-&#65279;X that has been enabled using a Kernel PlugIn &#8212;
see the description of <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> or the low&#65279;-&#65279;level
<code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> and <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions (see
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<h5><a name="idp46253659885264"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">BOOL __cdecl KP_PCI_IntAtIrqlMSI(
    PVOID pIntContext,
    ULONG dwLastMessage,
    DWORD dwReserved);
</pre>
<code class="japi">KP_FUNC_INT_AT_IRQL_MSI</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659887600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLastMessage</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwReserved</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659899984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to interrupt context data that was set by
    <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> and will also be passed to
    <span style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span> (if executed) and <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLastMessage</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The message data for the last received interrupt (applicable only on
    Windows 7 and higher)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwReserved</td><td style="" align="left" valign="top">Reserved for future use. Do not use this parameter.</td></tr></tbody></table></div>

<h5><a name="idp46253659917296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
<code class="japi">TRUE</code> if deferred MSI/MSI-&#65279;X processing (DPC) is required;
otherwise <code class="japi">FALSE</code>.
</p>

<h5><a name="idp46253659919968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Code running at IRQL will only be interrupted by higher priority
    interrupts.
  </li><li class="listitem" style="list-style-type: disc">
    Code running at high IRQL is limited in the following ways:
  <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
      It may only access non-pageable memory.
    </li><li class="listitem" style="list-style-type: disc">
      It may only call the following functions (or wrapper functions that call
      these functions):
        <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><code class="jfunc">WDC_xxx</code><span class="jfunc">()</span> read/write address or configuration space
            functions.
          </li><li class="listitem" style="list-style-type: disc"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_MultiTransfer</code><span class="japi">()</span></span><a class="xref" href="#WDC_MultiTransfer" title="B.3.30. WDC_MultiTransfer()"><fo:inline> [B.3.30]</fo:inline></a></span>, or the low&#65279;-&#65279;level
            <code class="jfunc">WD_Transfer</code><span class="jfunc">()</span>, <code class="jfunc">WD_MultiTransfer</code><span class="jfunc">()</span>, or
            <code class="jfunc">WD_DebugAdd</code><span class="jfunc">()</span> functions (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
          </li><li class="listitem" style="list-style-type: disc">
            Specific kernel OS functions (such as WDK functions) that can be
            called from high interrupt request level. Note that the use of such
            functions may break the code's portability to other operating
            systems.
          </li></ul></div></li><li class="listitem" style="list-style-type: disc">
      It may <span class="b"><strong>not</strong></span> call <code class="jfunc">malloc</code><span class="jfunc">()</span>, <code class="jfunc">free</code><span class="jfunc">()</span>, or any
      <code class="japi">WDC_xxx</code> or <code class="japi">WD_xxx</code> API other than those listed
      above.
    </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    The code performed at high interrupt request level should be minimal,
    since it is operating at a high priority. The rest of your code should be
    written in <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span>, which runs at the deferred
    DISPATCH level and is not subject to the above restrictions.
  </li></ul></div>

<h5><a name="idp46253659937408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">BOOL __cdecl KP_PCI_IntAtIrqlMSI(PVOID pIntContext,
    ULONG dwLastMessage, DWORD dwReserved)
{
    return TRUE;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_IntAtDpcMSI"></a>B.8.11. KP_IntAtDpcMSI</h3></div></div></div>
<h5><a name="idp46253659940976"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Deferred processing Message-Signaled Interrupts (MSI) / Extended Message-Signaled Interrupts (MSI-&#65279;X) handler
routine.<br>
This function is called once the high-priority MSI/MSI-&#65279;X handling is
completed, provided that <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span> returned
<code class="japi">TRUE</code>.
</p>

<h5><a name="idp46253659946352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD __cdecl KP_IntAtDpcMSI(
  PVOID pIntContext,
  DWORD dwCount,
  ULONG dwLastMessage,
  DWORD dwReserved);
</pre>
<code class="japi">KP_FUNC_INT_AT_DPC_MSI</code> Kernel PlugIn callback
  function type.


<h5><a name="idp46253659948688"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCount</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLastMessage</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwReserved</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253659962704"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIntContext</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Interrupt context data that was set by <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span>, passed
    to <span style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span>, and will be passed to
    <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwCount</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The number of times <span style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span> returned
    <code class="japi">TRUE</code> since the last DPC call. If <code class="japi">dwCount</code> is 1,
    <code class="japi">KP_IntAtIrqlMSI</code> requested a DPC only once since the last DPC
    call. If the value is greater than 1, <code class="japi">KP_IntAtIrqlMSI</code> has
    already requested a DPC a few times, but the interval was too short,
    therefore <code class="japi">KP_IntAtDpcMSI</code> was not called for each DPC request.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLastMessage</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    The message data for the last received interrupt (applicable only on
    Windows 7 and higher)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwReserved</td><td style="" align="left" valign="top">Reserved for future use. Do not use this parameter.</td></tr></tbody></table></div>

<h5><a name="idp46253659986224"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the number of times to notify user mode (i.e., return from
<code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> &#8212; see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>).
</p>

<h5><a name="idp46253659988944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Most of the MSI/MSI-&#65279;X handling should be implemented within this
    function, as opposed to the high-priority <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span>
    interrupt handler.
  </li><li class="listitem" style="list-style-type: disc">
    If <code class="japi">KP_IntAtDpcMSI</code> returns with a value greater than zero,
    <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> returns and the user-mode interrupt handler will
    be called in the amount of times set in the return value of
    <code class="japi">KP_IntAtDpcMSI</code>. If you do not want the user-mode interrupt
    handler to execute, <code class="japi">KP_IntAtDpcMSI</code> should return zero.
  </li></ul></div>

<h5><a name="idp46253659996256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Example</span></div>
<pre class="screen">DWORD __cdecl KP_IntAtDpcMSI(PVOID pIntContext, DWORD dwCount,
  ULONG dwLastMessage, DWORD dwReserved)
{
  /* Return WD_IntWait as many times as KP_IntAtIrqlMSI
     scheduled KP_IntAtDpcMSI */
  return dwCount;
}
</pre>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="COPY_TO_USER_OR_KERNEL"></a>B.8.12. COPY_TO_USER_OR_KERNEL, COPY_FROM_USER_OR_KERNEL</h3></div></div></div>
<h5><a name="idp46253659999984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Macros for copying data from the user mode to the Kernel PlugIn and vice versa.
</p>

<h5><a name="idp46253660001776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    The <code class="japi">COPY_TO_USER_OR_KERNEL</code> and
    <code class="japi">COPY_FROM_USER_OR_KERNEL</code> are macros used for copying data
    (when necessary) to/from user-mode memory addresses (respectively), when
    accessing such addresses from within the Kernel PlugIn. Copying the data
    ensures that the user-mode address can be used correctly, even if the
    context of the user-mode process changes in the midst of the I/&#65279;O
    operation. This is particularly relevant for long operations, during
    which the context of the user-mode process may change. The use of macros
    to perform the copy provides a generic solution for all supported
    operating systems.
  </li><li class="listitem" style="list-style-type: disc">
    Note that if you wish to access the user-mode data from within the
    Kernel PlugIn interrupt handler functions, you should first copy the data
    into some variable in the Kernel PlugIn before the execution of the
    kernel-mode interrupt handler routines.
  </li><li class="listitem" style="list-style-type: disc">
    The <code class="japi">COPY_TO_USER_OR_KERNEL</code> and
    <code class="japi">COPY_FROM_USER_OR_KERNEL</code> macros are defined in the
    <span class="jdirectory"><strong>WinDriver\include\kpstdlib.h</strong></span> header file.
  </li><li class="listitem" style="list-style-type: disc">
    For an example of using the <code class="japi">COPY_TO_USER_OR_KERNEL</code> macro, see
    the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> implementation (<code class="jfunc">KP_PCI_Call</code><span class="jfunc">()</span>) in the
    sample <span class="jprintfilename"><strong>WinDriver/&#65279;samples/&#65279;pci_diag/&#65279;kp_pci/&#65279;<span class="jprintfilename"><strong>kp_pci.c</strong></span></strong></span> Kernel PlugIn file.
  </li><li class="listitem" style="list-style-type: disc">
    To safely share a data buffer between the user-mode and Kernel PlugIn
    routines (e.g., <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span>),
    consider using the technique outlined in the technical document titled "How
    do I share a memory buffer between Kernel PlugIn and user-mode projects for
    DMA or other purposes?" found under the "Kernel PlugIn" technical documents
    section of the "Support" section.
    </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="kp_sync_apis"></a>B.8.13. Kernel PlugIn Synchronization APIs</h3></div></div></div><p>
This section describes the Kernel Plug-In synchronization APIs.<br>
These APIs support the following synchronization mechanisms:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Spinlocks [<a class="xref" href="#kp_spinlock_init" title="B.8.13.2. kp_spinlock_init()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.8.13.2</fo:inline></a>&#8211;<a class="xref" href="#kp_spinlock_uninit" title="B.8.13.5. kp_spinlock_uninit()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.8.13.5</fo:inline></a>], which are used to synchronize between threads
    on a single or multiple CPU system.
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The Kernel PlugIn spinlock functions can be called from any context
    apart from high interrupt request level. Hence, they can be called from
    any Kernel PlugIn function <span class="b"><strong>except</strong></span> for <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> and
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span>.<br>
    Note that the spinlock functions <span class="b"><strong>can</strong></span> be called from the deferred
    processing interrupt handler functions &#8212; <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span>
    and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span>.
    </td></tr></table></div></li><li class="listitem" style="list-style-type: disc">
    Interlocked operations [<a class="xref" href="#kp_interlocked_init" title="B.8.13.6. kp_interlocked_init()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.8.13.6</fo:inline></a>&#8211;<a class="xref" href="#kp_interlocked_uninit" title="B.8.13.7. kp_interlocked_uninit()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">B.8.13.7</fo:inline></a>], which are used for synchronizing access to
    a variable that is shared by multiple threads by performing complex
    operations on the variable in an atomic manner.
    <div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
    The Kernel PlugIn interlocked functions can be called from any context
    in the Kernel PlugIn, including from high interrupt request level. Hence,
    they can be called from any Kernel PlugIn function, <span class="b"><strong>including</strong></span>
    the Kernel PlugIn interrupt handler functions.
    </td></tr></table></div></li></ul></div><p>
</p><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_sync_types"></a>B.8.13.1. Kernel PlugIn Synchronization Types</h4></div></div></div><p>
The Kernel PlugIn synchronization APIs use the following types:

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc"><a name="KP_SPINLOCK"></a>
    <p>
    <strong class="japib"><code>KP_SPINLOCK</code></strong> &#8212; A Kernel PlugIn spinlock object
    structure:
    </p><p>
    </p><pre class="screen">typedef struct _KP_SPINLOCK KP_SPINLOCK;</pre><p>
    </p><p>
    </p>

    <p>
    <code class="japi">_KP_SPINLOCK</code> is an internal WinDriver spinlock object structure,
    opaque to the user.
    </p>
    </li><li class="listitem" style="list-style-type: disc"><a name="KP_INTERLOCKED"></a>
    <strong class="japib"><code>KP_INTERLOCKED</code></strong> &#8212; a Kernel PlugIn
    interlocked operations counter:

    <pre class="screen">typedef volatile int KP_INTERLOCKED;</pre>
    </li></ul></div><p>
</p></div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_spinlock_init"></a>B.8.13.2. kp_spinlock_init()</h4></div></div></div>
<h5><a name="idp46253660052320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Initializes a new Kernel PlugIn spinlock object.
</p>

<h5><a name="idp46253660053456"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">KP_SPINLOCK * kp_spinlock_init(void);</pre>

<h5><a name="idp46253660054800"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
If successful, returns a pointer to the new Kernel PlugIn
<a class="link" href="#KP_SPINLOCK">spinlock object</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.8.13.1]</fo:inline></a>,
otherwise returns <code class="japi">NULL</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_spinlock_wait"></a>B.8.13.3. kp_spinlock_wait()</h4></div></div></div>
<h5><a name="idp46253660059648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Waits on a Kernel PlugIn spinlock object.
</p>

<h5><a name="idp46253660060784"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_spinlock_wait(KP_SPINLOCK *spinlock);</pre>

<h5><a name="idp46253660062192"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_SPINLOCK*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660070928"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_SPINLOCK">spinlock object</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a>
    on which to wait
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660079024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_spinlock_release"></a>B.8.13.4. kp_spinlock_release()</h4></div></div></div>
<h5><a name="idp46253660082416"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Releases a Kernel PlugIn spinlock object.
</p>

<h5><a name="idp46253660083552"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_spinlock_release(KP_SPINLOCK *spinlock);</pre>

<h5><a name="idp46253660084960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_SPINLOCK*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660093696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_SPINLOCK">spinlock object</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a>
    to release
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660101760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_spinlock_uninit"></a>B.8.13.5. kp_spinlock_uninit()</h4></div></div></div>
<h5><a name="idp46253660105168"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Uninitializes a Kernel PlugIn spinlock object.
</p>

<h5><a name="idp46253660106304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_spinlock_uninit(KP_SPINLOCK *spinlock);</pre>

<h5><a name="idp46253660107712"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_SPINLOCK*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660116448"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">spinlock</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_SPINLOCK">spinlock object</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a>
    to uninitialize
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660124512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_init"></a>B.8.13.6. kp_interlocked_init()</h4></div></div></div>
<h5><a name="idp46253660127920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Initializes a Kernel PlugIn interlocked counter.
</p>

<h5><a name="idp46253660129056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_interlocked_init(KP_INTERLOCKED *target);</pre>

<h5><a name="idp46253660130464"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="" align="left" valign="top">Input/Output</td></tr></tbody></table></div>

<h5><a name="idp46253660139200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to initialize
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660147264"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_uninit"></a>B.8.13.7. kp_interlocked_uninit()</h4></div></div></div>
<h5><a name="idp46253660150672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Uninitializes a Kernel PlugIn interlocked counter.
</p>

<h5><a name="idp46253660151808"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_interlocked_uninit(KP_INTERLOCKED *target);</pre>

<h5><a name="idp46253660153216"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="" align="left" valign="top">Input/Output</td></tr></tbody></table></div>

<h5><a name="idp46253660161952"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to uninitialize
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660170016"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_increment"></a>B.8.13.8. kp_interlocked_increment()</h4></div></div></div>
<h5><a name="idp46253660173408"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Increments the value of a Kernel PlugIn interlocked counter by one.
</p>

<h5><a name="idp46253660174560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">int kp_interlocked_increment(KP_INTERLOCKED *target);</pre>

<h5><a name="idp46253660175968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="" align="left" valign="top">Input/Output</td></tr></tbody></table></div>

<h5><a name="idp46253660184704"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to increment
  </td></tr></tbody></table></div>

<h5><a name="idp46253660192560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the new value of the interlocked counter (<code class="japi">target</code>).
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_decrement"></a>B.8.13.9. kp_interlocked_decrement()</h4></div></div></div>
<h5><a name="idp46253660196272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Decrements the value of a Kernel PlugIn interlocked counter by one.
</p>

<h5><a name="idp46253660197424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">int kp_interlocked_decrement(KP_INTERLOCKED *target);</pre>

<h5><a name="idp46253660198832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="" align="left" valign="top">Input/Output</td></tr></tbody></table></div>

<h5><a name="idp46253660207568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to decrement
  </td></tr></tbody></table></div>

<h5><a name="idp46253660215424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the new value of the interlocked counter (<code class="japi">target</code>).
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_add"></a>B.8.13.10. kp_interlocked_add()</h4></div></div></div>
<h5><a name="idp46253660219152"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Adds a specified value to the current value of a Kernel PlugIn interlocked
counter.
</p>

<h5><a name="idp46253660220560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">int kp_interlocked_add(
    KP_INTERLOCKED *target,
    int val);
</pre>

<h5><a name="idp46253660221984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660232288"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to which to add
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    The value to add to the interlocked counter (<code class="japi">target</code>)
  </td></tr></tbody></table></div>

<h5><a name="idp46253660241760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the new value of the interlocked counter (<code class="japi">target</code>).
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_read"></a>B.8.13.11. kp_interlocked_read()</h4></div></div></div>
<h5><a name="idp46253660245488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Reads to the value of a Kernel PlugIn interlocked counter.
</p>

<h5><a name="idp46253660246880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">int kp_interlocked_read(KP_INTERLOCKED *target);</pre>

<h5><a name="idp46253660248288"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660257024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">target</td><td style="" align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to read
  </td></tr></tbody></table></div>

<h5><a name="idp46253660264832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the value of the interlocked counter (<code class="japi">target</code>).
</p>
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_set"></a>B.8.13.12. kp_interlocked_set()</h4></div></div></div>
<h5><a name="idp46253660268560"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets the value of a Kernel PlugIn interlocked counter to the specified value.
</p>

<h5><a name="idp46253660269968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void kp_interlocked_set(
    KP_INTERLOCKED *target,
    int val);
</pre>

<h5><a name="idp46253660271392"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660281696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to set
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    The value to set for the interlocked counter (<code class="japi">target</code>)
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660291488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h4 class="title"><a name="kp_interlocked_exchange"></a>B.8.13.13. kp_interlocked_exchange()</h4></div></div></div>
<h5><a name="idp46253660294864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets the value of a Kernel PlugIn interlocked counter to the specified value
and returns the previous value of the counter.
</p>

<h5><a name="idp46253660296320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">int kp_interlocked_exchange(
    KP_INTERLOCKED *target,
    int val);
</pre>

<h5><a name="idp46253660297744"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_INTERLOCKED*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input/Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660308048"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">target</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Pointer to the Kernel PlugIn
    <a class="link" href="#KP_INTERLOCKED">interlocked counter</a><a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline> [B.8.13.1]</fo:inline></a> to exchange
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">val</td><td style="" align="left" valign="top">
    The new value to set for the interlocked counter (<code class="japi">target</code>)
  </td></tr></tbody></table></div>

<h5><a name="idp46253660317568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the previous value of the interlocked counter (<code class="japi">target</code>).
</p>
</div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="KPSTRUCT"></a>B.9. Kernel PlugIn Structure Reference</h2></div></div></div><p>
This section contains detailed information about the different Kernel PlugIn
related structures. <strong class="japib"><code>WD_XXX</code></strong> structures are used in user-mode
functions and <strong class="japib"><code>KP_XXX</code></strong> structures are used in kernel-mode
functions.
</p><p>
The Kernel PlugIn synchronization types are documented in
<a class="xref" href="#kp_sync_types" title="B.8.13.1. Kernel PlugIn Synchronization Types"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section B.8.13.1</fo:inline></a>.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_KERNEL_PLUGIN"></a>B.9.1. WD_KERNEL_PLUGIN</h3></div></div></div>
<p>
Defines a Kernel PlugIn open command.
</p>

<p>
This structure is used by the low&#65279;-&#65279;level <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span>
and <code class="jfunc">WD_KernelPlugInClose</code><span class="jfunc">()</span> functions &#8212; see the
<span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hKernelPlugIn</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Handle to a Kernel PlugIn</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcDriverName</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PCHAR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Name of Kernel PlugIn driver.<br>
    The name should be no longer than 12 characters and should not include the
    <span class="b"><strong>*.sys</strong></span> extension.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcDriverPath</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PCHAR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    This field should be set to NULL. WinDriver will search for the driver in the
    operating system's drivers/modules directory.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pOpenData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="" align="left" valign="top">
    Data to pass to the <span style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> callback in the Kernel PlugIn.
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_INTERRUPT"></a>B.9.2. WD_INTERRUPT</h3></div></div></div>
<p>
Interrupt information structure.
</p>

<p>
This structure is used by the low&#65279;-&#65279;level <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>,
<code class="jfunc">InterruptDisable</code><span class="jfunc">()</span>, <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span>,
<code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span>, <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> and
<code class="jfunc">WD_IntCount</code><span class="jfunc">()</span> functions.<br>
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span> calls <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>, which in turn
calls <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span>, <code class="jfunc">WD_IntWait</code><span class="jfunc">()</span> and
<code class="jfunc">WD_IntCount</code><span class="jfunc">()</span>. <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> calls
<code class="jfunc">InterruptDisable</code><span class="jfunc">()</span>, which calls <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span>.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">kpCall</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_KERNEL_ PLUGIN_CALL</td><td style="" align="left" valign="top">
    Kernel PlugIn message information structure<a class="xref" href="#WD_KERNEL_PLUGIN_CALL" title="B.9.3. WD_KERNEL_PLUGIN_CALL"><fo:inline> [B.9.3]</fo:inline></a>. This structure contains the handle to the
    Kernel PlugIn and additional information that should be passed to the
    kernel-mode interrupt handler. If the Kernel PlugIn handle is zero, the
    interrupt is installed without a Kernel PlugIn interrupt handler. If a
    valid Kernel PlugIn handle is set, this structure will passed as a
    parameter to the <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> Kernel PlugIn callback function.
  </td></tr></tbody></table></div>

<p>
For information about the other members of <code class="japi">WD_INTERRUPT</code>, see the
description of <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> in the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_KERNEL_PLUGIN_CALL"></a>B.9.3. WD_KERNEL_PLUGIN_CALL</h3></div></div></div>
<p>
Kernel PlugIn message information structure. This structure contains
information that will be passed between a user-mode process and the Kernel
PlugIn. The structure is used when passing messages to the Kernel PlugIn or
when installing a Kernel PlugIn interrupt.
</p>

<p>
This structure is passed as a parameter to the Kernel PlugIn
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> and <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> callback functions and is
used by the low&#65279;-&#65279;level <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span>,
<code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> and <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> functions.
<code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> is called from the high&#65279;-&#65279;level
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span>. <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>
(which calls <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span>) is called from the high&#65279;-&#65279;level
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span>.
</p>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hKernelPlugIn</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Handle to a Kernel PlugIn, returned by <code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span>
    (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) &#8212; which is called from
    <span style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span>, and from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline> [B.3.18]</fo:inline></a>)
    when called with the name of a Kernel PlugIn driver<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline> [12.5]</fo:inline></a>
    
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMessage</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Message ID to pass to the Kernel PlugIn</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">PVOID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to data to pass to the Kernel PlugIn</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwResult</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Value set by the Kernel PlugIn, to return back to user mode</td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_INIT"></a>B.9.4. KP_INIT</h3></div></div></div>
<p>
This structure is used by the Kernel PlugIn
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Init</code></span><span> function</span><a class="xref" href="#KP_Init" title="B.8.1. KP_Init"><fo:inline> [B.8.1]</fo:inline></a></span>. Its primary use is to notify WinDriver of
the given driver's name and of which kernel-mode function to call when
<code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>) is called from the
user mode.
</p>

<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top"><code class="jfunc">WD_KernelPlugInOpen</code><span class="jfunc">()</span> is called from the high&#65279;-&#65279;level
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_KernelPlugInOpen</code><span class="japi">()</span></span><a class="xref" href="#WDC_KernelPlugInOpen" title="B.3.22. WDC_KernelPlugInOpen()"><fo:inline> [B.3.22]</fo:inline></a></span> function.<br>
It is also called from the <code class="jfunc">WDC_xxxDeviceOpen</code><span class="jfunc">()</span> functions (PCI<a class="xref" href="#WDC_PciDeviceOpen" title="B.3.17. WDC_PciDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.17]</fo:inline></a> / 
    ISA<a class="xref" href="#WDC_IsaDeviceOpen" title="B.3.18. WDC_IsaDeviceOpen()"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.3.18]</fo:inline></a>) when these functions are called
with a valid Kernel PlugIn driver (set in the <code class="japi">pcKPDriverName</code>
parameter). However, to ensure the correct execution of your code in all
scenarios &#8212; including execution of a 32-&#65279;bit application with a 64-&#65279;bit
Kernel PlugIn driver &#8212; do not use the device-open functions to open a
handle to the Kernel PlugIn driver.
</td></tr></table></div>

<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwVerWD</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The version of the WinDriver Kernel PlugIn library.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">cDriverName</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">CHAR[12]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The device driver name, up to 12 characters.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcOpen</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_OPEN</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Standard <span style=""><span style=""><code class="japi">KP_Open</code></span><span> callback function</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>, which will be
    called when a user-mode application opens a handle to a Kernel PlugIn
    driver<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline> [12.5]</fo:inline></a>, except when opening a handle to a
    64-&#65279;bit driver from a 32-&#65279;bit application (in which case
    <strong class="japib"><code>funcOpen_32_64</code></strong> will be used).
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">funcOpen_32_64</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_FUNC_OPEN</td><td style="" align="left" valign="top">
    <span style=""><span style=""><code class="japi">KP_Open</code></span><span> callback function</span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> that will be called when a
    32-&#65279;bit application opens a handle to a 64-&#65279;bit Kernel PlugIn driver<a class="xref" href="#kp_handle_open" title="12.5. Open a Handle to the Kernel PlugIn"><fo:inline> [12.5]</fo:inline></a>, except for a 32-&#65279;bit application request to open a
    handle to a 64-&#65279;bit driver (when <strong class="japib"><code>funcOpen_32_64</code></strong> will be
    used)<a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a>.
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="KP_OPEN_CALL"></a>B.9.5. KP_OPEN_CALL</h3></div></div></div><p>
This is the structure through which the Kernel PlugIn defines the names of its
callback functions (other than <code class="japi">KP_Open</code>). It is used from the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span> Kernel PlugIn function, which sets the callbacks in the
structure.
</p><p>
A Kernel PlugIn may implement the following callback functions (other than
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">KP_Open</code></span><a class="xref" href="#KP_Open" title="B.8.2. KP_Open"><fo:inline> [B.8.2]</fo:inline></a></span>):

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcClose</strong></span> &#8212; Called when the user-mode process is done with this
    instance of the driver.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcCall</strong></span> &#8212; Called when the user mode process calls
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_CallKerPlug</code><span class="japi">()</span></span><a class="xref" href="#WDC_CallKerPlug" title="B.3.23. WDC_CallKerPlug()"><fo:inline> [B.3.23]</fo:inline></a></span>, or the low&#65279;-&#65279;level
    <code class="jfunc">WD_KernelPlugInCall</code><span class="jfunc">()</span> function (see the <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>),
    which is called from <code class="jfunc">WDC_CallKerPlug</code><span class="jfunc">()</span>.<br>
    This is a general-purpose function. You can use it to implement any
    functionality that should run in kernel mode (except the interrupt
    handler, which is a special case). The <code class="japi">funcCall</code> callback
    determines which function to execute according to the message passed to
    it from the user mode.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntEnable</strong></span> &#8212; Called when the user-mode process calls
    <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> with a Kernel PlugIn handle.
    <code class="jfunc">WD_IntEnable</code><span class="jfunc">()</span> is called from <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span>
    (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which is called from the high&#65279;-&#65279;level
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntEnable</code><span class="japi">()</span></span><span> function</span><a class="xref" href="#WDC_IntEnable" title="B.3.48. WDC_IntEnable()"><fo:inline> [B.3.48]</fo:inline></a></span>. When calling
    <code class="jfunc">WDC_IntEnable</code><span class="jfunc">()</span> with <code class="japi">fUseKP = TRUE</code>, the function
    calls <code class="jfunc">InterruptEnable</code><span class="jfunc">()</span> with a Kernel PlugIn handle.<br>
    This callback function should perform any initialization required when
    enabling an interrupt.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntDisable</strong></span> &#8212; Interrupt cleanup function, which is called
    when the user-mode process calls <code class="jfunc">WD_IntDisable</code><span class="jfunc">()</span> &#8212;
    called from <code class="jfunc">InterruptDisable</code><span class="jfunc">()</span> (see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>), which
    is called from <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_IntDisable</code><span class="japi">()</span></span><a class="xref" href="#WDC_IntDisable" title="B.3.49. WDC_IntDisable()"><fo:inline> [B.3.49]</fo:inline></a></span> &#8212; after having enabled
    interrupts using a Kernel PlugIn driver.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntAtIrql</strong></span> &#8212; High-priority kernel-mode legacy interrupt
    handler. This callback function is called at high interrupt request level
    when WinDriver processes a legacy interrupt that is assigned to this Kernel
    PlugIn. If this function returns a value greater than zero, the
    <code class="jfunc">funcIntAtDpc</code><span class="jfunc">()</span> callback is called as a Deferred Procedure Call (DPC).
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntAtDpc</strong></span> &#8212; Most of your legacy interrupt handler code
    should be written in this callback. It is called as a Deferred Procedure Call (DPC) if
    <code class="jfunc">funcIntAtIrql</code><span class="jfunc">()</span> returned a value greater than zero.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntAtIrqlMSI</strong></span> &#8212; High-priority kernel-mode PCI Message-Signaled Interrupts
    (MSI) and Extended Message-Signaled Interrupts (MSI-&#65279;X) handler. This callback function is called
    at high interrupt request level when WinDriver processes an MSI/MSI-&#65279;X that
    is assigned to this Kernel PlugIn. If this function returns a value greater
    than zero, the <code class="jfunc">funcIntAtDpcMSI</code><span class="jfunc">()</span> callback is called as a
    Deferred Procedure Call (DPC).<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcIntAtDpcMSI</strong></span> &#8212; Most of your PCI MSI/MSI-&#65279;X handler code
    should be written in this callback. It is called as a Deferred Procedure Call (DPC) if
    <code class="jfunc">funcIntAtIrqlMSI</code><span class="jfunc">()</span> returned a value greater than zero.<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
    </li><li class="listitem" style="list-style-type: disc">
    <span class="b"><strong>funcEvent</strong></span> &#8212; Called when a Plug&#65279;-&#65279;and&#65279;-&#65279;Play or power management event
    occurs, if the user-mode process first called
    <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDC_EventRegister</code><span class="japi">()</span></span><a class="xref" href="#WDC_EventRegister" title="B.3.52. WDC_EventRegister()"><fo:inline> [B.3.52]</fo:inline></a></span> with <code class="japi">fUseKP = TRUE</code> (or if the
    low&#65279;-&#65279;level <code class="jfunc">EventRegister</code><span class="jfunc">()</span> function was called with a
    Kernel PlugIn handle &#8212; see <span class="jprintfilename"><strong>WinDriver PCI Low&#65279;-&#65279;Level API Reference</strong></span>). This callback
    function should implement the desired kernel handling for Plug&#65279;-&#65279;and&#65279;-&#65279;Play and power
    management events.
    </li></ul></div><p>
</p><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Field</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcClose</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_CLOSE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Name of your <span style=""><span style=""><code class="japi">KP_Close</code></span><a class="xref" href="#KP_Close" title="B.8.3. KP_Close"><fo:inline> [B.8.3]</fo:inline></a></span> function in the kernel.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcCall</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_CALL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Name of your <span style=""><span style=""><code class="japi">KP_Call</code></span><a class="xref" href="#KP_Call" title="B.8.4. KP_Call"><fo:inline> [B.8.4]</fo:inline></a></span> function in the kernel.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntEnable</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_ENABLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Name of your <span style=""><span style=""><code class="japi">KP_IntEnable</code></span><a class="xref" href="#KP_IntEnable" title="B.8.6. KP_IntEnable"><fo:inline> [B.8.6]</fo:inline></a></span> function in the kernel.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntDisable</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_DISABLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Name of your <span style=""><span style=""><code class="japi">KP_IntDisable</code></span><a class="xref" href="#KP_IntDisable" title="B.8.7. KP_IntDisable"><fo:inline> [B.8.7]</fo:inline></a></span> function in the kernel.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntAtIrql</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_AT_IRQL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Name of your <span style=""><span style=""><code class="japi">KP_IntAtIrql</code></span><a class="xref" href="#KP_IntAtIrql" title="B.8.8. KP_IntAtIrql"><fo:inline> [B.8.8]</fo:inline></a></span> function in the kernel.</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntAtDpc</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_AT_DPC</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Name of your <span style=""><span style=""><code class="japi">KP_IntAtDpc</code></span><a class="xref" href="#KP_IntAtDpc" title="B.8.9. KP_IntAtDpc"><fo:inline> [B.8.9]</fo:inline></a></span> function in the kernel.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntAtIrqlMSI</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_AT_IRQL_MSI</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Name of your <span style=""><span style=""><code class="japi">KP_IntAtIrqlMSI</code></span><a class="xref" href="#KP_IntAtIrqlMSI" title="B.8.10. KP_IntAtIrqlMSI"><fo:inline> [B.8.10]</fo:inline></a></span> function in the kernel.<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">funcIntAtDpcMSI</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">KP_FUNC_INT_AT_DPC_MSI</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Name of your <span style=""><span style=""><code class="japi">KP_IntAtDpcMSI</code></span><a class="xref" href="#KP_IntAtDpcMSI" title="B.8.11. KP_IntAtDpcMSI"><fo:inline> [B.8.11]</fo:inline></a></span> function in the kernel.<br>
    Note: MSI/MSI-&#65279;X is supported on Linux and Windows 7 and higher.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">funcEvent</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">KP_FUNC_EVENT</td><td style="" align="left" valign="top">Name of your <span style=""><span style=""><code class="japi">KP_Event</code></span><a class="xref" href="#KP_Event" title="B.8.5. KP_Event"><fo:inline> [B.8.5]</fo:inline></a></span> function in the kernel.</td></tr></tbody></table></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Function_Reference_Utils"></a>B.10. User-Mode Utility Functions</h2></div></div></div><p>
This section describes a number of user-mode utility functions you will find
useful for implementing various tasks. These utility functions are
multi-platform, implemented on all operating systems supported by WinDriver.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="Stat2Str"></a>B.10.1. Stat2Str</h3></div></div></div>
<h5><a name="idp46253660540816"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves the status string that corresponds to a status code.
</p>

<h5><a name="idp46253660541968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>

<pre class="screen">const char *Stat2Str(DWORD dwStatus);</pre>

<h5><a name="idp46253660543360"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwStatus</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660552096"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwStatus</span></td><td style="" align="left" valign="top">A numeric status code</td></tr></tbody></table></div>

<h5><a name="idp46253660559584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the verbal status description (string) that corresponds to the
specified numeric status code.
</p>

<h5><a name="idp46253660560768"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
See <a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section B.11</fo:inline></a> for a complete list of status codes
and strings.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="get_os_type"></a>B.10.2. get_os_type</h3></div></div></div>
<h5><a name="idp46253660565072"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Retrieves the type of the operating system.
</p>

<h5><a name="idp46253660566208"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">OS_TYPE get_os_type(void);</pre>

<h5><a name="idp46253660567600"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
Returns the type of the operating system.<br>
If the operating system type is not detected, returns
<code class="japi">OS_CAN_NOT_DETECT</code>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="check_secureBoot_enabled"></a>B.10.3. check_secureBoot_enabled</h3></div></div></div>
<h5><a name="idp46253660571616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Checks whether the Secure Boot feature is enabled on the system.
Developing drivers while Secure Boot is enabled can result in driver installation problems.
</p>
<h5><a name="idp46253660572864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD check_secureBoot_enabled(void);</pre>
<h5><a name="idp46253660574256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
<p>
    <code class="japi">WD_STATUS_SUCCESS</code> (0) when Secure Boot is enabled.
    <code class="japi">WD_WINDRIVER_STATUS_ERROR</code> when Secure Boot is disabled.
    Any other status when Secure Boot is not supported.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ThreadStart"></a>B.10.4. ThreadStart</h3></div></div></div>
<h5><a name="idp46253660578480"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Creates a thread.
</p>

<h5><a name="idp46253660579584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD ThreadStart(
    HANDLE *phThread,
    HANDLER_FUNC pFunc,
    void *pData);
</pre>

<h5><a name="idp46253660581024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phThread</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">HANDLE*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pFunc</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    typedef void (*HANDLER_FUNC)(<br>
    &#8194; void *pData);
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">VOID*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660593312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">phThread</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Returns the handle to the created thread</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pFunc</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Starting address of the code that the new thread is to execute. (The
    handler's prototype &#8212;
    <span><code class="japi">HANDLER_FUNC</code> &#8212;  is defined
    in <span class="jprintfilename"><strong>utils.h</strong></span>.</span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="" align="left" valign="top">Pointer to the data to be passed to the new thread</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660604400"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="ThreadWait"></a>B.10.5. ThreadWait</h3></div></div></div>
<h5><a name="idp46253660608784"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Waits for a thread to exit.
</p>

<h5><a name="idp46253660609904"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void ThreadWait(HANDLE hThread);</pre>

<h5><a name="idp46253660611296"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hThread</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660620032"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hThread</td><td style="" align="left" valign="top">The handle to the thread whose completion is awaited</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660627040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsEventCreate"></a>B.10.6. OsEventCreate</h3></div></div></div>
<h5><a name="idp46253660630368"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Creates an event object.
</p>

<h5><a name="idp46253660631488"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsEventCreate(HANDLE *phOsEvent);</pre>

<h5><a name="idp46253660632880"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">phOsEvent</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253660641616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">phOsEvent</td><td style="" align="left" valign="top">
    The pointer to a variable that receives a handle to the newly created event
    object
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660648672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsEventClose"></a>B.10.7. OsEventClose</h3></div></div></div>
<h5><a name="idp46253660653056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Closes a handle to an event object.
</p>

<h5><a name="idp46253660654176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void OsEventClose(HANDLE hOsEvent);</pre>

<h5><a name="idp46253660655568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660664304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="" align="left" valign="top">The handle to the event object to be closed</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660671312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsEventWait"></a>B.10.8. OsEventWait</h3></div></div></div>
<h5><a name="idp46253660674640"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Waits until a specified event object is in the signaled state or the time-out
interval elapses.
</p>

<h5><a name="idp46253660675824"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsEventWait(
    HANDLE hOsEvent,
    DWORD dwSecTimeout);
</pre>

<h5><a name="idp46253660677248"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwSecTimeout</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660687616"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">The handle to the event object</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">dwSecTimeout</td><td style="" align="left" valign="top">
    Time-out interval of the event, in seconds. <br>
    For an infinite wait, set the timeout to <code class="japi">INFINITE</code>.
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660697040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsEventSignal"></a>B.10.9. OsEventSignal</h3></div></div></div>
<h5><a name="idp46253660701424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sets the specified event object to the signaled state.
</p>

<h5><a name="idp46253660702576"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsEventSignal(HANDLE hOsEvent);</pre>

<h5><a name="idp46253660703968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660712704"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="" align="left" valign="top">The handle to the event object</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660719696"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsEventReset"></a>B.10.10. OsEventReset</h3></div></div></div>
<h5><a name="idp46253660724080"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Resets the specified event object to the non-signaled state.
</p>

<h5><a name="idp46253660725232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsEventReset(HANDLE hOsEvent);</pre>

<h5><a name="idp46253660726624"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660735360"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsEvent</td><td style="" align="left" valign="top">The handle to the event object</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660742352"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsMutexCreate"></a>B.10.11. OsMutexCreate</h3></div></div></div>
<h5><a name="idp46253660746736"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Creates a mutex object.
</p>

<h5><a name="idp46253660747856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsMutexCreate(HANDLE *phOsMutex);</pre>

<h5><a name="idp46253660749248"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">phOsMutex</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE*</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253660757984"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">phOsMutex</td><td style="" align="left" valign="top">
    The pointer to a variable that receives a handle to the newly created mutex
    object
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660765040"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsMutexClose"></a>B.10.12. OsMutexClose</h3></div></div></div>
<h5><a name="idp46253660769424"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Closes a handle to a mutex object.
</p>

<h5><a name="idp46253660770544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void OsMutexClose(HANDLE hOsMutex);</pre>

<h5><a name="idp46253660771936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660780672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="" align="left" valign="top">The handle to the mutex object to be closed</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660787680"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsMutexLock"></a>B.10.13. OsMutexLock</h3></div></div></div>
<h5><a name="idp46253660791008"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Locks the specified mutex object.
</p>

<h5><a name="idp46253660792128"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsMutexLock(HANDLE hOsMutex);</pre>

<h5><a name="idp46253660793520"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660802256"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="" align="left" valign="top">The handle to the mutex object to be locked</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660809264"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="OsMutexUnlock"></a>B.10.14. OsMutexUnlock</h3></div></div></div>
<h5><a name="idp46253660813648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Releases (unlocks) a locked mutex object.
</p>

<h5><a name="idp46253660814784"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD OsMutexUnlock(HANDLE hOsMutex);</pre>

<h5><a name="idp46253660816176"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">HANDLE</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660824912"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">hOsMutex</td><td style="" align="left" valign="top">The handle to the mutex object to be unlocked</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660831920"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="PrintDbgMessage"></a>B.10.15. PrintDbgMessage</h3></div></div></div>
<h5><a name="idp46253660836304"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sends debug messages to the Debug Monitor.
</p>

<h5><a name="idp46253660837440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">void PrintDbgMessage(
    DWORD dwLevel,
    DWORD dwSection,
    const char *format
    [, argument]...);
</pre>

<h5><a name="idp46253660838912"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLevel</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwSection</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const char*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="border-right: 0.5pt solid ; " align="left" valign="top"> </td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660852384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwLevel</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Assigns the level in the Debug Monitor, in which the data will be declared.
    If zero, <code class="japi">D_ERROR</code> will be declared.<br>
    For more details please refer to <code class="japi">DEBUG_LEVEL</code> in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwSection</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Assigns the section in the Debug Monitor, in which the data will be
    declared. If zero, <code class="japi">S_MISC</code> will be declared.<br>
    For more details please refer to DEBUG_SECTION in
    <span class="jprintfilename"><strong>windrvr.h</strong></span>.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">format</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Format-control string</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="" align="left" valign="top">Optional arguments, limited to 256 bytes</td></tr></tbody></table></div>



  
  <h5><a name="idp46253660866624"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_LogStart"></a>B.10.16. WD_LogStart</h3></div></div></div>
<h5><a name="idp46253660869856"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Opens a log file.
</p>

<h5><a name="idp46253660870960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD WD_LogStart(
    const char *sFileName,
    const char *sMode);
</pre>

<h5><a name="idp46253660872384"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sFileName</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const char*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sMode</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">const char*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660882752"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sFileName</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Name of log file to be opened</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">sMode</td><td style="" align="left" valign="top">
    Type of access permitted.<br>
    For example, NULL or <span class="b"><strong>w</strong></span> opens an empty file for writing, and if the
    given file exists, its contents are destroyed;<br>
    <span class="b"><strong>a</strong></span> opens a file for writing at the end of the file (i.e., append).
  </td></tr></tbody></table></div>


  
  <h5><a name="idp46253660892544"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  

<h5><a name="idp46253660894832"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<p>
Once a log file is opened, all API calls are logged in this file.<br>
You may add your own printouts to the log file by calling
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WD_LogAdd</code><span class="japi">()</span></span><a class="xref" href="#WD_LogAdd" title="B.10.18. WD_LogAdd"><fo:inline> [B.10.18]</fo:inline></a></span>.
</p>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_LogStop"></a>B.10.17. WD_LogStop</h3></div></div></div>
<h5><a name="idp46253660900928"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Closes a log file.
</p>

<h5><a name="idp46253660902032"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">VOID WD_LogStop(void);</pre>


  
  <h5><a name="idp46253660903664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  None
  </p>
  
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WD_LogAdd"></a>B.10.18. WD_LogAdd</h3></div></div></div>
<h5><a name="idp46253660906992"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Adds user printouts into log file.
</p>

<h5><a name="idp46253660908112"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">VOID DLLCALLCONV WD_LogAdd(
    const char *sFormat
    [, argument ]...);
</pre>

<h5><a name="idp46253660909552"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sFormat</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const char*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="border-right: 0.5pt solid ; " align="left" valign="top"> </td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253660919760"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">sFormat</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Format-control string</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">argument</td><td style="" align="left" valign="top">Optional format arguments</td></tr></tbody></table></div>


  
  <h5><a name="idp46253660927968"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
</div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="Status_Strings"></a>B.11. WinDriver Status Codes</h2></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_status_codes_intro"></a>B.11.1. Introduction</h3></div></div></div><p>
Most of the WinDriver functions return a status code, where zero
(<code class="japi">WD_STATUS_SUCCESS</code>) means success and a non-zero value means
failure.<br>
The <code class="jfunc">Stat2Str</code><span class="jfunc">()</span> functions can be used to retrieve the status
description string for a given status code. The status codes and their
descriptive strings are listed below.
</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="wd_status_codes"></a>B.11.2. Status Codes Returned by WinDriver</h3></div></div></div><div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Status Code</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_STATUS_SUCCESS</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Success</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_STATUS_INVALID_WD_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Invalid WinDriver handle</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_WINDRIVER_STATUS_ERROR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Error</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INVALID_HANDLE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Invalid handle</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INVALID_PIPE_NUMBER</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Invalid pipe number</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_READ_WRITE_CONFLICT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Conflict between read and write operations</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_ZERO_PACKET_SIZE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Packet size is zero</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INSUFFICIENT_RESOURCES</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Insufficient resources</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_UNKNOWN_PIPE_TYPE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Unknown pipe type</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_SYSTEM_INTERNAL_ERROR</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Internal system error</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_DATA_MISMATCH</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Data mismatch</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_NO_LICENSE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">No valid license</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_NOT_IMPLEMENTED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Function not implemented</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_KERPLUG_FAILURE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Kernel PlugIn failure</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_FAILED_ENABLING_INTERRUPT</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Failed enabling interrupt</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INTERRUPT_NOT_ENABLED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Interrupt not enabled</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_RESOURCE_OVERLAP</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Resource overlap</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_DEVICE_NOT_FOUND</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Device not found</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_WRONG_UNIQUE_ID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Wrong unique ID</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_OPERATION_ALREADY_DONE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Operation already done</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_SET_CONFIGURATION_FAILED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Set configuration operation failed</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_CANT_OBTAIN_PDO</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Cannot obtain PDO</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TIME_OUT_EXPIRED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Timeout expired</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_IRP_CANCELED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">IRP operation canceled</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_FAILED_USER_MAPPING</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Failed to map in user space</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_FAILED_KERNEL_MAPPING</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Failed to map in kernel space</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_NO_RESOURCES_ON_DEVICE</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">No resources on the device</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_NO_EVENTS</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">No events</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INVALID_PARAMETER</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Invalid parameter</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INCORRECT_VERSION</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Incorrect WinDriver version installed</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TRY_AGAIN</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Try again</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INVALID_IOCTL</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Received an invalid IOCTL</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_OPERATION_FAILED</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Operation failed</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_INVALID_32BIT_APP</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Received an invalid 32-&#65279;bit IOCTL</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_TOO_MANY_HANDLES</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">No room to add handle</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">WD_NO_DEVICE_OBJECT</td><td style="" align="left" valign="top">Driver not installed</td></tr></tbody></table></div></div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="windriver_ipc"></a>Appendix C. WinDriver IPC</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WD_IPC_overview"></a>C.1. WinDriver IPC Overview</h2></div></div></div><p>
This section describes how to use WinDriver to perform Inter-Process Communication.
WinDriver IPC allows several WinDriver-based user applications to send and receive
user defined messages.
</p><p>
You should define a group ID that will be used by all your applications, and 
optionally you can also define several sub-group IDs to differentiate between different types of applications. For example, define one sub-group ID for
operational applications, and another sub-group ID for monitoring or debug 
applications. This will enable you to send messages only to one type of 
application. 
</p><p>
An IPC message can be sent in three ways:
</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Multicast - The message will be sent to all processes that were registered
    with the same group ID.
  </li><li class="listitem" style="list-style-type: disc">
    Sub-group Multicast - The message will be sent to all processes that were 
    registered with the same sub-group ID.
  </li><li class="listitem" style="list-style-type: disc">
    Unicast (By WinDriver IPC unique ID) - The message will be sent to one 
    specific process.
  </li></ul></div><p>
</p><p>
In order to start working with WinDriver IPC each user application must first 
register by calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcRegister</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcRegister" title="C.2.2. WDS_IpcRegister()"><fo:inline> [C.2.2]</fo:inline></a></span>. It must provide a group ID 
and a sub-group ID and can optionally provides callback function to receive 
incoming messages.
</p><p>
WinDriver IPC unique ID is received either in the result of 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcScanProcs</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcScanProcs" title="C.2.5. WDS_IpcScanProcs()"><fo:inline> [C.2.5]</fo:inline></a></span> or in the message received by the callback 
function. 
</p><p>
Multicast messages may be sent by calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcMulticast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcMulticast" title="C.2.6. WDS_IpcMulticast()"><fo:inline> [C.2.6]</fo:inline></a></span> or 
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcSubGroupMulticast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcSubGroupMulticast" title="C.2.7. WDS_IpcSubGroupMulticast()"><fo:inline> [C.2.7]</fo:inline></a></span>, while unicast messages may be sent by 
WinDriver IPC unique ID by calling <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcUidUnicast</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcUidUnicast" title="C.2.8. WDS_IpcUidUnicast()"><fo:inline> [C.2.8]</fo:inline></a></span>.
</p><p>
Query of current registered processes can be done using
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcScanProcs</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcScanProcs" title="C.2.5. WDS_IpcScanProcs()"><fo:inline> [C.2.5]</fo:inline></a></span>.
</p></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="WDS_IPC_API_reference"></a>C.2. WinDriver IPC API Reference</h2></div></div></div><p>
This section describes the WinDriver IPC API defined in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jprintfilename"><strong>WinDriver/include/wds_lib.h</strong></span></span>
header file.
</p><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="IPC_MSG_RX_HANDLER"></a>C.2.1. IPC_MSG_RX_HANDLER()</h3></div></div></div>
<h5><a name="idp46253661018320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
WinDriver IPC message handler callback. 
</p>

<h5><a name="idp46253661019840"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">typedef void (*IPC_MSG_RX_HANDLER)(
    WDS_IPC_MSG_RX *pIpcRxMsg,
    void *pData);
</pre>

<h5><a name="idp46253661021664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIpcRxMsg</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDS_IPC_MSG_RX *</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwSenderUID</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwMsgID</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">qwMsgData</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">void *</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253661039584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pIpcRxMsg</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Pointer to the received IPC message</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwSenderUID</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">WinDriver IPC unique ID of the sending process</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwMsgID</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A 32 bit unique number defined by the user application. This number should 
    be known to all user-applications that work under WinDriver IPC and share the
    same group ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">qwMsgData</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Optional - 64 bit additional data from the sending user-application process
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="" align="left" valign="top">
    Application specific data opaque as passed to <span style=""><span style=""><code class="japi">WDS_IpcRegister</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcRegister" title="C.2.2. WDS_IpcRegister()"><fo:inline> [C.2.2]</fo:inline></a></span>
  </td></tr></tbody></table></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcRegister"></a>C.2.2. WDS_IpcRegister()</h3></div></div></div>
<h5><a name="idp46253661058448"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Registers an application with WinDriver IPC.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661060944"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcRegister(
    const CHAR *pcProcessName,
    DWORD dwGroupID,
    DWORD dwSubGroupID,
    DWORD dwAction,
    IPC_MSG_RX_HANDLER pFunc,
    void *pData);
</pre>

<h5><a name="idp46253661062864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcProcessName</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">const CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwGroupID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwSubGroupID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAction</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pFunc</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">
    see <span style=""><span style=""><code class="japi">IPC_MSG_RX_HANDLER</code><span class="japi">()</span></span><a class="xref" href="#IPC_MSG_RX_HANDLER" title="C.2.1. IPC_MSG_RX_HANDLER()"><fo:inline> [C.2.1]</fo:inline></a></span>
  </td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">void*</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253661082656"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pcProcessName</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Optional process name string</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwGroupID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A unique group ID represent the specific application. Must be a positive ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwSubGroupID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Sub-group ID that should identify your user application type in case you 
    have several types that may work simultaneously. Must be a positive ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwAction</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
  <p>
    IPC message type to receive, which can consist one of the enumeration values
    listed below:
  </p>
  <p>
  
    &#8226; <strong class="japib"><code>WD_IPC_UNICAST_MSG</code></strong>:  <br>
  
  
    &#8226; <strong class="japib"><code>WD_IPC_MULTICAST_MSG</code></strong>:  <br>
  
  
    &#8226; <strong class="japib"><code>WD_IPC_ALL_MSG</code></strong>:    <br> 
  
  </p>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">pFunc</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A user-mode IPC message handler callback function, which will be called when
    a message was received by WinDriver from a different process (see
    <strong class="japib"><code>dwActions</code></strong>) occurs. (See <span style=""><span style=""><code class="japi">IPC_MSG_RX_HANDLER</code><span class="japi">()</span></span><a class="xref" href="#IPC_MSG_RX_HANDLER" title="C.2.1. IPC_MSG_RX_HANDLER()"><fo:inline> [C.2.1]</fo:inline></a></span>)
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">pData</td><td style="" align="left" valign="top">
    Data for the user-mode IPC message handler callback routine
    (<strong class="japib"><code>pFunc</code></strong>)
  </td></tr></tbody></table></div>

  <h5><a name="idp46253661104320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  
<h5><a name="idp46253661106864"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Remarks</span></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    You should choose your user applications a unique group ID parameter. This
    is done as a precaution to prevent several applications that use WinDriver
    with its default driver name (windrvrXXXX) to get mixing messages. We
    strongly recommend that you rename your driver before distributing it to
    avoid this issue entirely, among other issue (See 
    <a class="xref" href="#wd_rename_driver" title="15.2. Renaming the WinDriver Kernel Driver"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format">Section 15.2</fo:inline></a> on renaming you driver name).
  </li><li class="listitem" style="list-style-type: disc">
    The sub-group id parameter should identify your user application type in
    case you have several types that may work simultaneously.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcUnRegister"></a>C.2.3. WDS_IpcUnRegister()</h3></div></div></div>
<h5><a name="idp46253661112528"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
This function enables the user application to unregister with WinDriver IPC.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661115056"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcUnRegister(void);
</pre>

  <h5><a name="idp46253661116848"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IsIpcRegistered"></a>C.2.4. WDS_IsIpcRegistered()</h3></div></div></div>
<h5><a name="idp46253661121120"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Enables the application to check if it is already registered with WinDriver IPC.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661123648"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IsIpcRegistered(void);
</pre>

  <h5><a name="idp46253661125440"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">TRUE</code> if successful; otherwise returns <code class="japi">FALSE</code>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcScanProcs"></a>C.2.5. WDS_IpcScanProcs()</h3></div></div></div>
<h5><a name="idp46253661129584"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Scans and returns information of all registered processes that share the 
application process groupID (as was given to <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style=""><span style=""><code class="japi">WDS_IpcRegister</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcRegister" title="C.2.2. WDS_IpcRegister()"><fo:inline> [C.2.2]</fo:inline></a></span> or a
specific groupID.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661134672"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcScanProcs(
    DWORD dwGroupID,
    WDS_IPC_SCAN_RESULT *ipcScanProcs);
</pre>

<h5><a name="idp46253661136512"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwGroupID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ipcScanProcs</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WDS_IPC_SCAN_RESULT*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwNumProcs</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">procInfo</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">WD_IPC_PROCESS[]</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">cProcessName</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">CHAR*</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwSubGroupID</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwGroupID</span></td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Output</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top"> * <span style="">hIpc</span></td><td style="border-right: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="" align="left" valign="top">Output</td></tr></tbody></table></div>

<h5><a name="idp46253661161664"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwGroupID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    0 - Scan processes that share the current process group ID.
    Other - Scan for all processes that registered with the specific group ID.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">ipcScanProcs</td><td class="auto-generated" style="border-bottom: 0.5pt solid ; "> </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">dwNumProcs</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Number of matching processes</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">&#8226; <span style="">procInfo</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">An array of matching processes[]</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">cProcessName</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Matched process name</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwSubGroupID</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Unique identifier of the process sub-group</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"> * <span style="">dwGroupID</span></td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
  Unique identifier of the processes group for discarding unrelated processes
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top"> * <span style="">hIpc</span></td><td style="" align="left" valign="top">
    IPC handle as returned by the low&#65279;-&#65279;level
    <code class="jfunc">WD_IpcRegister</code><span class="jfunc">()</span> function
  </td></tr></tbody></table></div>

  <h5><a name="idp46253661182272"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcMulticast"></a>C.2.6. WDS_IpcMulticast()</h3></div></div></div>
<h5><a name="idp46253661186592"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sends a message to all processes that were registered with the same group ID as
the sending process. The message won't be sent to the sending process.
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661189200"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcMulticast(
    DWORD dwMsgID,
    UINT64 qwMsgData);
</pre>

<h5><a name="idp46253661191024"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253661201776"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A 32 bit unique number defined by the user application. This number should 
    be known to all user-applications that work under WinDriver IPC and share the
    same group ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="" align="left" valign="top">
    Optional - 64 bit additional data from the sending user-application
  </td></tr></tbody></table></div>

  <h5><a name="idp46253661210320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcSubGroupMulticast"></a>C.2.7. WDS_IpcSubGroupMulticast()</h3></div></div></div>
<h5><a name="idp46253661214576"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sends a message to all processes that registered with the same sub-group ID
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661217104"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcSubGroupMulticast(
    DWORD dwRecipientSubGroupID,
    DWORD dwMsgID,
    UINT64 qwMsgData);
</pre>

<h5><a name="idp46253661218960"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwRecipientSubGroupID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253661231344"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwRecipientSubGroupID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    Recipient sub-group ID that should identify your user application type in 
    case you have several types that may work simultaneously.
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A 32 bit unique number defined by the user application. This number should 
    be known to all user-applications that work under WinDriver IPC and share the
    same group ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="" align="left" valign="top">
    Optional - 64 bit additional data from the sending user-application
  </td></tr></tbody></table></div>

  <h5><a name="idp46253661241232"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a name="WDS_IpcUidUnicast"></a>C.2.8. WDS_IpcUidUnicast()</h3></div></div></div>
<h5><a name="idp46253661245568"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Purpose</span></div>
<p>
Sends a message to a specific process with WinDriver IPC unique ID 
</p>
<div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  This API is not part of the standard WinDriver APIs, and is not included in
  the standard version of WinDriver. It is part of 
  "WinDriver for Server" API and requires 
  "WinDriver for Server" license. Note that 
  "WinDriver for Server" APIs are included in WinDriver evaluation 
  version.
  </td></tr></table></div>
<h5><a name="idp46253661248080"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Prototype</span></div>
<pre class="screen">DWORD DLLCALLCONV WDS_IpcUidUnicast(
    DWORD dwRecipientUID,
    DWORD dwMsgID,
    UINT64 qwMsgData);
</pre>

<h5><a name="idp46253661249936"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Parameters</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"><col align="left" class="col3"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Type</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Input/Output</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwRecipientUID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">DWORD</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">Input</td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="border-right: 0.5pt solid ; " align="left" valign="top">UINT64</td><td style="" align="left" valign="top">Input</td></tr></tbody></table></div>

<h5><a name="idp46253661262320"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Description</span></div>
<div class="informaltable"><table cellpadding="6px" style="border-collapse: collapse;border-top: 0.5pt solid ; border-bottom: 0.5pt solid ; border-left: 0.5pt solid ; border-right: 0.5pt solid ; "><colgroup><col align="left" class="col1"><col align="left" class="col2"></colgroup><thead><tr xmlns:fo="http://www.w3.org/1999/XSL/Format" bgcolor="#EEEEEE"><th style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Name</strong></span></th><th style="border-bottom: 0.5pt solid ; " align="left" valign="top"><span class="b"><strong>Description</strong></span></th></tr></thead><tbody><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwRecipientUID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    WinDriver IPC unique ID that should identify one of your user application. 
    The reciepient UID can be obtained from the result of 
    <span style=""><span style=""><code class="japi">WDS_IpcScanProcs</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcScanProcs" title="C.2.5. WDS_IpcScanProcs()"><fo:inline> [C.2.5]</fo:inline></a></span> or the sender ID as received in the callback
    registered in <span style=""><span style=""><code class="japi">WDS_IpcRegister</code><span class="japi">()</span></span><a class="xref" href="#WDS_IpcRegister" title="C.2.2. WDS_IpcRegister()"><fo:inline> [C.2.2]</fo:inline></a></span>
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; border-bottom: 0.5pt solid ; " align="left" valign="top">dwMsgID</td><td style="border-bottom: 0.5pt solid ; " align="left" valign="top">
    A 32 bit unique number defined by the user application. This number should 
    be known to all user-applications that work under WinDriver IPC and share the
    same group ID
  </td></tr><tr xmlns:fo="http://www.w3.org/1999/XSL/Format"><td style="border-right: 0.5pt solid ; " align="left" valign="top">qwMsgData</td><td style="" align="left" valign="top">
    Optional - 64 bit additional data from the sending user-application
  </td></tr></tbody></table></div>

  <h5><a name="idp46253661277312"></a></h5><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.33em"><span class="bridgehead">Return Value</span></div>
  <p>
  Returns <code class="japi">WD_STATUS_SUCCESS</code> (0) on success, or an appropriate
  error code otherwise<a class="xref" href="#Status_Strings" title="B.11. WinDriver Status Codes"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [B.11]</fo:inline></a>.
  </p>
  </div></div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="troubleshooting_n_support"></a>Appendix D. Troubleshooting and Support</h1></div></div></div><p>
Please refer to the online WinDriver support page &#8212; <a class="ulink" href="https://www.jungo.com/st/support/windriver/" target="_top">https://www.jungo.com/st/support/windriver/</a> &#8212;
for additional resources for developers, including

</p><div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Technical documents
  </li><li class="listitem" style="list-style-type: disc">
    FAQs
  </li><li class="listitem" style="list-style-type: disc">
    Samples
  </li><li class="listitem" style="list-style-type: disc">
    Quick start guides
  </li></ul></div><p>
</p></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="Appendix_Limitations"></a>Appendix E. Evaluation Version Limitations</h1></div></div></div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="winpnp_eval_limits"></a>E.1. Windows WinDriver Evaluation Limitations</h2></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Each time WinDriver is activated, an <em class="guilabel">Unregistered</em>
    message appears.
  </li><li class="listitem" style="list-style-type: disc">
    When using DriverWizard, a dialogue box with a message stating that an
    evaluation version is being run appears on every interaction with the
    hardware.
  </li><li class="listitem" style="list-style-type: disc">
    DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a>:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; "><li class="listitem">
        Each time DriverWizard is activated, an
        <em class="guilabel">Unregistered</em> message appears.
      </li><li class="listitem">
        An evaluation message is displayed on every interaction with the
        hardware using DriverWizard.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc">
    WinDriver will function for only 30 days after the original installation.
  </li></ul></div>
</div><div class="section"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="linux_eval_limits"></a>E.2. Linux WinDriver Evaluation Limitations</h2></div></div></div>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
    Each time WinDriver is activated, an <em class="guilabel">Unregistered</em>
    message appears.
  </li><li class="listitem" style="list-style-type: disc">
    DriverWizard<a class="xref" href="#driverwizard" title="Chapter 4. Using DriverWizard"><fo:inline xmlns:fo="http://www.w3.org/1999/XSL/Format"> [4]</fo:inline></a>:

    <div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: bullet; "><li class="listitem" style="list-style-type: disc">
        Each time DriverWizard is activated, an
        <em class="guilabel">Unregistered</em> message appears.
      </li><li class="listitem" style="list-style-type: disc">
        An evaluation message is displayed on every interaction with the
        hardware using DriverWizard.
      </li></ul></div></li><li class="listitem" style="list-style-type: disc"><p>
  WinDriver's kernel module will work for no more than 60 minutes at a time. To
  continue working, the WinDriver kernel module must be reloaded (unload and load
  the module) using the following commands:
    

  </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="scripts/images/note.png"></td><th align="left"></th></tr><tr><td align="left" valign="top">
  The following commands must be executed with root privileges.
  </td></tr></table></div><p>
  </p><p>
    To unload &#8212;<br>
    <strong class="jcmd"><code># /sbin/modprobe -r windrvr1281</code></strong>
      
    </p><p>
    To load &#8212;<br>
    <strong class="jcmd"><code># &lt;path to wdreg&gt; windrvr1281</code></strong>
    </p><p>
    <span class="jprintfilename"><strong>wdreg</strong></span> is provided in the
  <span class="jdirectory"><strong>WinDriver/util</strong></span>
  directory.

    </p></li></ul></div>
</div></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="purchasing_wd"></a>Appendix F. Purchasing WinDriver</h1></div></div></div><p>
Visit the WinDriver order page on our web site &#8212; <a class="ulink" href="https://www.jungo.com/st/order_wd/" target="_top">https://www.jungo.com/st/order_wd/</a> &#8212;
to select your WinDriver product(s) and receive a quote. Then fill in the WinDriver
order form &#8212; available for download from the order page &#8212; and send
it to Jungo by email or fax (see details in the order form and in the
online order page). If you have installed the evaluation version of WinDriver, you
can also find the order form in the
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/docs</strong></span></span> directory, or
access it via
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jmenupath"><strong>Start | WinDriver | Order Form</strong></span></span> on
Windows.
</p><p>
The WinDriver license string will be emailed to you immediately.<br>
Your WinDriver package will be sent to you via courier or registered mail.
</p><p>
Feel free to contact us with any question you may have. For full contact
information, visit our contact web page: <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/company/contact-us/" target="_top">https://www.jungo.com/st/company/contact-us/</a></span>.
</p></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="Distrib_Legal"></a>Appendix G. Distributing Your Driver &#8212; Legal Issues</h1></div></div></div><p>
WinDriver is licensed per-seat. The WinDriver license allows one developer on a single
machine to develop a device driver for a single device (VID/DID (PCI) or 
VID/PID (USB)), and to freely distribute the created driver without royalties,
as outlined in the license agreement in the <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><span class="jdirectory"><strong>WinDriver/docs/</strong></span><span class="jprintfilename"><strong>wd_license.pdf</strong></span></span> file.
</p></div><div class="appendix"><div class="titlepage"><div><div><h1 class="title"><a name="additional_doc"></a>Appendix H. Additional Documentation</h1></div></div></div><h4><a name="idp46253661322464"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">Updated Manuals</span></div><p>
The most updated WinDriver user manuals can be found on Jungo's site at
<span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/windriver/" target="_top">https://www.jungo.com/st/support/windriver/</a></span>.
</p><h4><a name="idp46253661324256"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">Version History</span></div><p>
If you wish to view WinDriver version history, refer to the WinDriver release notes,
available online at <span xmlns:fo="http://www.w3.org/1999/XSL/Format" style="white-space:nowrap"><a class="ulink" href="https://www.jungo.com/st/support/windriver/wdver/" target="_top">https://www.jungo.com/st/support/windriver/wdver/</a></span>. The release notes include a list of the
new features, enhancements and fixes that have been added in each WinDriver
version.
</p><h4><a name="idp46253661326288"></a></h4><div xmlns:fo="http://www.w3.org/1999/XSL/Format" style="font-size: 1.5em"><span class="bridgehead">Technical Documents</span></div><p>
For additional information, refer to the WinDriver Technical Documents
database:<br>
<a class="ulink" href="https://www.jungo.com/st/support/tech_docs_indexes/main_index.html" target="_top">https://www.jungo.com/st/support/tech_docs_indexes/main_index.html</a>.<br>
This database includes detailed descriptions of WinDriver's features,
utilities and APIs and their correct usage, troubleshooting of common
problems, useful tips and answers to frequently asked questions.
</p></div></div><HR><table class="footer" width="100%"><tr><td width="33.33%" align="left"><span xmlns:fo="http://www.w3.org/1999/XSL/Format" class="j_footer_copyright">
  © 2018 Jungo Connectivity Ltd.
</span></td><td width="33.33%" align="right">CONFIDENTIAL</td></tr></table></body></html>
